Private Sub edite_bilan_n()
'animationv1
'mise en forme conditionnelle
Sheets("feuil28").Range("zb18") = 1

'délai d'essai
date_test = Now()
If Year(2020) > 2017 Then
MsgBox "Délai d'essai expiré we in 1 !"
Else

'condition d'installation
'If Sheets("feuil12").Range("a100") = Left(Sheets("feuil12").Range("a101"), 10) Then

'condition d'édition du bilan N
If WorksheetFunction.Sum(Sheets("feuil2").Range("g1:h5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à éditer."
Else
'If WorksheetFunction.Sum(Sheets("feuil6").Range("i13:i54")) = 0 Then
If Sheets("feuil6").Range("i54") = "" Then
MsgBox "Veuillez d'abord éditer le Compte de résultat N !"
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition du Bilan N ?", vbYesNo, "Demande de confirmation") = vbYes Then

'affecte la date au 31/12/N
If Sheets("feuil4").Range("k9") = "" Then
Sheets("feuil5").Range("g9") = "-"
Else
Sheets("feuil5").Range("g9") = Sheets("feuil4").Range("k9")
End If

'efface d'abord les données du bilan
Sheets("feuil5").Range("e14:g47").ClearContents 'actif
Sheets("feuil5").Range("m13:m47").ClearContents 'passif
Sheets("feuil5").Range("b21").ClearContents 'terrain - immeuble de placement
Sheets("feuil5").Range("b25").ClearContents 'bâtiment - immeuble de placement
Sheets("feuil23").Range("c16:k35").ClearContents 'tableau 1 - Actif immobilisé N


For i = 3 To 5000

'recup ACTIF DU BILAN
'recup compte 211 et 2181
If Left(Sheets("feuil2").Cells(i, 1), 3) = 211 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2181 Then
Sheets("feuil28").Cells(i, 1) = Sheets("feuil2").Cells(i, 7) 'colonne A
Else
End If

'recup compte 2811 et 28181
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2811 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 28181 Then 'compte 2811 et 28181
Sheets("feuil28").Cells(i, 2) = Sheets("feuil2").Cells(i, 8) 'colonne B
Else
End If

'recup compte 212
If Left(Sheets("feuil2").Cells(i, 1), 3) = 212 Then 'compte 212
Sheets("feuil28").Cells(i, 3) = Sheets("feuil2").Cells(i, 7) 'colonne C
Else
End If

'recup compte 213
If Left(Sheets("feuil2").Cells(i, 1), 3) = 213 Then 'compte 213
Sheets("feuil28").Cells(i, 4) = Sheets("feuil2").Cells(i, 7) 'colonne D
Else
End If

'recup compte 214
If Left(Sheets("feuil2").Cells(i, 1), 3) = 214 Then 'compte 214
Sheets("feuil28").Cells(i, 5) = Sheets("feuil2").Cells(i, 7) 'colonne E
Else
End If

'recup compte 2812
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2812 Then 'compte 2812
Sheets("feuil28").Cells(i, 6) = Sheets("feuil2").Cells(i, 8) 'colonne F
Else
End If

'recup compte 2813
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2813 Then 'compte 2813
Sheets("feuil28").Cells(i, 7) = Sheets("feuil2").Cells(i, 8) 'colonne G
Else
End If

'recup compte 2814
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2814 Then 'compte 2814
Sheets("feuil28").Cells(i, 8) = Sheets("feuil2").Cells(i, 8) 'colonne H
Else
End If

'recup compte 2912
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2912 Then 'compte 2912
Sheets("feuil28").Cells(i, 9) = Sheets("feuil2").Cells(i, 8) 'colonne I
Else
End If

'recup compte 2913
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2913 Then 'compte 2913
Sheets("feuil28").Cells(i, 10) = Sheets("feuil2").Cells(i, 8) 'colonne J
Else
End If

'recup compte 2914
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2914 Then 'compte 2914
Sheets("feuil28").Cells(i, 11) = Sheets("feuil2").Cells(i, 8) 'colonne K
Else
End If

'recup compte 215
If Left(Sheets("feuil2").Cells(i, 1), 3) = 215 Then 'compte 215
Sheets("feuil28").Cells(i, 12) = Sheets("feuil2").Cells(i, 7) 'colonne L
Else
End If

'recup compte 216
If Left(Sheets("feuil2").Cells(i, 1), 3) = 216 Then 'compte 216
Sheets("feuil28").Cells(i, 13) = Sheets("feuil2").Cells(i, 7) 'colonne M
Else
End If

'recup compte 2815
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2815 Then 'compte 2815
Sheets("feuil28").Cells(i, 14) = Sheets("feuil2").Cells(i, 8) 'colonne N
Else
End If

'recup compte 2816
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2816 Then 'compte 2816
Sheets("feuil28").Cells(i, 15) = Sheets("feuil2").Cells(i, 8) 'colonne O
Else
End If

'recup compte 2915
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2915 Then 'compte 2915
Sheets("feuil28").Cells(i, 16) = Sheets("feuil2").Cells(i, 8) 'colonne P
Else
End If

'recup compte 2916
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2916 Then 'compte 2916
Sheets("feuil28").Cells(i, 17) = Sheets("feuil2").Cells(i, 8) 'colonne Q
Else
End If

'recup compte 217
If Left(Sheets("feuil2").Cells(i, 1), 3) = 217 Then 'compte 217
Sheets("feuil28").Cells(i, 18) = Sheets("feuil2").Cells(i, 7) 'colonne R
Else
End If

'recup compte 218
If Left(Sheets("feuil2").Cells(i, 1), 3) = 218 Then 'compte 218
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2181 Then
Else
Sheets("feuil28").Cells(i, 19) = Sheets("feuil2").Cells(i, 7) 'colonne S
End If
Else
End If

'recup compte 2817
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2817 Then 'compte 2817
Sheets("feuil28").Cells(i, 20) = Sheets("feuil2").Cells(i, 8) 'colonne T
Else
End If

'recup compte 2818
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2818 Then 'compte 2818
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28181 Then
Else
Sheets("feuil28").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'colonne U
End If
Else
End If

'recup compte 2917
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2917 Then 'compte 2917
Sheets("feuil28").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'colonne V
Else
End If

'recup compte 2918
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2918 Then 'compte 2918
If Left(Sheets("feuil2").Cells(i, 1), 5) = 29181 Then
Else
Sheets("feuil28").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'colonne W
End If
Else
End If

'recup compte 2191
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2191 Then 'compte 2191
Sheets("feuil28").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'colonne X
Else
End If

'recup compte 2193
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2193 Then 'compte 2193
Sheets("feuil28").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'colonne Y
Else
End If

'recup compte 2198
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2198 Then 'compte 2198
Sheets("feuil28").Cells(i, 26) = Sheets("feuil2").Cells(i, 7) 'colonne Z
Else
End If

'recup compte 29191 + 2911 + 29181
If Left(Sheets("feuil2").Cells(i, 1), 5) = 29191 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29181 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2911 Then  'compte 29191
Sheets("feuil28").Cells(i, 27) = Sheets("feuil2").Cells(i, 8) 'colonne AA
Else
End If

'recup compte 29193
If Left(Sheets("feuil2").Cells(i, 1), 5) = 29193 Then 'compte 29193
Sheets("feuil28").Cells(i, 28) = Sheets("feuil2").Cells(i, 8) 'colonne AB
Else
End If

'recup compte 29198
If Left(Sheets("feuil2").Cells(i, 1), 5) = 29198 Then 'compte 29198
Sheets("feuil28").Cells(i, 29) = Sheets("feuil2").Cells(i, 8) 'colonne AC
Else
End If

'recup compte 22
If Left(Sheets("feuil2").Cells(i, 1), 2) = 22 Then 'compte 22 sauf 229
If Left(Sheets("feuil2").Cells(i, 1), 3) = 229 Then
Else
Sheets("feuil28").Cells(i, 30) = Sheets("feuil2").Cells(i, 7) 'colonne AD
End If
Else
End If

'recup compte 282
If Left(Sheets("feuil2").Cells(i, 1), 3) = 282 Then 'compte 282
Sheets("feuil28").Cells(i, 31) = Sheets("feuil2").Cells(i, 8) 'colonne AE
Else
End If

'recup compte 292
If Left(Sheets("feuil2").Cells(i, 1), 3) = 292 Then 'compte 292 sauf 2929
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2929 Then
Else
Sheets("feuil28").Cells(i, 32) = Sheets("feuil2").Cells(i, 8) 'colonne AF
End If
Else
End If

'recup compte 231
If Left(Sheets("feuil2").Cells(i, 1), 3) = 231 Then 'compte 231
Sheets("feuil28").Cells(i, 33) = Sheets("feuil2").Cells(i, 7) 'colonne AG
Else
End If

'recup compte 232
If Left(Sheets("feuil2").Cells(i, 1), 3) = 232 Then 'compte 232
Sheets("feuil28").Cells(i, 34) = Sheets("feuil2").Cells(i, 7) 'colonne AH
Else
End If

'recup compte 233
If Left(Sheets("feuil2").Cells(i, 1), 3) = 233 Then 'compte 233
Sheets("feuil28").Cells(i, 35) = Sheets("feuil2").Cells(i, 7) 'colonne AI
Else
End If

'recup compte 237
If Left(Sheets("feuil2").Cells(i, 1), 3) = 237 Then 'compte 237
Sheets("feuil28").Cells(i, 36) = Sheets("feuil2").Cells(i, 7) 'colonne AJ
Else
End If

'recup compte 2831
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2831 Then 'compte 2831
Sheets("feuil28").Cells(i, 37) = Sheets("feuil2").Cells(i, 8) 'colonne AK
Else
End If

'recup compte 2832
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2832 Then 'compte 2832
Sheets("feuil28").Cells(i, 38) = Sheets("feuil2").Cells(i, 8) 'colonne AL
Else
End If

'recup compte 2833
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2833 Then 'compte 2833
Sheets("feuil28").Cells(i, 39) = Sheets("feuil2").Cells(i, 8) 'colonne AM
Else
End If

'recup compte 2837
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2837 Then 'compte 2837
Sheets("feuil28").Cells(i, 40) = Sheets("feuil2").Cells(i, 8) 'colonne AN
Else
End If

'recup compte 2931
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2931 Then 'compte 2931
Sheets("feuil28").Cells(i, 41) = Sheets("feuil2").Cells(i, 8) 'colonne AO
Else
End If

'recup compte 2932
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2932 Then 'compte 2932
Sheets("feuil28").Cells(i, 42) = Sheets("feuil2").Cells(i, 8) 'colonne AP
Else
End If

'recup compte 2933
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2933 Then 'compte 2933
Sheets("feuil28").Cells(i, 43) = Sheets("feuil2").Cells(i, 8) 'colonne AQ
Else
End If

'recup compte 2937
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2937 Then 'compte 2937
Sheets("feuil28").Cells(i, 44) = Sheets("feuil2").Cells(i, 8) 'colonne AR
Else
End If

'recup compte 234
If Left(Sheets("feuil2").Cells(i, 1), 3) = 234 Then 'compte 234
Sheets("feuil28").Cells(i, 45) = Sheets("feuil2").Cells(i, 7) 'colonne AS
Else
End If

'recup compte 235
If Left(Sheets("feuil2").Cells(i, 1), 3) = 235 Then 'compte 235
Sheets("feuil28").Cells(i, 46) = Sheets("feuil2").Cells(i, 7) 'colonne AT
Else
End If

'recup compte 238
If Left(Sheets("feuil2").Cells(i, 1), 3) = 238 Then 'compte 238
Sheets("feuil28").Cells(i, 47) = Sheets("feuil2").Cells(i, 7) 'colonne AU
Else
End If

'recup compte 2834
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2834 Then 'compte 2834
Sheets("feuil28").Cells(i, 48) = Sheets("feuil2").Cells(i, 8) 'colonne AV
Else
End If

'recup compte 2835
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2835 Then 'compte 2835
Sheets("feuil28").Cells(i, 49) = Sheets("feuil2").Cells(i, 8) 'colonne AW
Else
End If

'recup compte 2838
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2838 Then 'compte 2838
Sheets("feuil28").Cells(i, 50) = Sheets("feuil2").Cells(i, 8) 'colonne AX
Else
End If

'recup compte 2934
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2934 Then 'compte 2934
Sheets("feuil28").Cells(i, 51) = Sheets("feuil2").Cells(i, 8) 'colonne AY
Else
End If

'recup compte 2935
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2935 Then 'compte 2935
Sheets("feuil28").Cells(i, 52) = Sheets("feuil2").Cells(i, 8) 'colonne AZ
Else
End If

'recup compte 2938
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2938 Then 'compte 2938
Sheets("feuil28").Cells(i, 53) = Sheets("feuil2").Cells(i, 8) 'colonne BA
Else
End If

'recup compte 24
If Left(Sheets("feuil2").Cells(i, 1), 2) = 24 Then 'compte 24 sauf 249+245
If Left(Sheets("feuil2").Cells(i, 1), 3) = 249 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 3) = 245 Then
Else
Sheets("feuil28").Cells(i, 54) = Sheets("feuil2").Cells(i, 7) 'colonne BB
End If
End If
Else
End If

'recup compte 284
If Left(Sheets("feuil2").Cells(i, 1), 3) = 284 Then 'compte 284 sauf 2845
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2845 Then
Else
Sheets("feuil28").Cells(i, 55) = Sheets("feuil2").Cells(i, 8) 'colonne BC
End If
Else
End If

'recup compte 294
If Left(Sheets("feuil2").Cells(i, 1), 3) = 294 Then 'compte 294 sauf 2949+2945
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2949 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2945 Then
Else
Sheets("feuil28").Cells(i, 56) = Sheets("feuil2").Cells(i, 8) 'colonne BD
End If
End If
Else
End If

'recup compte 229
If Left(Sheets("feuil2").Cells(i, 1), 3) = 229 Then 'compte 229
Sheets("feuil28").Cells(i, 57) = Sheets("feuil2").Cells(i, 7) 'colonne BE
Else
End If

'recup compte 239
If Left(Sheets("feuil2").Cells(i, 1), 3) = 239 Then 'compte 239
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2394 Then 'compte 2394
Else
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2395 Then 'compte 2395
Else
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2398 Then 'compte 2398
Else
Sheets("feuil28").Cells(i, 58) = Sheets("feuil2").Cells(i, 7) 'colonne BF
End If
End If
End If
Else
End If

'recup compte 249
If Left(Sheets("feuil2").Cells(i, 1), 3) = 249 Then 'compte 249
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2495 Then 'compte 2495
Else
Sheets("feuil28").Cells(i, 59) = Sheets("feuil2").Cells(i, 7) 'colonne BG
End If
Else
End If

'recup compte 2929
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2929 Then 'compte 2929
Sheets("feuil28").Cells(i, 60) = Sheets("feuil2").Cells(i, 8) 'colonne BH
Else
End If

'recup compte 2939
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2939 Then 'compte 2939
If Left(Sheets("feuil2").Cells(i, 1), 5) = 29394 Then 'compte 29394
Else
If Left(Sheets("feuil2").Cells(i, 1), 5) = 29395 Then 'compte 29395
Else
If Left(Sheets("feuil2").Cells(i, 1), 5) = 29398 Then 'compte 29398
Else
Sheets("feuil28").Cells(i, 61) = Sheets("feuil2").Cells(i, 8) 'colonne BI
End If
End If
End If
Else
End If

'recup compte 2949
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2949 Then 'compte 2949
If Left(Sheets("feuil2").Cells(i, 1), 5) = 29495 Then 'compte 29495
Else
Sheets("feuil28").Cells(i, 62) = Sheets("feuil2").Cells(i, 8) 'colonne BJ
End If
Else
End If

'recup compte 25
If Left(Sheets("feuil2").Cells(i, 1), 2) = 25 Then 'compte 25
Sheets("feuil28").Cells(i, 63) = Sheets("feuil2").Cells(i, 7) 'colonne BK
Else
End If

'recup compte 295
If Left(Sheets("feuil2").Cells(i, 1), 3) = 295 Then 'compte 295
Sheets("feuil28").Cells(i, 64) = Sheets("feuil2").Cells(i, 8) 'colonne BL
Else
End If

'recup compte 26
If Left(Sheets("feuil2").Cells(i, 1), 2) = 26 Then 'compte 26
Sheets("feuil28").Cells(i, 65) = Sheets("feuil2").Cells(i, 7) 'colonne BM
Else
End If

'recup compte 296
If Left(Sheets("feuil2").Cells(i, 1), 3) = 296 Then 'compte 296
Sheets("feuil28").Cells(i, 66) = Sheets("feuil2").Cells(i, 8) 'colonne BN
Else
End If

'recup compte 27
If Left(Sheets("feuil2").Cells(i, 1), 2) = 27 Then 'compte 27
Sheets("feuil28").Cells(i, 67) = Sheets("feuil2").Cells(i, 7) 'colonne BO
Else
End If

'recup compte 297
If Left(Sheets("feuil2").Cells(i, 1), 3) = 297 Then 'compte 297
Sheets("feuil28").Cells(i, 68) = Sheets("feuil2").Cells(i, 8) 'colonne BP
Else
End If

'recup compte 3
If Left(Sheets("feuil2").Cells(i, 1), 1) = 3 Then 'compte 3
Sheets("feuil28").Cells(i, 69) = Sheets("feuil2").Cells(i, 7) 'colonne BQ
Else
End If

'recup compte 39
If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then 'compte 39
Sheets("feuil28").Cells(i, 70) = Sheets("feuil2").Cells(i, 8) 'colonne BR
Else
End If

'recup compte 409
If Left(Sheets("feuil2").Cells(i, 1), 3) = 409 Then 'compte 409
Sheets("feuil28").Cells(i, 71) = Sheets("feuil2").Cells(i, 7) 'colonne BS
Else
End If

'recup compte 490
If Left(Sheets("feuil2").Cells(i, 1), 3) = 490 Then 'compte 490
Sheets("feuil28").Cells(i, 72) = Sheets("feuil2").Cells(i, 8) 'colonne BT
Else
End If

'recup compte 41
If Left(Sheets("feuil2").Cells(i, 1), 2) = 41 Then 'compte 41 sauf 419
If Left(Sheets("feuil2").Cells(i, 1), 3) = 419 Then
Else
Sheets("feuil28").Cells(i, 73) = Sheets("feuil2").Cells(i, 7) 'colonne BU
End If
Else
End If

'recup compte 491
If Left(Sheets("feuil2").Cells(i, 1), 3) = 491 Then 'compte 491
Sheets("feuil28").Cells(i, 74) = Sheets("feuil2").Cells(i, 8) 'colonne BV
Else
End If

'recup compte 42
If Left(Sheets("feuil2").Cells(i, 1), 2) = 42 Then 'compte 42
Sheets("feuil28").Cells(i, 75) = Sheets("feuil2").Cells(i, 7) 'colonne BW
Else
End If

'recup compte 43
If Left(Sheets("feuil2").Cells(i, 1), 2) = 43 Then 'compte 43
Sheets("feuil28").Cells(i, 76) = Sheets("feuil2").Cells(i, 7) 'colonne BX
Else
End If

'recup compte 44
If Left(Sheets("feuil2").Cells(i, 1), 2) = 44 Then 'compte 44
Sheets("feuil28").Cells(i, 77) = Sheets("feuil2").Cells(i, 7) 'colonne BY
Else
End If

'recup compte 45
If Left(Sheets("feuil2").Cells(i, 1), 2) = 45 Then 'compte 45
Sheets("feuil28").Cells(i, 78) = Sheets("feuil2").Cells(i, 7) 'colonne BZ
Else
End If

'recup compte 46
If Left(Sheets("feuil2").Cells(i, 1), 2) = 46 Then 'compte 46
Sheets("feuil28").Cells(i, 79) = Sheets("feuil2").Cells(i, 7) 'colonne CA
Else
End If

'recup compte 47
If Left(Sheets("feuil2").Cells(i, 1), 2) = 47 Then 'compte 47
If Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Then
Else
Sheets("feuil28").Cells(i, 80) = Sheets("feuil2").Cells(i, 7) 'colonne CB
End If
End If
Else
End If

'recup compte 48
If Left(Sheets("feuil2").Cells(i, 1), 2) = 48 Then 'compte 48
Sheets("feuil28").Cells(i, 81) = Sheets("feuil2").Cells(i, 7) 'colonne CC
Else
End If

'recup compte 492
If Left(Sheets("feuil2").Cells(i, 1), 3) = 492 Then 'compte 492
Sheets("feuil28").Cells(i, 82) = Sheets("feuil2").Cells(i, 8) 'colonne CD
Else
End If

'recup compte 493
If Left(Sheets("feuil2").Cells(i, 1), 3) = 493 Then 'compte 493
Sheets("feuil28").Cells(i, 83) = Sheets("feuil2").Cells(i, 8) 'colonne CE
Else
End If

'recup compte 494
If Left(Sheets("feuil2").Cells(i, 1), 3) = 494 Then 'compte 494
Sheets("feuil28").Cells(i, 84) = Sheets("feuil2").Cells(i, 8) 'colonne CF
Else
End If

'recup compte 495
If Left(Sheets("feuil2").Cells(i, 1), 3) = 495 Then 'compte 495
Sheets("feuil28").Cells(i, 85) = Sheets("feuil2").Cells(i, 8) 'colonne CG
Else
End If

'recup compte 496
If Left(Sheets("feuil2").Cells(i, 1), 3) = 496 Then 'compte 496
Sheets("feuil28").Cells(i, 86) = Sheets("feuil2").Cells(i, 8) 'colonne CH
Else
End If

'adaptation SYSCOHADA révisé recup compte 497 + 4986
If Left(Sheets("feuil2").Cells(i, 1), 3) = 497 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4986 Then  'compte 497+4986
Sheets("feuil28").Cells(i, 87) = Sheets("feuil2").Cells(i, 8) 'colonne CI
Else
End If

'adaptation SYSCOHADA révisé recup compte 498 sauf 4986
If Left(Sheets("feuil2").Cells(i, 1), 3) = 498 Then 'compte 498
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4986 Then
Else
Sheets("feuil28").Cells(i, 88) = Sheets("feuil2").Cells(i, 8) 'colonne CJ
End If
Else
End If



'ADAPTATION DES COMPTES AU SYSCOHADA
'recup compte 2394
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2394 Then
Sheets("feuil28").Cells(i, 276) = Sheets("feuil2").Cells(i, 7) 'colonne JP
Else
End If

'recup compte 2395
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2395 Then
Sheets("feuil28").Cells(i, 277) = Sheets("feuil2").Cells(i, 7) 'colonne JQ
Else
End If

'recup compte 2398
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2398 Then
Sheets("feuil28").Cells(i, 278) = Sheets("feuil2").Cells(i, 7) 'colonne JR
Else
End If

'recup compte 29394
If Left(Sheets("feuil2").Cells(i, 1), 5) = 29394 Then
Sheets("feuil28").Cells(i, 279) = Sheets("feuil2").Cells(i, 8) 'colonne JS
Else
End If

'recup compte 29395
If Left(Sheets("feuil2").Cells(i, 1), 5) = 29395 Then
Sheets("feuil28").Cells(i, 280) = Sheets("feuil2").Cells(i, 8) 'colonne JT
Else
End If

'recup compte 29398
If Left(Sheets("feuil2").Cells(i, 1), 5) = 29398 Then
Sheets("feuil28").Cells(i, 281) = Sheets("feuil2").Cells(i, 8) 'colonne JU
Else
End If

'recup compte 245
If Left(Sheets("feuil2").Cells(i, 1), 3) = 245 Then
Sheets("feuil28").Cells(i, 282) = Sheets("feuil2").Cells(i, 7) 'colonne JV
Else
End If

'recup compte 2495
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2495 Then
Sheets("feuil28").Cells(i, 283) = Sheets("feuil2").Cells(i, 7) 'colonne JW
Else
End If

'recup compte 2845
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2845 Then
Sheets("feuil28").Cells(i, 284) = Sheets("feuil2").Cells(i, 8) 'colonne JX
Else
End If

'recup compte 2945
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2945 Then
Sheets("feuil28").Cells(i, 285) = Sheets("feuil2").Cells(i, 8) 'colonne JY
Else
End If

'recup compte 29495
If Left(Sheets("feuil2").Cells(i, 1), 5) = 29495 Then
Sheets("feuil28").Cells(i, 286) = Sheets("feuil2").Cells(i, 8) 'colonne JZ
Else
End If

'recup compte 478
If Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Then
Sheets("feuil28").Cells(i, 314) = Sheets("feuil2").Cells(i, 7) 'colonne LB
Else
End If

'ADAPTATION AU SYSCOHADA révisé (immeubles de placement)
'recup compte 2281
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2281 Then
Sheets("feuil28").Cells(i, 320) = Sheets("feuil2").Cells(i, 7) 'colonne LH
Else
End If

'recup compte 29281
If Left(Sheets("feuil2").Cells(i, 1), 5) = 29281 Then
Sheets("feuil28").Cells(i, 321) = Sheets("feuil2").Cells(i, 8) 'colonne LI
Else
End If

'recup compte 2315+2325
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2315 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2325 Then
Sheets("feuil28").Cells(i, 322) = Sheets("feuil2").Cells(i, 7) 'colonne LJ
Else
End If

'recup compte 28315+28325+29315+29325
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28315 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 28325 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29315 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29325 Then
Sheets("feuil28").Cells(i, 323) = Sheets("feuil2").Cells(i, 8) 'colonne LK
Else
End If



Next

'Affecte ACTIF DU BILAN
'affecte compte 211+2191+218 poste AE
Sheets("feuil28").Range("a5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("a1:a5000")) 'compte 211
Sheets("feuil28").Range("x5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("x1:x5000")) 'compte 2191
Sheets("feuil5").Range("e14") = Sheets("feuil28").Range("a5001") + Sheets("feuil28").Range("x5001")
'affecte compte 2811+28181+2911+29181+29191 poste AE
Sheets("feuil28").Range("b5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("b1:b5000")) 'compte 2811
Sheets("feuil28").Range("aa5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("aa1:aa5000")) 'compte 29191
Sheets("feuil5").Range("f14") = Sheets("feuil28").Range("b5001") + Sheets("feuil28").Range("aa5001")
'calcul
Sheets("feuil5").Range("g14") = Sheets("feuil5").Range("e14") - Sheets("feuil5").Range("f14")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("i16") = Sheets("feuil5").Range("e14")


'affecte comptes 212+213+214+2193 poste AF
Sheets("feuil28").Range("c5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("c1:c5000")) 'compte 212
Sheets("feuil28").Range("d5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("d1:d5000")) 'compte 213
Sheets("feuil28").Range("e5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("e1:e5000")) 'compte 214
Sheets("feuil28").Range("y5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("y1:y5000")) 'compte 2193
Sheets("feuil5").Range("e15") = Sheets("feuil28").Range("c5001") + Sheets("feuil28").Range("d5001") + Sheets("feuil28").Range("e5001") + Sheets("feuil28").Range("y5001")
'affecte comptes 2812+2813+2814 et 2912+2913+2914+29193 poste AF
Sheets("feuil28").Range("f5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("f1:f5000")) 'compte 2812
Sheets("feuil28").Range("g5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("g1:g5000")) 'compte 2813
Sheets("feuil28").Range("h5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("h1:h5000")) 'compte 2814
Sheets("feuil28").Range("i5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("i1:i5000")) 'compte 2912
Sheets("feuil28").Range("j5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("j1:j5000")) 'compte 2913
Sheets("feuil28").Range("k5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("k1:k5000")) 'compte 2914
Sheets("feuil28").Range("ab5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ab1:ab5000")) 'compte 29193
Sheets("feuil5").Range("f15") = Sheets("feuil28").Range("f5001") + Sheets("feuil28").Range("g5001") + Sheets("feuil28").Range("h5001") + Sheets("feuil28").Range("i5001") + Sheets("feuil28").Range("j5001") + Sheets("feuil28").Range("k5001") + Sheets("feuil28").Range("ab5001")
'calcul
Sheets("feuil5").Range("g15") = Sheets("feuil5").Range("e15") - Sheets("feuil5").Range("f15")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("i17") = Sheets("feuil5").Range("e15")

'affecte comptes 215+216 poste AG
Sheets("feuil28").Range("l5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("l1:l5000")) 'compte 215
Sheets("feuil28").Range("m5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("m1:m5000")) 'compte 216
Sheets("feuil5").Range("e16") = Sheets("feuil28").Range("l5001") + Sheets("feuil28").Range("m5001")
'affecte comptes 2815+2816 et 2915+2916 poste AG
Sheets("feuil28").Range("n5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("n1:n5000")) 'compte 2815
Sheets("feuil28").Range("o5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("o1:o5000")) 'compte 2816
Sheets("feuil28").Range("p5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("p1:p5000")) 'compte 2915
Sheets("feuil28").Range("q5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("q1:q5000")) 'compte 2916
Sheets("feuil5").Range("f16") = Sheets("feuil28").Range("n5001") + Sheets("feuil28").Range("o5001") + Sheets("feuil28").Range("p5001") + Sheets("feuil28").Range("q5001")
'calcul
Sheets("feuil5").Range("g16") = Sheets("feuil5").Range("e16") - Sheets("feuil5").Range("f16")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("i18") = Sheets("feuil5").Range("e16")

'affecte comptes 217+218+2198 poste AH
Sheets("feuil28").Range("r5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("r1:r5000")) 'compte 217
Sheets("feuil28").Range("s5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("s1:s5000")) 'compte 218
Sheets("feuil28").Range("z5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("z1:z5000")) 'compte 2198
Sheets("feuil5").Range("e17") = Sheets("feuil28").Range("r5001") + Sheets("feuil28").Range("s5001") + Sheets("feuil28").Range("z5001")
'affecte comptes 2817+2818 et 2917+2918 poste AH
Sheets("feuil28").Range("t5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("t1:t5000")) 'compte 2817
Sheets("feuil28").Range("u5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("u1:u5000")) 'compte 2818
Sheets("feuil28").Range("v5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("v1:v5000")) 'compte 2917
Sheets("feuil28").Range("w5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("w1:w5000")) 'compte 2918
Sheets("feuil28").Range("ac5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ac1:ac5000")) 'compte 29198
Sheets("feuil5").Range("f17") = Sheets("feuil28").Range("t5001") + Sheets("feuil28").Range("u5001") + Sheets("feuil28").Range("v5001") + Sheets("feuil28").Range("w5001") + Sheets("feuil28").Range("ac5001")
'calcul
Sheets("feuil5").Range("g17") = Sheets("feuil5").Range("e17") - Sheets("feuil5").Range("f17")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("i19") = Sheets("feuil5").Range("e17")

'affecte comptes 22+229 poste AK
Sheets("feuil28").Range("ad5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ad1:ad5000")) 'compte 22
Sheets("feuil28").Range("be5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("be1:be5000")) 'compte 229
Sheets("feuil5").Range("e19") = Sheets("feuil28").Range("ad5001") + Sheets("feuil28").Range("be5001")
'affecte comptes 282+292+2929 poste AK
Sheets("feuil28").Range("ae5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ae1:ae5000")) 'compte 282
Sheets("feuil28").Range("af5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("af1:af5000")) 'compte 292
Sheets("feuil28").Range("bh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bh1:bh5000")) 'compte 2929
Sheets("feuil5").Range("f19") = Sheets("feuil28").Range("ae5001") + Sheets("feuil28").Range("af5001") + Sheets("feuil28").Range("bh5001")
'calcul
Sheets("feuil5").Range("g19") = Sheets("feuil5").Range("e19") - Sheets("feuil5").Range("f19")
'adaptaion SYSCOHADA révisé (terrains - immeuble de placement)
'affecte bilan comptes 2281-29281 (placements en net)
Sheets("feuil28").Range("lh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lh1:lh5000")) 'compte 2281
Sheets("feuil28").Range("li5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("li1:li5000")) 'compte 29281
Sheets("feuil5").Range("b21") = Sheets("feuil28").Range("lh5001") - Sheets("feuil28").Range("li5001")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("i22") = Sheets("feuil28").Range("lh5001") 'terrains - immeuble de placement
Sheets("feuil23").Range("i21") = Sheets("feuil5").Range("e19") - Sheets("feuil28").Range("lh5001") 'terrains hors immeuble de placement


'affecte comptes 231+232+233+237 et 239 sauf 2394+2395+2398 poste AL
Sheets("feuil28").Range("ag5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ag1:ag5000")) 'compte 231
Sheets("feuil28").Range("ah5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ah1:ah5000")) 'compte 232
Sheets("feuil28").Range("ai5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ai1:ai5000")) 'compte 233
Sheets("feuil28").Range("aj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("aj1:aj5000")) 'compte 237
Sheets("feuil28").Range("bf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bf1:bf5000")) 'compte 239
Sheets("feuil5").Range("e23") = Sheets("feuil28").Range("ag5001") + Sheets("feuil28").Range("ah5001") + Sheets("feuil28").Range("ai5001") + Sheets("feuil28").Range("aj5001") + Sheets("feuil28").Range("bf5001")
'affecte comptes 2831+2832+2833+2837 et 2931+2932+2933+2937 et 2939 sauf 29394+29395+29398 poste AL
Sheets("feuil28").Range("ak5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ak1:ak5000")) 'compte 2831
Sheets("feuil28").Range("al5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("al1:al5000")) 'compte 2832
Sheets("feuil28").Range("am5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("am1:am5000")) 'compte 2833
Sheets("feuil28").Range("an5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("an1:an5000")) 'compte 2837
Sheets("feuil28").Range("ao5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ao1:ao5000")) 'compte 2931
Sheets("feuil28").Range("ap5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ap1:ap5000")) 'compte 2932
Sheets("feuil28").Range("aq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("aq1:aq5000")) 'compte 2933
Sheets("feuil28").Range("ar5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ar1:ar5000")) 'compte 2937
Sheets("feuil28").Range("bi5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bi1:bi5000")) 'compte 2939
Sheets("feuil5").Range("f23") = Sheets("feuil28").Range("ak5001") + Sheets("feuil28").Range("al5001") + Sheets("feuil28").Range("am5001") + Sheets("feuil28").Range("an5001") + Sheets("feuil28").Range("ao5001") + Sheets("feuil28").Range("ap5001") + Sheets("feuil28").Range("aq5001") + Sheets("feuil28").Range("ar5001") + Sheets("feuil28").Range("bi5001")
'calcul
Sheets("feuil5").Range("g23") = Sheets("feuil5").Range("e23") - Sheets("feuil5").Range("f23")
'adaptaion SYSCOHADA révisé (bâtiments - immeuble de placement)
'affecte bilan comptes (2315+2325)-(28315+28325+29315+29325) (placements en net)
Sheets("feuil28").Range("lj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lj1:lj5000")) 'comptes 2315+2325
Sheets("feuil28").Range("lk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lk1:lk5000")) 'compte 28315+28325+29315+29325
Sheets("feuil5").Range("b25") = Sheets("feuil28").Range("lj5001") - Sheets("feuil28").Range("lk5001")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("i24") = Sheets("feuil28").Range("lj5001") 'bâtiments - immeuble de placement
Sheets("feuil23").Range("i23") = Sheets("feuil5").Range("e23") - Sheets("feuil28").Range("lj5001") 'bâtiments hors immeuble de placement


'affecte comptes 234+235+238 et 2394+2395+2398 poste AM
Sheets("feuil28").Range("as5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("as1:as5000")) 'compte 234
Sheets("feuil28").Range("at5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("at1:at5000")) 'compte 235
Sheets("feuil28").Range("au5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("au1:au5000")) 'compte 238
Sheets("feuil28").Range("jp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jp1:jp5000")) 'compte 2934
Sheets("feuil28").Range("jq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jq1:jq5000")) 'compte 2935
Sheets("feuil28").Range("jr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jr1:jr5000")) 'compte 2938
Sheets("feuil5").Range("e27") = Sheets("feuil28").Range("as5001") + Sheets("feuil28").Range("at5001") + Sheets("feuil28").Range("au5001") + Sheets("feuil28").Range("jp5001") + Sheets("feuil28").Range("jq5001") + Sheets("feuil28").Range("jr5001")
'affecte comptes 2834+2835+2838 et 2934+2935+2938 et 29394+29395+29398 poste AM
Sheets("feuil28").Range("av5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("av1:av5000")) 'compte 2834
Sheets("feuil28").Range("aw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("aw1:aw5000")) 'compte 2835
Sheets("feuil28").Range("ax5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ax1:ax5000")) 'compte 2838
Sheets("feuil28").Range("ay5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ay1:ay5000")) 'compte 2934
Sheets("feuil28").Range("az5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("az1:az5000")) 'compte 2935
Sheets("feuil28").Range("ba5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ba1:ba5000")) 'compte 2938
Sheets("feuil28").Range("js5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("js1:js5000")) 'compte 29394
Sheets("feuil28").Range("jt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jt1:jt5000")) 'compte 29395
Sheets("feuil28").Range("ju5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ju1:ju5000")) 'compte 29398
Sheets("feuil5").Range("f27") = Sheets("feuil28").Range("av5001") + Sheets("feuil28").Range("aw5001") + Sheets("feuil28").Range("ax5001") + Sheets("feuil28").Range("ay5001") + Sheets("feuil28").Range("az5001") + Sheets("feuil28").Range("ba5001") + Sheets("feuil28").Range("js5001") + Sheets("feuil28").Range("jt5001") + Sheets("feuil28").Range("ju5001")
'calcul
Sheets("feuil5").Range("g27") = Sheets("feuil5").Range("e27") - Sheets("feuil5").Range("f27")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("i25") = Sheets("feuil5").Range("e27")

'affecte comptes 24 (sauf 245) + 249 (sauf 2495) poste AN
Sheets("feuil28").Range("bb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bb1:bb5000")) 'compte 24
Sheets("feuil28").Range("bg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bg1:bg5000")) 'compte 249
Sheets("feuil5").Range("e28") = Sheets("feuil28").Range("bb5001") + Sheets("feuil28").Range("bg5001")
'affecte comptes 284 et 294 (sauf 2945) + 2949 (sauf 29495) poste AN
Sheets("feuil28").Range("bc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bc1:bc5000")) 'compte 284
Sheets("feuil28").Range("bd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bd1:bd5000")) 'compte 294
Sheets("feuil28").Range("bj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bj1:bj5000")) 'compte 2949
Sheets("feuil5").Range("f28") = Sheets("feuil28").Range("bc5001") + Sheets("feuil28").Range("bd5001") + Sheets("feuil28").Range("bj5001")
'calcul
Sheets("feuil5").Range("g28") = Sheets("feuil5").Range("e28") - Sheets("feuil5").Range("f28")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("i26") = Sheets("feuil5").Range("e28")

'affecte comptes 245 + 2495 poste AN
Sheets("feuil28").Range("jv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jv1:jv5000")) 'compte 245
Sheets("feuil28").Range("jw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jw1:jw5000")) 'compte 2495
Sheets("feuil5").Range("e29") = Sheets("feuil28").Range("jv5001") + Sheets("feuil28").Range("jw5001")
'affecte comptes 2845 et 2945+29495 poste AN
Sheets("feuil28").Range("jx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jx1:jx5000")) 'compte 2845
Sheets("feuil28").Range("jy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jy1:jy5000")) 'compte 2945
Sheets("feuil28").Range("jz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jz1:jz5000")) 'compte 29495
Sheets("feuil5").Range("f29") = Sheets("feuil28").Range("jx5001") + Sheets("feuil28").Range("jy5001") + Sheets("feuil28").Range("jz5001")
'calcul
Sheets("feuil5").Range("g29") = Sheets("feuil5").Range("e29") - Sheets("feuil5").Range("f29")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("i27") = Sheets("feuil5").Range("e29")

'affecte comptes 25 poste AQ
Sheets("feuil28").Range("bk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bk1:bk5000")) 'compte 25
Sheets("feuil5").Range("e30") = Sheets("feuil28").Range("bk5001")
'affecte comptes 295 poste AQ
Sheets("feuil28").Range("bl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bl1:bl5000")) 'compte 295
Sheets("feuil5").Range("f30") = Sheets("feuil28").Range("bl5001")
'calcul
Sheets("feuil5").Range("g30") = Sheets("feuil5").Range("e30") - Sheets("feuil5").Range("f30")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("i29") = Sheets("feuil5").Range("e30")

'affecte comptes 26 poste AS
Sheets("feuil28").Range("bm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bm1:bm5000")) 'compte 26
Sheets("feuil5").Range("e32") = Sheets("feuil28").Range("bm5001")
'affecte comptes 296 poste AS
Sheets("feuil28").Range("bn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bn1:bn5000")) 'compte 296
Sheets("feuil5").Range("f32") = Sheets("feuil28").Range("bn5001")
'calcul
Sheets("feuil5").Range("g32") = Sheets("feuil5").Range("e32") - Sheets("feuil5").Range("f32")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("i33") = Sheets("feuil5").Range("e32")

'affecte comptes 27 poste AT
Sheets("feuil28").Range("bo5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bo1:bo5000")) 'compte 27
Sheets("feuil5").Range("e33") = Sheets("feuil28").Range("bo5001")
'affecte comptes 297 poste AT
Sheets("feuil28").Range("bp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bp1:bp5000")) 'compte 297
Sheets("feuil5").Range("f33") = Sheets("feuil28").Range("bp5001")
'calcul
Sheets("feuil5").Range("g33") = Sheets("feuil5").Range("e33") - Sheets("feuil5").Range("f33")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("i34") = Sheets("feuil5").Range("e33")

'affecte comptes 3 poste BB
Sheets("feuil28").Range("bq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bq1:bq5000")) 'compte 3
Sheets("feuil5").Range("e36") = Sheets("feuil28").Range("bq5001")
'affecte comptes 39 poste BB
Sheets("feuil28").Range("br5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("br1:br5000")) 'compte 39
Sheets("feuil5").Range("f36") = Sheets("feuil28").Range("br5001")
'calcul
Sheets("feuil5").Range("g36") = Sheets("feuil5").Range("e36") - Sheets("feuil5").Range("f36")

'adaptation syscohada compte 48 H.A.O
Sheets("feuil28").Range("cc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cc1:cc5000")) 'compte 48
Sheets("feuil5").Range("e35") = Sheets("feuil28").Range("cc5001")
'adaptation syscohada compte 498 H.A.O
Sheets("feuil28").Range("cj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cj1:cj5000")) 'compte 498
Sheets("feuil5").Range("f35") = Sheets("feuil28").Range("cj5001")
'calcul
Sheets("feuil5").Range("g35") = Sheets("feuil5").Range("e35") - Sheets("feuil5").Range("f35")

'affecte comptes 409 poste BH
Sheets("feuil28").Range("bs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bs1:bs5000")) 'compte 409
Sheets("feuil5").Range("e38") = Sheets("feuil28").Range("bs5001")
'affecte comptes 490 poste BH
Sheets("feuil28").Range("bt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bt1:bt5000")) 'compte 490
Sheets("feuil5").Range("f38") = Sheets("feuil28").Range("bt5001")
'calcul
Sheets("feuil5").Range("g38") = Sheets("feuil5").Range("e38") - Sheets("feuil5").Range("f38")

'affecte comptes 41 poste BI
Sheets("feuil28").Range("bu5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bu1:bu5000")) 'compte 41
Sheets("feuil5").Range("e39") = Sheets("feuil28").Range("bu5001")
'affecte comptes 491 poste BI
Sheets("feuil28").Range("bv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bv1:bv5000")) 'compte 491
Sheets("feuil5").Range("f39") = Sheets("feuil28").Range("bv5001")
'calcul
Sheets("feuil5").Range("g39") = Sheets("feuil5").Range("e39") - Sheets("feuil5").Range("f39")

'affecte comptes 42+43+44+45+46+47 sauf 48 poste BJ
Sheets("feuil28").Range("bw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bw1:bw5000")) 'compte 42
Sheets("feuil28").Range("bx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bx1:bx5000")) 'compte 43
Sheets("feuil28").Range("by5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("by1:by5000")) 'compte 44
Sheets("feuil28").Range("bz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bz1:bz5000")) 'compte 45
Sheets("feuil28").Range("ca5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ca1:ca5000")) 'compte 46
Sheets("feuil28").Range("cb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cb1:cb5000")) 'compte 47
'Sheets("feuil28").Range("cc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cc1:cc5000")) 'compte 48
Sheets("feuil5").Range("e40") = Sheets("feuil28").Range("bw5001") + Sheets("feuil28").Range("bx5001") + Sheets("feuil28").Range("by5001") + Sheets("feuil28").Range("bz5001") + Sheets("feuil28").Range("ca5001") + Sheets("feuil28").Range("cb5001") '+ Sheets("feuil28").Range("cc5001")
'affecte comptes 492+493+494+495+496+497 sauf 498 poste BJ
Sheets("feuil28").Range("cd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cd1:cd5000")) 'compte 492
Sheets("feuil28").Range("ce5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ce1:ce5000")) 'compte 493
Sheets("feuil28").Range("cf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cf1:cf5000")) 'compte 494
Sheets("feuil28").Range("cg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cg1:cg5000")) 'compte 495
Sheets("feuil28").Range("ch5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ch1:ch5000")) 'compte 496
Sheets("feuil28").Range("ci5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ci1:ci5000")) 'compte 497
'Sheets("feuil28").Range("cj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cj1:cj5000")) 'compte 498
Sheets("feuil5").Range("f40") = Sheets("feuil28").Range("cd5001") + Sheets("feuil28").Range("ce5001") + Sheets("feuil28").Range("cf5001") + Sheets("feuil28").Range("cg5001") + Sheets("feuil28").Range("ch5001") + Sheets("feuil28").Range("ci5001") '+ Sheets("feuil28").Range("cj5001")
'calcul
Sheets("feuil5").Range("g40") = Sheets("feuil5").Range("e40") - Sheets("feuil5").Range("f40")

'adaptation syscohada compte 478 ECA
Sheets("feuil28").Range("lb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lb1:lb5000")) 'compte 478
Sheets("feuil5").Range("e46") = Sheets("feuil28").Range("lb5001")
'calcul
Sheets("feuil5").Range("g46") = Sheets("feuil5").Range("e46") - Sheets("feuil5").Range("f46")



edite_bilan_n_suite

'demande de confirmation
End If

'condition d'édition du bilan N
End If
End If


'condition d'installation
'Else
'MsgBox "Désolé  !  Veuillez d'abord installer votre logiciel."
'End If

'délai d'essai
End If

'mise en forme conditionnelle
Sheets("feuil28").Range("zb18").ClearContents
End Sub
Private Sub audit_nomenclature_classe_1()

'condition de contrôle
If WorksheetFunction.Sum(Sheets("feuil2").Range("g3:g5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à auditer."
Else
       
'mise en forme conditionnelle
Sheets("feuil2").Range("k21") = 1

If MsgBox("Confirmez vous le contrôle de la classe 1 ?", vbYesNo, "Demande de confirmation") = vbYes Then
       
       For i = 3 To 5000
       
       'contrôle comptes 10
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 10 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 101 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 102 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 103 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 104 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 105 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 106 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 109 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 101
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 101 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1011 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1012 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1013 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1014 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1018 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 102
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 102 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1021 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1022 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1028 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 104
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 104 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1041 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1042 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1043 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1047 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1048 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 105
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 105 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1051 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1052 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1053 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1054 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1058 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 106
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 106 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1061 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1062 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       
       'contrôle comptes 11
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 11 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 111 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 112 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 113 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 118 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 113
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 113 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1131 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1132 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1133 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1134 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1138 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 118
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 118 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1181 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1188 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If


       'contrôle comptes 12
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 12 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 121 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 129 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 129
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 129 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1291 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1292 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
             
       'contrôle comptes 13
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 13 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1301 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1309 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 14
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 14 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 141 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 142 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 148 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 141
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 141 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1411 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1412 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1413 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1414 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1415 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1416 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1417 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1418 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
             
       'contrôle comptes 142 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 142 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  "
       Else
       End If
       
       'contrôle comptes 15
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 15 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 151 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 152 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 153 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 154 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 155 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 156 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 157 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 158 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 153
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 153 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1531 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1532 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 155
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 155 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1551 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 156
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 156 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1561 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1562 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 16
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 16 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 161 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 162 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 163 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 164 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 165 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 166 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 167 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 168 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 161
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 161 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1611 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1612 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1613 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1618 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 165
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 165 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1651 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1652 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 166
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 166 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1661 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1662 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1663 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1664 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1665 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1667 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1668 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 167
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 167 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1671 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1672 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1673 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1674 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1676 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
        'contrôle comptes 1676 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 1676 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Dans un contrat de concessions de service public, les biens apportés par le concédant n'entrent plus dans le patrimoine de l'opérateur privé sauf si ces biens ne seront plus restitués."
       Else
       End If
       
       'contrôle comptes 168
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 168 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1681 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1682 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1683 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1684 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1685 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1686 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 17
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 17 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 172 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 173 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 174 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 176 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 178 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 176
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 176 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1762 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1763 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1764 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1768 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 18
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 18 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 181 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 182 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 183 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 184 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 185 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 186 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 187 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 188 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 181
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 181 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1811 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1812 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 19
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 19 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 191 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 192 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 193 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 194 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 195 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1961 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1962 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 197 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 198 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 198
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 198 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 1981 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1982 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1983 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1984 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1985 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 1988 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
        'contrôle comptes 1982 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 1982 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Dans un contrat de concessions de service public, les biens apportés par le concédant n'entrent plus dans le patrimoine de l'opérateur privé sauf si ces biens ne seront plus restitués."
       Else
       End If
         
       
      Next
       
       
MsgBox "FIN DU CONTRÔLE DE LA CLASSE 1  !"

'demande de confirmation
End If

'mise en forme conditionnelle
Sheets("feuil2").Range("k21").ClearContents

'condition de contrôle
End If

End Sub
Private Sub audit_nomenclature_classe_2()

'condition de contrôle
If WorksheetFunction.Sum(Sheets("feuil2").Range("g3:g5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à auditer."
Else
       
'mise en forme conditionnelle
Sheets("feuil2").Range("k23") = 1
       
If MsgBox("Confirmez vous le contrôle de la classe 2 ?", vbYesNo, "Demande de confirmation") = vbYes Then

For i = 3 To 5000

'contrôle comptes 20 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 20 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Les charges immobilisées ne répondent pas à la définition d'un actif." & Chr(10) & "Les opérations dans ces comptes, sont comptabilisées dorénavant dans leur compte de charges par nature."
       Else
       End If
       
       'contrôle comptes 21
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 21 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 211 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 212 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 213 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 214 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 215 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 216 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 217 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 218 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2191 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2193 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2198 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 212
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 212 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2121 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2122 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2123 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2128 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 213
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 213 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2131 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2132 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 218
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 218 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2181 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2182 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2183 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2184 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2188 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 22
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 22 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 221 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 222 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 223 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 224 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 225 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 226 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 227 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 228 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 229 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 221
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 221 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2211 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2212 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2218 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 222
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 222 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2221 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2228 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 223
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 223 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2231 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2232 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2234 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2235 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2238 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 224
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 224 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2241 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2245 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2248 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 225
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 225 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2251 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 226
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 226 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2261 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 228
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 228 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2281 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2285 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2286 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2288 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 229
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 229 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2291 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2292 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2295 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2298 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       
       'contrôle comptes 23
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 23 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 231 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 232 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 233 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 234 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 235 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 237 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 238 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 239 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 231
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 231 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2311 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2312 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2313 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2314 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2315 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2316 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 232
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 232 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2321 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2322 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2323 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2324 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2325 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2326 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 233
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 233 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2331 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2332 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2333 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2334 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2335 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2338 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 234
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 234 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2341 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2342 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2343 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2344 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2345 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 235
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 235 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2351 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2358 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 239
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 239 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2391 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2392 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2393 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2394 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2395 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2398 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 24
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 24 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 241 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 242 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 243 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 244 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 245 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 246 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 247 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 248 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 249 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 241
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 241 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2411 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2412 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2413 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2414 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2416 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 242
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 242 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2421 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2422 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2426 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 244
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 244 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2441 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2442 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2443 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2444 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2445 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2446 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2447 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 245
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 245 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2451 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2452 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2453 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2454 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2455 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2456 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2457 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2458 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 246
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 246 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2461 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2462 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2463 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2465 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2468 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 247
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 247 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2471 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2472 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2478 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 248
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 248 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2481 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2488 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 249
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 249 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2491 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2492 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2493 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2494 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2495 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2496 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2497 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2498 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 25
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 25 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 251 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 252 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 26
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 26 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 261 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 262 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 263 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 265 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 266 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 268 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 27
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 27 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 271 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 272 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 273 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 274 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 275 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 276 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 277 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 278 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 271
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 271 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2711 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2712 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2713 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2714 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2718 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 272
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 272 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2721 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2722 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2728 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 273
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 273 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2731 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2733 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2734 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2738 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 274
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 274 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2741 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2742 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2743 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2744 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2745 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2746 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2748 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 275
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 275 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2751 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2752 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2753 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2754 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2755 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2756 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2757 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2758 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 276
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 276 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2761 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2762 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2763 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2764 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2765 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2767 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2768 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 277
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 277 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2771 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2772 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2773 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2774 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 278
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 278 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2781 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2782 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2784 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2785 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2788 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 28
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 28 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 281 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 282 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 283 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 284 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 281
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 281 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2811 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2812 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2813 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2814 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2815 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2816 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2817 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2818 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 282
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 282 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2821 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2824 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2825 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 2821 et 2825 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 2821 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2825 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Le SYSCOHADA révisé retient les travaux de mise en valeur des terrains, comme seul élément des terrains pouvant être amorti."
       Else
       End If
       
       'contrôle comptes 283
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 283 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2831 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2832 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2833 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2834 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2835 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2837 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2838 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 284
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 284 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2841 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2842 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2843 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2844 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2845 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2846 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2847 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2848 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 29
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 29 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 291 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 292 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 293 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 294 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 295 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 296 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 297 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 291
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 291 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2911 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2912 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2913 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2914 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2915 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2916 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2917 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2918 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2919 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 292
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 292 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2921 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2922 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2923 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2924 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2925 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2926 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2927 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2928 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2929 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 293
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 293 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2931 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2932 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2933 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2934 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2935 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2937 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2938 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2939 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 294
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 294 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2941 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2942 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2943 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2944 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2945 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2946 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2947 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2948 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2949 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 295
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 295 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2951 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2952 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 296
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 296 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2961 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2962 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2963 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2965 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2966 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2968 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 297
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 297 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 2971 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2972 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2973 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2974 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2975 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2977 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 2978 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       
Next

MsgBox "FIN DU CONTRÔLE DE LA CLASSE 2  !"

'demande de confirmation
End If

'mise en forme conditionnelle
Sheets("feuil2").Range("k23").ClearContents

'condition de contrôle
End If

End Sub
Private Sub audit_nomenclature_classe_3()

'condition de contrôle
If WorksheetFunction.Sum(Sheets("feuil2").Range("g3:g5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à auditer."
Else
       
'mise en forme conditionnelle
Sheets("feuil2").Range("k25") = 1
       
If MsgBox("Confirmez vous le contrôle de la classe 3 ?", vbYesNo, "Demande de confirmation") = vbYes Then

For i = 3 To 5000
       
       'contrôle comptes 3
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 3 Then
       If Left(Sheets("feuil2").Cells(i, 1), 2) <> 31 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 32 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 33 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 34 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 35 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 36 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 37 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 38 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 39 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 31
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 31 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 311 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 312 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 313 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 318 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 32
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 32 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 321 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 322 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 323 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 33
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 33 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 331 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 332 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 333 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 334 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 335 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 338 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 34
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 34 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 341 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 342 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 343 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 344 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 345 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 35
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 35 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 351 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 352 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 36
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 36 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 361 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 362 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 363 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 37
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 37 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 371 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 372 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 373 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 38
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 38 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 381 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 382 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 383 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 386 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 387 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 388 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 39
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 391 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 392 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 393 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 394 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 395 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 396 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 397 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 398 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
Next

MsgBox "FIN DU CONTRÔLE DE LA CLASSE 3  !"

'demande de confirmation
End If

'mise en forme conditionnelle
Sheets("feuil2").Range("k25").ClearContents

'condition de contrôle
End If


End Sub
Private Sub audit_nomenclature_classe_4()

'condition de contrôle
If WorksheetFunction.Sum(Sheets("feuil2").Range("g3:g5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à auditer."
Else
      
'mise en forme conditionnelle
Sheets("feuil2").Range("k27") = 1
      
If MsgBox("Confirmez vous le contrôle de la classe 4 ?", vbYesNo, "Demande de confirmation") = vbYes Then

For i = 3 To 5000

       'contrôle comptes 40
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 40 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 401 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 402 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 404 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 408 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 409 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 401
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 401 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4011 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4012 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4013 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4016 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4017 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 402
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 402 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4021 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4022 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4023 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 404
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 404 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4041 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4042 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4046 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4047 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 408
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 408 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4081 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4082 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4083 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4086 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 409
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 409 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4091 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4092 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4093 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4094 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4098 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 41
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 41 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 411 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 412 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 413 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 414 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 415 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 416 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 418 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 419 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 411
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 411 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4111 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4112 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4114 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4115 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4116 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4117 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4118 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 412
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 412 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4121 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4122 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4124 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4125 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4126 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 413
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 413 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4131 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4132 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4133 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4138 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 414
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 414 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4141 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4142 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4146 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4147 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 416
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 416 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4161 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4162 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 418
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 418 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4181 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4186 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 419
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 419 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4191 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4192 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4194 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4198 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 42
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 42 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 421 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 422 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 423 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 424 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 425 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 426 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 427 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 428 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 421
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 421 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4211 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4212 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4213 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 423
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 423 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4231 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4232 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4233 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 424
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 424 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4241 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4242 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4245 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4248 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 425
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 425 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4251 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4252 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4258 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 426
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 426 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4261 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4264 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 428
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 428 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4281 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4286 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4287 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 43
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 43 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 431 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 432 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 433 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 438 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 431
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 431 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4311 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4312 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4313 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4314 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4318 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 433
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 433 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4331 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4332 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4333 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 438
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 438 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4381 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4382 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4386 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4387 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 44
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 44 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 441 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 442 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 443 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 444 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 445 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 446 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 447 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 448 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 449 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 442
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 442 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4421 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4422 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4423 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4424 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4426 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4428 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 443
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 443 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4431 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4432 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4433 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4434 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4435 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 444
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 444 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4441 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4449 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 445
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 445 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4451 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4452 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4453 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4454 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4455 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4456 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 447
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 447 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4471 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4472 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4473 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4474 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4478 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 448
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 448 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4486 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4487 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 449
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 449 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4491 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4492 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4493 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4494 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4495 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4496 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4497 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4499 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 45
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 45 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 451 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 452 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4581 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4582 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 46
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 46 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 461 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 462 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 463 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 465 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 466 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 467 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 461
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 461 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4611 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4612 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4613 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4614 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4615 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4616 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4617 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4618 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4619 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 462
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 462 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4621 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4626 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 463
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 463 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4631 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4636 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 47
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 47 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 471 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 472 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 473 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 474 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 475 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 476 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 477 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 478 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 479 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 471
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 471 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4711 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4712 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4713 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4715 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4716 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4717 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4718 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4719 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 472
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 472 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4721 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4726 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4727 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4728 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 4727 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4727 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Il a été remplacé par le compte 4813."
       Else
       End If
       
       'contrôle comptes 4728 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4728 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Il a été remplacé par le compte 4726."
       Else
       End If
       
       'contrôle comptes 473
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 473 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4731 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4732 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4733 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4734 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4739 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 474
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 474 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4746 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4747 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 475
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 475 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !   Attention  !" & Chr(10) & Chr(10) & "Le compte 475 doit être utilisé uniquement pour la transition au SYSCOHADA révisé   (4751 : Compte-Actif   et   4752 : Compte-Passif)."
       Else
       End If
       
       'contrôle comptes 478
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4781 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4782 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4783 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4784 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4786 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4788 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 479
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4791 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4792 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4793 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4794 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4797 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4798 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 48
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 48 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 481 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 482 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 484 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 485 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 488 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 483 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 486 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 481
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 481 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4811 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4812 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4813 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4816 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4817 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4818 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 482
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 482 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4821 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4822 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 483 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 483 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Il a été remplacé par le compte 4726."
       Else
       End If
       
       'contrôle comptes 485
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 485 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4851 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4852 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4853 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4854 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4855 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4857 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4858 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 486 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 486 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Il a été remplacé par le compte 4721."
       Else
       End If
       
       'contrôle comptes 491
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 491 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4911 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4912 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 496
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 496 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4962 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4963 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4966 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 498
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 498 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4985 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4986 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4988 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4981 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4982 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4983 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 4981 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4981 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Il a été remplacé par le compte 4985."
       Else
       End If
       
       'contrôle comptes 4982 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4982 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Il a été remplacé par le compte 4986."
       Else
       End If
       
       'contrôle comptes 4983 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4983 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Il a été remplacé par le compte 4988."
       Else
       End If
       
       'contrôle comptes 499
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 499 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 4991 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4997 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 4998 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
            
Next

MsgBox "FIN DU CONTRÔLE DE LA CLASSE 4  !"

'demande de confirmation
End If

'mise en forme conditionnelle
Sheets("feuil2").Range("k27").ClearContents

'condition de contrôle
End If
End Sub
Private Sub audit_nomenclature_classe_5()

'condition de contrôle
If WorksheetFunction.Sum(Sheets("feuil2").Range("g3:g5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à auditer."
Else
       
'mise en forme conditionnelle
Sheets("feuil2").Range("k29") = 1
       
If MsgBox("Confirmez vous le contrôle de la classe 5 ?", vbYesNo, "Demande de confirmation") = vbYes Then

For i = 3 To 5000
       
       'contrôle comptes 50
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 50 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 501 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 502 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 503 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 504 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 505 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 506 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 508 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 501
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 501 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 5011 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5012 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5013 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5016 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 502
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 502 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 5021 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5022 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5023 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5024 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5025 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5026 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 503
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 503 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 5031 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5032 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5033 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5035 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5036 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 504
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 504 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 5042 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5043 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 506
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 506 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 5061 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5062 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5063 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 51
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 51 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 511 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 512 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 513 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 514 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 515 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 518 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 518
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 518 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 5181 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5182 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5185 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5186 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5187 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 52
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 52 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 521 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 522 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 523 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 524 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 525 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 526 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 521
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 521 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 5211 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5215 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 526
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 526 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 5261 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5267 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 53
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 53 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 531 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 532 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 533 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 536 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 538 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 54
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 54 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 541 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 542 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 543 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 544 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 545 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 55
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 55 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 551 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 552 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 553 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 554 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 558 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 56
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 56 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 561 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 564 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 565 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 566 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 57
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 57 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 571 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 572 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 573 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 571
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 571 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 5711 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5712 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 572
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 572 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 5721 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5722 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 573
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 573 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 5731 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 5732 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 58
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 58 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 581 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 582 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 585 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 588 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 59
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 59 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 590 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 591 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 592 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 593 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 594 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 599 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
                  
Next

MsgBox "FIN DU CONTRÔLE DE LA CLASSE 5  !"

'demande de confirmation
End If

'mise en forme conditionnelle
Sheets("feuil2").Range("k29").ClearContents

'condition de contrôle
End If

End Sub
Private Sub audit_nomenclature_classe_6()

'condition de contrôle
If WorksheetFunction.Sum(Sheets("feuil2").Range("g3:g5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à auditer."
Else
       
'mise en forme conditionnelle
Sheets("feuil2").Range("k31") = 1
       
If MsgBox("Confirmez vous le contrôle de la classe 6 ?", vbYesNo, "Demande de confirmation") = vbYes Then

For i = 3 To 5000
       
       'contrôle comptes 60
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 60 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 601 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 602 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 603 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 604 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 605 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 608 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 601
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 601 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6011 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6012 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6013 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6014 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6015 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6019 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 602
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 602 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6021 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6022 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6023 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6024 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6025 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6029 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 603
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 603 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6031 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6032 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6033 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 604
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 604 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6041 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6042 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6043 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6044 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6045 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6046 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6047 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6049 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 605
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 605 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6051 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6052 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6053 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6054 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6055 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6056 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6057 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6058 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6059 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 608
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 608 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6081 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6082 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6083 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6085 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6089 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 61
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 61 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 611 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 612 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 613 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 614 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 616 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6181 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6182 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6183 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 611 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 611 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Les frais accessoires d'achat sont comptabilisés directement dans les comptes   60.Achats   ou   2.Immobilisations."
       Else
       End If
       
       'contrôle comptes 62
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 62 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 621 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 622 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 623 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 624 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 625 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 626 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 627 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 628 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 622
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 622 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6221 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6222 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6223 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6224 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6225 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6226 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6228 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 623
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 623 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6232 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6233 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6234 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6235 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6238 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 6235 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6235 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Le compte 6235 (Contrats assimilés) a été remplacé par le compte 6238 (Autres contrats de location acquisition)."
       Else
       End If
       
       'contrôle comptes 624
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 624 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6241 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6242 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6243 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6244 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6248 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 625
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 625 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6251 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6252 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6253 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6254 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6255 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6256 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6257 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6258 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 6256 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6256 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Les frais accessoires d'achat sont comptabilisés directement dans les comptes   60.Achats   ou   2.Immobilisations."
       Else
       End If
       
        'contrôle comptes 626
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 626 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6261 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6265 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6266 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 627
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 627 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6271 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6272 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6273 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6274 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6275 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6276 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6277 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6278 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 628
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 628 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6281 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6282 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6283 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6288 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 63
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 63 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 631 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 632 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 633 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 634 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 635 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 637 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 638 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 631
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 631 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6311 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6312 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6313 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6314 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6315 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6316 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6317 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6318 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 632
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 632 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6321 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6322 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6323 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6324 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6325 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6326 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6327 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6328 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 6321 et 6323 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6321 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6323 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Les frais accessoires d'achat sont comptabilisés directement dans les comptes   60.Achats   ou   2.Immobilisations."
       Else
       End If
       
       'contrôle comptes 634
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 634 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6342 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6343 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6344 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6345 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6346 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 635
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 635 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6351 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6358 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 637
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 637 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6371 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6372 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 638
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 638 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6381 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6382 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6383 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6384 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6385 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 64
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 64 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 641 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 645 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 646 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 647 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 648 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 641
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 641 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6411 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6412 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6413 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6414 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6415 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6418 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 646
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 646 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6461 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6462 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6463 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6464 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6468 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 647
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 647 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6471 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6472 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6473 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6474 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6478 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 65
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 65 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 651 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 652 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 653 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 654 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 656 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 657 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 658 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 659 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 651
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 651 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6511 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6515 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 652
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 652 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6521 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6525 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 653 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 653 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Le SYSCOHADA révisé a retenu la méthode à l'avancement comme principale méthode de comptabilisation pour les contrats pluri-exercices."
       Else
       End If
       
       'contrôle comptes 654
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 654 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6541 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6542 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 658
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 658 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6581 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6582 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6583 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6588 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 659
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 659 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6591 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6593 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6594 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6598 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 66
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 66 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 661 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 662 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 663 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 664 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 666 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 667 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 668 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 661
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 661 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6611 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6612 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6613 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6614 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6615 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6616 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6617 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6618 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 662
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 662 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6621 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6622 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6623 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6624 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6625 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6626 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6627 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6628 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 663
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 663 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6631 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6632 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6633 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6634 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6638 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 664
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 664 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6641 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6642 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 666
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 666 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6661 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6662 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 667
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 667 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6671 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6672 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 668
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 668 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6681 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6682 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6683 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6684 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6685 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6686 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6687 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6688 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 67
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 67 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 671 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 672 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 673 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 674 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 675 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 676 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 677 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 678 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 679 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 671
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 671 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6711 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6712 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6713 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6714 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 672
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 672 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6721 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6722 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6723 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6724 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6728 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 6721 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6721 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Le compte 6721 a été remplacé par le compte 6722."
       Else
       End If
       
       'contrôle comptes 674
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 674 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6741 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6742 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6743 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6744 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6745 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6748 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 677
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 677 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6771 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6772 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 678
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 678 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6781 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6782 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6784 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 679
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 679 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6791 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6795 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6798 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 68
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 68 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 681 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 687 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 681
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 681 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6811 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6812 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6813 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 6811 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6811 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Le SYSCOHADA révisé a supprimé les charges immobilisées de même que leurs amortissements."
       Else
       End If
       
       'contrôle comptes 687 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 687 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Les primes de remboursement des obligations ne sont plus immobilisées pour être amorties, mais comptabilisées en charges dans le compte 6714."
       Else
       End If
       
       'contrôle comptes 69
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 69 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 691 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 697 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 691
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 691 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6911 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6912 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6913 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6914 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 6912 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6912 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Les provisions pour grosses réparations sont dorénavant des provisions non admises."
       Else
       End If
       
       'contrôle comptes 697
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 697 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 6971 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 6972 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
                       
Next

MsgBox "FIN DU CONTRÔLE DE LA CLASSE 6  !"

'demande de confirmation
End If

'mise en forme conditionnelle
Sheets("feuil2").Range("k31").ClearContents

'condition de contrôle
End If

End Sub
Private Sub audit_nomenclature_classe_7()

'condition de contrôle
If WorksheetFunction.Sum(Sheets("feuil2").Range("g3:g5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à auditer."
Else
       
'mise en forme conditionnelle
Sheets("feuil2").Range("k33") = 1
       
If MsgBox("Confirmez vous le contrôle de la classe 7 ?", vbYesNo, "Demande de confirmation") = vbYes Then

For i = 3 To 5000
       
       'contrôle comptes 7
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 7 Then
       If Left(Sheets("feuil2").Cells(i, 1), 2) <> 70 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 71 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 72 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 73 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 75 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 77 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 78 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 79 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 70
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 70 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 701 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 702 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 703 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 704 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 705 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 706 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 707 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 701
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 701 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7011 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7012 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7013 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7014 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7015 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7019 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 702
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 702 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7021 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7022 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7023 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7024 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7025 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7029 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 703
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 703 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7031 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7032 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7033 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7034 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7035 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7039 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 704
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 704 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7041 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7042 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7043 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7044 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7045 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7049 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 705
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 705 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7051 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7052 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7053 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7054 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7055 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7059 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 706
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 706 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7061 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7062 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7063 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7064 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7065 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7069 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 707
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 707 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7071 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7072 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7073 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7074 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7075 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7076 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7077 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7078 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 71
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 71 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 711 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 712 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 713 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 714 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 718 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 718
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 718 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7181 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7182 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7183 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 72
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 72 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 721 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 722 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 724 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 726 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 722
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 722 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7221 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7222 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 73
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 73 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 734 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 735 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 736 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 737 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 734
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 734 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7341 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7342 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 735
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 735 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7351 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7352 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 737
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 737 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7371 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7372 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 75
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 75 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 751 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 752 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 753 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 754 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 756 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 758 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 759 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 752
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 752 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7521 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7525 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 753 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 753 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Le SYSCOHADA révisé a retenu la méthode à l'avancement comme principale méthode de comptabilisation pour les contrats pluri-exercices."
       Else
       End If
       
       'contrôle comptes 754
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 754 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7541 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7542 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 758
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 758 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7581 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7582 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7588 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 759
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 759 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7591 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7593 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7594 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7598 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 77
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 77 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 771 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 772 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 773 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 774 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 775 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 776 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 777 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 778 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 779 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 771
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 771 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7712 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7713 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 772
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 772 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7721 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7722 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 774
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 774 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7745 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7746 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 778
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 778 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7781 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7782 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7784 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 779
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 779 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7791 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7795 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7798 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 78
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 78 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 781 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 787 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 79
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 79 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 791 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 797 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 798 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 799 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 791
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 791 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7911 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7912 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7913 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7914 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 7912 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 7912 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Les provisions pour grosses réparations sont dorénavant des provisions non admises."
       Else
       End If
       
       'contrôle comptes 797
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 797 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 7971 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 7972 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
                 
Next

MsgBox "FIN DU CONTRÔLE DE LA CLASSE 7  !"

'demande de confirmation
End If

'mise en forme conditionnelle
Sheets("feuil2").Range("k33").ClearContents

'condition de contrôle
End If

End Sub
Private Sub audit_nomenclature_classe_8()

'condition de contrôle
If WorksheetFunction.Sum(Sheets("feuil2").Range("g3:g5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à auditer."
Else
       
'mise en forme conditionnelle
Sheets("feuil2").Range("k35") = 1
       
If MsgBox("Confirmez vous le contrôle de la classe 8 ?", vbYesNo, "Demande de confirmation") = vbYes Then

For i = 3 To 5000
       
       'contrôle comptes 8
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 8 Then
       If Left(Sheets("feuil2").Cells(i, 1), 2) <> 81 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 82 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 83 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 84 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 85 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 86 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 87 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 88 And Left(Sheets("feuil2").Cells(i, 1), 2) <> 89 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 81
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 81 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 811 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 812 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 816 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 82
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 82 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 821 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 822 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 826 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 83
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 83 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 831 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 833 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 834 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 835 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 836 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 837 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 839 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 84
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 84 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 841 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 843 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 844 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 845 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 846 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 847 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 848 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 849 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 85
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 85 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 851 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 852 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 853 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 854 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 858 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 86
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 86 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 861 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 862 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 863 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 864 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 865 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 868 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 865 SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 865 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a été supprimé par le SYSCOHADA révisé.  " & Chr(10) & Chr(10) & "NB : Les reprises de subventions d'investissement se comptabilisent dorénavant avec le compte 799."
       Else
       End If
       
       'contrôle comptes 87
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 87 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 871 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 874 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 878 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 88
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 88 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 881 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 884 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 886 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 888 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 89
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 89 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) <> 891 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 892 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 895 And Left(Sheets("feuil2").Cells(i, 1), 3) <> 899 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 891
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 891 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 8911 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 8912 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 8913 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
       
       'contrôle comptes 899
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 899 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) <> 8991 And Left(Sheets("feuil2").Cells(i, 1), 4) <> 8994 Then
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
       Cells(i, 1).Select
       MsgBox "Attention  !  Veuillez revoir la nomenclature du compte  " & Sheets("feuil2").Cells(i, 1) & "."
       Else
       End If
       Else
       End If
                      
Next

MsgBox "FIN DU CONTRÔLE DE LA CLASSE 8  !"

'demande de confirmation
End If

'mise en forme conditionnelle
Sheets("feuil2").Range("k35").ClearContents

'condition de contrôle
End If

End Sub
Private Sub test_couleur()
'Sheets("feuil2").Range("a1").Font.Bold = True 'gras
'Sheets("feuil2").Range("a1").Font.Italic = True
Sheets("feuil2").Range("a1").Font.Color = RGB(136, 255, 0) 'Couleur vert fluor
Sheets("feuil2").Range("a2").Font.Color = RGB(255, 108, 0) 'Couleur orange
Sheets("feuil2").Range("a3").Font.Color = RGB(255, 0, 0) 'Couleur rouge
Sheets("feuil2").Range("a4").Font.Color = RGB(136, 220, 0) 'Couleur vert foncé
Sheets("feuil2").Range("a8").Font.Color = RGB(220, 136, 255) 'Couleur violet clair
Sheets("feuil2").Range("a9").Font.Color = RGB(220, 50, 255) 'Couleur violet foncé
Sheets("feuil2").Range("a10").Font.Color = RGB(136, 0, 900) 'Couleur bleu
Sheets("feuil2").Range("a10").Font.Bold = True 'gras

'RGB(255, 108, 0) 'Couleur orange
'Target.Interior.Color = RGB(136, 255, 0) 'Couleur verte

End Sub
Private Sub annuler_bilan()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

If Sheets("feuil5").Range("m47") <> "" Then
Sheets("feuil5").Range("e14:g47").ClearContents 'actif
Sheets("feuil5").Range("m13:m47").ClearContents 'passif
Sheets("feuil5").Range("b21").ClearContents 'terrain - immeuble de placement
Sheets("feuil5").Range("b25").ClearContents 'bâtiment - immeuble de placement
Sheets("feuil23").Range("c16:k35").ClearContents 'tableau 1 - Actif immobilisé N
Else
Sheets("feuil5").Range("h14:h47").ClearContents 'actif
Sheets("feuil5").Range("n13:n47").ClearContents 'passif
Sheets("feuil5").Range("c21").ClearContents 'terrain - immeuble de placement
Sheets("feuil5").Range("c25").ClearContents 'bâtiment - immeuble de placement
Sheets("feuil24").Range("b16:k35").ClearContents 'tableau 1 - Actif immobilisé N-1
Sheets("feuil23").Range("b16:b35").ClearContents 'tableau 1 - Actif immobilisé N
End If

End If
End Sub
Private Sub edite_bilan_n_suite()

For i = 1 To 5000
'recup compte 50
If Left(Sheets("feuil2").Cells(i, 1), 2) = 50 Then 'compte 50
Sheets("feuil28").Cells(i, 89) = Sheets("feuil2").Cells(i, 7) 'colonne CK
Else
End If

'recup compte 590
If Left(Sheets("feuil2").Cells(i, 1), 3) = 590 Then 'compte 590
Sheets("feuil28").Cells(i, 90) = Sheets("feuil2").Cells(i, 8) 'colonne CL
Else
End If

'recup compte 51
If Left(Sheets("feuil2").Cells(i, 1), 2) = 51 Then 'compte 51
Sheets("feuil28").Cells(i, 91) = Sheets("feuil2").Cells(i, 7) 'colonne CM
Else
End If

'recup compte 52
If Left(Sheets("feuil2").Cells(i, 1), 2) = 52 Then 'compte 52
Sheets("feuil28").Cells(i, 92) = Sheets("feuil2").Cells(i, 7) 'colonne CN
Else
End If

'recup compte 53
If Left(Sheets("feuil2").Cells(i, 1), 2) = 53 Then 'compte 53
Sheets("feuil28").Cells(i, 93) = Sheets("feuil2").Cells(i, 7) 'colonne CO
Else
End If

'recup compte 54
If Left(Sheets("feuil2").Cells(i, 1), 2) = 54 Then 'compte 54
Sheets("feuil28").Cells(i, 94) = Sheets("feuil2").Cells(i, 7) 'colonne CP
Else
End If

'recup compte 57 + 55
If Left(Sheets("feuil2").Cells(i, 1), 2) = 57 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 55 Then 'compte 57
Sheets("feuil28").Cells(i, 95) = Sheets("feuil2").Cells(i, 7) 'colonne CQ
Else
End If

'recup compte 581
If Left(Sheets("feuil2").Cells(i, 1), 3) = 581 Then 'compte 581
Sheets("feuil28").Cells(i, 96) = Sheets("feuil2").Cells(i, 7) 'colonne CR
Else
End If

'recup compte 582
If Left(Sheets("feuil2").Cells(i, 1), 3) = 582 Then 'compte 582
Sheets("feuil28").Cells(i, 97) = Sheets("feuil2").Cells(i, 7) 'colonne CS
Else
End If

'recup compte 591
If Left(Sheets("feuil2").Cells(i, 1), 3) = 591 Then 'compte 591
Sheets("feuil28").Cells(i, 98) = Sheets("feuil2").Cells(i, 8) 'colonne CT
Else
End If

'recup compte 592
If Left(Sheets("feuil2").Cells(i, 1), 3) = 592 Then 'compte 592
Sheets("feuil28").Cells(i, 99) = Sheets("feuil2").Cells(i, 8) 'colonne CU
Else
End If

'recup compte 593
If Left(Sheets("feuil2").Cells(i, 1), 3) = 593 Then 'compte 593
Sheets("feuil28").Cells(i, 100) = Sheets("feuil2").Cells(i, 8) 'colonne CV
Else
End If

'recup compte 594
If Left(Sheets("feuil2").Cells(i, 1), 3) = 594 Then 'compte 594
Sheets("feuil28").Cells(i, 101) = Sheets("feuil2").Cells(i, 8) 'colonne CW
Else
End If


'recup PASSIF BILAN
'recup compte 101
If Left(Sheets("feuil2").Cells(i, 1), 3) = 101 Then 'compte 101
Sheets("feuil28").Cells(i, 102) = Sheets("feuil2").Cells(i, 8) 'colonne CX
Else
End If

'recup compte 102
If Left(Sheets("feuil2").Cells(i, 1), 3) = 102 Then 'compte 102
Sheets("feuil28").Cells(i, 103) = Sheets("feuil2").Cells(i, 8) 'colonne CY
Else
End If

'recup compte 103
If Left(Sheets("feuil2").Cells(i, 1), 3) = 103 Then 'compte 103
Sheets("feuil28").Cells(i, 104) = Sheets("feuil2").Cells(i, 8) 'colonne CZ
Else
End If

'recup compte 104c
If Left(Sheets("feuil2").Cells(i, 1), 3) = 104 Then 'compte 104c
Sheets("feuil28").Cells(i, 105) = Sheets("feuil2").Cells(i, 8) 'colonne DA
Else
End If

'recup compte 104d
If Left(Sheets("feuil2").Cells(i, 1), 3) = 104 Then 'compte 104d
Sheets("feuil28").Cells(i, 106) = Sheets("feuil2").Cells(i, 7) 'colonne DB
Else
End If

'recup compte 109
If Left(Sheets("feuil2").Cells(i, 1), 3) = 109 Then 'compte 109
Sheets("feuil28").Cells(i, 107) = Sheets("feuil2").Cells(i, 7) 'colonne DC
Else
End If

'recup compte 105
If Left(Sheets("feuil2").Cells(i, 1), 3) = 105 Then 'compte 105
Sheets("feuil28").Cells(i, 108) = Sheets("feuil2").Cells(i, 8) 'colonne DD
Else
End If

'recup compte 106
If Left(Sheets("feuil2").Cells(i, 1), 3) = 106 Then 'compte 106
Sheets("feuil28").Cells(i, 109) = Sheets("feuil2").Cells(i, 8) 'colonne DE
Else
End If

'recup compte 111
If Left(Sheets("feuil2").Cells(i, 1), 3) = 111 Then 'compte 111
Sheets("feuil28").Cells(i, 110) = Sheets("feuil2").Cells(i, 8) 'colonne DF
Else
End If

'recup compte 112
If Left(Sheets("feuil2").Cells(i, 1), 3) = 112 Then 'compte 112
Sheets("feuil28").Cells(i, 111) = Sheets("feuil2").Cells(i, 8) 'colonne DG
Else
End If

'recup compte 113
If Left(Sheets("feuil2").Cells(i, 1), 3) = 113 Then 'compte 113
Sheets("feuil28").Cells(i, 112) = Sheets("feuil2").Cells(i, 8) 'colonne DH
Else
End If

'recup compte 118
If Left(Sheets("feuil2").Cells(i, 1), 3) = 118 Then 'compte 118
Sheets("feuil28").Cells(i, 113) = Sheets("feuil2").Cells(i, 8) 'colonne DI
Else
End If

'recup compte 121
If Left(Sheets("feuil2").Cells(i, 1), 3) = 121 Then 'compte 121
Sheets("feuil28").Cells(i, 114) = Sheets("feuil2").Cells(i, 8) 'colonne DJ
Else
End If

'recup compte 129
If Left(Sheets("feuil2").Cells(i, 1), 3) = 129 Then 'compte 129
Sheets("feuil28").Cells(i, 115) = Sheets("feuil2").Cells(i, 7) 'colonne DK
Else
End If


'recup compte 15
If Left(Sheets("feuil2").Cells(i, 1), 2) = 15 Then 'compte 15
Sheets("feuil28").Cells(i, 120) = Sheets("feuil2").Cells(i, 8) 'colonne DP
Else
End If

'recup compte 14
If Left(Sheets("feuil2").Cells(i, 1), 2) = 14 Then 'compte 14
Sheets("feuil28").Cells(i, 121) = Sheets("feuil2").Cells(i, 8) 'colonne DQ
Else
End If

'recup compte 16
If Left(Sheets("feuil2").Cells(i, 1), 2) = 16 Then 'compte 16
Sheets("feuil28").Cells(i, 122) = Sheets("feuil2").Cells(i, 8) 'colonne DR
Else
End If

'recup compte 18
If Left(Sheets("feuil2").Cells(i, 1), 2) = 18 Then 'compte 18
Sheets("feuil28").Cells(i, 123) = Sheets("feuil2").Cells(i, 8) 'colonne DS
Else
End If

'recup compte 17
If Left(Sheets("feuil2").Cells(i, 1), 2) = 17 Then 'compte 17
Sheets("feuil28").Cells(i, 124) = Sheets("feuil2").Cells(i, 8) 'colonne DT
Else
End If

'recup compte 19
If Left(Sheets("feuil2").Cells(i, 1), 2) = 19 Then 'compte 19
Sheets("feuil28").Cells(i, 125) = Sheets("feuil2").Cells(i, 8) 'colonne DU
Else
End If

'recup compte 419
If Left(Sheets("feuil2").Cells(i, 1), 3) = 419 Then 'compte 419
Sheets("feuil28").Cells(i, 126) = Sheets("feuil2").Cells(i, 8) 'colonne DV
Else
End If

'recup compte 401
If Left(Sheets("feuil2").Cells(i, 1), 3) = 401 Then 'compte 401
Sheets("feuil28").Cells(i, 127) = Sheets("feuil2").Cells(i, 8) 'colonne DW
Else
End If

'recup compte 402
If Left(Sheets("feuil2").Cells(i, 1), 3) = 402 Then 'compte 402
Sheets("feuil28").Cells(i, 128) = Sheets("feuil2").Cells(i, 8) 'colonne DX
Else
End If

'recup compte 408+404
If Left(Sheets("feuil2").Cells(i, 1), 3) = 408 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 404 Then 'compte 408+404
Sheets("feuil28").Cells(i, 129) = Sheets("feuil2").Cells(i, 8) 'colonne DY
Else
End If

'recup compte 42
If Left(Sheets("feuil2").Cells(i, 1), 2) = 42 Then 'compte 42
Sheets("feuil28").Cells(i, 130) = Sheets("feuil2").Cells(i, 8) 'colonne DZ
Else
End If

'recup compte 43
If Left(Sheets("feuil2").Cells(i, 1), 2) = 43 Then 'compte 43
Sheets("feuil28").Cells(i, 131) = Sheets("feuil2").Cells(i, 8) 'colonne EA
Else
End If

'recup compte 44
If Left(Sheets("feuil2").Cells(i, 1), 2) = 44 Then 'compte 44
Sheets("feuil28").Cells(i, 132) = Sheets("feuil2").Cells(i, 8) 'colonne EB
Else
End If

'recup compte 45
If Left(Sheets("feuil2").Cells(i, 1), 2) = 45 Then 'compte 45
Sheets("feuil28").Cells(i, 133) = Sheets("feuil2").Cells(i, 8) 'colonne EC
Else
End If

'recup compte 46
If Left(Sheets("feuil2").Cells(i, 1), 2) = 46 Then 'compte 46
Sheets("feuil28").Cells(i, 134) = Sheets("feuil2").Cells(i, 8) 'colonne ED
Else
End If

'recup compte 47
If Left(Sheets("feuil2").Cells(i, 1), 2) = 47 Then 'compte 47
If Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Then
Else
Sheets("feuil28").Cells(i, 135) = Sheets("feuil2").Cells(i, 8) 'colonne EE
End If
End If
Else
End If

'recup compte 48
If Left(Sheets("feuil2").Cells(i, 1), 2) = 48 Then 'compte 48
Sheets("feuil28").Cells(i, 136) = Sheets("feuil2").Cells(i, 8) 'colonne EF
Else
End If

'recup compte 499
If Left(Sheets("feuil2").Cells(i, 1), 3) = 499 Then 'compte 499
Sheets("feuil28").Cells(i, 137) = Sheets("feuil2").Cells(i, 8) 'colonne EG
Else
End If

'recup compte 599
If Left(Sheets("feuil2").Cells(i, 1), 3) = 599 Then 'compte 599
Sheets("feuil28").Cells(i, 138) = Sheets("feuil2").Cells(i, 8) 'colonne EH
Else
End If

'recup compte 564
If Left(Sheets("feuil2").Cells(i, 1), 3) = 564 Then 'compte 564
Sheets("feuil28").Cells(i, 139) = Sheets("feuil2").Cells(i, 8) 'colonne EI
Else
End If

'recup compte 565
If Left(Sheets("feuil2").Cells(i, 1), 3) = 565 Then 'compte 565
Sheets("feuil28").Cells(i, 140) = Sheets("feuil2").Cells(i, 8) 'colonne EJ
Else
End If

'recup compte 52c
If Left(Sheets("feuil2").Cells(i, 1), 2) = 52 Then 'compte 52
Sheets("feuil28").Cells(i, 141) = Sheets("feuil2").Cells(i, 8) 'colonne EK
Else
End If

'recup compte 561
If Left(Sheets("feuil2").Cells(i, 1), 3) = 561 Then 'compte 561
Sheets("feuil28").Cells(i, 142) = Sheets("feuil2").Cells(i, 8) 'colonne EL
Else
End If

'recup compte 566
If Left(Sheets("feuil2").Cells(i, 1), 3) = 566 Then 'compte 566
Sheets("feuil28").Cells(i, 143) = Sheets("feuil2").Cells(i, 8) 'colonne EM
Else
End If

'RATTRAPAGE DES COMPTES 53c et 54c
'recup compte 53c
If Left(Sheets("feuil2").Cells(i, 1), 2) = 53 Then
Sheets("feuil28").Cells(i, 274) = Sheets("feuil2").Cells(i, 8) 'colonne JN
Else
End If
'recup compte 54c
If Left(Sheets("feuil2").Cells(i, 1), 2) = 54 Then
Sheets("feuil28").Cells(i, 275) = Sheets("feuil2").Cells(i, 8) 'colonne JO
Else
End If

'recup compte 479
If Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
Sheets("feuil28").Cells(i, 315) = Sheets("feuil2").Cells(i, 8) 'colonne LC
Else
End If



Next


'affecte comptes 50 poste BQ
Sheets("feuil28").Range("ck5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ck1:ck5000")) 'compte 50
Sheets("feuil5").Range("e42") = Sheets("feuil28").Range("ck5001")
'affecte comptes 590 poste BQ
Sheets("feuil28").Range("cl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cl1:cl5000")) 'compte 590
Sheets("feuil5").Range("f42") = Sheets("feuil28").Range("cl5001")
'calcul
Sheets("feuil5").Range("g42") = Sheets("feuil5").Range("e42") - Sheets("feuil5").Range("f42")

'adaptation syscohada compte 51 poste BS
Sheets("feuil28").Range("cm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cm1:cm5000")) 'compte 51
Sheets("feuil5").Range("e43") = Sheets("feuil28").Range("cm5001")
'adaptation syscohada compte 591 poste BS
Sheets("feuil28").Range("ct5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ct1:ct5000")) 'compte 591
Sheets("feuil5").Range("f43") = Sheets("feuil28").Range("ct5001")
'calcul
Sheets("feuil5").Range("g43") = Sheets("feuil5").Range("e43") - Sheets("feuil5").Range("f43")

'affecte comptes 52+53+54+57+581+582 poste BS
'Sheets("feuil28").Range("cm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cm1:cm5000")) 'compte 51
Sheets("feuil28").Range("cn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cn1:cn5000")) 'compte 52
Sheets("feuil28").Range("co5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("co1:co5000")) 'compte 53
Sheets("feuil28").Range("cp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cp1:cp5000")) 'compte 54
Sheets("feuil28").Range("cq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cq1:cq5000")) 'compte 57
Sheets("feuil28").Range("cr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cr1:cr5000")) 'compte 581
Sheets("feuil28").Range("cs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cs1:cs5000")) 'compte 582
Sheets("feuil5").Range("e44") = Sheets("feuil28").Range("cn5001") + Sheets("feuil28").Range("co5001") + Sheets("feuil28").Range("cp5001") + Sheets("feuil28").Range("cq5001") + Sheets("feuil28").Range("cr5001") + Sheets("feuil28").Range("cs5001")
'affecte comptes 592+593+594 poste BS
'Sheets("feuil28").Range("ct5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ct1:ct5000")) 'compte 591
Sheets("feuil28").Range("cu5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cu1:cu5000")) 'compte 592
Sheets("feuil28").Range("cv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cv1:cv5000")) 'compte 593
Sheets("feuil28").Range("cw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cw1:cw5000")) 'compte 594
Sheets("feuil5").Range("f44") = Sheets("feuil28").Range("cu5001") + Sheets("feuil28").Range("cv5001") + Sheets("feuil28").Range("cw5001")
'calcul
Sheets("feuil5").Range("g44") = Sheets("feuil5").Range("e44") - Sheets("feuil5").Range("f44")

'calcul TOTAUX DE L'ACTIF
'total actif immobilisé
Sheets("feuil5").Range("e34") = WorksheetFunction.Sum(Sheets("feuil5").Range("e14:e33")) 'montants bruts
Sheets("feuil5").Range("f34") = WorksheetFunction.Sum(Sheets("feuil5").Range("f14:f33")) 'Amorts et provisions
Sheets("feuil5").Range("g34") = WorksheetFunction.Sum(Sheets("feuil5").Range("g14:g33")) 'montants nets

'total actif circulant
Sheets("feuil5").Range("e41") = WorksheetFunction.Sum(Sheets("feuil5").Range("e35:e40")) 'montants bruts
Sheets("feuil5").Range("f41") = WorksheetFunction.Sum(Sheets("feuil5").Range("f35:f40")) 'Amorts et provisions
Sheets("feuil5").Range("g41") = WorksheetFunction.Sum(Sheets("feuil5").Range("g35:g40")) 'montants nets

'total trésorerie actif
Sheets("feuil5").Range("e45") = WorksheetFunction.Sum(Sheets("feuil5").Range("e42:e44")) 'montants bruts
Sheets("feuil5").Range("f45") = WorksheetFunction.Sum(Sheets("feuil5").Range("f42:f44")) 'Amorts et provisions
Sheets("feuil5").Range("g45") = WorksheetFunction.Sum(Sheets("feuil5").Range("g42:g44")) 'montants nets

'total général actif
Sheets("feuil5").Range("e47") = Sheets("feuil5").Range("e34") + Sheets("feuil5").Range("e41") + Sheets("feuil5").Range("e45") + Sheets("feuil5").Range("e46") 'montants bruts
Sheets("feuil5").Range("f47") = Sheets("feuil5").Range("f34") + Sheets("feuil5").Range("f41") + Sheets("feuil5").Range("f45") + Sheets("feuil5").Range("f46") 'Amorts et provisions
Sheets("feuil5").Range("g47") = Sheets("feuil5").Range("g34") + Sheets("feuil5").Range("g41") + Sheets("feuil5").Range("g45") + Sheets("feuil5").Range("g46") 'montants nets

'________________________________________________________________________________________

'affecte PASSIF BILAN
'affecte comptes 101+102+103+104(c/d) poste CA
Sheets("feuil28").Range("cx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cx1:cx5000")) 'compte 101
Sheets("feuil28").Range("cy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cy1:cy5000")) 'compte 102
Sheets("feuil28").Range("cz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cz1:cz5000")) 'compte 103
Sheets("feuil28").Range("da5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("da1:da5000")) 'compte 104c
Sheets("feuil28").Range("db5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("db1:db5000")) 'compte 104d
Sheets("feuil5").Range("m13") = Sheets("feuil28").Range("cx5001") + Sheets("feuil28").Range("cy5001") + Sheets("feuil28").Range("cz5001") + Sheets("feuil28").Range("da5001") - Sheets("feuil28").Range("db5001")

'affecte comptes 109 poste CB
Sheets("feuil28").Range("dc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dc1:dc5000")) 'compte 109
Sheets("feuil5").Range("m14") = -Sheets("feuil28").Range("dc5001")

'affecte comptes 105 poste CD
Sheets("feuil28").Range("dd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dd1:dd5000")) 'compte 105
Sheets("feuil5").Range("m15") = Sheets("feuil28").Range("dd5001")

'affecte comptes 106 poste CE
Sheets("feuil28").Range("de5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("de1:de5000")) 'compte 106
Sheets("feuil5").Range("m16") = Sheets("feuil28").Range("de5001")

'affecte comptes 111+112+113 poste CF
Sheets("feuil28").Range("df5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("df1:df5000")) 'compte 111
Sheets("feuil28").Range("dg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dg1:dg5000")) 'compte 112
Sheets("feuil28").Range("dh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dh1:dh5000")) 'compte 113
Sheets("feuil5").Range("m17") = Sheets("feuil28").Range("df5001") + Sheets("feuil28").Range("dg5001") + Sheets("feuil28").Range("dh5001")

'affecte comptes 118 poste CG
Sheets("feuil28").Range("di5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("di1:di5000")) 'compte 118
Sheets("feuil5").Range("m18") = Sheets("feuil28").Range("di5001")

'affecte comptes 121+129 poste CH
Sheets("feuil28").Range("dj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dj1:dj5000")) 'compte 121
Sheets("feuil28").Range("dk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dk1:dk5000")) 'compte 129
Sheets("feuil5").Range("m19") = Sheets("feuil28").Range("dj5001") - Sheets("feuil28").Range("dk5001")

'affecte comptes 15 poste CM
Sheets("feuil28").Range("dp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dp1:dp5000")) 'compte 15
Sheets("feuil5").Range("m25") = Sheets("feuil28").Range("dp5001")

'affecte comptes 14 poste CL
Sheets("feuil28").Range("dq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dq1:dq5000")) 'compte 478
Sheets("feuil5").Range("m24") = Sheets("feuil28").Range("dq5001")

'affecte comptes 16 poste DA
Sheets("feuil28").Range("dr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dr1:dr5000")) 'compte 16
Sheets("feuil28").Range("ds5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ds1:ds5000")) 'compte 18
Sheets("feuil5").Range("m30") = Sheets("feuil28").Range("dr5001") + Sheets("feuil28").Range("ds5001")

'affecte comptes 17 poste DB
Sheets("feuil28").Range("dt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dt1:dt5000")) 'compte 17
Sheets("feuil5").Range("m31") = Sheets("feuil28").Range("dt5001")

'affecte comptes 19 poste DD
Sheets("feuil28").Range("du5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("du1:du5000")) 'compte 19
Sheets("feuil5").Range("m32") = Sheets("feuil28").Range("du5001")

'affecte comptes 419 poste DI
Sheets("feuil28").Range("dv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dv1:dv5000")) 'compte 419
Sheets("feuil5").Range("m36") = Sheets("feuil28").Range("dv5001")

'affecte comptes 401+402+408+404 poste DJ
Sheets("feuil28").Range("dw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dw1:dw5000")) 'compte 401
Sheets("feuil28").Range("dx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dx1:dx5000")) 'compte 402
Sheets("feuil28").Range("dy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dy1:dy5000")) 'compte 408
Sheets("feuil5").Range("m37") = Sheets("feuil28").Range("dw5001") + Sheets("feuil28").Range("dx5001") + Sheets("feuil28").Range("dy5001")

'adaptation syscohada compte 48 H.A.O
Sheets("feuil28").Range("ef5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ef1:ef5000")) 'compte 48
Sheets("feuil5").Range("m35") = Sheets("feuil28").Range("ef5001")

'affecte comptes 42+43+44 poste DK
Sheets("feuil28").Range("dz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dz1:dz5000")) 'compte 42
Sheets("feuil28").Range("ea5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ea1:ea5000")) 'compte 43
Sheets("feuil28").Range("eb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eb1:eb5000")) 'compte 44
Sheets("feuil5").Range("m38") = Sheets("feuil28").Range("dz5001") + Sheets("feuil28").Range("ea5001") + Sheets("feuil28").Range("eb5001")


'affecte comptes 45+46+47 poste DM
Sheets("feuil28").Range("ec5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ec1:ec5000")) 'compte 45
Sheets("feuil28").Range("ed5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ed1:ed5000")) 'compte 46
Sheets("feuil28").Range("ee5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ee1:ee5000")) 'compte 47
'Sheets("feuil28").Range("ef5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ef1:ef5000")) 'compte 48
Sheets("feuil5").Range("m39") = Sheets("feuil28").Range("ec5001") + Sheets("feuil28").Range("ed5001") + Sheets("feuil28").Range("ee5001") '+ Sheets("feuil28").Range("ef5001")

'affecte comptes 499+599 poste DN
Sheets("feuil28").Range("eg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eg1:eg5000")) 'compte 499
Sheets("feuil28").Range("eh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eh1:eh5000")) 'compte 599
Sheets("feuil5").Range("m40") = Sheets("feuil28").Range("eg5001") + Sheets("feuil28").Range("eh5001")

'affecte comptes 564+565 poste DQ
Sheets("feuil28").Range("ei5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ei1:ei5000")) 'compte 564
Sheets("feuil28").Range("ej5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ej1:ej5000")) 'compte 565
Sheets("feuil5").Range("m43") = Sheets("feuil28").Range("ei5001") + Sheets("feuil28").Range("ej5001")

'affecte comptes 52+(53+54 rattrapés) poste DS
Sheets("feuil28").Range("ek5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ek1:ek5000")) 'compte 52
Sheets("feuil28").Range("jn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jn1:jn5000")) 'compte 53c rattrapage
Sheets("feuil28").Range("jo5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jo1:jo5000")) 'compte 54c rattrapage
Sheets("feuil28").Range("el5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("el1:el5000")) 'compte 561
Sheets("feuil28").Range("em5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("em1:em5000")) 'compte 566
Sheets("feuil5").Range("m44") = Sheets("feuil28").Range("ek5001") + Sheets("feuil28").Range("jn5001") + Sheets("feuil28").Range("jo5001") + Sheets("feuil28").Range("el5001") + Sheets("feuil28").Range("em5001")

'adaptation syscohada compte 479 ECP
Sheets("feuil28").Range("lc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lc1:lc5000")) 'compte 479
Sheets("feuil5").Range("m46") = Sheets("feuil28").Range("lc5001")

'calcul TOTAUX DU PASSIF
'récupération d'abord du résultat à partir du compte de résultat
Sheets("feuil5").Range("m21") = Sheets("feuil6").Range("i54")

'calcul total capitaux propres
Sheets("feuil5").Range("m28") = WorksheetFunction.Sum(Sheets("feuil5").Range("m13:m25"))

'calcul total dettes financières
Sheets("feuil5").Range("m33") = WorksheetFunction.Sum(Sheets("feuil5").Range("m30:m32"))

'calcul total ressources stables
Sheets("feuil5").Range("m34") = Sheets("feuil5").Range("m28") + Sheets("feuil5").Range("m33")

'calcul total passif circulant
Sheets("feuil5").Range("m41") = WorksheetFunction.Sum(Sheets("feuil5").Range("m35:m40"))

'calcul total trésorerie passif
Sheets("feuil5").Range("m45") = WorksheetFunction.Sum(Sheets("feuil5").Range("m43:m44"))

'calcul total général passif
Sheets("feuil5").Range("m47") = Sheets("feuil5").Range("m34") + Sheets("feuil5").Range("m41") + Sheets("feuil5").Range("m45") + Sheets("feuil5").Range("m46")

'_______________________________________________________________________________________

'afficher bilan
Sheets("feuil5").Activate
Sheets("feuil5").Range("a1").Select

'message d'équilibre
If Sheets("feuil5").Range("g47") = Sheets("feuil5").Range("m47") Then
MsgBox "Votre Bilan N est équilibré avec un résultat de  " & Sheets("feuil6").Range("i54")
Else
MsgBox "Votre bilan N est déséquilibré de  " & Abs(Sheets("feuil5").Range("g47") - Sheets("feuil5").Range("m47"))
End If

'efface les données sur la feuil28
Sheets("feuil28").Range("a1:za5001").ClearContents
End Sub
Private Sub annuler_feuil28()
Sheets("feuil28").Range("a1:za5001").ClearContents
End Sub
Private Sub onglet()
'Pour masquer les onglets :
ActiveWindow.DisplayWorkbookTabs = False
'Et pour réafficher les onglets :
'ActiveWindow.DisplayWorkbookTabs = True
End Sub
Private Sub affiche_balance_n()
'animationv1
'délai d'essai
date_test = Now()
If Year(2020) > 2017 Then
MsgBox "Délai d'essai expiré we in 2 !"
Else

'condition d'installation
'If Sheets("feuil12").Range("a100") = Left(Sheets("feuil12").Range("a101"), 10) Then

Sheets("feuil2").Activate

'condition d'installation
'Else
'MsgBox "Désolé  !  Veuillez d'abord installer votre logiciel."
'End If

'délai d'essai
End If
End Sub
Private Sub retour_menu_général()
Sheets("feuil28").Activate
End Sub
Private Sub edite_compte_résultat_n()

'condition d'édition
'If WorksheetFunction.Sum(Sheets("feuil2").Range("g1:h5000")) = 0 Then
'MsgBox "Désolé !  Aucune donnée à éditer."
'Else

'demande de confirmation
'If Sheets("feuil7").Range("h54") = "" Then
'If MsgBox("NB : Si ce n'est pas le 1er exercice comptable, veuillez toujours commencer par éditer les Etats financiers de l'exercice N-1  !" & Chr(10) & Chr(10) & "Confirmez vous l'édition du Compte de résultat N ?", vbYesNo, "Demande de confirmation") = vbYes Then
'End If
'Else
'If MsgBox("Confirmez vous l'édition du Compte de résultat N ?", vbYesNo, "Demande de confirmation") = vbYes Then


'efface d'abord les données du compte de résultat
Sheets("feuil6").Range("i13:i54").ClearContents

For i = 3 To 5000

'recup CHARGES
'recup compte 601
If Left(Sheets("feuil2").Cells(i, 1), 3) = 601 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6019 Then
Else
Sheets("feuil28").Cells(i, 144) = Sheets("feuil2").Cells(i, 7) 'colonne EN
End If
Else
End If

'recup compte 6019
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6019 Then
Sheets("feuil28").Cells(i, 145) = Sheets("feuil2").Cells(i, 8) 'colonne EO
Else
End If

'recup compte 6031d
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6031 Then
Sheets("feuil28").Cells(i, 146) = Sheets("feuil2").Cells(i, 7) 'colonne EP
Else
End If

'recup compte 6031c
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6031 Then
Sheets("feuil28").Cells(i, 147) = Sheets("feuil2").Cells(i, 8) 'colonne EQ
Else
End If

'recup compte 602
If Left(Sheets("feuil2").Cells(i, 1), 3) = 602 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6029 Then
Else
Sheets("feuil28").Cells(i, 148) = Sheets("feuil2").Cells(i, 7) 'colonne ER
End If
Else
End If

'recup compte 6029
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6029 Then
Sheets("feuil28").Cells(i, 149) = Sheets("feuil2").Cells(i, 8) 'colonne ES
Else
End If

'recup compte 6032d
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6032 Then
Sheets("feuil28").Cells(i, 150) = Sheets("feuil2").Cells(i, 7) 'colonne ET
Else
End If

'recup compte 6032c
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6032 Then
Sheets("feuil28").Cells(i, 151) = Sheets("feuil2").Cells(i, 8) 'colonne EU
Else
End If

'recup compte 604
If Left(Sheets("feuil2").Cells(i, 1), 3) = 604 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6049 Then
Else
Sheets("feuil28").Cells(i, 152) = Sheets("feuil2").Cells(i, 7) 'colonne EV
End If
Else
End If

'recup compte 605
If Left(Sheets("feuil2").Cells(i, 1), 3) = 605 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6059 Then
Else
Sheets("feuil28").Cells(i, 153) = Sheets("feuil2").Cells(i, 7) 'colonne EW
End If
Else
End If

'recup compte 608
If Left(Sheets("feuil2").Cells(i, 1), 3) = 608 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6089 Then
Else
Sheets("feuil28").Cells(i, 154) = Sheets("feuil2").Cells(i, 7) 'colonne EX
End If
Else
End If

'recup compte 6049
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6049 Then
Sheets("feuil28").Cells(i, 155) = Sheets("feuil2").Cells(i, 8) 'colonne EY
Else
End If

'recup compte 6059
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6059 Then
Sheets("feuil28").Cells(i, 156) = Sheets("feuil2").Cells(i, 8) 'colonne EZ
Else
End If

'recup compte 6089
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6089 Then
Sheets("feuil28").Cells(i, 157) = Sheets("feuil2").Cells(i, 8) 'colonne FA
Else
End If

'recup compte 6033d
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6033 Then
Sheets("feuil28").Cells(i, 158) = Sheets("feuil2").Cells(i, 7) 'colonne FB
Else
End If

'recup compte 6033c
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6033 Then
Sheets("feuil28").Cells(i, 159) = Sheets("feuil2").Cells(i, 8) 'colonne FC
Else
End If

'recup compte 61
If Left(Sheets("feuil2").Cells(i, 1), 2) = 61 Then
Sheets("feuil28").Cells(i, 160) = Sheets("feuil2").Cells(i, 7) 'colonne FD
Else
End If

'recup compte 62
If Left(Sheets("feuil2").Cells(i, 1), 2) = 62 Then
Sheets("feuil28").Cells(i, 161) = Sheets("feuil2").Cells(i, 7) 'colonne FE
Else
End If

'recup compte 63
If Left(Sheets("feuil2").Cells(i, 1), 2) = 63 Then
Sheets("feuil28").Cells(i, 162) = Sheets("feuil2").Cells(i, 7) 'colonne FF
Else
End If

'recup compte 64
If Left(Sheets("feuil2").Cells(i, 1), 2) = 64 Then
Sheets("feuil28").Cells(i, 163) = Sheets("feuil2").Cells(i, 7) 'colonne FG
Else
End If

'recup compte 65
If Left(Sheets("feuil2").Cells(i, 1), 2) = 65 Then
Sheets("feuil28").Cells(i, 164) = Sheets("feuil2").Cells(i, 7) 'colonne FH
Else
End If

'recup compte 66
If Left(Sheets("feuil2").Cells(i, 1), 2) = 66 Then
Sheets("feuil28").Cells(i, 165) = Sheets("feuil2").Cells(i, 7) 'colonne FI
Else
End If

'recup compte 681
If Left(Sheets("feuil2").Cells(i, 1), 3) = 681 Then
Sheets("feuil28").Cells(i, 166) = Sheets("feuil2").Cells(i, 7) 'colonne FJ
Else
End If

'recup compte 691
If Left(Sheets("feuil2").Cells(i, 1), 3) = 691 Then
Sheets("feuil28").Cells(i, 167) = Sheets("feuil2").Cells(i, 7) 'colonne FK
Else
End If

'recup compte 67
If Left(Sheets("feuil2").Cells(i, 1), 2) = 67 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 676 Then
Else
Sheets("feuil28").Cells(i, 168) = Sheets("feuil2").Cells(i, 7) 'colonne FL
End If
Else
End If

'recup compte 676
If Left(Sheets("feuil2").Cells(i, 1), 3) = 676 Then
Sheets("feuil28").Cells(i, 169) = Sheets("feuil2").Cells(i, 7) 'colonne FM
Else
End If

'recup compte 687
If Left(Sheets("feuil2").Cells(i, 1), 3) = 687 Then
Sheets("feuil28").Cells(i, 170) = Sheets("feuil2").Cells(i, 7) 'colonne FN
Else
End If

'recup compte 697
If Left(Sheets("feuil2").Cells(i, 1), 3) = 697 Then
Sheets("feuil28").Cells(i, 171) = Sheets("feuil2").Cells(i, 7) 'colonne FO
Else
End If

'recup compte 81
If Left(Sheets("feuil2").Cells(i, 1), 2) = 81 Then
Sheets("feuil28").Cells(i, 172) = Sheets("feuil2").Cells(i, 7) 'colonne FP
Else
End If

'recup compte 831
If Left(Sheets("feuil2").Cells(i, 1), 3) = 831 Then
Sheets("feuil28").Cells(i, 173) = Sheets("feuil2").Cells(i, 7) 'colonne FQ
Else
End If

'recup compte 836
If Left(Sheets("feuil2").Cells(i, 1), 3) = 836 Then
Sheets("feuil28").Cells(i, 174) = Sheets("feuil2").Cells(i, 7) 'colonne FR
Else
End If

'recup compte 83 sauf 831+836
If Left(Sheets("feuil2").Cells(i, 1), 2) = 83 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 836 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 3) = 831 Then
Else
Sheets("feuil28").Cells(i, 175) = Sheets("feuil2").Cells(i, 7) 'colonne FS
End If
End If
Else
End If

'recup compte 85
If Left(Sheets("feuil2").Cells(i, 1), 2) = 85 Then
Sheets("feuil28").Cells(i, 176) = Sheets("feuil2").Cells(i, 7) 'colonne FT
Else
End If

'recup compte 87
If Left(Sheets("feuil2").Cells(i, 1), 2) = 87 Then
Sheets("feuil28").Cells(i, 177) = Sheets("feuil2").Cells(i, 7) 'colonne FU
Else
End If

'recup compte 89
If Left(Sheets("feuil2").Cells(i, 1), 2) = 89 Then
Sheets("feuil28").Cells(i, 178) = Sheets("feuil2").Cells(i, 7) 'colonne FV
Else
End If


'recup PRODUITS
'recup compte 701
If Left(Sheets("feuil2").Cells(i, 1), 3) = 701 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7019 Then
Else
Sheets("feuil28").Cells(i, 179) = Sheets("feuil2").Cells(i, 8) 'colonne FW
End If
Else
End If

'recup compte 702
If Left(Sheets("feuil2").Cells(i, 1), 3) = 702 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7029 Then
Else
Sheets("feuil28").Cells(i, 180) = Sheets("feuil2").Cells(i, 8) 'colonne FX
End If
Else
End If

'recup compte 703
If Left(Sheets("feuil2").Cells(i, 1), 3) = 703 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7039 Then
Else
Sheets("feuil28").Cells(i, 181) = Sheets("feuil2").Cells(i, 8) 'colonne FY
End If
Else
End If

'recup compte 704
If Left(Sheets("feuil2").Cells(i, 1), 3) = 704 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7049 Then
Else
Sheets("feuil28").Cells(i, 182) = Sheets("feuil2").Cells(i, 8) 'colonne FZ
End If
Else
End If

'recup compte 705
If Left(Sheets("feuil2").Cells(i, 1), 3) = 705 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7059 Then
Else
Sheets("feuil28").Cells(i, 183) = Sheets("feuil2").Cells(i, 8) 'colonne GA
End If
Else
End If

'recup compte 706
If Left(Sheets("feuil2").Cells(i, 1), 3) = 706 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7069 Then
Else
Sheets("feuil28").Cells(i, 184) = Sheets("feuil2").Cells(i, 8) 'colonne GB
End If
Else
End If

'recup compte 73c
If Left(Sheets("feuil2").Cells(i, 1), 2) = 73 Then
Sheets("feuil28").Cells(i, 185) = Sheets("feuil2").Cells(i, 8) 'colonne GC
Else
End If

'recup compte 73d
If Left(Sheets("feuil2").Cells(i, 1), 2) = 73 Then
Sheets("feuil28").Cells(i, 186) = Sheets("feuil2").Cells(i, 7) 'colonne GD
Else
End If

'recup compte 72
If Left(Sheets("feuil2").Cells(i, 1), 2) = 72 Then
Sheets("feuil28").Cells(i, 187) = Sheets("feuil2").Cells(i, 8) 'colonne GE
Else
End If

'recup compte 707
If Left(Sheets("feuil2").Cells(i, 1), 3) = 707 Then
Sheets("feuil28").Cells(i, 188) = Sheets("feuil2").Cells(i, 8) 'colonne GF
Else
End If

'recup compte 71
If Left(Sheets("feuil2").Cells(i, 1), 2) = 71 Then
Sheets("feuil28").Cells(i, 189) = Sheets("feuil2").Cells(i, 8) 'colonne GG
Else
End If

'recup compte 75
If Left(Sheets("feuil2").Cells(i, 1), 2) = 75 Then
Sheets("feuil28").Cells(i, 190) = Sheets("feuil2").Cells(i, 8) 'colonne GH
Else
End If

'recup compte 791
If Left(Sheets("feuil2").Cells(i, 1), 3) = 791 Then
Sheets("feuil28").Cells(i, 191) = Sheets("feuil2").Cells(i, 8) 'colonne GI
Else
End If

'adaptation SYSCOHADA révisé (compte 799 nouveau)
'recup compte 798+799
If Left(Sheets("feuil2").Cells(i, 1), 3) = 798 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 799 Then
Sheets("feuil28").Cells(i, 192) = Sheets("feuil2").Cells(i, 8) 'colonne GJ
Else
End If

'recup compte 781
If Left(Sheets("feuil2").Cells(i, 1), 3) = 781 Then
Sheets("feuil28").Cells(i, 193) = Sheets("feuil2").Cells(i, 8) 'colonne GK
Else
End If

'recup compte 77 sauf 776
If Left(Sheets("feuil2").Cells(i, 1), 2) = 77 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 776 Then
Else
Sheets("feuil28").Cells(i, 194) = Sheets("feuil2").Cells(i, 8) 'colonne GL
End If
Else
End If

'recup compte 776
If Left(Sheets("feuil2").Cells(i, 1), 3) = 776 Then
Sheets("feuil28").Cells(i, 195) = Sheets("feuil2").Cells(i, 8) 'colonne GM
Else
End If

'recup compte 797
If Left(Sheets("feuil2").Cells(i, 1), 3) = 797 Then
Sheets("feuil28").Cells(i, 196) = Sheets("feuil2").Cells(i, 8) 'colonne GN
Else
End If

'recup compte 787
If Left(Sheets("feuil2").Cells(i, 1), 3) = 787 Then
Sheets("feuil28").Cells(i, 197) = Sheets("feuil2").Cells(i, 8) 'colonne GO
Else
End If

'recup compte 82
If Left(Sheets("feuil2").Cells(i, 1), 2) = 82 Then
Sheets("feuil28").Cells(i, 198) = Sheets("feuil2").Cells(i, 8) 'colonne GP
Else
End If

'recup compte 848
If Left(Sheets("feuil2").Cells(i, 1), 3) = 848 Then
Sheets("feuil28").Cells(i, 199) = Sheets("feuil2").Cells(i, 8) 'colonne GQ
Else
End If

'recup compte 84
If Left(Sheets("feuil2").Cells(i, 1), 2) = 84 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 848 Then
Else
Sheets("feuil28").Cells(i, 200) = Sheets("feuil2").Cells(i, 8) 'colonne GR
End If
Else
End If

'recup compte 88
If Left(Sheets("feuil2").Cells(i, 1), 2) = 88 Then
Sheets("feuil28").Cells(i, 201) = Sheets("feuil2").Cells(i, 8) 'colonne GS
Else
End If

'recup compte 86
If Left(Sheets("feuil2").Cells(i, 1), 2) = 86 Then
Sheets("feuil28").Cells(i, 202) = Sheets("feuil2").Cells(i, 8) 'colonne GT
Else
End If

'pour calcul dont personnel extérieur des charges de personnel
'recup compte 637
If Left(Sheets("feuil2").Cells(i, 1), 3) = 637 Then
Sheets("feuil28").Cells(i, 203) = Sheets("feuil2").Cells(i, 7) 'colonne GU
Else
End If
'recup compte 667
If Left(Sheets("feuil2").Cells(i, 1), 3) = 667 Then
Sheets("feuil28").Cells(i, 204) = Sheets("feuil2").Cells(i, 7) 'colonne GV
Else
End If


'Adaptation SYSCOHADA révisé (R,R,R sur les ventes)
'recup compte 7019
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7019 Then
Sheets("feuil28").Cells(i, 209) = Sheets("feuil2").Cells(i, 7) 'colonne HA
Else
End If

'recup compte 7029+7039+7049
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7029 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7039 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7049 Then
Sheets("feuil28").Cells(i, 210) = Sheets("feuil2").Cells(i, 7) 'colonne HB
Else
End If

'recup compte 7059+7069
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7059 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7069 Then
Sheets("feuil28").Cells(i, 211) = Sheets("feuil2").Cells(i, 7) 'colonne HC
Else
End If


Next

'affecte CHARGES
'affecte comptes 601+6019 poste RA
Sheets("feuil28").Range("en5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("en1:en5000")) 'compte 601
Sheets("feuil28").Range("eo5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eo1:eo5000")) 'compte 6019
Sheets("feuil6").Range("i14") = -(Sheets("feuil28").Range("en5001") - Sheets("feuil28").Range("eo5001"))

'affecte comptes 6031(d/c) poste RB
Sheets("feuil28").Range("ep5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ep1:ep5000")) 'compte 6031d
Sheets("feuil28").Range("eq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eq1:eq5000")) 'compte 6031c
Sheets("feuil6").Range("i15") = -(Sheets("feuil28").Range("ep5001") - Sheets("feuil28").Range("eq5001"))

'affecte comptes 602+6029 poste RC
Sheets("feuil28").Range("er5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("er1:er5000")) 'compte 602
Sheets("feuil28").Range("es5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("es1:es5000")) 'compte 6029
Sheets("feuil6").Range("i26") = -(Sheets("feuil28").Range("er5001") - Sheets("feuil28").Range("es5001"))

'affecte comptes 6032(d/c) poste RD
Sheets("feuil28").Range("et5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("et1:et5000")) 'compte 6032d
Sheets("feuil28").Range("eu5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eu1:eu5000")) 'compte 6032c
Sheets("feuil6").Range("i27") = -(Sheets("feuil28").Range("et5001") - Sheets("feuil28").Range("eu5001"))

'affecte comptes 604+605+608+6049+6059+6089 poste RE
Sheets("feuil28").Range("ev5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ev1:ev5000")) 'compte 604
Sheets("feuil28").Range("ew5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ew1:ew5000")) 'compte 605
Sheets("feuil28").Range("ex5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ex1:ex5000")) 'compte 608
Sheets("feuil28").Range("ey5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ey1:ey5000")) 'compte 6049
Sheets("feuil28").Range("ez5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ez1:ez5000")) 'compte 6059
Sheets("feuil28").Range("fa5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fa1:fa5000")) 'compte 6089
Sheets("feuil6").Range("i28") = -((Sheets("feuil28").Range("ev5001") + Sheets("feuil28").Range("ew5001") + Sheets("feuil28").Range("ex5001")) - (Sheets("feuil28").Range("ey5001") + Sheets("feuil28").Range("ez5001") + Sheets("feuil28").Range("fa5001")))

'affecte comptes 6033(d/c) poste RH
Sheets("feuil28").Range("fb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fb1:fb5000")) 'compte 6033d
Sheets("feuil28").Range("fc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fc1:fc5000")) 'compte 6033c
Sheets("feuil6").Range("i29") = -(Sheets("feuil28").Range("fb5001") - Sheets("feuil28").Range("fc5001"))

'affecte comptes 61 poste RI
Sheets("feuil28").Range("fd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fd1:fd5000")) 'compte 61
Sheets("feuil6").Range("i30") = -Sheets("feuil28").Range("fd5001")

'affecte comptes 62+63 poste RJ
Sheets("feuil28").Range("fe5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fe1:fe5000")) 'compte 62
Sheets("feuil28").Range("ff5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ff1:ff5000")) 'compte 63
Sheets("feuil6").Range("i31") = -(Sheets("feuil28").Range("fe5001") + Sheets("feuil28").Range("ff5001"))

'affecte comptes 64 poste RK
Sheets("feuil28").Range("fg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fg1:fg5000")) 'compte 64
Sheets("feuil6").Range("i32") = -Sheets("feuil28").Range("fg5001")

'affecte comptes 65 poste RL
Sheets("feuil28").Range("fh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fh1:fh5000")) 'compte 65
Sheets("feuil6").Range("i33") = -Sheets("feuil28").Range("fh5001")

'affecte comptes 66 poste RP
Sheets("feuil28").Range("fi5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fi1:fi5000")) 'compte 66
Sheets("feuil6").Range("i35") = -Sheets("feuil28").Range("fi5001")

'affecte comptes 681+691 poste RS
Sheets("feuil28").Range("fj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fj1:fj5000")) 'compte 681
Sheets("feuil28").Range("fk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fk1:fk5000")) 'compte 691
Sheets("feuil6").Range("i38") = -(Sheets("feuil28").Range("fj5001") + Sheets("feuil28").Range("fk5001"))

'adaptation syscohada comptes 67+676 poste SF
Sheets("feuil28").Range("fl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fl1:fl5000")) 'compte 67
Sheets("feuil28").Range("fm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fm1:fm5000")) 'compte 676
Sheets("feuil6").Range("i43") = -(Sheets("feuil28").Range("fl5001") + Sheets("feuil28").Range("fm5001"))

'adaptaion syscohada comptes 687+697 poste SF
Sheets("feuil28").Range("fn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fn1:fn5000")) 'compte 687
Sheets("feuil28").Range("fo5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fo1:fo5000")) 'compte 697
Sheets("feuil6").Range("i44") = -(Sheets("feuil28").Range("fn5001") + Sheets("feuil28").Range("fo5001"))


'affecte comptes 81 poste SJ
Sheets("feuil28").Range("fp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fp1:fp5000")) 'compte 81
Sheets("feuil6").Range("i49") = -Sheets("feuil28").Range("fp5001")

'adaptation SYSCOHADA révisé comptes 83+831+836 poste SM
Sheets("feuil28").Range("fs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fs1:fs5000")) 'compte 81
Sheets("feuil28").Range("fq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fq1:fq5000")) 'compte 831
Sheets("feuil28").Range("fr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fr1:fr5000")) 'compte 836
Sheets("feuil28").Range("ft5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ft1:ft5000")) 'compte 85
Sheets("feuil6").Range("i50") = -(Sheets("feuil28").Range("fs5001") + Sheets("feuil28").Range("fq5001") + Sheets("feuil28").Range("fr5001") + Sheets("feuil28").Range("ft5001"))

'affecte comptes 87 poste SQ
Sheets("feuil28").Range("fu5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fu1:fu5000")) 'compte 87
Sheets("feuil6").Range("i52") = -Sheets("feuil28").Range("fu5001")

'affecte comptes 89 poste SR
Sheets("feuil28").Range("fv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fv1:fv5000")) 'compte 89
Sheets("feuil6").Range("i53") = -Sheets("feuil28").Range("fv5001")


'affecte PRODUITS
'affecte comptes 701-7019 poste TA
Sheets("feuil28").Range("fw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fw1:fw5000")) 'compte 701
Sheets("feuil28").Range("ha5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ha1:ha5000")) 'compte 7019
Sheets("feuil6").Range("i13") = Sheets("feuil28").Range("fw5001") - Sheets("feuil28").Range("ha5001")

'affecte comptes 702+703+704-(7029+7039+7049) poste TC
Sheets("feuil28").Range("fx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fx1:fx5000")) 'compte 702
Sheets("feuil28").Range("fy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fy1:fy5000")) 'compte 703
Sheets("feuil28").Range("fz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fz1:fz5000")) 'compte 704
Sheets("feuil28").Range("hb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hb1:hb5000")) 'compte 7029+7039+7049
Sheets("feuil6").Range("i17") = Sheets("feuil28").Range("fx5001") + Sheets("feuil28").Range("fy5001") + Sheets("feuil28").Range("fz5001") - Sheets("feuil28").Range("hb5001")

'affecte comptes 705+706- (7059+7069) poste TD
Sheets("feuil28").Range("ga5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ga1:ga5000")) 'compte 705
Sheets("feuil28").Range("gb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gb1:gb5000")) 'compte 706
Sheets("feuil28").Range("hc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hc1:hc5000")) 'compte 7059+7069
Sheets("feuil6").Range("i18") = Sheets("feuil28").Range("ga5001") + Sheets("feuil28").Range("gb5001") - Sheets("feuil28").Range("hc5001")

'affecte comptes 73(c/d) poste TE
Sheets("feuil28").Range("gc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gc1:gc5000")) 'compte 73c
Sheets("feuil28").Range("gd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gd1:gd5000")) 'compte 73d
Sheets("feuil6").Range("i21") = Sheets("feuil28").Range("gc5001") - Sheets("feuil28").Range("gd5001")

'affecte comptes 72 poste TF
Sheets("feuil28").Range("ge5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ge1:ge5000")) 'compte 72
Sheets("feuil6").Range("i22") = Sheets("feuil28").Range("ge5001")

'affecte comptes 707 poste TH
Sheets("feuil28").Range("gf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gf1:gf5000")) 'compte 707
Sheets("feuil6").Range("i19") = Sheets("feuil28").Range("gf5001")

'affecte comptes 71 poste TK
Sheets("feuil28").Range("gg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gg1:gg5000")) 'compte 71
Sheets("feuil6").Range("i23") = Sheets("feuil28").Range("gg5001")

'affecte comptes 75 poste TL
Sheets("feuil28").Range("gh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gh1:gh5000")) 'compte 75
Sheets("feuil6").Range("i24") = Sheets("feuil28").Range("gh5001")

'affecte comptes 791+798+799 poste TS
Sheets("feuil28").Range("gi5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gi1:gi5000")) 'compte 791
Sheets("feuil28").Range("gj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gj1:gj5000")) 'compte 798+799
Sheets("feuil6").Range("i37") = Sheets("feuil28").Range("gi5001") + Sheets("feuil28").Range("gj5001")

'affecte comptes 781 poste TT
Sheets("feuil28").Range("gk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gk1:gk5000")) 'compte 781
Sheets("feuil6").Range("i25") = Sheets("feuil28").Range("gk5001")


'adaptation SYSCOHADA révisé comptes 77+776 poste UF
Sheets("feuil28").Range("gl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gl1:gl5000")) 'compte 77
Sheets("feuil28").Range("gm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gm1:gm5000")) 'compte 776
Sheets("feuil6").Range("i40") = Sheets("feuil28").Range("gl5001") + Sheets("feuil28").Range("gm5001")

'adaptation syscohada comptes 797 poste UF
Sheets("feuil28").Range("gn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gn1:gn5000")) 'compte 797
Sheets("feuil6").Range("i41") = Sheets("feuil28").Range("gn5001")

'adaptation syscohada comptes 787 poste UF
Sheets("feuil28").Range("go5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("go1:go5000")) 'compte 787
Sheets("feuil6").Range("i42") = Sheets("feuil28").Range("go5001")


'affecte comptes 82 poste UJ
Sheets("feuil28").Range("gp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gp1:gp5000")) 'compte 82
Sheets("feuil6").Range("i47") = Sheets("feuil28").Range("gp5001")

'adaptation SYSCOHADA révisé comptes 84+848+88+86 poste UM
Sheets("feuil28").Range("gr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gr1:gr5000")) 'compte 84 sauf 841
Sheets("feuil28").Range("gq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gq1:gq5000")) 'compte 841
Sheets("feuil28").Range("gs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gs1:gs5000")) 'compte 88
Sheets("feuil28").Range("gt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gt1:gt5000")) 'compte 86
Sheets("feuil6").Range("i48") = Sheets("feuil28").Range("gr5001") + Sheets("feuil28").Range("gq5001") + Sheets("feuil28").Range("gs5001") + Sheets("feuil28").Range("gt5001")

'___________________________________________________________________________________________

'calcul des TOTAUX DU COMPTE DE Résultat
'marge commerciale
Sheets("feuil6").Range("i16") = WorksheetFunction.Sum(Sheets("feuil6").Range("i13:i15"))

'chiffre d'affaires
Sheets("feuil6").Range("i20") = WorksheetFunction.Sum(Sheets("feuil6").Range("i17:i19")) + Sheets("feuil6").Range("i13")

'valeur ajoutée
Sheets("feuil6").Range("i34") = WorksheetFunction.Sum(Sheets("feuil6").Range("i21:i33")) + Sheets("feuil6").Range("i20") + Sheets("feuil6").Range("i14") + Sheets("feuil6").Range("i15")

'excédent brut d'exploitation
Sheets("feuil6").Range("i36") = Sheets("feuil6").Range("i34") + Sheets("feuil6").Range("i35")

'résultat d'exploitation
Sheets("feuil6").Range("i39") = Sheets("feuil6").Range("i36") + WorksheetFunction.Sum(Sheets("feuil6").Range("i37:i38"))

'résultat financier
Sheets("feuil6").Range("i45") = WorksheetFunction.Sum(Sheets("feuil6").Range("i40:i44"))

'résultat A.O.
Sheets("feuil6").Range("i46") = Sheets("feuil6").Range("i39") + Sheets("feuil6").Range("i45")

'résultat H.A.O.
Sheets("feuil6").Range("i51") = WorksheetFunction.Sum(Sheets("feuil6").Range("i47:i50"))

'résultat NET
Sheets("feuil6").Range("i54") = Sheets("feuil6").Range("i46") + Sheets("feuil6").Range("i51") + Sheets("feuil6").Range("i52") + Sheets("feuil6").Range("i53")

'____________________________________________________________________________________________


'affiche COMPTE DE RESULTAT
Sheets("feuil6").Activate
Sheets("feuil6").Range("a1").Select

'message du résultat de N
MsgBox "Votre résultat N est de  " & Sheets("feuil6").Range("i54")


'efface les données sur la feuil28
Sheets("feuil28").Range("a1:za5001").ClearContents


'demande de confirmation
'End If
'End If

'condition d'édition
'End If

End Sub
Private Sub annuler_compte_résultat()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

If Sheets("feuil6").Range("i54") <> "" Then
Sheets("feuil6").Range("i13:i54").ClearContents
Else
Sheets("feuil6").Range("j13:j54").ClearContents
End If

End If
End Sub
Private Sub edite_bilan_n_1()
'animationv1
'mise en forme conditionnelle
Sheets("feuil28").Range("zb11") = 1

'délai d'essai
date_test = Now()
If Year(2020) > 2017 Then
MsgBox "Délai d'essai expiré 5!"
Else

'condition d'installation
'If Sheets("feuil12").Range("a100") = Left(Sheets("feuil12").Range("a101"), 10) Then

If WorksheetFunction.Sum(Sheets("feuil1").Range("g1:h5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à éditer."
Else

'condition d'édition du bilan N-1
If Sheets("feuil6").Range("j47") = "" Then
MsgBox "Veuillez d'abord éditer le Compte de résultat N-1 !"
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition du Bilan N-1 ?", vbYesNo, "Demande de confirmation") = vbYes Then

'annule les données du bilan
Sheets("feuil5").Range("h14:h47").ClearContents 'actif
Sheets("feuil5").Range("n13:n47").ClearContents 'passif
Sheets("feuil5").Range("c21").ClearContents 'terrain - immeuble de placement
Sheets("feuil5").Range("c25").ClearContents 'bâtiment - immeuble de placement
Sheets("feuil24").Range("b16:k35").ClearContents 'tableau 1 - Actif immobilisé N-1
Sheets("feuil23").Range("b16:b35").ClearContents 'tableau 1 - Actif immobilisé N (report brut N-1)
Sheets("feuil5").Range("ah14:ah47").ClearContents 'pour note annexe

For i = 3 To 5000

'recup ACTIF DU BILAN
'recup compte 211 et 2181
If Left(Sheets("feuil1").Cells(i, 1), 3) = 211 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2181 Then
Sheets("feuil28").Cells(i, 1) = Sheets("feuil1").Cells(i, 7) 'colonne A
Else
End If

'recup compte 2811 et 28181
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2811 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 28181 Then 'compte 2811 et 28181
Sheets("feuil28").Cells(i, 2) = Sheets("feuil1").Cells(i, 8) 'colonne B
Else
End If

'recup compte 212
If Left(Sheets("feuil1").Cells(i, 1), 3) = 212 Then 'compte 212
Sheets("feuil28").Cells(i, 3) = Sheets("feuil1").Cells(i, 7) 'colonne C
Else
End If

'recup compte 213
If Left(Sheets("feuil1").Cells(i, 1), 3) = 213 Then 'compte 213
Sheets("feuil28").Cells(i, 4) = Sheets("feuil1").Cells(i, 7) 'colonne D
Else
End If

'recup compte 214
If Left(Sheets("feuil1").Cells(i, 1), 3) = 214 Then 'compte 214
Sheets("feuil28").Cells(i, 5) = Sheets("feuil1").Cells(i, 7) 'colonne E
Else
End If

'recup compte 2812
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2812 Then 'compte 2812
Sheets("feuil28").Cells(i, 6) = Sheets("feuil1").Cells(i, 8) 'colonne F
Else
End If

'recup compte 2813
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2813 Then 'compte 2813
Sheets("feuil28").Cells(i, 7) = Sheets("feuil1").Cells(i, 8) 'colonne G
Else
End If

'recup compte 2814
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2814 Then 'compte 2814
Sheets("feuil28").Cells(i, 8) = Sheets("feuil1").Cells(i, 8) 'colonne H
Else
End If

'recup compte 2912
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2912 Then 'compte 2912
Sheets("feuil28").Cells(i, 9) = Sheets("feuil1").Cells(i, 8) 'colonne I
Else
End If

'recup compte 2913
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2913 Then 'compte 2913
Sheets("feuil28").Cells(i, 10) = Sheets("feuil1").Cells(i, 8) 'colonne J
Else
End If

'recup compte 2914
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2914 Then 'compte 2914
Sheets("feuil28").Cells(i, 11) = Sheets("feuil1").Cells(i, 8) 'colonne K
Else
End If

'recup compte 215
If Left(Sheets("feuil1").Cells(i, 1), 3) = 215 Then 'compte 215
Sheets("feuil28").Cells(i, 12) = Sheets("feuil1").Cells(i, 7) 'colonne L
Else
End If

'recup compte 216
If Left(Sheets("feuil1").Cells(i, 1), 3) = 216 Then 'compte 216
Sheets("feuil28").Cells(i, 13) = Sheets("feuil1").Cells(i, 7) 'colonne M
Else
End If

'recup compte 2815
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2815 Then 'compte 2815
Sheets("feuil28").Cells(i, 14) = Sheets("feuil1").Cells(i, 8) 'colonne N
Else
End If

'recup compte 2816
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2816 Then 'compte 2816
Sheets("feuil28").Cells(i, 15) = Sheets("feuil1").Cells(i, 8) 'colonne O
Else
End If

'recup compte 2915
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2915 Then 'compte 2915
Sheets("feuil28").Cells(i, 16) = Sheets("feuil1").Cells(i, 8) 'colonne P
Else
End If

'recup compte 2916
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2916 Then 'compte 2916
Sheets("feuil28").Cells(i, 17) = Sheets("feuil1").Cells(i, 8) 'colonne Q
Else
End If

'recup compte 217
If Left(Sheets("feuil1").Cells(i, 1), 3) = 217 Then 'compte 217
Sheets("feuil28").Cells(i, 18) = Sheets("feuil1").Cells(i, 7) 'colonne R
Else
End If

'recup compte 218
If Left(Sheets("feuil1").Cells(i, 1), 3) = 218 Then 'compte 218
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2181 Then
Else
Sheets("feuil28").Cells(i, 19) = Sheets("feuil1").Cells(i, 7) 'colonne S
End If
Else
End If

'recup compte 2817
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2817 Then 'compte 2817
Sheets("feuil28").Cells(i, 20) = Sheets("feuil1").Cells(i, 8) 'colonne T
Else
End If

'recup compte 2818
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2818 Then 'compte 2818
If Left(Sheets("feuil1").Cells(i, 1), 5) = 28181 Then
Else
Sheets("feuil28").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'colonne U
End If
Else
End If

'recup compte 2917
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2917 Then 'compte 2917
Sheets("feuil28").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'colonne V
Else
End If

'recup compte 2918
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2918 Then 'compte 2918
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29181 Then
Else
Sheets("feuil28").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'colonne W
End If
Else
End If

'recup compte 2191
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2191 Then 'compte 2191
Sheets("feuil28").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'colonne X
Else
End If

'recup compte 2193
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2193 Then 'compte 2193
Sheets("feuil28").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'colonne Y
Else
End If

'recup compte 2198
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2198 Then 'compte 2198
Sheets("feuil28").Cells(i, 26) = Sheets("feuil1").Cells(i, 7) 'colonne Z
Else
End If

'recup compte 29191 + 2911 + 29181
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29191 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 29181 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2911 Then  'compte 29191
Sheets("feuil28").Cells(i, 27) = Sheets("feuil1").Cells(i, 8) 'colonne AA
Else
End If

'recup compte 29193
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29193 Then 'compte 29193
Sheets("feuil28").Cells(i, 28) = Sheets("feuil1").Cells(i, 8) 'colonne AB
Else
End If

'recup compte 29198
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29198 Then 'compte 29198
Sheets("feuil28").Cells(i, 29) = Sheets("feuil1").Cells(i, 8) 'colonne AC
Else
End If

'recup compte 22
If Left(Sheets("feuil1").Cells(i, 1), 2) = 22 Then 'compte 22 sauf 229
If Left(Sheets("feuil1").Cells(i, 1), 3) = 229 Then
Else
Sheets("feuil28").Cells(i, 30) = Sheets("feuil1").Cells(i, 7) 'colonne AD
End If
Else
End If

'recup compte 282
If Left(Sheets("feuil1").Cells(i, 1), 3) = 282 Then 'compte 282
Sheets("feuil28").Cells(i, 31) = Sheets("feuil1").Cells(i, 8) 'colonne AE
Else
End If

'recup compte 292
If Left(Sheets("feuil1").Cells(i, 1), 3) = 292 Then 'compte 292 sauf 2929
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2929 Then
Else
Sheets("feuil28").Cells(i, 32) = Sheets("feuil1").Cells(i, 8) 'colonne AF
End If
Else
End If

'recup compte 231
If Left(Sheets("feuil1").Cells(i, 1), 3) = 231 Then 'compte 231
Sheets("feuil28").Cells(i, 33) = Sheets("feuil1").Cells(i, 7) 'colonne AG
Else
End If

'recup compte 232
If Left(Sheets("feuil1").Cells(i, 1), 3) = 232 Then 'compte 232
Sheets("feuil28").Cells(i, 34) = Sheets("feuil1").Cells(i, 7) 'colonne AH
Else
End If

'recup compte 233
If Left(Sheets("feuil1").Cells(i, 1), 3) = 233 Then 'compte 233
Sheets("feuil28").Cells(i, 35) = Sheets("feuil1").Cells(i, 7) 'colonne AI
Else
End If

'recup compte 237
If Left(Sheets("feuil1").Cells(i, 1), 3) = 237 Then 'compte 237
Sheets("feuil28").Cells(i, 36) = Sheets("feuil1").Cells(i, 7) 'colonne AJ
Else
End If

'recup compte 2831
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2831 Then 'compte 2831
Sheets("feuil28").Cells(i, 37) = Sheets("feuil1").Cells(i, 8) 'colonne AK
Else
End If

'recup compte 2832
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2832 Then 'compte 2832
Sheets("feuil28").Cells(i, 38) = Sheets("feuil1").Cells(i, 8) 'colonne AL
Else
End If

'recup compte 2833
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2833 Then 'compte 2833
Sheets("feuil28").Cells(i, 39) = Sheets("feuil1").Cells(i, 8) 'colonne AM
Else
End If

'recup compte 2837
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2837 Then 'compte 2837
Sheets("feuil28").Cells(i, 40) = Sheets("feuil1").Cells(i, 8) 'colonne AN
Else
End If

'recup compte 2931
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2931 Then 'compte 2931
Sheets("feuil28").Cells(i, 41) = Sheets("feuil1").Cells(i, 8) 'colonne AO
Else
End If

'recup compte 2932
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2932 Then 'compte 2932
Sheets("feuil28").Cells(i, 42) = Sheets("feuil1").Cells(i, 8) 'colonne AP
Else
End If

'recup compte 2933
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2933 Then 'compte 2933
Sheets("feuil28").Cells(i, 43) = Sheets("feuil1").Cells(i, 8) 'colonne AQ
Else
End If

'recup compte 2937
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2937 Then 'compte 2937
Sheets("feuil28").Cells(i, 44) = Sheets("feuil1").Cells(i, 8) 'colonne AR
Else
End If

'recup compte 234
If Left(Sheets("feuil1").Cells(i, 1), 3) = 234 Then 'compte 234
Sheets("feuil28").Cells(i, 45) = Sheets("feuil1").Cells(i, 7) 'colonne AS
Else
End If

'recup compte 235
If Left(Sheets("feuil1").Cells(i, 1), 3) = 235 Then 'compte 235
Sheets("feuil28").Cells(i, 46) = Sheets("feuil1").Cells(i, 7) 'colonne AT
Else
End If

'recup compte 238
If Left(Sheets("feuil1").Cells(i, 1), 3) = 238 Then 'compte 238
Sheets("feuil28").Cells(i, 47) = Sheets("feuil1").Cells(i, 7) 'colonne AU
Else
End If

'recup compte 2834
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2834 Then 'compte 2834
Sheets("feuil28").Cells(i, 48) = Sheets("feuil1").Cells(i, 8) 'colonne AV
Else
End If

'recup compte 2835
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2835 Then 'compte 2835
Sheets("feuil28").Cells(i, 49) = Sheets("feuil1").Cells(i, 8) 'colonne AW
Else
End If

'recup compte 2838
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2838 Then 'compte 2838
Sheets("feuil28").Cells(i, 50) = Sheets("feuil1").Cells(i, 8) 'colonne AX
Else
End If

'recup compte 2934
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2934 Then 'compte 2934
Sheets("feuil28").Cells(i, 51) = Sheets("feuil1").Cells(i, 8) 'colonne AY
Else
End If

'recup compte 2935
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2935 Then 'compte 2935
Sheets("feuil28").Cells(i, 52) = Sheets("feuil1").Cells(i, 8) 'colonne AZ
Else
End If

'recup compte 2938
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2938 Then 'compte 2938
Sheets("feuil28").Cells(i, 53) = Sheets("feuil1").Cells(i, 8) 'colonne BA
Else
End If

'recup compte 24
If Left(Sheets("feuil1").Cells(i, 1), 2) = 24 Then 'compte 24 sauf 249+245
If Left(Sheets("feuil1").Cells(i, 1), 3) = 249 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 3) = 245 Then
Else
Sheets("feuil28").Cells(i, 54) = Sheets("feuil1").Cells(i, 7) 'colonne BB
End If
End If
Else
End If

'recup compte 284
If Left(Sheets("feuil1").Cells(i, 1), 3) = 284 Then 'compte 284 sauf 2845
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2845 Then
Else
Sheets("feuil28").Cells(i, 55) = Sheets("feuil1").Cells(i, 8) 'colonne BC
End If
Else
End If

'recup compte 294
If Left(Sheets("feuil1").Cells(i, 1), 3) = 294 Then 'compte 294 sauf 2949+2945
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2949 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2945 Then
Else
Sheets("feuil28").Cells(i, 56) = Sheets("feuil1").Cells(i, 8) 'colonne BD
End If
End If
Else
End If

'recup compte 229
If Left(Sheets("feuil1").Cells(i, 1), 3) = 229 Then 'compte 229
Sheets("feuil28").Cells(i, 57) = Sheets("feuil1").Cells(i, 7) 'colonne BE
Else
End If

'recup compte 239
If Left(Sheets("feuil1").Cells(i, 1), 3) = 239 Then 'compte 239
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2394 Then 'compte 2394
Else
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2395 Then 'compte 2395
Else
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2398 Then 'compte 2398
Else
Sheets("feuil28").Cells(i, 58) = Sheets("feuil1").Cells(i, 7) 'colonne BF
End If
End If
End If
Else
End If

'recup compte 249
If Left(Sheets("feuil1").Cells(i, 1), 3) = 249 Then 'compte 249
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2495 Then 'compte 2495
Else
Sheets("feuil28").Cells(i, 59) = Sheets("feuil1").Cells(i, 7) 'colonne BG
End If
Else
End If

'recup compte 2929
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2929 Then 'compte 2929
Sheets("feuil28").Cells(i, 60) = Sheets("feuil1").Cells(i, 8) 'colonne BH
Else
End If

'recup compte 2939
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2939 Then 'compte 2939
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29394 Then 'compte 29394
Else
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29395 Then 'compte 29395
Else
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29398 Then 'compte 29398
Else
Sheets("feuil28").Cells(i, 61) = Sheets("feuil1").Cells(i, 8) 'colonne BI
End If
End If
End If
Else
End If

'recup compte 2949
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2949 Then 'compte 2949
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29495 Then 'compte 29495
Else
Sheets("feuil28").Cells(i, 62) = Sheets("feuil1").Cells(i, 8) 'colonne BJ
End If
Else
End If

'recup compte 25
If Left(Sheets("feuil1").Cells(i, 1), 2) = 25 Then 'compte 25
Sheets("feuil28").Cells(i, 63) = Sheets("feuil1").Cells(i, 7) 'colonne BK
Else
End If

'recup compte 295
If Left(Sheets("feuil1").Cells(i, 1), 3) = 295 Then 'compte 295
Sheets("feuil28").Cells(i, 64) = Sheets("feuil1").Cells(i, 8) 'colonne BL
Else
End If

'recup compte 26
If Left(Sheets("feuil1").Cells(i, 1), 2) = 26 Then 'compte 26
Sheets("feuil28").Cells(i, 65) = Sheets("feuil1").Cells(i, 7) 'colonne BM
Else
End If

'recup compte 296
If Left(Sheets("feuil1").Cells(i, 1), 3) = 296 Then 'compte 296
Sheets("feuil28").Cells(i, 66) = Sheets("feuil1").Cells(i, 8) 'colonne BN
Else
End If

'recup compte 27
If Left(Sheets("feuil1").Cells(i, 1), 2) = 27 Then 'compte 27
Sheets("feuil28").Cells(i, 67) = Sheets("feuil1").Cells(i, 7) 'colonne BO
Else
End If

'recup compte 297
If Left(Sheets("feuil1").Cells(i, 1), 3) = 297 Then 'compte 297
Sheets("feuil28").Cells(i, 68) = Sheets("feuil1").Cells(i, 8) 'colonne BP
Else
End If

'recup compte 3
If Left(Sheets("feuil1").Cells(i, 1), 1) = 3 Then 'compte 3
Sheets("feuil28").Cells(i, 69) = Sheets("feuil1").Cells(i, 7) 'colonne BQ
Else
End If

'recup compte 39
If Left(Sheets("feuil1").Cells(i, 1), 2) = 39 Then 'compte 39
Sheets("feuil28").Cells(i, 70) = Sheets("feuil1").Cells(i, 8) 'colonne BR
Else
End If




'ADAPTATION DES COMPTES AU SYSCOHADA
'recup compte 2394
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2394 Then
Sheets("feuil28").Cells(i, 276) = Sheets("feuil1").Cells(i, 7) 'colonne JP
Else
End If

'recup compte 2395
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2395 Then
Sheets("feuil28").Cells(i, 277) = Sheets("feuil1").Cells(i, 7) 'colonne JQ
Else
End If

'recup compte 2398
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2398 Then
Sheets("feuil28").Cells(i, 278) = Sheets("feuil1").Cells(i, 7) 'colonne JR
Else
End If

'recup compte 29394
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29394 Then
Sheets("feuil28").Cells(i, 279) = Sheets("feuil1").Cells(i, 8) 'colonne JS
Else
End If

'recup compte 29395
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29395 Then
Sheets("feuil28").Cells(i, 280) = Sheets("feuil1").Cells(i, 8) 'colonne JT
Else
End If

'recup compte 29398
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29398 Then
Sheets("feuil28").Cells(i, 281) = Sheets("feuil1").Cells(i, 8) 'colonne JU
Else
End If

'recup compte 245
If Left(Sheets("feuil1").Cells(i, 1), 3) = 245 Then
Sheets("feuil28").Cells(i, 282) = Sheets("feuil1").Cells(i, 7) 'colonne JV
Else
End If

'recup compte 2495
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2495 Then
Sheets("feuil28").Cells(i, 283) = Sheets("feuil1").Cells(i, 7) 'colonne JW
Else
End If

'recup compte 2845
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2845 Then
Sheets("feuil28").Cells(i, 284) = Sheets("feuil1").Cells(i, 8) 'colonne JX
Else
End If

'recup compte 2945
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2945 Then
Sheets("feuil28").Cells(i, 285) = Sheets("feuil1").Cells(i, 8) 'colonne JY
Else
End If

'recup compte 29495
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29495 Then
Sheets("feuil28").Cells(i, 286) = Sheets("feuil1").Cells(i, 8) 'colonne JZ
Else
End If



'recup compte 478
If Left(Sheets("feuil1").Cells(i, 1), 3) = 478 Then
Sheets("feuil28").Cells(i, 314) = Sheets("feuil1").Cells(i, 7) 'colonne LB
Else
End If


'ADAPTATION AU SYSCOHADA révisé (immeubles de placement)
'recup compte 2281
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2281 Then
Sheets("feuil28").Cells(i, 320) = Sheets("feuil1").Cells(i, 7) 'colonne LH
Else
End If

'recup compte 29281
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29281 Then
Sheets("feuil28").Cells(i, 321) = Sheets("feuil1").Cells(i, 8) 'colonne LI
Else
End If

'recup compte 2315+2325
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2315 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2325 Then
Sheets("feuil28").Cells(i, 322) = Sheets("feuil1").Cells(i, 7) 'colonne LJ
Else
End If

'recup compte 28315+28325+29315+29325
If Left(Sheets("feuil1").Cells(i, 1), 5) = 28315 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 28325 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 29315 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 29325 Then
Sheets("feuil28").Cells(i, 323) = Sheets("feuil1").Cells(i, 8) 'colonne LK
Else
End If


Next


'Affecte ACTIF DU BILAN
'affecte compte 211+2191+218 poste AE
Sheets("feuil28").Range("a5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("a1:a5000")) 'compte 211
Sheets("feuil28").Range("x5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("x1:x5000")) 'compte 2191
Sheets("feuil5").Range("e14") = Sheets("feuil28").Range("a5001") + Sheets("feuil28").Range("x5001")
'affecte compte 2811+28181+2911+29181+29191 poste AE
Sheets("feuil28").Range("b5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("b1:b5000")) 'compte 2811
Sheets("feuil28").Range("aa5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("aa1:aa5000")) 'compte 29191
Sheets("feuil5").Range("f14") = Sheets("feuil28").Range("b5001") + Sheets("feuil28").Range("aa5001")
'calcul
Sheets("feuil5").Range("g14") = Sheets("feuil5").Range("e14") - Sheets("feuil5").Range("f14")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("i16") = Sheets("feuil5").Range("e14")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("b16") = Sheets("feuil5").Range("e14")

'affecte comptes 212+213+214+2193 poste AF
Sheets("feuil28").Range("c5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("c1:c5000")) 'compte 212
Sheets("feuil28").Range("d5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("d1:d5000")) 'compte 213
Sheets("feuil28").Range("e5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("e1:e5000")) 'compte 214
Sheets("feuil28").Range("y5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("y1:y5000")) 'compte 2193
Sheets("feuil5").Range("e15") = Sheets("feuil28").Range("c5001") + Sheets("feuil28").Range("d5001") + Sheets("feuil28").Range("e5001") + Sheets("feuil28").Range("y5001")
'affecte comptes 2812+2813+2814 et 2912+2913+2914+29193 poste AF
Sheets("feuil28").Range("f5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("f1:f5000")) 'compte 2812
Sheets("feuil28").Range("g5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("g1:g5000")) 'compte 2813
Sheets("feuil28").Range("h5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("h1:h5000")) 'compte 2814
Sheets("feuil28").Range("i5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("i1:i5000")) 'compte 2912
Sheets("feuil28").Range("j5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("j1:j5000")) 'compte 2913
Sheets("feuil28").Range("k5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("k1:k5000")) 'compte 2914
Sheets("feuil28").Range("ab5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ab1:ab5000")) 'compte 29193
Sheets("feuil5").Range("f15") = Sheets("feuil28").Range("f5001") + Sheets("feuil28").Range("g5001") + Sheets("feuil28").Range("h5001") + Sheets("feuil28").Range("i5001") + Sheets("feuil28").Range("j5001") + Sheets("feuil28").Range("k5001") + Sheets("feuil28").Range("ab5001")
'calcul
Sheets("feuil5").Range("g15") = Sheets("feuil5").Range("e15") - Sheets("feuil5").Range("f15")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("i17") = Sheets("feuil5").Range("e15")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("b17") = Sheets("feuil5").Range("e15")

'affecte comptes 215+216 poste AG
Sheets("feuil28").Range("l5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("l1:l5000")) 'compte 215
Sheets("feuil28").Range("m5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("m1:m5000")) 'compte 216
Sheets("feuil5").Range("e16") = Sheets("feuil28").Range("l5001") + Sheets("feuil28").Range("m5001")
'affecte comptes 2815+2816 et 2915+2916 poste AG
Sheets("feuil28").Range("n5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("n1:n5000")) 'compte 2815
Sheets("feuil28").Range("o5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("o1:o5000")) 'compte 2816
Sheets("feuil28").Range("p5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("p1:p5000")) 'compte 2915
Sheets("feuil28").Range("q5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("q1:q5000")) 'compte 2916
Sheets("feuil5").Range("f16") = Sheets("feuil28").Range("n5001") + Sheets("feuil28").Range("o5001") + Sheets("feuil28").Range("p5001") + Sheets("feuil28").Range("q5001")
'calcul
Sheets("feuil5").Range("g16") = Sheets("feuil5").Range("e16") - Sheets("feuil5").Range("f16")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("i18") = Sheets("feuil5").Range("e16")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("b18") = Sheets("feuil5").Range("e16")

'affecte comptes 217+218+2198 poste AH
Sheets("feuil28").Range("r5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("r1:r5000")) 'compte 217
Sheets("feuil28").Range("s5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("s1:s5000")) 'compte 218
Sheets("feuil28").Range("z5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("z1:z5000")) 'compte 2198
Sheets("feuil5").Range("e17") = Sheets("feuil28").Range("r5001") + Sheets("feuil28").Range("s5001") + Sheets("feuil28").Range("z5001")
'affecte comptes 2817+2818 et 2917+2918 poste AH
Sheets("feuil28").Range("t5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("t1:t5000")) 'compte 2817
Sheets("feuil28").Range("u5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("u1:u5000")) 'compte 2818
Sheets("feuil28").Range("v5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("v1:v5000")) 'compte 2917
Sheets("feuil28").Range("w5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("w1:w5000")) 'compte 2918
Sheets("feuil28").Range("ac5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ac1:ac5000")) 'compte 29198
Sheets("feuil5").Range("f17") = Sheets("feuil28").Range("t5001") + Sheets("feuil28").Range("u5001") + Sheets("feuil28").Range("v5001") + Sheets("feuil28").Range("w5001") + Sheets("feuil28").Range("ac5001")
'calcul
Sheets("feuil5").Range("g17") = Sheets("feuil5").Range("e17") - Sheets("feuil5").Range("f17")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("i19") = Sheets("feuil5").Range("e17")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("b19") = Sheets("feuil5").Range("e17")

'affecte comptes 22+229 poste AK
Sheets("feuil28").Range("ad5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ad1:ad5000")) 'compte 22
Sheets("feuil28").Range("be5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("be1:be5000")) 'compte 229
Sheets("feuil5").Range("e19") = Sheets("feuil28").Range("ad5001") + Sheets("feuil28").Range("be5001")
'affecte comptes 282+292+2929 poste AK
Sheets("feuil28").Range("ae5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ae1:ae5000")) 'compte 282
Sheets("feuil28").Range("af5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("af1:af5000")) 'compte 292
Sheets("feuil28").Range("bh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bh1:bh5000")) 'compte 2929
Sheets("feuil5").Range("f19") = Sheets("feuil28").Range("ae5001") + Sheets("feuil28").Range("af5001") + Sheets("feuil28").Range("bh5001")
'calcul
Sheets("feuil5").Range("g19") = Sheets("feuil5").Range("e19") - Sheets("feuil5").Range("f19")
'adaptaion SYSCOHADA révisé (terrains - immeuble de placement)
'affecte bilan comptes 2281-29281 (placements en net)
Sheets("feuil28").Range("lh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lh1:lh5000")) 'compte 2281
Sheets("feuil28").Range("li5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("li1:li5000")) 'compte 29281
Sheets("feuil5").Range("c21") = Sheets("feuil28").Range("lh5001") - Sheets("feuil28").Range("li5001")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("i22") = Sheets("feuil28").Range("lh5001") 'terrains - immeuble de placement
Sheets("feuil24").Range("i21") = Sheets("feuil5").Range("e19") - Sheets("feuil28").Range("lh5001") 'terrains hors immeuble de placement
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("b22") = Sheets("feuil28").Range("lh5001") 'terrains - immeuble de placement
Sheets("feuil23").Range("b21") = Sheets("feuil5").Range("e19") - Sheets("feuil28").Range("lh5001") 'terrains hors immeuble de placement

'affecte comptes 231+232+233+237 et 239 sauf 2394+2395+2398 poste AL
Sheets("feuil28").Range("ag5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ag1:ag5000")) 'compte 231
Sheets("feuil28").Range("ah5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ah1:ah5000")) 'compte 232
Sheets("feuil28").Range("ai5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ai1:ai5000")) 'compte 233
Sheets("feuil28").Range("aj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("aj1:aj5000")) 'compte 237
Sheets("feuil28").Range("bf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bf1:bf5000")) 'compte 239
Sheets("feuil5").Range("e23") = Sheets("feuil28").Range("ag5001") + Sheets("feuil28").Range("ah5001") + Sheets("feuil28").Range("ai5001") + Sheets("feuil28").Range("aj5001") + Sheets("feuil28").Range("bf5001")
'affecte comptes 2831+2832+2833+2837 et 2931+2932+2933+2937 et 2939 sauf 29394+29395+29398 poste AL
Sheets("feuil28").Range("ak5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ak1:ak5000")) 'compte 2831
Sheets("feuil28").Range("al5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("al1:al5000")) 'compte 2832
Sheets("feuil28").Range("am5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("am1:am5000")) 'compte 2833
Sheets("feuil28").Range("an5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("an1:an5000")) 'compte 2837
Sheets("feuil28").Range("ao5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ao1:ao5000")) 'compte 2931
Sheets("feuil28").Range("ap5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ap1:ap5000")) 'compte 2932
Sheets("feuil28").Range("aq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("aq1:aq5000")) 'compte 2933
Sheets("feuil28").Range("ar5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ar1:ar5000")) 'compte 2937
Sheets("feuil28").Range("bi5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bi1:bi5000")) 'compte 2939
Sheets("feuil5").Range("f23") = Sheets("feuil28").Range("ak5001") + Sheets("feuil28").Range("al5001") + Sheets("feuil28").Range("am5001") + Sheets("feuil28").Range("an5001") + Sheets("feuil28").Range("ao5001") + Sheets("feuil28").Range("ap5001") + Sheets("feuil28").Range("aq5001") + Sheets("feuil28").Range("ar5001") + Sheets("feuil28").Range("bi5001")
'calcul
Sheets("feuil5").Range("g23") = Sheets("feuil5").Range("e23") - Sheets("feuil5").Range("f23")
'adaptaion SYSCOHADA révisé (bâtiments - immeuble de placement)
'affecte bilan comptes (2315+2325)-(28315+28325+29315+29325) (placements en net)
Sheets("feuil28").Range("lj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lj1:lj5000")) 'comptes 2315+2325
Sheets("feuil28").Range("lk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lk1:lk5000")) 'compte 28315+28325+29315+29325
Sheets("feuil5").Range("c25") = Sheets("feuil28").Range("lj5001") - Sheets("feuil28").Range("lk5001")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("i24") = Sheets("feuil28").Range("lj5001") 'bâtiments - immeuble de placement
Sheets("feuil24").Range("i23") = Sheets("feuil5").Range("e23") - Sheets("feuil28").Range("lj5001") 'bâtiments hors immeuble de placement
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("b24") = Sheets("feuil28").Range("lj5001") 'bâtiments - immeuble de placement
Sheets("feuil23").Range("b23") = Sheets("feuil5").Range("e23") - Sheets("feuil28").Range("lj5001") 'bâtiments hors immeuble de placement

'affecte comptes 234+235+238 et 2394+2395+2398 poste AM
Sheets("feuil28").Range("as5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("as1:as5000")) 'compte 234
Sheets("feuil28").Range("at5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("at1:at5000")) 'compte 235
Sheets("feuil28").Range("au5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("au1:au5000")) 'compte 238
Sheets("feuil28").Range("jp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jp1:jp5000")) 'compte 2934
Sheets("feuil28").Range("jq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jq1:jq5000")) 'compte 2935
Sheets("feuil28").Range("jr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jr1:jr5000")) 'compte 2938
Sheets("feuil5").Range("e27") = Sheets("feuil28").Range("as5001") + Sheets("feuil28").Range("at5001") + Sheets("feuil28").Range("au5001") + Sheets("feuil28").Range("jp5001") + Sheets("feuil28").Range("jq5001") + Sheets("feuil28").Range("jr5001")
'affecte comptes 2834+2835+2838 et 2934+2935+2938 et 29394+29395+29398 poste AM
Sheets("feuil28").Range("av5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("av1:av5000")) 'compte 2834
Sheets("feuil28").Range("aw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("aw1:aw5000")) 'compte 2835
Sheets("feuil28").Range("ax5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ax1:ax5000")) 'compte 2838
Sheets("feuil28").Range("ay5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ay1:ay5000")) 'compte 2934
Sheets("feuil28").Range("az5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("az1:az5000")) 'compte 2935
Sheets("feuil28").Range("ba5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ba1:ba5000")) 'compte 2938
Sheets("feuil28").Range("js5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("js1:js5000")) 'compte 29394
Sheets("feuil28").Range("jt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jt1:jt5000")) 'compte 29395
Sheets("feuil28").Range("ju5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ju1:ju5000")) 'compte 29398
Sheets("feuil5").Range("f27") = Sheets("feuil28").Range("av5001") + Sheets("feuil28").Range("aw5001") + Sheets("feuil28").Range("ax5001") + Sheets("feuil28").Range("ay5001") + Sheets("feuil28").Range("az5001") + Sheets("feuil28").Range("ba5001") + Sheets("feuil28").Range("js5001") + Sheets("feuil28").Range("jt5001") + Sheets("feuil28").Range("ju5001")
'calcul
Sheets("feuil5").Range("g27") = Sheets("feuil5").Range("e27") - Sheets("feuil5").Range("f27")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("i25") = Sheets("feuil5").Range("e27")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("b25") = Sheets("feuil5").Range("e27")

'affecte comptes 24 (sauf 245) + 249 (sauf 2495) poste AN
Sheets("feuil28").Range("bb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bb1:bb5000")) 'compte 24
Sheets("feuil28").Range("bg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bg1:bg5000")) 'compte 249
Sheets("feuil5").Range("e28") = Sheets("feuil28").Range("bb5001") + Sheets("feuil28").Range("bg5001")
'affecte comptes 284 et 294 (sauf 2945) + 2949 (sauf 29495) poste AN
Sheets("feuil28").Range("bc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bc1:bc5000")) 'compte 284
Sheets("feuil28").Range("bd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bd1:bd5000")) 'compte 294
Sheets("feuil28").Range("bj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bj1:bj5000")) 'compte 2949
Sheets("feuil5").Range("f28") = Sheets("feuil28").Range("bc5001") + Sheets("feuil28").Range("bd5001") + Sheets("feuil28").Range("bj5001")
'calcul
Sheets("feuil5").Range("g28") = Sheets("feuil5").Range("e28") - Sheets("feuil5").Range("f28")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("i26") = Sheets("feuil5").Range("e28")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("b26") = Sheets("feuil5").Range("e28")

'affecte comptes 245 + 2495 poste AN
Sheets("feuil28").Range("jv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jv1:jv5000")) 'compte 245
Sheets("feuil28").Range("jw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jw1:jw5000")) 'compte 2495
Sheets("feuil5").Range("e29") = Sheets("feuil28").Range("jv5001") + Sheets("feuil28").Range("jw5001")
'affecte comptes 2845 et 2945+29495 poste AN
Sheets("feuil28").Range("jx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jx1:jx5000")) 'compte 2845
Sheets("feuil28").Range("jy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jy1:jy5000")) 'compte 2945
Sheets("feuil28").Range("jz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jz1:jz5000")) 'compte 29495
Sheets("feuil5").Range("f29") = Sheets("feuil28").Range("jx5001") + Sheets("feuil28").Range("jy5001") + Sheets("feuil28").Range("jz5001")
'calcul
Sheets("feuil5").Range("g29") = Sheets("feuil5").Range("e29") - Sheets("feuil5").Range("f29")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("i27") = Sheets("feuil5").Range("e29")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("b27") = Sheets("feuil5").Range("e29")

'affecte comptes 25 poste AQ
Sheets("feuil28").Range("bk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bk1:bk5000")) 'compte 25
Sheets("feuil5").Range("e30") = Sheets("feuil28").Range("bk5001")
'affecte comptes 295 poste AQ
Sheets("feuil28").Range("bl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bl1:bl5000")) 'compte 295
Sheets("feuil5").Range("f30") = Sheets("feuil28").Range("bl5001")
'calcul
Sheets("feuil5").Range("g30") = Sheets("feuil5").Range("e30") - Sheets("feuil5").Range("f30")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("i29") = Sheets("feuil5").Range("e30")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("b29") = Sheets("feuil5").Range("e30")

'affecte comptes 26 poste AS
Sheets("feuil28").Range("bm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bm1:bm5000")) 'compte 26
Sheets("feuil5").Range("e32") = Sheets("feuil28").Range("bm5001")
'affecte comptes 296 poste AS
Sheets("feuil28").Range("bn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bn1:bn5000")) 'compte 296
Sheets("feuil5").Range("f32") = Sheets("feuil28").Range("bn5001")
'calcul
Sheets("feuil5").Range("g32") = Sheets("feuil5").Range("e32") - Sheets("feuil5").Range("f32")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("i33") = Sheets("feuil5").Range("e32")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("b33") = Sheets("feuil5").Range("e32")

'affecte comptes 27 poste AT
Sheets("feuil28").Range("bo5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bo1:bo5000")) 'compte 27
Sheets("feuil5").Range("e33") = Sheets("feuil28").Range("bo5001")
'affecte comptes 297 poste AT
Sheets("feuil28").Range("bp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bp1:bp5000")) 'compte 297
Sheets("feuil5").Range("f33") = Sheets("feuil28").Range("bp5001")
'calcul
Sheets("feuil5").Range("g33") = Sheets("feuil5").Range("e33") - Sheets("feuil5").Range("f33")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("i34") = Sheets("feuil5").Range("e33")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil23").Range("b34") = Sheets("feuil5").Range("e33")

'affecte comptes 3 poste BB
Sheets("feuil28").Range("bq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bq1:bq5000")) 'compte 3
Sheets("feuil5").Range("e36") = Sheets("feuil28").Range("bq5001")
Sheets("feuil5").Range("ah36") = Sheets("feuil28").Range("bq5001") 'pour note annexe
'affecte comptes 39 poste BB
Sheets("feuil28").Range("br5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("br1:br5000")) 'compte 39
Sheets("feuil5").Range("f36") = Sheets("feuil28").Range("br5001")
'calcul
Sheets("feuil5").Range("g36") = Sheets("feuil5").Range("e36") - Sheets("feuil5").Range("f36")


edite_bilan_n_1_suite

'demande de confirmation
End If

'condition d'édition du bilan N-1
End If
End If

'condition d'installation
'Else
'MsgBox "Désolé  !  Veuillez d'abord installer votre logiciel."
'End If

'délai d'essai
End If

'mise en forme conditionnelle
Sheets("feuil28").Range("zb11").ClearContents
End Sub
Private Sub edite_bilan_n_1_suite()

For i = 3 To 5000
'recup compte 409
If Left(Sheets("feuil1").Cells(i, 1), 3) = 409 Then 'compte 409
Sheets("feuil28").Cells(i, 71) = Sheets("feuil1").Cells(i, 7) 'colonne BS
Else
End If

'recup compte 490
If Left(Sheets("feuil1").Cells(i, 1), 3) = 490 Then 'compte 490
Sheets("feuil28").Cells(i, 72) = Sheets("feuil1").Cells(i, 8) 'colonne BT
Else
End If

'recup compte 41
If Left(Sheets("feuil1").Cells(i, 1), 2) = 41 Then 'compte 41 sauf 419
If Left(Sheets("feuil1").Cells(i, 1), 3) = 419 Then
Else
Sheets("feuil28").Cells(i, 73) = Sheets("feuil1").Cells(i, 7) 'colonne BU
End If
Else
End If

'recup compte 491
If Left(Sheets("feuil1").Cells(i, 1), 3) = 491 Then 'compte 491
Sheets("feuil28").Cells(i, 74) = Sheets("feuil1").Cells(i, 8) 'colonne BV
Else
End If

'recup compte 42
If Left(Sheets("feuil1").Cells(i, 1), 2) = 42 Then 'compte 42
Sheets("feuil28").Cells(i, 75) = Sheets("feuil1").Cells(i, 7) 'colonne BW
Else
End If

'recup compte 43
If Left(Sheets("feuil1").Cells(i, 1), 2) = 43 Then 'compte 43
Sheets("feuil28").Cells(i, 76) = Sheets("feuil1").Cells(i, 7) 'colonne BX
Else
End If

'recup compte 44
If Left(Sheets("feuil1").Cells(i, 1), 2) = 44 Then 'compte 44
Sheets("feuil28").Cells(i, 77) = Sheets("feuil1").Cells(i, 7) 'colonne BY
Else
End If

'recup compte 45
If Left(Sheets("feuil1").Cells(i, 1), 2) = 45 Then 'compte 45
Sheets("feuil28").Cells(i, 78) = Sheets("feuil1").Cells(i, 7) 'colonne BZ
Else
End If

'recup compte 46
If Left(Sheets("feuil1").Cells(i, 1), 2) = 46 Then 'compte 46
Sheets("feuil28").Cells(i, 79) = Sheets("feuil1").Cells(i, 7) 'colonne CA
Else
End If

'recup compte 47
If Left(Sheets("feuil1").Cells(i, 1), 2) = 47 Then 'compte 47
If Left(Sheets("feuil1").Cells(i, 1), 3) = 479 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 3) = 478 Then
Else
Sheets("feuil28").Cells(i, 80) = Sheets("feuil1").Cells(i, 7) 'colonne CB
End If
End If
Else
End If

'recup compte 48
If Left(Sheets("feuil1").Cells(i, 1), 2) = 48 Then 'compte 48
Sheets("feuil28").Cells(i, 81) = Sheets("feuil1").Cells(i, 7) 'colonne CC
Else
End If

'recup compte 492
If Left(Sheets("feuil1").Cells(i, 1), 3) = 492 Then 'compte 492
Sheets("feuil28").Cells(i, 82) = Sheets("feuil1").Cells(i, 8) 'colonne CD
Else
End If

'recup compte 493
If Left(Sheets("feuil1").Cells(i, 1), 3) = 493 Then 'compte 493
Sheets("feuil28").Cells(i, 83) = Sheets("feuil1").Cells(i, 8) 'colonne CE
Else
End If

'recup compte 494
If Left(Sheets("feuil1").Cells(i, 1), 3) = 494 Then 'compte 494
Sheets("feuil28").Cells(i, 84) = Sheets("feuil1").Cells(i, 8) 'colonne CF
Else
End If

'recup compte 495
If Left(Sheets("feuil1").Cells(i, 1), 3) = 495 Then 'compte 495
Sheets("feuil28").Cells(i, 85) = Sheets("feuil1").Cells(i, 8) 'colonne CG
Else
End If

'recup compte 496
If Left(Sheets("feuil1").Cells(i, 1), 3) = 496 Then 'compte 496
Sheets("feuil28").Cells(i, 86) = Sheets("feuil1").Cells(i, 8) 'colonne CH
Else
End If

'adaptation SYSCOHADA révisé recup compte 497 +  4986
If Left(Sheets("feuil1").Cells(i, 1), 3) = 497 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4986 Then 'compte 497
Sheets("feuil28").Cells(i, 87) = Sheets("feuil1").Cells(i, 8) 'colonne CI
Else
End If

'adaptation SYSCOHADA révisé recup compte 498 sauf 4986
If Left(Sheets("feuil1").Cells(i, 1), 3) = 498 Then 'compte 498
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4986 Then
Else
Sheets("feuil28").Cells(i, 88) = Sheets("feuil1").Cells(i, 8) 'colonne CJ
End If
Else
End If

'recup compte 50
If Left(Sheets("feuil1").Cells(i, 1), 2) = 50 Then 'compte 50
Sheets("feuil28").Cells(i, 89) = Sheets("feuil1").Cells(i, 7) 'colonne CK
Else
End If

'recup compte 590
If Left(Sheets("feuil1").Cells(i, 1), 3) = 590 Then 'compte 590
Sheets("feuil28").Cells(i, 90) = Sheets("feuil1").Cells(i, 8) 'colonne CL
Else
End If

'recup compte 51
If Left(Sheets("feuil1").Cells(i, 1), 2) = 51 Then 'compte 51
Sheets("feuil28").Cells(i, 91) = Sheets("feuil1").Cells(i, 7) 'colonne CM
Else
End If

'recup compte 52
If Left(Sheets("feuil1").Cells(i, 1), 2) = 52 Then 'compte 52
Sheets("feuil28").Cells(i, 92) = Sheets("feuil1").Cells(i, 7) 'colonne CN
Else
End If

'recup compte 53
If Left(Sheets("feuil1").Cells(i, 1), 2) = 53 Then 'compte 53
Sheets("feuil28").Cells(i, 93) = Sheets("feuil1").Cells(i, 7) 'colonne CO
Else
End If

'recup compte 54
If Left(Sheets("feuil1").Cells(i, 1), 2) = 54 Then 'compte 54
Sheets("feuil28").Cells(i, 94) = Sheets("feuil1").Cells(i, 7) 'colonne CP
Else
End If

'recup compte 57+55
If Left(Sheets("feuil1").Cells(i, 1), 2) = 57 Or Left(Sheets("feuil1").Cells(i, 1), 2) = 55 Then 'compte 57+55
Sheets("feuil28").Cells(i, 95) = Sheets("feuil1").Cells(i, 7) 'colonne CQ
Else
End If

'recup compte 581
If Left(Sheets("feuil1").Cells(i, 1), 3) = 581 Then 'compte 581
Sheets("feuil28").Cells(i, 96) = Sheets("feuil1").Cells(i, 7) 'colonne CR
Else
End If

'recup compte 582
If Left(Sheets("feuil1").Cells(i, 1), 3) = 582 Then 'compte 582
Sheets("feuil28").Cells(i, 97) = Sheets("feuil1").Cells(i, 7) 'colonne CS
Else
End If

'recup compte 591
If Left(Sheets("feuil1").Cells(i, 1), 3) = 591 Then 'compte 591
Sheets("feuil28").Cells(i, 98) = Sheets("feuil1").Cells(i, 8) 'colonne CT
Else
End If

'recup compte 592
If Left(Sheets("feuil1").Cells(i, 1), 3) = 592 Then 'compte 592
Sheets("feuil28").Cells(i, 99) = Sheets("feuil1").Cells(i, 8) 'colonne CU
Else
End If

'recup compte 593
If Left(Sheets("feuil1").Cells(i, 1), 3) = 593 Then 'compte 593
Sheets("feuil28").Cells(i, 100) = Sheets("feuil1").Cells(i, 8) 'colonne CV
Else
End If

'recup compte 594
If Left(Sheets("feuil1").Cells(i, 1), 3) = 594 Then 'compte 594
Sheets("feuil28").Cells(i, 101) = Sheets("feuil1").Cells(i, 8) 'colonne CW
Else
End If


'recup PASSIF BILAN
'recup compte 101
If Left(Sheets("feuil1").Cells(i, 1), 3) = 101 Then 'compte 101
Sheets("feuil28").Cells(i, 102) = Sheets("feuil1").Cells(i, 8) 'colonne CX
Else
End If

'recup compte 102
If Left(Sheets("feuil1").Cells(i, 1), 3) = 102 Then 'compte 102
Sheets("feuil28").Cells(i, 103) = Sheets("feuil1").Cells(i, 8) 'colonne CY
Else
End If

'recup compte 103
If Left(Sheets("feuil1").Cells(i, 1), 3) = 103 Then 'compte 103
Sheets("feuil28").Cells(i, 104) = Sheets("feuil1").Cells(i, 8) 'colonne CZ
Else
End If

'recup compte 104c
If Left(Sheets("feuil1").Cells(i, 1), 3) = 104 Then 'compte 104c
Sheets("feuil28").Cells(i, 105) = Sheets("feuil1").Cells(i, 8) 'colonne DA
Else
End If

'recup compte 104d
If Left(Sheets("feuil1").Cells(i, 1), 3) = 104 Then 'compte 104d
Sheets("feuil28").Cells(i, 106) = Sheets("feuil1").Cells(i, 7) 'colonne DB
Else
End If

'recup compte 109
If Left(Sheets("feuil1").Cells(i, 1), 3) = 109 Then 'compte 109
Sheets("feuil28").Cells(i, 107) = Sheets("feuil1").Cells(i, 7) 'colonne DC
Else
End If

'recup compte 105
If Left(Sheets("feuil1").Cells(i, 1), 3) = 105 Then 'compte 105
Sheets("feuil28").Cells(i, 108) = Sheets("feuil1").Cells(i, 8) 'colonne DD
Else
End If

'recup compte 106
If Left(Sheets("feuil1").Cells(i, 1), 3) = 106 Then 'compte 106
Sheets("feuil28").Cells(i, 109) = Sheets("feuil1").Cells(i, 8) 'colonne DE
Else
End If

'recup compte 111
If Left(Sheets("feuil1").Cells(i, 1), 3) = 111 Then 'compte 111
Sheets("feuil28").Cells(i, 110) = Sheets("feuil1").Cells(i, 8) 'colonne DF
Else
End If

'recup compte 112
If Left(Sheets("feuil1").Cells(i, 1), 3) = 112 Then 'compte 112
Sheets("feuil28").Cells(i, 111) = Sheets("feuil1").Cells(i, 8) 'colonne DG
Else
End If

'recup compte 113
If Left(Sheets("feuil1").Cells(i, 1), 3) = 113 Then 'compte 113
Sheets("feuil28").Cells(i, 112) = Sheets("feuil1").Cells(i, 8) 'colonne DH
Else
End If

'recup compte 118
If Left(Sheets("feuil1").Cells(i, 1), 3) = 118 Then 'compte 118
Sheets("feuil28").Cells(i, 113) = Sheets("feuil1").Cells(i, 8) 'colonne DI
Else
End If

'recup compte 121
If Left(Sheets("feuil1").Cells(i, 1), 3) = 121 Then 'compte 121
Sheets("feuil28").Cells(i, 114) = Sheets("feuil1").Cells(i, 8) 'colonne DJ
Else
End If

'recup compte 129
If Left(Sheets("feuil1").Cells(i, 1), 3) = 129 Then 'compte 129
Sheets("feuil28").Cells(i, 115) = Sheets("feuil1").Cells(i, 7) 'colonne DK
Else
End If


'recup compte 15
If Left(Sheets("feuil1").Cells(i, 1), 2) = 15 Then 'compte 15
Sheets("feuil28").Cells(i, 120) = Sheets("feuil1").Cells(i, 8) 'colonne DP
Else
End If

'recup compte 14
If Left(Sheets("feuil1").Cells(i, 1), 2) = 14 Then 'compte 14
Sheets("feuil28").Cells(i, 121) = Sheets("feuil1").Cells(i, 8) 'colonne DQ
Else
End If

'recup compte 16
If Left(Sheets("feuil1").Cells(i, 1), 2) = 16 Then 'compte 16
Sheets("feuil28").Cells(i, 122) = Sheets("feuil1").Cells(i, 8) 'colonne DR
Else
End If

'recup compte 18
If Left(Sheets("feuil1").Cells(i, 1), 2) = 18 Then 'compte 18
Sheets("feuil28").Cells(i, 123) = Sheets("feuil1").Cells(i, 8) 'colonne DS
Else
End If

'recup compte 17
If Left(Sheets("feuil1").Cells(i, 1), 2) = 17 Then 'compte 17
Sheets("feuil28").Cells(i, 124) = Sheets("feuil1").Cells(i, 8) 'colonne DT
Else
End If

'recup compte 19
If Left(Sheets("feuil1").Cells(i, 1), 2) = 19 Then 'compte 19
Sheets("feuil28").Cells(i, 125) = Sheets("feuil1").Cells(i, 8) 'colonne DU
Else
End If

'recup compte 419
If Left(Sheets("feuil1").Cells(i, 1), 3) = 419 Then 'compte 419
Sheets("feuil28").Cells(i, 126) = Sheets("feuil1").Cells(i, 8) 'colonne DV
Else
End If

'recup compte 401
If Left(Sheets("feuil1").Cells(i, 1), 3) = 401 Then 'compte 401
Sheets("feuil28").Cells(i, 127) = Sheets("feuil1").Cells(i, 8) 'colonne DW
Else
End If

'recup compte 402
If Left(Sheets("feuil1").Cells(i, 1), 3) = 402 Then 'compte 402
Sheets("feuil28").Cells(i, 128) = Sheets("feuil1").Cells(i, 8) 'colonne DX
Else
End If

'recup compte 408+404
If Left(Sheets("feuil1").Cells(i, 1), 3) = 408 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 404 Then 'compte 408
Sheets("feuil28").Cells(i, 129) = Sheets("feuil1").Cells(i, 8) 'colonne DY
Else
End If

'recup compte 42
If Left(Sheets("feuil1").Cells(i, 1), 2) = 42 Then 'compte 42
Sheets("feuil28").Cells(i, 130) = Sheets("feuil1").Cells(i, 8) 'colonne DZ
Else
End If

'recup compte 43
If Left(Sheets("feuil1").Cells(i, 1), 2) = 43 Then 'compte 43
Sheets("feuil28").Cells(i, 131) = Sheets("feuil1").Cells(i, 8) 'colonne EA
Else
End If

'recup compte 44
If Left(Sheets("feuil1").Cells(i, 1), 2) = 44 Then 'compte 44
Sheets("feuil28").Cells(i, 132) = Sheets("feuil1").Cells(i, 8) 'colonne EB
Else
End If

'recup compte 45
If Left(Sheets("feuil1").Cells(i, 1), 2) = 45 Then 'compte 45
Sheets("feuil28").Cells(i, 133) = Sheets("feuil1").Cells(i, 8) 'colonne EC
Else
End If

'recup compte 46
If Left(Sheets("feuil1").Cells(i, 1), 2) = 46 Then 'compte 46
Sheets("feuil28").Cells(i, 134) = Sheets("feuil1").Cells(i, 8) 'colonne ED
Else
End If

'recup compte 47
If Left(Sheets("feuil1").Cells(i, 1), 2) = 47 Then 'compte 47
If Left(Sheets("feuil1").Cells(i, 1), 3) = 479 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 3) = 478 Then
Else
Sheets("feuil28").Cells(i, 135) = Sheets("feuil1").Cells(i, 8) 'colonne EE
End If
End If
Else
End If

'recup compte 48
If Left(Sheets("feuil1").Cells(i, 1), 2) = 48 Then 'compte 48
Sheets("feuil28").Cells(i, 136) = Sheets("feuil1").Cells(i, 8) 'colonne EF
Else
End If

'recup compte 499
If Left(Sheets("feuil1").Cells(i, 1), 3) = 499 Then 'compte 499
Sheets("feuil28").Cells(i, 137) = Sheets("feuil1").Cells(i, 8) 'colonne EG
Else
End If

'recup compte 599
If Left(Sheets("feuil1").Cells(i, 1), 3) = 599 Then 'compte 599
Sheets("feuil28").Cells(i, 138) = Sheets("feuil1").Cells(i, 8) 'colonne EH
Else
End If

'recup compte 564
If Left(Sheets("feuil1").Cells(i, 1), 3) = 564 Then 'compte 564
Sheets("feuil28").Cells(i, 139) = Sheets("feuil1").Cells(i, 8) 'colonne EI
Else
End If

'recup compte 565
If Left(Sheets("feuil1").Cells(i, 1), 3) = 565 Then 'compte 565
Sheets("feuil28").Cells(i, 140) = Sheets("feuil1").Cells(i, 8) 'colonne EJ
Else
End If

'recup compte 52c
If Left(Sheets("feuil1").Cells(i, 1), 2) = 52 Then 'compte 52
Sheets("feuil28").Cells(i, 141) = Sheets("feuil1").Cells(i, 8) 'colonne EK
Else
End If

'recup compte 561
If Left(Sheets("feuil1").Cells(i, 1), 3) = 561 Then 'compte 561
Sheets("feuil28").Cells(i, 142) = Sheets("feuil1").Cells(i, 8) 'colonne EL
Else
End If

'recup compte 566
If Left(Sheets("feuil1").Cells(i, 1), 3) = 566 Then 'compte 566
Sheets("feuil28").Cells(i, 143) = Sheets("feuil1").Cells(i, 8) 'colonne EM
Else
End If

'RATTRAPAGE DES COMPTES 53c et 54c
'recup compte 53c
If Left(Sheets("feuil1").Cells(i, 1), 2) = 53 Then
Sheets("feuil28").Cells(i, 274) = Sheets("feuil1").Cells(i, 8) 'colonne JN
Else
End If
'recup compte 54c
If Left(Sheets("feuil1").Cells(i, 1), 2) = 54 Then
Sheets("feuil28").Cells(i, 275) = Sheets("feuil1").Cells(i, 8) 'colonne JO
Else
End If

'recup compte 479
If Left(Sheets("feuil1").Cells(i, 1), 3) = 479 Then
Sheets("feuil28").Cells(i, 315) = Sheets("feuil1").Cells(i, 8) 'colonne LC
Else
End If



Next


'adaptation syscohada compte 48 H.A.O
Sheets("feuil28").Range("cc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cc1:cc5000")) 'compte 48
Sheets("feuil5").Range("e35") = Sheets("feuil28").Range("cc5001")
Sheets("feuil5").Range("ah35") = Sheets("feuil28").Range("cc5001") 'pour note annexe
'adaptation syscohada compte 498 H.A.O
Sheets("feuil28").Range("cj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cj1:cj5000")) 'compte 498
Sheets("feuil5").Range("f35") = Sheets("feuil28").Range("cj5001")
'calcul
Sheets("feuil5").Range("g35") = Sheets("feuil5").Range("e35") - Sheets("feuil5").Range("f35")

'affecte comptes 409 poste BH
Sheets("feuil28").Range("bs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bs1:bs5000")) 'compte 409
Sheets("feuil5").Range("e38") = Sheets("feuil28").Range("bs5001")
Sheets("feuil5").Range("ah38") = Sheets("feuil28").Range("bs5001") 'pour note annexe
'affecte comptes 490 poste BH
Sheets("feuil28").Range("bt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bt1:bt5000")) 'compte 490
Sheets("feuil5").Range("f38") = Sheets("feuil28").Range("bt5001")
'calcul
Sheets("feuil5").Range("g38") = Sheets("feuil5").Range("e38") - Sheets("feuil5").Range("f38")

'affecte comptes 41 poste BI
Sheets("feuil28").Range("bu5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bu1:bu5000")) 'compte 41
Sheets("feuil5").Range("e39") = Sheets("feuil28").Range("bu5001")
Sheets("feuil5").Range("ah39") = Sheets("feuil28").Range("bu5001") 'pour note annexe
'affecte comptes 491 poste BI
Sheets("feuil28").Range("bv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bv1:bv5000")) 'compte 491
Sheets("feuil5").Range("f39") = Sheets("feuil28").Range("bv5001")
'calcul
Sheets("feuil5").Range("g39") = Sheets("feuil5").Range("e39") - Sheets("feuil5").Range("f39")

'affecte comptes 42+43+44+45+46+47 sauf 48 poste BJ
Sheets("feuil28").Range("bw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bw1:bw5000")) 'compte 42
Sheets("feuil28").Range("bx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bx1:bx5000")) 'compte 43
Sheets("feuil28").Range("by5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("by1:by5000")) 'compte 44
Sheets("feuil28").Range("bz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bz1:bz5000")) 'compte 45
Sheets("feuil28").Range("ca5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ca1:ca5000")) 'compte 46
Sheets("feuil28").Range("cb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cb1:cb5000")) 'compte 47
'Sheets("feuil28").Range("cc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cc1:cc5000")) 'compte 48
Sheets("feuil5").Range("e40") = Sheets("feuil28").Range("bw5001") + Sheets("feuil28").Range("bx5001") + Sheets("feuil28").Range("by5001") + Sheets("feuil28").Range("bz5001") + Sheets("feuil28").Range("ca5001") + Sheets("feuil28").Range("cb5001") '+ Sheets("feuil28").Range("cc5001")
Sheets("feuil5").Range("ah40") = Sheets("feuil28").Range("bw5001") + Sheets("feuil28").Range("bx5001") + Sheets("feuil28").Range("by5001") + Sheets("feuil28").Range("bz5001") + Sheets("feuil28").Range("ca5001") + Sheets("feuil28").Range("cb5001") '+ Sheets("feuil28").Range("cc5001")'pour note annexe
'affecte comptes 492+493+494+495+496+497 sauf 498 poste BJ
Sheets("feuil28").Range("cd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cd1:cd5000")) 'compte 492
Sheets("feuil28").Range("ce5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ce1:ce5000")) 'compte 493
Sheets("feuil28").Range("cf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cf1:cf5000")) 'compte 494
Sheets("feuil28").Range("cg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cg1:cg5000")) 'compte 495
Sheets("feuil28").Range("ch5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ch1:ch5000")) 'compte 496
Sheets("feuil28").Range("ci5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ci1:ci5000")) 'compte 497
'Sheets("feuil28").Range("cj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cj1:cj5000")) 'compte 498
Sheets("feuil5").Range("f40") = Sheets("feuil28").Range("cd5001") + Sheets("feuil28").Range("ce5001") + Sheets("feuil28").Range("cf5001") + Sheets("feuil28").Range("cg5001") + Sheets("feuil28").Range("ch5001") + Sheets("feuil28").Range("ci5001") '+ Sheets("feuil28").Range("cj5001")
'calcul
Sheets("feuil5").Range("g40") = Sheets("feuil5").Range("e40") - Sheets("feuil5").Range("f40")

'adaptation syscohada compte 478 ECA
Sheets("feuil28").Range("lb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lb1:lb5000")) 'compte 478
Sheets("feuil5").Range("e46") = Sheets("feuil28").Range("lb5001")
Sheets("feuil5").Range("ah46") = Sheets("feuil28").Range("lb5001") 'pour note annexe
'calcul
Sheets("feuil5").Range("g46") = Sheets("feuil5").Range("e46") - Sheets("feuil5").Range("f46")


'affecte comptes 50 poste BQ
Sheets("feuil28").Range("ck5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ck1:ck5000")) 'compte 50
Sheets("feuil5").Range("e42") = Sheets("feuil28").Range("ck5001")
Sheets("feuil5").Range("ah42") = Sheets("feuil28").Range("ck5001") 'pour note annexe
'affecte comptes 590 poste BQ
Sheets("feuil28").Range("cl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cl1:cl5000")) 'compte 590
Sheets("feuil5").Range("f42") = Sheets("feuil28").Range("cl5001")
'calcul
Sheets("feuil5").Range("g42") = Sheets("feuil5").Range("e42") - Sheets("feuil5").Range("f42")

'adaptation syscohada compte 51 poste BS
Sheets("feuil28").Range("cm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cm1:cm5000")) 'compte 51
Sheets("feuil5").Range("e43") = Sheets("feuil28").Range("cm5001")
Sheets("feuil5").Range("ah43") = Sheets("feuil28").Range("cm5001") 'pour note annexe
'adaptation syscohada compte 591 poste BS
Sheets("feuil28").Range("ct5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ct1:ct5000")) 'compte 591
Sheets("feuil5").Range("f43") = Sheets("feuil28").Range("ct5001")
'calcul
Sheets("feuil5").Range("g43") = Sheets("feuil5").Range("e43") - Sheets("feuil5").Range("f43")

'affecte comptes 52+53+54+57+581+582 poste BS
'Sheets("feuil28").Range("cm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cm1:cm5000")) 'compte 51
Sheets("feuil28").Range("cn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cn1:cn5000")) 'compte 52
Sheets("feuil28").Range("co5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("co1:co5000")) 'compte 53
Sheets("feuil28").Range("cp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cp1:cp5000")) 'compte 54
Sheets("feuil28").Range("cq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cq1:cq5000")) 'compte 57
Sheets("feuil28").Range("cr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cr1:cr5000")) 'compte 581
Sheets("feuil28").Range("cs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cs1:cs5000")) 'compte 582
Sheets("feuil5").Range("e44") = Sheets("feuil28").Range("cn5001") + Sheets("feuil28").Range("co5001") + Sheets("feuil28").Range("cp5001") + Sheets("feuil28").Range("cq5001") + Sheets("feuil28").Range("cr5001") + Sheets("feuil28").Range("cs5001")
Sheets("feuil5").Range("ah44") = Sheets("feuil28").Range("cn5001") + Sheets("feuil28").Range("co5001") + Sheets("feuil28").Range("cp5001") + Sheets("feuil28").Range("cq5001") + Sheets("feuil28").Range("cr5001") + Sheets("feuil28").Range("cs5001") 'pour note annexe
'affecte comptes 592+593+594 poste BS
'Sheets("feuil28").Range("ct5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ct1:ct5000")) 'compte 591
Sheets("feuil28").Range("cu5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cu1:cu5000")) 'compte 592
Sheets("feuil28").Range("cv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cv1:cv5000")) 'compte 593
Sheets("feuil28").Range("cw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cw1:cw5000")) 'compte 594
Sheets("feuil5").Range("f44") = Sheets("feuil28").Range("cu5001") + Sheets("feuil28").Range("cv5001") + Sheets("feuil28").Range("cw5001")
'calcul
Sheets("feuil5").Range("g44") = Sheets("feuil5").Range("e44") - Sheets("feuil5").Range("f44")

'_______________________________________________________________________________________________

'calcul TOTAUX DE L'ACTIF
'total actif immobilisé
Sheets("feuil5").Range("e34") = WorksheetFunction.Sum(Sheets("feuil5").Range("e14:e33")) 'montants bruts
Sheets("feuil5").Range("f34") = WorksheetFunction.Sum(Sheets("feuil5").Range("f14:f33")) 'Amorts et provisions
Sheets("feuil5").Range("g34") = WorksheetFunction.Sum(Sheets("feuil5").Range("g14:g33")) 'montants nets

'total actif circulant
Sheets("feuil5").Range("e41") = WorksheetFunction.Sum(Sheets("feuil5").Range("e35:e40")) 'montants bruts
Sheets("feuil5").Range("f41") = WorksheetFunction.Sum(Sheets("feuil5").Range("f35:f40")) 'Amorts et provisions
Sheets("feuil5").Range("g41") = WorksheetFunction.Sum(Sheets("feuil5").Range("g35:g40")) 'montants nets

'total trésorerie actif
Sheets("feuil5").Range("e45") = WorksheetFunction.Sum(Sheets("feuil5").Range("e42:e44")) 'montants bruts
Sheets("feuil5").Range("f45") = WorksheetFunction.Sum(Sheets("feuil5").Range("f42:f44")) 'Amorts et provisions
Sheets("feuil5").Range("g45") = WorksheetFunction.Sum(Sheets("feuil5").Range("g42:g44")) 'montants nets

'total général actif
Sheets("feuil5").Range("e47") = Sheets("feuil5").Range("e34") + Sheets("feuil5").Range("e41") + Sheets("feuil5").Range("e45") + Sheets("feuil5").Range("e46") 'montants bruts
Sheets("feuil5").Range("f47") = Sheets("feuil5").Range("f34") + Sheets("feuil5").Range("f41") + Sheets("feuil5").Range("f45") + Sheets("feuil5").Range("f46") 'Amorts et provisions
Sheets("feuil5").Range("g47") = Sheets("feuil5").Range("g34") + Sheets("feuil5").Range("g41") + Sheets("feuil5").Range("g45") + Sheets("feuil5").Range("g46") 'montants nets

'________________________________________________________________________________________

'affecte PASSIF BILAN
'affecte comptes 101+102+103+104(c/d) poste CA
Sheets("feuil28").Range("cx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cx1:cx5000")) 'compte 101
Sheets("feuil28").Range("cy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cy1:cy5000")) 'compte 102
Sheets("feuil28").Range("cz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cz1:cz5000")) 'compte 103
Sheets("feuil28").Range("da5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("da1:da5000")) 'compte 104c
Sheets("feuil28").Range("db5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("db1:db5000")) 'compte 104d
Sheets("feuil5").Range("m13") = Sheets("feuil28").Range("cx5001") + Sheets("feuil28").Range("cy5001") + Sheets("feuil28").Range("cz5001") + Sheets("feuil28").Range("da5001") - Sheets("feuil28").Range("db5001")

'affecte comptes 109 poste CB
Sheets("feuil28").Range("dc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dc1:dc5000")) 'compte 109
Sheets("feuil5").Range("m14") = -Sheets("feuil28").Range("dc5001")

'affecte comptes 105 poste CD
Sheets("feuil28").Range("dd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dd1:dd5000")) 'compte 105
Sheets("feuil5").Range("m15") = Sheets("feuil28").Range("dd5001")

'affecte comptes 106 poste CE
Sheets("feuil28").Range("de5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("de1:de5000")) 'compte 106
Sheets("feuil5").Range("m16") = Sheets("feuil28").Range("de5001")

'affecte comptes 111+112+113 poste CF
Sheets("feuil28").Range("df5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("df1:df5000")) 'compte 111
Sheets("feuil28").Range("dg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dg1:dg5000")) 'compte 112
Sheets("feuil28").Range("dh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dh1:dh5000")) 'compte 113
Sheets("feuil5").Range("m17") = Sheets("feuil28").Range("df5001") + Sheets("feuil28").Range("dg5001") + Sheets("feuil28").Range("dh5001")

'affecte comptes 118 poste CG
Sheets("feuil28").Range("di5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("di1:di5000")) 'compte 118
Sheets("feuil5").Range("m18") = Sheets("feuil28").Range("di5001")

'affecte comptes 121+129 poste CH
Sheets("feuil28").Range("dj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dj1:dj5000")) 'compte 121
Sheets("feuil28").Range("dk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dk1:dk5000")) 'compte 129
Sheets("feuil5").Range("m19") = Sheets("feuil28").Range("dj5001") - Sheets("feuil28").Range("dk5001")

'affecte comptes 15 poste CM
Sheets("feuil28").Range("dp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dp1:dp5000")) 'compte 15
Sheets("feuil5").Range("m25") = Sheets("feuil28").Range("dp5001")

'affecte comptes 14 poste CL
Sheets("feuil28").Range("dq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dq1:dq5000")) 'compte 478
Sheets("feuil5").Range("m24") = Sheets("feuil28").Range("dq5001")

'affecte comptes 16 poste DA
Sheets("feuil28").Range("dr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dr1:dr5000")) 'compte 16
Sheets("feuil28").Range("ds5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ds1:ds5000")) 'compte 18
Sheets("feuil5").Range("m30") = Sheets("feuil28").Range("dr5001") + Sheets("feuil28").Range("ds5001")

'affecte comptes 17 poste DB
Sheets("feuil28").Range("dt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dt1:dt5000")) 'compte 17
Sheets("feuil5").Range("m31") = Sheets("feuil28").Range("dt5001")

'affecte comptes 19 poste DD
Sheets("feuil28").Range("du5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("du1:du5000")) 'compte 19
Sheets("feuil5").Range("m32") = Sheets("feuil28").Range("du5001")

'affecte comptes 419 poste DI
Sheets("feuil28").Range("dv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dv1:dv5000")) 'compte 419
Sheets("feuil5").Range("m36") = Sheets("feuil28").Range("dv5001")

'affecte comptes 401+402+408+404 poste DJ
Sheets("feuil28").Range("dw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dw1:dw5000")) 'compte 401
Sheets("feuil28").Range("dx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dx1:dx5000")) 'compte 402
Sheets("feuil28").Range("dy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dy1:dy5000")) 'compte 408
Sheets("feuil5").Range("m37") = Sheets("feuil28").Range("dw5001") + Sheets("feuil28").Range("dx5001") + Sheets("feuil28").Range("dy5001")

'adaptation syscohada compte 48 H.A.O
Sheets("feuil28").Range("ef5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ef1:ef5000")) 'compte 48
Sheets("feuil5").Range("m35") = Sheets("feuil28").Range("ef5001")

'affecte comptes 42+43+44 poste DK
Sheets("feuil28").Range("dz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dz1:dz5000")) 'compte 42
Sheets("feuil28").Range("ea5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ea1:ea5000")) 'compte 43
Sheets("feuil28").Range("eb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eb1:eb5000")) 'compte 44
Sheets("feuil5").Range("m38") = Sheets("feuil28").Range("dz5001") + Sheets("feuil28").Range("ea5001") + Sheets("feuil28").Range("eb5001")


'affecte comptes 45+46+47 poste DM
Sheets("feuil28").Range("ec5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ec1:ec5000")) 'compte 45
Sheets("feuil28").Range("ed5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ed1:ed5000")) 'compte 46
Sheets("feuil28").Range("ee5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ee1:ee5000")) 'compte 47
'Sheets("feuil28").Range("ef5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ef1:ef5000")) 'compte 48
Sheets("feuil5").Range("m39") = Sheets("feuil28").Range("ec5001") + Sheets("feuil28").Range("ed5001") + Sheets("feuil28").Range("ee5001") '+ Sheets("feuil28").Range("ef5001")

'affecte comptes 499+599 poste DN
Sheets("feuil28").Range("eg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eg1:eg5000")) 'compte 499
Sheets("feuil28").Range("eh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eh1:eh5000")) 'compte 599
Sheets("feuil5").Range("m40") = Sheets("feuil28").Range("eg5001") + Sheets("feuil28").Range("eh5001")

'affecte comptes 564+565 poste DQ
Sheets("feuil28").Range("ei5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ei1:ei5000")) 'compte 564
Sheets("feuil28").Range("ej5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ej1:ej5000")) 'compte 565
Sheets("feuil5").Range("m43") = Sheets("feuil28").Range("ei5001") + Sheets("feuil28").Range("ej5001")

'affecte comptes 52+(53+54 rattrapés) poste DS
Sheets("feuil28").Range("ek5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ek1:ek5000")) 'compte 52
Sheets("feuil28").Range("jn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jn1:jn5000")) 'compte 53c rattrapage
Sheets("feuil28").Range("jo5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jo1:jo5000")) 'compte 54c rattrapage
Sheets("feuil28").Range("el5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("el1:el5000")) 'compte 561
Sheets("feuil28").Range("em5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("em1:em5000")) 'compte 566
Sheets("feuil5").Range("m44") = Sheets("feuil28").Range("ek5001") + Sheets("feuil28").Range("jn5001") + Sheets("feuil28").Range("jo5001") + Sheets("feuil28").Range("el5001") + Sheets("feuil28").Range("em5001")

'adaptation syscohada compte 479 ECP
Sheets("feuil28").Range("lc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lc1:lc5000")) 'compte 479
Sheets("feuil5").Range("m46") = Sheets("feuil28").Range("lc5001")

'___________________________________________________________________________________________________________

'calcul TOTAUX DU PASSIF
'récupération d'abord du résultat à partir du compte de résultat
Sheets("feuil5").Range("m21") = Sheets("feuil6").Range("j54")

'calcul total capitaux propres
Sheets("feuil5").Range("m28") = WorksheetFunction.Sum(Sheets("feuil5").Range("m13:m25"))

'calcul total dettes financières
Sheets("feuil5").Range("m33") = WorksheetFunction.Sum(Sheets("feuil5").Range("m30:m32"))

'calcul total ressources stables
Sheets("feuil5").Range("m34") = Sheets("feuil5").Range("m28") + Sheets("feuil5").Range("m33")

'calcul total passif circulant
Sheets("feuil5").Range("m41") = WorksheetFunction.Sum(Sheets("feuil5").Range("m35:m40"))

'calcul total trésorerie passif
Sheets("feuil5").Range("m45") = WorksheetFunction.Sum(Sheets("feuil5").Range("m43:m44"))

'calcul total général passif
Sheets("feuil5").Range("m47") = Sheets("feuil5").Range("m34") + Sheets("feuil5").Range("m41") + Sheets("feuil5").Range("m45") + Sheets("feuil5").Range("m46")

'_______________________________________________________________________________________


'affectation dans les colonnes N-1
'affectation de l'actif
For i = 14 To 47
Sheets("feuil5").Cells(i, 8) = Sheets("feuil5").Cells(i, 7)
Next

'affectation Passif
For i = 13 To 47
Sheets("feuil5").Cells(i, 14) = Sheets("feuil5").Cells(i, 13)
Next


'annulation des colonnes N
Sheets("feuil5").Range("e14:g47").ClearContents
Sheets("feuil5").Range("m13:m47").ClearContents



'afficher bilan
Sheets("feuil5").Activate
Sheets("feuil5").Range("a1").Select


'message d'équilibre du Bilan N-1
If Sheets("feuil5").Range("h47") = Sheets("feuil5").Range("n47") Then
MsgBox "Votre Bilan N-1 est équilibré avec un résultat de  " & Sheets("feuil6").Range("j54")
Else
MsgBox "Votre bilan N-1 est déséquilibré de  " & Abs(Sheets("feuil5").Range("h47") - Sheets("feuil5").Range("n47"))
End If

'efface les données sur la feuil28
Sheets("feuil28").Range("a1:za5001").ClearContents
End Sub
Private Sub affiche_balance_n_1()
'animationv1
'délai d'essai
date_test = Now()
If Year(2020) > 2017 Then
MsgBox "Délai d'essai expiré 600!"
Else

'condition d'installation
'If Sheets("feuil12").Range("a100") = Left(Sheets("feuil12").Range("a101"), 10) Then

Sheets("feuil1").Activate

'condition d'installation
'Else
'MsgBox "Désolé  !  Veuillez d'abord installer votre logiciel."
'End If

'délai d'essai
End If
End Sub
Private Sub edite_compte_résultat_n_1()
'animationv1
'mise en forme conditionnelle
Sheets("feuil28").Range("za11") = 1

'délai d'essai
date_test = Now()
If Year(2020) > 2017 Then
MsgBox "Délai d'essai expiré 7!"
Else

'condition d'installation
'If Sheets("feuil12").Range("a100") = Left(Sheets("feuil12").Range("a101"), 10) Then


'condition d'édition
If WorksheetFunction.Sum(Sheets("feuil1").Range("g1:h5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à éditer."
Else

'demande de confirmation
If MsgBox("Confirmez vous que la balance n-1 a été auditée en Balance N ?", vbYesNo, "Demande de confirmation") = vbYes Then


'annule les données du compte de résultat
Sheets("feuil6").Range("j13:j54").ClearContents


For i = 3 To 5000

'recup CHARGES
'recup compte 601
If Left(Sheets("feuil1").Cells(i, 1), 3) = 601 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6019 Then
Else
Sheets("feuil28").Cells(i, 144) = Sheets("feuil1").Cells(i, 7) 'colonne EN
End If
Else
End If

'recup compte 6019
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6019 Then
Sheets("feuil28").Cells(i, 145) = Sheets("feuil1").Cells(i, 8) 'colonne EO
Else
End If

'recup compte 6031d
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6031 Then
Sheets("feuil28").Cells(i, 146) = Sheets("feuil1").Cells(i, 7) 'colonne EP
Else
End If

'recup compte 6031c
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6031 Then
Sheets("feuil28").Cells(i, 147) = Sheets("feuil1").Cells(i, 8) 'colonne EQ
Else
End If

'recup compte 602
If Left(Sheets("feuil1").Cells(i, 1), 3) = 602 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6029 Then
Else
Sheets("feuil28").Cells(i, 148) = Sheets("feuil1").Cells(i, 7) 'colonne ER
End If
Else
End If

'recup compte 6029
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6029 Then
Sheets("feuil28").Cells(i, 149) = Sheets("feuil1").Cells(i, 8) 'colonne ES
Else
End If

'recup compte 6032d
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6032 Then
Sheets("feuil28").Cells(i, 150) = Sheets("feuil1").Cells(i, 7) 'colonne ET
Else
End If

'recup compte 6032c
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6032 Then
Sheets("feuil28").Cells(i, 151) = Sheets("feuil1").Cells(i, 8) 'colonne EU
Else
End If

'recup compte 604
If Left(Sheets("feuil1").Cells(i, 1), 3) = 604 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6049 Then
Else
Sheets("feuil28").Cells(i, 152) = Sheets("feuil1").Cells(i, 7) 'colonne EV
End If
Else
End If

'recup compte 605
If Left(Sheets("feuil1").Cells(i, 1), 3) = 605 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6059 Then
Else
Sheets("feuil28").Cells(i, 153) = Sheets("feuil1").Cells(i, 7) 'colonne EW
End If
Else
End If

'recup compte 608
If Left(Sheets("feuil1").Cells(i, 1), 3) = 608 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6089 Then
Else
Sheets("feuil28").Cells(i, 154) = Sheets("feuil1").Cells(i, 7) 'colonne EX
End If
Else
End If

'recup compte 6049
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6049 Then
Sheets("feuil28").Cells(i, 155) = Sheets("feuil1").Cells(i, 8) 'colonne EY
Else
End If

'recup compte 6059
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6059 Then
Sheets("feuil28").Cells(i, 156) = Sheets("feuil1").Cells(i, 8) 'colonne EZ
Else
End If

'recup compte 6089
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6089 Then
Sheets("feuil28").Cells(i, 157) = Sheets("feuil1").Cells(i, 8) 'colonne FA
Else
End If

'recup compte 6033d
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6033 Then
Sheets("feuil28").Cells(i, 158) = Sheets("feuil1").Cells(i, 7) 'colonne FB
Else
End If

'recup compte 6033c
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6033 Then
Sheets("feuil28").Cells(i, 159) = Sheets("feuil1").Cells(i, 8) 'colonne FC
Else
End If

'recup compte 61
If Left(Sheets("feuil1").Cells(i, 1), 2) = 61 Then
Sheets("feuil28").Cells(i, 160) = Sheets("feuil1").Cells(i, 7) 'colonne FD
Else
End If

'recup compte 62
If Left(Sheets("feuil1").Cells(i, 1), 2) = 62 Then
Sheets("feuil28").Cells(i, 161) = Sheets("feuil1").Cells(i, 7) 'colonne FE
Else
End If

'recup compte 63
If Left(Sheets("feuil1").Cells(i, 1), 2) = 63 Then
Sheets("feuil28").Cells(i, 162) = Sheets("feuil1").Cells(i, 7) 'colonne FF
Else
End If

'recup compte 64
If Left(Sheets("feuil1").Cells(i, 1), 2) = 64 Then
Sheets("feuil28").Cells(i, 163) = Sheets("feuil1").Cells(i, 7) 'colonne FG
Else
End If

'recup compte 65
If Left(Sheets("feuil1").Cells(i, 1), 2) = 65 Then
Sheets("feuil28").Cells(i, 164) = Sheets("feuil1").Cells(i, 7) 'colonne FH
Else
End If

'recup compte 66
If Left(Sheets("feuil1").Cells(i, 1), 2) = 66 Then
Sheets("feuil28").Cells(i, 165) = Sheets("feuil1").Cells(i, 7) 'colonne FI
Else
End If

'recup compte 681
If Left(Sheets("feuil1").Cells(i, 1), 3) = 681 Then
Sheets("feuil28").Cells(i, 166) = Sheets("feuil1").Cells(i, 7) 'colonne FJ
Else
End If

'recup compte 691
If Left(Sheets("feuil1").Cells(i, 1), 3) = 691 Then
Sheets("feuil28").Cells(i, 167) = Sheets("feuil1").Cells(i, 7) 'colonne FK
Else
End If

'recup compte 67
If Left(Sheets("feuil1").Cells(i, 1), 2) = 67 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 676 Then
Else
Sheets("feuil28").Cells(i, 168) = Sheets("feuil1").Cells(i, 7) 'colonne FL
End If
Else
End If

'recup compte 676
If Left(Sheets("feuil1").Cells(i, 1), 3) = 676 Then
Sheets("feuil28").Cells(i, 169) = Sheets("feuil1").Cells(i, 7) 'colonne FM
Else
End If

'recup compte 687
If Left(Sheets("feuil1").Cells(i, 1), 3) = 687 Then
Sheets("feuil28").Cells(i, 170) = Sheets("feuil1").Cells(i, 7) 'colonne FN
Else
End If

'recup compte 697
If Left(Sheets("feuil1").Cells(i, 1), 3) = 697 Then
Sheets("feuil28").Cells(i, 171) = Sheets("feuil1").Cells(i, 7) 'colonne FO
Else
End If

'recup compte 81
If Left(Sheets("feuil1").Cells(i, 1), 2) = 81 Then
Sheets("feuil28").Cells(i, 172) = Sheets("feuil1").Cells(i, 7) 'colonne FP
Else
End If

'recup compte 831
If Left(Sheets("feuil1").Cells(i, 1), 3) = 831 Then
Sheets("feuil28").Cells(i, 173) = Sheets("feuil1").Cells(i, 7) 'colonne FQ
Else
End If

'recup compte 836
If Left(Sheets("feuil1").Cells(i, 1), 3) = 836 Then
Sheets("feuil28").Cells(i, 174) = Sheets("feuil1").Cells(i, 7) 'colonne FR
Else
End If

'recup compte 83 sauf 831+836
If Left(Sheets("feuil1").Cells(i, 1), 2) = 83 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 836 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 3) = 831 Then
Else
Sheets("feuil28").Cells(i, 175) = Sheets("feuil1").Cells(i, 7) 'colonne FS
End If
End If
Else
End If

'recup compte 85
If Left(Sheets("feuil1").Cells(i, 1), 2) = 85 Then
Sheets("feuil28").Cells(i, 176) = Sheets("feuil1").Cells(i, 7) 'colonne FT
Else
End If

'recup compte 87
If Left(Sheets("feuil1").Cells(i, 1), 2) = 87 Then
Sheets("feuil28").Cells(i, 177) = Sheets("feuil1").Cells(i, 7) 'colonne FU
Else
End If

'recup compte 89
If Left(Sheets("feuil1").Cells(i, 1), 2) = 89 Then
Sheets("feuil28").Cells(i, 178) = Sheets("feuil1").Cells(i, 7) 'colonne FV
Else
End If


'recup PRODUITS
'recup compte 701
If Left(Sheets("feuil1").Cells(i, 1), 3) = 701 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7019 Then
Else
Sheets("feuil28").Cells(i, 179) = Sheets("feuil1").Cells(i, 8) 'colonne FW
End If
Else
End If

'recup compte 702
If Left(Sheets("feuil1").Cells(i, 1), 3) = 702 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7029 Then
Else
Sheets("feuil28").Cells(i, 180) = Sheets("feuil1").Cells(i, 8) 'colonne FX
End If
Else
End If

'recup compte 703
If Left(Sheets("feuil1").Cells(i, 1), 3) = 703 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7039 Then
Else
Sheets("feuil28").Cells(i, 181) = Sheets("feuil1").Cells(i, 8) 'colonne FY
End If
Else
End If

'recup compte 704
If Left(Sheets("feuil1").Cells(i, 1), 3) = 704 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7049 Then
Else
Sheets("feuil28").Cells(i, 182) = Sheets("feuil1").Cells(i, 8) 'colonne FZ
End If
Else
End If

'recup compte 705
If Left(Sheets("feuil1").Cells(i, 1), 3) = 705 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7059 Then
Else
Sheets("feuil28").Cells(i, 183) = Sheets("feuil1").Cells(i, 8) 'colonne GA
End If
Else
End If

'recup compte 706
If Left(Sheets("feuil1").Cells(i, 1), 3) = 706 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7069 Then
Else
Sheets("feuil28").Cells(i, 184) = Sheets("feuil1").Cells(i, 8) 'colonne GB
End If
Else
End If

'recup compte 73c
If Left(Sheets("feuil1").Cells(i, 1), 2) = 73 Then
Sheets("feuil28").Cells(i, 185) = Sheets("feuil1").Cells(i, 8) 'colonne GC
Else
End If

'recup compte 73d
If Left(Sheets("feuil1").Cells(i, 1), 2) = 73 Then
Sheets("feuil28").Cells(i, 186) = Sheets("feuil1").Cells(i, 7) 'colonne GD
Else
End If

'recup compte 72
If Left(Sheets("feuil1").Cells(i, 1), 2) = 72 Then
Sheets("feuil28").Cells(i, 187) = Sheets("feuil1").Cells(i, 8) 'colonne GE
Else
End If

'recup compte 707
If Left(Sheets("feuil1").Cells(i, 1), 3) = 707 Then
Sheets("feuil28").Cells(i, 188) = Sheets("feuil1").Cells(i, 8) 'colonne GF
Else
End If

'recup compte 71
If Left(Sheets("feuil1").Cells(i, 1), 2) = 71 Then
Sheets("feuil28").Cells(i, 189) = Sheets("feuil1").Cells(i, 8) 'colonne GG
Else
End If

'recup compte 75
If Left(Sheets("feuil1").Cells(i, 1), 2) = 75 Then
Sheets("feuil28").Cells(i, 190) = Sheets("feuil1").Cells(i, 8) 'colonne GH
Else
End If

'recup compte 791
If Left(Sheets("feuil1").Cells(i, 1), 3) = 791 Then
Sheets("feuil28").Cells(i, 191) = Sheets("feuil1").Cells(i, 8) 'colonne GI
Else
End If

'recup compte 798+799
If Left(Sheets("feuil1").Cells(i, 1), 3) = 798 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 799 Then
Sheets("feuil28").Cells(i, 192) = Sheets("feuil1").Cells(i, 8) 'colonne GJ
Else
End If

'recup compte 781
If Left(Sheets("feuil1").Cells(i, 1), 3) = 781 Then
Sheets("feuil28").Cells(i, 193) = Sheets("feuil1").Cells(i, 8) 'colonne GK
Else
End If

'recup compte 77 sauf 776
If Left(Sheets("feuil1").Cells(i, 1), 2) = 77 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 776 Then
Else
Sheets("feuil28").Cells(i, 194) = Sheets("feuil1").Cells(i, 8) 'colonne GL
End If
Else
End If

'recup compte 776
If Left(Sheets("feuil1").Cells(i, 1), 3) = 776 Then
Sheets("feuil28").Cells(i, 195) = Sheets("feuil1").Cells(i, 8) 'colonne GM
Else
End If

'recup compte 797
If Left(Sheets("feuil1").Cells(i, 1), 3) = 797 Then
Sheets("feuil28").Cells(i, 196) = Sheets("feuil1").Cells(i, 8) 'colonne GN
Else
End If

'recup compte 787
If Left(Sheets("feuil1").Cells(i, 1), 3) = 787 Then
Sheets("feuil28").Cells(i, 197) = Sheets("feuil1").Cells(i, 8) 'colonne GO
Else
End If

'recup compte 82
If Left(Sheets("feuil1").Cells(i, 1), 2) = 82 Then
Sheets("feuil28").Cells(i, 198) = Sheets("feuil1").Cells(i, 8) 'colonne GP
Else
End If

'recup compte 848
If Left(Sheets("feuil1").Cells(i, 1), 3) = 848 Then
Sheets("feuil28").Cells(i, 199) = Sheets("feuil1").Cells(i, 8) 'colonne GQ
Else
End If

'recup compte 84
If Left(Sheets("feuil1").Cells(i, 1), 2) = 84 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 848 Then
Else
Sheets("feuil28").Cells(i, 200) = Sheets("feuil1").Cells(i, 8) 'colonne GR
End If
Else
End If

'recup compte 88
If Left(Sheets("feuil1").Cells(i, 1), 2) = 88 Then
Sheets("feuil28").Cells(i, 201) = Sheets("feuil1").Cells(i, 8) 'colonne GS
Else
End If

'recup compte 86
If Left(Sheets("feuil1").Cells(i, 1), 2) = 86 Then
Sheets("feuil28").Cells(i, 202) = Sheets("feuil1").Cells(i, 8) 'colonne GT
Else
End If


'pour calcul dont personnel extérieur des charges de personnel
'recup compte 637
If Left(Sheets("feuil1").Cells(i, 1), 3) = 637 Then
Sheets("feuil28").Cells(i, 203) = Sheets("feuil1").Cells(i, 7) 'colonne GU
Else
End If
'recup compte 667
If Left(Sheets("feuil1").Cells(i, 1), 3) = 667 Then
Sheets("feuil28").Cells(i, 204) = Sheets("feuil1").Cells(i, 7) 'colonne GV
Else
End If


'Adaptation SYSCOHADA révisé (R,R,R sur les ventes)
'recup compte 7019
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7019 Then
Sheets("feuil28").Cells(i, 209) = Sheets("feuil1").Cells(i, 7) 'colonne HA
Else
End If

'recup compte 7029+7039+7049
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7029 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7039 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7049 Then
Sheets("feuil28").Cells(i, 210) = Sheets("feuil1").Cells(i, 7) 'colonne HB
Else
End If

'recup compte 7059+7069
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7059 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7069 Then
Sheets("feuil28").Cells(i, 211) = Sheets("feuil1").Cells(i, 7) 'colonne HC
Else
End If


Next

'affecte CHARGES
'affecte comptes 601+6019 poste RA
Sheets("feuil28").Range("en5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("en1:en5000")) 'compte 601
Sheets("feuil28").Range("eo5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eo1:eo5000")) 'compte 6019
Sheets("feuil6").Range("j14") = -(Sheets("feuil28").Range("en5001") - Sheets("feuil28").Range("eo5001"))

'affecte comptes 6031(d/c) poste RB
Sheets("feuil28").Range("ep5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ep1:ep5000")) 'compte 6031d
Sheets("feuil28").Range("eq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eq1:eq5000")) 'compte 6031c
Sheets("feuil6").Range("j15") = -(Sheets("feuil28").Range("ep5001") - Sheets("feuil28").Range("eq5001"))

'affecte comptes 602+6029 poste RC
Sheets("feuil28").Range("er5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("er1:er5000")) 'compte 602
Sheets("feuil28").Range("es5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("es1:es5000")) 'compte 6029
Sheets("feuil6").Range("j26") = -(Sheets("feuil28").Range("er5001") - Sheets("feuil28").Range("es5001"))

'affecte comptes 6032(d/c) poste RD
Sheets("feuil28").Range("et5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("et1:et5000")) 'compte 6032d
Sheets("feuil28").Range("eu5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eu1:eu5000")) 'compte 6032c
Sheets("feuil6").Range("j27") = -(Sheets("feuil28").Range("et5001") - Sheets("feuil28").Range("eu5001"))

'affecte comptes 604+605+608+6049+6059+6089 poste RE
Sheets("feuil28").Range("ev5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ev1:ev5000")) 'compte 604
Sheets("feuil28").Range("ew5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ew1:ew5000")) 'compte 605
Sheets("feuil28").Range("ex5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ex1:ex5000")) 'compte 608
Sheets("feuil28").Range("ey5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ey1:ey5000")) 'compte 6049
Sheets("feuil28").Range("ez5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ez1:ez5000")) 'compte 6059
Sheets("feuil28").Range("fa5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fa1:fa5000")) 'compte 6089
Sheets("feuil6").Range("j28") = -((Sheets("feuil28").Range("ev5001") + Sheets("feuil28").Range("ew5001") + Sheets("feuil28").Range("ex5001")) - (Sheets("feuil28").Range("ey5001") + Sheets("feuil28").Range("ez5001") + Sheets("feuil28").Range("fa5001")))

'affecte comptes 6033(d/c) poste RH
Sheets("feuil28").Range("fb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fb1:fb5000")) 'compte 6033d
Sheets("feuil28").Range("fc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fc1:fc5000")) 'compte 6033c
Sheets("feuil6").Range("j29") = -(Sheets("feuil28").Range("fb5001") - Sheets("feuil28").Range("fc5001"))

'affecte comptes 61 poste RI
Sheets("feuil28").Range("fd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fd1:fd5000")) 'compte 61
Sheets("feuil6").Range("j30") = -Sheets("feuil28").Range("fd5001")

'affecte comptes 62+63 poste RJ
Sheets("feuil28").Range("fe5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fe1:fe5000")) 'compte 62
Sheets("feuil28").Range("ff5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ff1:ff5000")) 'compte 63
Sheets("feuil6").Range("j31") = -(Sheets("feuil28").Range("fe5001") + Sheets("feuil28").Range("ff5001"))

'affecte comptes 64 poste RK
Sheets("feuil28").Range("fg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fg1:fg5000")) 'compte 64
Sheets("feuil6").Range("j32") = -Sheets("feuil28").Range("fg5001")

'affecte comptes 65 poste RL
Sheets("feuil28").Range("fh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fh1:fh5000")) 'compte 65
Sheets("feuil6").Range("j33") = -Sheets("feuil28").Range("fh5001")

'affecte comptes 66 poste RP
Sheets("feuil28").Range("fi5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fi1:fi5000")) 'compte 66
Sheets("feuil6").Range("j35") = -Sheets("feuil28").Range("fi5001")

'affecte comptes 681+691 poste RS
Sheets("feuil28").Range("fj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fj1:fj5000")) 'compte 681
Sheets("feuil28").Range("fk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fk1:fk5000")) 'compte 691
Sheets("feuil6").Range("j38") = -(Sheets("feuil28").Range("fj5001") + Sheets("feuil28").Range("fk5001"))

'adaptation syscohada comptes 67+676 poste SF
Sheets("feuil28").Range("fl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fl1:fl5000")) 'compte 67
Sheets("feuil28").Range("fm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fm1:fm5000")) 'compte 676
Sheets("feuil6").Range("j43") = -(Sheets("feuil28").Range("fl5001") + Sheets("feuil28").Range("fm5001"))

'adaptaion syscohada comptes 687+697 poste SF
Sheets("feuil28").Range("fn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fn1:fn5000")) 'compte 687
Sheets("feuil28").Range("fo5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fo1:fo5000")) 'compte 697
Sheets("feuil6").Range("j44") = -(Sheets("feuil28").Range("fn5001") + Sheets("feuil28").Range("fo5001"))


'affecte comptes 81 poste SJ
Sheets("feuil28").Range("fp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fp1:fp5000")) 'compte 81
Sheets("feuil6").Range("j49") = -Sheets("feuil28").Range("fp5001")

'adaptation SYSCOHADA révisé comptes 83+831+836 poste SM
Sheets("feuil28").Range("fs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fs1:fs5000")) 'compte 81
Sheets("feuil28").Range("fq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fq1:fq5000")) 'compte 831
Sheets("feuil28").Range("fr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fr1:fr5000")) 'compte 836
Sheets("feuil28").Range("ft5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ft1:ft5000")) 'compte 85
Sheets("feuil6").Range("j50") = -(Sheets("feuil28").Range("fs5001") + Sheets("feuil28").Range("fq5001") + Sheets("feuil28").Range("fr5001") + Sheets("feuil28").Range("ft5001"))

'affecte comptes 87 poste SQ
Sheets("feuil28").Range("fu5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fu1:fu5000")) 'compte 87
Sheets("feuil6").Range("j52") = -Sheets("feuil28").Range("fu5001")

'affecte comptes 89 poste SR
Sheets("feuil28").Range("fv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fv1:fv5000")) 'compte 89
Sheets("feuil6").Range("j53") = -Sheets("feuil28").Range("fv5001")


'affecte PRODUITS
'affecte comptes 701-7019 poste TA
Sheets("feuil28").Range("fw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fw1:fw5000")) 'compte 701
Sheets("feuil28").Range("ha5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ha1:ha5000")) 'compte 7019
Sheets("feuil6").Range("j13") = Sheets("feuil28").Range("fw5001") - Sheets("feuil28").Range("ha5001")

'affecte comptes 702+703+704-(7029+7039+7049) poste TC
Sheets("feuil28").Range("fx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fx1:fx5000")) 'compte 702
Sheets("feuil28").Range("fy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fy1:fy5000")) 'compte 703
Sheets("feuil28").Range("fz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("fz1:fz5000")) 'compte 704
Sheets("feuil28").Range("hb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hb1:hb5000")) 'compte 7029+7039+7049
Sheets("feuil6").Range("j17") = Sheets("feuil28").Range("fx5001") + Sheets("feuil28").Range("fy5001") + Sheets("feuil28").Range("fz5001") - Sheets("feuil28").Range("hb5001")

'affecte comptes 705+706- (7059+7069) poste TD
Sheets("feuil28").Range("ga5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ga1:ga5000")) 'compte 705
Sheets("feuil28").Range("gb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gb1:gb5000")) 'compte 706
Sheets("feuil28").Range("hc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hc1:hc5000")) 'compte 7059+7069
Sheets("feuil6").Range("j18") = Sheets("feuil28").Range("ga5001") + Sheets("feuil28").Range("gb5001") - Sheets("feuil28").Range("hc5001")

'affecte comptes 73(c/d) poste TE
Sheets("feuil28").Range("gc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gc1:gc5000")) 'compte 73c
Sheets("feuil28").Range("gd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gd1:gd5000")) 'compte 73d
Sheets("feuil6").Range("j21") = Sheets("feuil28").Range("gc5001") - Sheets("feuil28").Range("gd5001")

'affecte comptes 72 poste TF
Sheets("feuil28").Range("ge5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ge1:ge5000")) 'compte 72
Sheets("feuil6").Range("j22") = Sheets("feuil28").Range("ge5001")

'affecte comptes 707 poste TH
Sheets("feuil28").Range("gf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gf1:gf5000")) 'compte 707
Sheets("feuil6").Range("j19") = Sheets("feuil28").Range("gf5001")

'affecte comptes 71 poste TK
Sheets("feuil28").Range("gg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gg1:gg5000")) 'compte 71
Sheets("feuil6").Range("j23") = Sheets("feuil28").Range("gg5001")

'affecte comptes 75 poste TL
Sheets("feuil28").Range("gh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gh1:gh5000")) 'compte 75
Sheets("feuil6").Range("j24") = Sheets("feuil28").Range("gh5001")

'affecte comptes 791+798+799 poste TS
Sheets("feuil28").Range("gi5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gi1:gi5000")) 'compte 791
Sheets("feuil28").Range("gj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gj1:gj5000")) 'compte 798+799
Sheets("feuil6").Range("j37") = Sheets("feuil28").Range("gi5001") + Sheets("feuil28").Range("gj5001")

'affecte comptes 781 poste TT
Sheets("feuil28").Range("gk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gk1:gk5000")) 'compte 781
Sheets("feuil6").Range("j25") = Sheets("feuil28").Range("gk5001")


'adaptation SYSCOHADA révisé comptes 77+776 poste UF
Sheets("feuil28").Range("gl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gl1:gl5000")) 'compte 77
Sheets("feuil28").Range("gm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gm1:gm5000")) 'compte 776
Sheets("feuil6").Range("j40") = Sheets("feuil28").Range("gl5001") + Sheets("feuil28").Range("gm5001")

'adaptation syscohada comptes 797 poste UF
Sheets("feuil28").Range("gn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gn1:gn5000")) 'compte 797
Sheets("feuil6").Range("j41") = Sheets("feuil28").Range("gn5001")

'adaptation syscohada comptes 787 poste UF
Sheets("feuil28").Range("go5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("go1:go5000")) 'compte 787
Sheets("feuil6").Range("j42") = Sheets("feuil28").Range("go5001")


'affecte comptes 82 poste UJ
Sheets("feuil28").Range("gp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gp1:gp5000")) 'compte 82
Sheets("feuil6").Range("j47") = Sheets("feuil28").Range("gp5001")

'adaptation SYSCOHADA révisé comptes 84+848+88+86 poste UM
Sheets("feuil28").Range("gr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gr1:gr5000")) 'compte 84 sauf 841
Sheets("feuil28").Range("gq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gq1:gq5000")) 'compte 841
Sheets("feuil28").Range("gs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gs1:gs5000")) 'compte 88
Sheets("feuil28").Range("gt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gt1:gt5000")) 'compte 86
Sheets("feuil6").Range("j48") = Sheets("feuil28").Range("gr5001") + Sheets("feuil28").Range("gq5001") + Sheets("feuil28").Range("gs5001") + Sheets("feuil28").Range("gt5001")

'___________________________________________________________________________________________

'calcul des TOTAUX DU COMPTE DE Résultat
'marge commerciale
Sheets("feuil6").Range("j16") = WorksheetFunction.Sum(Sheets("feuil6").Range("j13:j15"))

'chiffre d'affaires
Sheets("feuil6").Range("j20") = WorksheetFunction.Sum(Sheets("feuil6").Range("j17:j19")) + Sheets("feuil6").Range("j13")

'valeur ajoutée
Sheets("feuil6").Range("j34") = WorksheetFunction.Sum(Sheets("feuil6").Range("j21:j33")) + Sheets("feuil6").Range("j20") + Sheets("feuil6").Range("j14") + Sheets("feuil6").Range("j15")

'excédent brut d'exploitation
Sheets("feuil6").Range("j36") = Sheets("feuil6").Range("j34") + Sheets("feuil6").Range("j35")

'résultat d'exploitation
Sheets("feuil6").Range("j39") = Sheets("feuil6").Range("j36") + WorksheetFunction.Sum(Sheets("feuil6").Range("j37:j38"))

'résultat financier
Sheets("feuil6").Range("j45") = WorksheetFunction.Sum(Sheets("feuil6").Range("j40:j44"))

'résultat A.O.
Sheets("feuil6").Range("j46") = Sheets("feuil6").Range("j39") + Sheets("feuil6").Range("j45")

'résultat H.A.O.
Sheets("feuil6").Range("j51") = WorksheetFunction.Sum(Sheets("feuil6").Range("j47:j50"))

'résultat NET
Sheets("feuil6").Range("j54") = Sheets("feuil6").Range("j46") + Sheets("feuil6").Range("j51") + Sheets("feuil6").Range("j52") + Sheets("feuil6").Range("j53")

'____________________________________________________________________________________________


'affiche COMPTE DE RESULTAT
Sheets("feuil6").Activate
Sheets("feuil6").Range("a1").Select

'message du résultat de N-1
MsgBox "Votre résultat N-1 est de  " & Sheets("feuil6").Range("j54")


'efface les données sur la feuil28
Sheets("feuil28").Range("a1:za5001").ClearContents

'demande de confirmation
End If

'condition d'édition
End If

'condition d'installation
'Else
'MsgBox "Désolé  !  Veuillez d'abord installer votre logiciel."
'End If

'délai d'essai
End If

'mise en forme conditionnelle
Sheets("feuil28").Range("za11").ClearContents

End Sub
Private Sub edite_bilan_n_2()

For i = 3 To 5000

'recup ACTIF DU BILAN
'recup compte 211 et 2181
If Left(Sheets("feuil1").Cells(i, 1), 3) = 211 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2181 Then
Sheets("feuil28").Cells(i, 1) = Sheets("feuil1").Cells(i, 3) 'colonne A
Else
End If

'recup compte 2811 et 28181
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2811 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 28181 Then 'compte 2811 et 28181
Sheets("feuil28").Cells(i, 2) = Sheets("feuil1").Cells(i, 4) 'colonne B
Else
End If

'recup compte 212
If Left(Sheets("feuil1").Cells(i, 1), 3) = 212 Then 'compte 212
Sheets("feuil28").Cells(i, 3) = Sheets("feuil1").Cells(i, 3) 'colonne C
Else
End If

'recup compte 213
If Left(Sheets("feuil1").Cells(i, 1), 3) = 213 Then 'compte 213
Sheets("feuil28").Cells(i, 4) = Sheets("feuil1").Cells(i, 3) 'colonne D
Else
End If

'recup compte 214
If Left(Sheets("feuil1").Cells(i, 1), 3) = 214 Then 'compte 214
Sheets("feuil28").Cells(i, 5) = Sheets("feuil1").Cells(i, 3) 'colonne E
Else
End If

'recup compte 2812
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2812 Then 'compte 2812
Sheets("feuil28").Cells(i, 6) = Sheets("feuil1").Cells(i, 4) 'colonne F
Else
End If

'recup compte 2813
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2813 Then 'compte 2813
Sheets("feuil28").Cells(i, 7) = Sheets("feuil1").Cells(i, 4) 'colonne G
Else
End If

'recup compte 2814
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2814 Then 'compte 2814
Sheets("feuil28").Cells(i, 8) = Sheets("feuil1").Cells(i, 4) 'colonne H
Else
End If

'recup compte 2912
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2912 Then 'compte 2912
Sheets("feuil28").Cells(i, 9) = Sheets("feuil1").Cells(i, 4) 'colonne I
Else
End If

'recup compte 2913
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2913 Then 'compte 2913
Sheets("feuil28").Cells(i, 10) = Sheets("feuil1").Cells(i, 4) 'colonne J
Else
End If

'recup compte 2914
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2914 Then 'compte 2914
Sheets("feuil28").Cells(i, 11) = Sheets("feuil1").Cells(i, 4) 'colonne K
Else
End If

'recup compte 215
If Left(Sheets("feuil1").Cells(i, 1), 3) = 215 Then 'compte 215
Sheets("feuil28").Cells(i, 12) = Sheets("feuil1").Cells(i, 3) 'colonne L
Else
End If

'recup compte 216
If Left(Sheets("feuil1").Cells(i, 1), 3) = 216 Then 'compte 216
Sheets("feuil28").Cells(i, 13) = Sheets("feuil1").Cells(i, 3) 'colonne M
Else
End If

'recup compte 2815
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2815 Then 'compte 2815
Sheets("feuil28").Cells(i, 14) = Sheets("feuil1").Cells(i, 4) 'colonne N
Else
End If

'recup compte 2816
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2816 Then 'compte 2816
Sheets("feuil28").Cells(i, 15) = Sheets("feuil1").Cells(i, 4) 'colonne O
Else
End If

'recup compte 2915
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2915 Then 'compte 2915
Sheets("feuil28").Cells(i, 16) = Sheets("feuil1").Cells(i, 4) 'colonne P
Else
End If

'recup compte 2916
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2916 Then 'compte 2916
Sheets("feuil28").Cells(i, 17) = Sheets("feuil1").Cells(i, 4) 'colonne Q
Else
End If

'recup compte 217
If Left(Sheets("feuil1").Cells(i, 1), 3) = 217 Then 'compte 217
Sheets("feuil28").Cells(i, 18) = Sheets("feuil1").Cells(i, 3) 'colonne R
Else
End If

'recup compte 218
If Left(Sheets("feuil1").Cells(i, 1), 3) = 218 Then 'compte 218
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2181 Then
Else
Sheets("feuil28").Cells(i, 19) = Sheets("feuil1").Cells(i, 3) 'colonne S
End If
Else
End If

'recup compte 2817
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2817 Then 'compte 2817
Sheets("feuil28").Cells(i, 20) = Sheets("feuil1").Cells(i, 4) 'colonne T
Else
End If

'recup compte 2818
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2818 Then 'compte 2818
If Left(Sheets("feuil1").Cells(i, 1), 5) = 28181 Then
Else
Sheets("feuil28").Cells(i, 21) = Sheets("feuil1").Cells(i, 4) 'colonne U
End If
Else
End If

'recup compte 2917
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2917 Then 'compte 2917
Sheets("feuil28").Cells(i, 22) = Sheets("feuil1").Cells(i, 4) 'colonne V
Else
End If

'recup compte 2918
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2918 Then 'compte 2918
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29181 Then
Else
Sheets("feuil28").Cells(i, 23) = Sheets("feuil1").Cells(i, 4) 'colonne W
End If
Else
End If

'recup compte 2191
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2191 Then 'compte 2191
Sheets("feuil28").Cells(i, 24) = Sheets("feuil1").Cells(i, 3) 'colonne X
Else
End If

'recup compte 2193
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2193 Then 'compte 2193
Sheets("feuil28").Cells(i, 25) = Sheets("feuil1").Cells(i, 3) 'colonne Y
Else
End If

'recup compte 2198
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2198 Then 'compte 2198
Sheets("feuil28").Cells(i, 26) = Sheets("feuil1").Cells(i, 3) 'colonne Z
Else
End If

'recup compte 29191 + 2911 + 29181
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29191 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 29181 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2911 Then  'compte 29191
Sheets("feuil28").Cells(i, 27) = Sheets("feuil1").Cells(i, 4) 'colonne AA
Else
End If

'recup compte 29193
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29193 Then 'compte 29193
Sheets("feuil28").Cells(i, 28) = Sheets("feuil1").Cells(i, 4) 'colonne AB
Else
End If

'recup compte 29198
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29198 Then 'compte 29198
Sheets("feuil28").Cells(i, 29) = Sheets("feuil1").Cells(i, 4) 'colonne AC
Else
End If

'recup compte 22
If Left(Sheets("feuil1").Cells(i, 1), 2) = 22 Then 'compte 22 sauf 229
If Left(Sheets("feuil1").Cells(i, 1), 3) = 229 Then
Else
Sheets("feuil28").Cells(i, 30) = Sheets("feuil1").Cells(i, 3) 'colonne AD
End If
Else
End If

'recup compte 282
If Left(Sheets("feuil1").Cells(i, 1), 3) = 282 Then 'compte 282
Sheets("feuil28").Cells(i, 31) = Sheets("feuil1").Cells(i, 4) 'colonne AE
Else
End If

'recup compte 292
If Left(Sheets("feuil1").Cells(i, 1), 3) = 292 Then 'compte 292 sauf 2929
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2929 Then
Else
Sheets("feuil28").Cells(i, 32) = Sheets("feuil1").Cells(i, 4) 'colonne AF
End If
Else
End If

'recup compte 231
If Left(Sheets("feuil1").Cells(i, 1), 3) = 231 Then 'compte 231
Sheets("feuil28").Cells(i, 33) = Sheets("feuil1").Cells(i, 3) 'colonne AG
Else
End If

'recup compte 232
If Left(Sheets("feuil1").Cells(i, 1), 3) = 232 Then 'compte 232
Sheets("feuil28").Cells(i, 34) = Sheets("feuil1").Cells(i, 3) 'colonne AH
Else
End If

'recup compte 233
If Left(Sheets("feuil1").Cells(i, 1), 3) = 233 Then 'compte 233
Sheets("feuil28").Cells(i, 35) = Sheets("feuil1").Cells(i, 3) 'colonne AI
Else
End If

'recup compte 237
If Left(Sheets("feuil1").Cells(i, 1), 3) = 237 Then 'compte 237
Sheets("feuil28").Cells(i, 36) = Sheets("feuil1").Cells(i, 3) 'colonne AJ
Else
End If

'recup compte 2831
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2831 Then 'compte 2831
Sheets("feuil28").Cells(i, 37) = Sheets("feuil1").Cells(i, 4) 'colonne AK
Else
End If

'recup compte 2832
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2832 Then 'compte 2832
Sheets("feuil28").Cells(i, 38) = Sheets("feuil1").Cells(i, 4) 'colonne AL
Else
End If

'recup compte 2833
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2833 Then 'compte 2833
Sheets("feuil28").Cells(i, 39) = Sheets("feuil1").Cells(i, 4) 'colonne AM
Else
End If

'recup compte 2837
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2837 Then 'compte 2837
Sheets("feuil28").Cells(i, 40) = Sheets("feuil1").Cells(i, 4) 'colonne AN
Else
End If

'recup compte 2931
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2931 Then 'compte 2931
Sheets("feuil28").Cells(i, 41) = Sheets("feuil1").Cells(i, 4) 'colonne AO
Else
End If

'recup compte 2932
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2932 Then 'compte 2932
Sheets("feuil28").Cells(i, 42) = Sheets("feuil1").Cells(i, 4) 'colonne AP
Else
End If

'recup compte 2933
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2933 Then 'compte 2933
Sheets("feuil28").Cells(i, 43) = Sheets("feuil1").Cells(i, 4) 'colonne AQ
Else
End If

'recup compte 2937
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2937 Then 'compte 2937
Sheets("feuil28").Cells(i, 44) = Sheets("feuil1").Cells(i, 4) 'colonne AR
Else
End If

'recup compte 234
If Left(Sheets("feuil1").Cells(i, 1), 3) = 234 Then 'compte 234
Sheets("feuil28").Cells(i, 45) = Sheets("feuil1").Cells(i, 3) 'colonne AS
Else
End If

'recup compte 235
If Left(Sheets("feuil1").Cells(i, 1), 3) = 235 Then 'compte 235
Sheets("feuil28").Cells(i, 46) = Sheets("feuil1").Cells(i, 3) 'colonne AT
Else
End If

'recup compte 238
If Left(Sheets("feuil1").Cells(i, 1), 3) = 238 Then 'compte 238
Sheets("feuil28").Cells(i, 47) = Sheets("feuil1").Cells(i, 3) 'colonne AU
Else
End If

'recup compte 2834
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2834 Then 'compte 2834
Sheets("feuil28").Cells(i, 48) = Sheets("feuil1").Cells(i, 4) 'colonne AV
Else
End If

'recup compte 2835
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2835 Then 'compte 2835
Sheets("feuil28").Cells(i, 49) = Sheets("feuil1").Cells(i, 4) 'colonne AW
Else
End If

'recup compte 2838
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2838 Then 'compte 2838
Sheets("feuil28").Cells(i, 50) = Sheets("feuil1").Cells(i, 4) 'colonne AX
Else
End If

'recup compte 2934
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2934 Then 'compte 2934
Sheets("feuil28").Cells(i, 51) = Sheets("feuil1").Cells(i, 4) 'colonne AY
Else
End If

'recup compte 2935
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2935 Then 'compte 2935
Sheets("feuil28").Cells(i, 52) = Sheets("feuil1").Cells(i, 4) 'colonne AZ
Else
End If

'recup compte 2938
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2938 Then 'compte 2938
Sheets("feuil28").Cells(i, 53) = Sheets("feuil1").Cells(i, 4) 'colonne BA
Else
End If

'recup compte 24
If Left(Sheets("feuil1").Cells(i, 1), 2) = 24 Then 'compte 24 sauf 249+245
If Left(Sheets("feuil1").Cells(i, 1), 3) = 249 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 3) = 245 Then
Else
Sheets("feuil28").Cells(i, 54) = Sheets("feuil1").Cells(i, 3) 'colonne BB
End If
End If
Else
End If

'recup compte 284
If Left(Sheets("feuil1").Cells(i, 1), 3) = 284 Then 'compte 284 sauf 2845
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2845 Then
Else
Sheets("feuil28").Cells(i, 55) = Sheets("feuil1").Cells(i, 4) 'colonne BC
End If
Else
End If

'recup compte 294
If Left(Sheets("feuil1").Cells(i, 1), 3) = 294 Then 'compte 294 sauf 2949+2945
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2949 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2945 Then
Else
Sheets("feuil28").Cells(i, 56) = Sheets("feuil1").Cells(i, 4) 'colonne BD
End If
End If
Else
End If

'recup compte 229
If Left(Sheets("feuil1").Cells(i, 1), 3) = 229 Then 'compte 229
Sheets("feuil28").Cells(i, 57) = Sheets("feuil1").Cells(i, 3) 'colonne BE
Else
End If

'recup compte 239
If Left(Sheets("feuil1").Cells(i, 1), 3) = 239 Then 'compte 239
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2394 Then 'compte 2394
Else
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2395 Then 'compte 2395
Else
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2398 Then 'compte 2398
Else
Sheets("feuil28").Cells(i, 58) = Sheets("feuil1").Cells(i, 3) 'colonne BF
End If
End If
End If
Else
End If

'recup compte 249
If Left(Sheets("feuil1").Cells(i, 1), 3) = 249 Then 'compte 249
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2495 Then 'compte 2495
Else
Sheets("feuil28").Cells(i, 59) = Sheets("feuil1").Cells(i, 3) 'colonne BG
End If
Else
End If

'recup compte 2929
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2929 Then 'compte 2929
Sheets("feuil28").Cells(i, 60) = Sheets("feuil1").Cells(i, 4) 'colonne BH
Else
End If

'recup compte 2939
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2939 Then 'compte 2939
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29394 Then 'compte 29394
Else
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29395 Then 'compte 29395
Else
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29398 Then 'compte 29398
Else
Sheets("feuil28").Cells(i, 61) = Sheets("feuil1").Cells(i, 4) 'colonne BI
End If
End If
End If
Else
End If

'recup compte 2949
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2949 Then 'compte 2949
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29495 Then 'compte 29495
Else
Sheets("feuil28").Cells(i, 62) = Sheets("feuil1").Cells(i, 4) 'colonne BJ
End If
Else
End If

'recup compte 25
If Left(Sheets("feuil1").Cells(i, 1), 2) = 25 Then 'compte 25
Sheets("feuil28").Cells(i, 63) = Sheets("feuil1").Cells(i, 3) 'colonne BK
Else
End If

'recup compte 295
If Left(Sheets("feuil1").Cells(i, 1), 3) = 295 Then 'compte 295
Sheets("feuil28").Cells(i, 64) = Sheets("feuil1").Cells(i, 4) 'colonne BL
Else
End If

'recup compte 26
If Left(Sheets("feuil1").Cells(i, 1), 2) = 26 Then 'compte 26
Sheets("feuil28").Cells(i, 65) = Sheets("feuil1").Cells(i, 3) 'colonne BM
Else
End If

'recup compte 296
If Left(Sheets("feuil1").Cells(i, 1), 3) = 296 Then 'compte 296
Sheets("feuil28").Cells(i, 66) = Sheets("feuil1").Cells(i, 4) 'colonne BN
Else
End If

'recup compte 27
If Left(Sheets("feuil1").Cells(i, 1), 2) = 27 Then 'compte 27
Sheets("feuil28").Cells(i, 67) = Sheets("feuil1").Cells(i, 3) 'colonne BO
Else
End If

'recup compte 297
If Left(Sheets("feuil1").Cells(i, 1), 3) = 297 Then 'compte 297
Sheets("feuil28").Cells(i, 68) = Sheets("feuil1").Cells(i, 4) 'colonne BP
Else
End If

'recup compte 3
If Left(Sheets("feuil1").Cells(i, 1), 1) = 3 Then 'compte 3
Sheets("feuil28").Cells(i, 69) = Sheets("feuil1").Cells(i, 3) 'colonne BQ
Else
End If

'recup compte 39
If Left(Sheets("feuil1").Cells(i, 1), 2) = 39 Then 'compte 39
Sheets("feuil28").Cells(i, 70) = Sheets("feuil1").Cells(i, 4) 'colonne BR
Else
End If




'ADAPTATION DES COMPTES AU SYSCOHADA
'recup compte 2394
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2394 Then
Sheets("feuil28").Cells(i, 276) = Sheets("feuil1").Cells(i, 3) 'colonne JP
Else
End If

'recup compte 2395
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2395 Then
Sheets("feuil28").Cells(i, 277) = Sheets("feuil1").Cells(i, 3) 'colonne JQ
Else
End If

'recup compte 2398
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2398 Then
Sheets("feuil28").Cells(i, 278) = Sheets("feuil1").Cells(i, 3) 'colonne JR
Else
End If

'recup compte 29394
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29394 Then
Sheets("feuil28").Cells(i, 279) = Sheets("feuil1").Cells(i, 4) 'colonne JS
Else
End If

'recup compte 29395
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29395 Then
Sheets("feuil28").Cells(i, 280) = Sheets("feuil1").Cells(i, 4) 'colonne JT
Else
End If

'recup compte 29398
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29398 Then
Sheets("feuil28").Cells(i, 281) = Sheets("feuil1").Cells(i, 4) 'colonne JU
Else
End If

'recup compte 245
If Left(Sheets("feuil1").Cells(i, 1), 3) = 245 Then
Sheets("feuil28").Cells(i, 282) = Sheets("feuil1").Cells(i, 3) 'colonne JV
Else
End If

'recup compte 2495
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2495 Then
Sheets("feuil28").Cells(i, 283) = Sheets("feuil1").Cells(i, 3) 'colonne JW
Else
End If

'recup compte 2845
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2845 Then
Sheets("feuil28").Cells(i, 284) = Sheets("feuil1").Cells(i, 4) 'colonne JX
Else
End If

'recup compte 2945
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2945 Then
Sheets("feuil28").Cells(i, 285) = Sheets("feuil1").Cells(i, 4) 'colonne JY
Else
End If

'recup compte 29495
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29495 Then
Sheets("feuil28").Cells(i, 286) = Sheets("feuil1").Cells(i, 4) 'colonne JZ
Else
End If



'recup compte 478
If Left(Sheets("feuil1").Cells(i, 1), 3) = 478 Then
Sheets("feuil28").Cells(i, 314) = Sheets("feuil1").Cells(i, 3) 'colonne LB
Else
End If


'ADAPTATION AU SYSCOHADA révisé (immeubles de placement)
'recup compte 2281
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2281 Then
Sheets("feuil28").Cells(i, 320) = Sheets("feuil1").Cells(i, 3) 'colonne LH
Else
End If

'recup compte 29281
If Left(Sheets("feuil1").Cells(i, 1), 5) = 29281 Then
Sheets("feuil28").Cells(i, 321) = Sheets("feuil1").Cells(i, 4) 'colonne LI
Else
End If

'recup compte 2315+2325
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2315 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2325 Then
Sheets("feuil28").Cells(i, 322) = Sheets("feuil1").Cells(i, 3) 'colonne LJ
Else
End If

'recup compte 28315+28325+29315+29325
If Left(Sheets("feuil1").Cells(i, 1), 5) = 28315 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 28325 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 29315 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 29325 Then
Sheets("feuil28").Cells(i, 323) = Sheets("feuil1").Cells(i, 4) 'colonne LK
Else
End If


Next


'Affecte ACTIF DU BILAN
'affecte compte 211+2191+218 poste AE
Sheets("feuil28").Range("a5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("a1:a5000")) 'compte 211
Sheets("feuil28").Range("x5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("x1:x5000")) 'compte 2191
Sheets("feuil5").Range("ae14") = Sheets("feuil28").Range("a5001") + Sheets("feuil28").Range("x5001")
'affecte compte 2811+28181+2911+29181+29191 poste AE
Sheets("feuil28").Range("b5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("b1:b5000")) 'compte 2811
Sheets("feuil28").Range("aa5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("aa1:aa5000")) 'compte 29191
Sheets("feuil5").Range("af14") = Sheets("feuil28").Range("b5001") + Sheets("feuil28").Range("aa5001")
'calcul
Sheets("feuil5").Range("ag14") = Sheets("feuil5").Range("ae14") - Sheets("feuil5").Range("af14")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("b16") = Sheets("feuil5").Range("ae14")

'affecte comptes 212+213+214+2193 poste AF
Sheets("feuil28").Range("c5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("c1:c5000")) 'compte 212
Sheets("feuil28").Range("d5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("d1:d5000")) 'compte 213
Sheets("feuil28").Range("e5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("e1:e5000")) 'compte 214
Sheets("feuil28").Range("y5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("y1:y5000")) 'compte 2193
Sheets("feuil5").Range("ae15") = Sheets("feuil28").Range("c5001") + Sheets("feuil28").Range("d5001") + Sheets("feuil28").Range("e5001") + Sheets("feuil28").Range("y5001")
'affecte comptes 2812+2813+2814 et 2912+2913+2914+29193 poste AF
Sheets("feuil28").Range("f5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("f1:f5000")) 'compte 2812
Sheets("feuil28").Range("g5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("g1:g5000")) 'compte 2813
Sheets("feuil28").Range("h5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("h1:h5000")) 'compte 2814
Sheets("feuil28").Range("i5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("i1:i5000")) 'compte 2912
Sheets("feuil28").Range("j5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("j1:j5000")) 'compte 2913
Sheets("feuil28").Range("k5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("k1:k5000")) 'compte 2914
Sheets("feuil28").Range("ab5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ab1:ab5000")) 'compte 29193
Sheets("feuil5").Range("af15") = Sheets("feuil28").Range("f5001") + Sheets("feuil28").Range("g5001") + Sheets("feuil28").Range("h5001") + Sheets("feuil28").Range("i5001") + Sheets("feuil28").Range("j5001") + Sheets("feuil28").Range("k5001") + Sheets("feuil28").Range("ab5001")
'calcul
Sheets("feuil5").Range("ag15") = Sheets("feuil5").Range("ae15") - Sheets("feuil5").Range("af15")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("b17") = Sheets("feuil5").Range("ae15")

'affecte comptes 215+216 poste AG
Sheets("feuil28").Range("l5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("l1:l5000")) 'compte 215
Sheets("feuil28").Range("m5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("m1:m5000")) 'compte 216
Sheets("feuil5").Range("ae16") = Sheets("feuil28").Range("l5001") + Sheets("feuil28").Range("m5001")
'affecte comptes 2815+2816 et 2915+2916 poste AG
Sheets("feuil28").Range("n5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("n1:n5000")) 'compte 2815
Sheets("feuil28").Range("o5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("o1:o5000")) 'compte 2816
Sheets("feuil28").Range("p5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("p1:p5000")) 'compte 2915
Sheets("feuil28").Range("q5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("q1:q5000")) 'compte 2916
Sheets("feuil5").Range("af16") = Sheets("feuil28").Range("n5001") + Sheets("feuil28").Range("o5001") + Sheets("feuil28").Range("p5001") + Sheets("feuil28").Range("q5001")
'calcul
Sheets("feuil5").Range("ag16") = Sheets("feuil5").Range("ae16") - Sheets("feuil5").Range("af16")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("b18") = Sheets("feuil5").Range("ae16")

'affecte comptes 217+218+2198 poste AH
Sheets("feuil28").Range("r5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("r1:r5000")) 'compte 217
Sheets("feuil28").Range("s5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("s1:s5000")) 'compte 218
Sheets("feuil28").Range("z5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("z1:z5000")) 'compte 2198
Sheets("feuil5").Range("ae17") = Sheets("feuil28").Range("r5001") + Sheets("feuil28").Range("s5001") + Sheets("feuil28").Range("z5001")
'affecte comptes 2817+2818 et 2917+2918 poste AH
Sheets("feuil28").Range("t5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("t1:t5000")) 'compte 2817
Sheets("feuil28").Range("u5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("u1:u5000")) 'compte 2818
Sheets("feuil28").Range("v5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("v1:v5000")) 'compte 2917
Sheets("feuil28").Range("w5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("w1:w5000")) 'compte 2918
Sheets("feuil28").Range("ac5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ac1:ac5000")) 'compte 29198
Sheets("feuil5").Range("af17") = Sheets("feuil28").Range("t5001") + Sheets("feuil28").Range("u5001") + Sheets("feuil28").Range("v5001") + Sheets("feuil28").Range("w5001") + Sheets("feuil28").Range("ac5001")
'calcul
Sheets("feuil5").Range("ag17") = Sheets("feuil5").Range("ae17") - Sheets("feuil5").Range("af17")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("b19") = Sheets("feuil5").Range("ae17")

'affecte comptes 22+229 poste AK
Sheets("feuil28").Range("ad5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ad1:ad5000")) 'compte 22
Sheets("feuil28").Range("be5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("be1:be5000")) 'compte 229
Sheets("feuil5").Range("ae19") = Sheets("feuil28").Range("ad5001") + Sheets("feuil28").Range("be5001")
'affecte comptes 282+292+2929 poste AK
Sheets("feuil28").Range("ae5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ae1:ae5000")) 'compte 282
Sheets("feuil28").Range("af5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("af1:af5000")) 'compte 292
Sheets("feuil28").Range("bh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bh1:bh5000")) 'compte 2929
Sheets("feuil5").Range("af19") = Sheets("feuil28").Range("ae5001") + Sheets("feuil28").Range("af5001") + Sheets("feuil28").Range("bh5001")
'calcul
Sheets("feuil5").Range("ag19") = Sheets("feuil5").Range("ae19") - Sheets("feuil5").Range("af19")
'adaptaion SYSCOHADA révisé (terrains - immeuble de placement)
'affecte bilan comptes 2281-29281 (placements en net)
Sheets("feuil28").Range("lh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lh1:lh5000")) 'compte 2281
Sheets("feuil28").Range("li5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("li1:li5000")) 'compte 29281
'Sheets("feuil5").Range("c21") = Sheets("feuil28").Range("lh5001") - Sheets("feuil28").Range("li5001")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("b22") = Sheets("feuil28").Range("lh5001") 'terrains - immeuble de placement
Sheets("feuil24").Range("b21") = Sheets("feuil5").Range("ae19") - Sheets("feuil28").Range("lh5001") 'terrains hors immeuble de placement

'affecte comptes 231+232+233+237 et 239 sauf 2394+2395+2398 poste AL
Sheets("feuil28").Range("ag5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ag1:ag5000")) 'compte 231
Sheets("feuil28").Range("ah5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ah1:ah5000")) 'compte 232
Sheets("feuil28").Range("ai5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ai1:ai5000")) 'compte 233
Sheets("feuil28").Range("aj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("aj1:aj5000")) 'compte 237
Sheets("feuil28").Range("bf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bf1:bf5000")) 'compte 239
Sheets("feuil5").Range("ae23") = Sheets("feuil28").Range("ag5001") + Sheets("feuil28").Range("ah5001") + Sheets("feuil28").Range("ai5001") + Sheets("feuil28").Range("aj5001") + Sheets("feuil28").Range("bf5001")
'affecte comptes 2831+2832+2833+2837 et 2931+2932+2933+2937 et 2939 sauf 29394+29395+29398 poste AL
Sheets("feuil28").Range("ak5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ak1:ak5000")) 'compte 2831
Sheets("feuil28").Range("al5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("al1:al5000")) 'compte 2832
Sheets("feuil28").Range("am5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("am1:am5000")) 'compte 2833
Sheets("feuil28").Range("an5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("an1:an5000")) 'compte 2837
Sheets("feuil28").Range("ao5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ao1:ao5000")) 'compte 2931
Sheets("feuil28").Range("ap5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ap1:ap5000")) 'compte 2932
Sheets("feuil28").Range("aq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("aq1:aq5000")) 'compte 2933
Sheets("feuil28").Range("ar5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ar1:ar5000")) 'compte 2937
Sheets("feuil28").Range("bi5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bi1:bi5000")) 'compte 2939
Sheets("feuil5").Range("af23") = Sheets("feuil28").Range("ak5001") + Sheets("feuil28").Range("al5001") + Sheets("feuil28").Range("am5001") + Sheets("feuil28").Range("an5001") + Sheets("feuil28").Range("ao5001") + Sheets("feuil28").Range("ap5001") + Sheets("feuil28").Range("aq5001") + Sheets("feuil28").Range("ar5001") + Sheets("feuil28").Range("bi5001")
'calcul
Sheets("feuil5").Range("ag23") = Sheets("feuil5").Range("ae23") - Sheets("feuil5").Range("af23")
'adaptaion SYSCOHADA révisé (bâtiments - immeuble de placement)
'affecte bilan comptes (2315+2325)-(28315+28325+29315+29325) (placements en net)
Sheets("feuil28").Range("lj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lj1:lj5000")) 'comptes 2315+2325
Sheets("feuil28").Range("lk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lk1:lk5000")) 'compte 28315+28325+29315+29325
'Sheets("feuil5").Range("c25") = Sheets("feuil28").Range("lj5001") - Sheets("feuil28").Range("lk5001")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("b24") = Sheets("feuil28").Range("lj5001") 'bâtiments - immeuble de placement
Sheets("feuil24").Range("b23") = Sheets("feuil5").Range("ae23") - Sheets("feuil28").Range("lj5001") 'bâtiments hors immeuble de placement

'affecte comptes 234+235+238 et 2394+2395+2398 poste AM
Sheets("feuil28").Range("as5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("as1:as5000")) 'compte 234
Sheets("feuil28").Range("at5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("at1:at5000")) 'compte 235
Sheets("feuil28").Range("au5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("au1:au5000")) 'compte 238
Sheets("feuil28").Range("jp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jp1:jp5000")) 'compte 2934
Sheets("feuil28").Range("jq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jq1:jq5000")) 'compte 2935
Sheets("feuil28").Range("jr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jr1:jr5000")) 'compte 2938
Sheets("feuil5").Range("ae27") = Sheets("feuil28").Range("as5001") + Sheets("feuil28").Range("at5001") + Sheets("feuil28").Range("au5001") + Sheets("feuil28").Range("jp5001") + Sheets("feuil28").Range("jq5001") + Sheets("feuil28").Range("jr5001")
'affecte comptes 2834+2835+2838 et 2934+2935+2938 et 29394+29395+29398 poste AM
Sheets("feuil28").Range("av5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("av1:av5000")) 'compte 2834
Sheets("feuil28").Range("aw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("aw1:aw5000")) 'compte 2835
Sheets("feuil28").Range("ax5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ax1:ax5000")) 'compte 2838
Sheets("feuil28").Range("ay5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ay1:ay5000")) 'compte 2934
Sheets("feuil28").Range("az5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("az1:az5000")) 'compte 2935
Sheets("feuil28").Range("ba5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ba1:ba5000")) 'compte 2938
Sheets("feuil28").Range("js5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("js1:js5000")) 'compte 29394
Sheets("feuil28").Range("jt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jt1:jt5000")) 'compte 29395
Sheets("feuil28").Range("ju5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ju1:ju5000")) 'compte 29398
Sheets("feuil5").Range("af27") = Sheets("feuil28").Range("av5001") + Sheets("feuil28").Range("aw5001") + Sheets("feuil28").Range("ax5001") + Sheets("feuil28").Range("ay5001") + Sheets("feuil28").Range("az5001") + Sheets("feuil28").Range("ba5001") + Sheets("feuil28").Range("js5001") + Sheets("feuil28").Range("jt5001") + Sheets("feuil28").Range("ju5001")
'calcul
Sheets("feuil5").Range("ag27") = Sheets("feuil5").Range("ae27") - Sheets("feuil5").Range("af27")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("b25") = Sheets("feuil5").Range("ae27")

'affecte comptes 24 (sauf 245) + 249 (sauf 2495) poste AN
Sheets("feuil28").Range("bb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bb1:bb5000")) 'compte 24
Sheets("feuil28").Range("bg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bg1:bg5000")) 'compte 249
Sheets("feuil5").Range("ae28") = Sheets("feuil28").Range("bb5001") + Sheets("feuil28").Range("bg5001")
'affecte comptes 284 et 294 (sauf 2945) + 2949 (sauf 29495) poste AN
Sheets("feuil28").Range("bc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bc1:bc5000")) 'compte 284
Sheets("feuil28").Range("bd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bd1:bd5000")) 'compte 294
Sheets("feuil28").Range("bj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bj1:bj5000")) 'compte 2949
Sheets("feuil5").Range("af28") = Sheets("feuil28").Range("bc5001") + Sheets("feuil28").Range("bd5001") + Sheets("feuil28").Range("bj5001")
'calcul
Sheets("feuil5").Range("ag28") = Sheets("feuil5").Range("ae28") - Sheets("feuil5").Range("af28")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("b26") = Sheets("feuil5").Range("ae28")

'affecte comptes 245 + 2495 poste AN
Sheets("feuil28").Range("jv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jv1:jv5000")) 'compte 245
Sheets("feuil28").Range("jw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jw1:jw5000")) 'compte 2495
Sheets("feuil5").Range("ae29") = Sheets("feuil28").Range("jv5001") + Sheets("feuil28").Range("jw5001")
'affecte comptes 2845 et 2945+29495 poste AN
Sheets("feuil28").Range("jx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jx1:jx5000")) 'compte 2845
Sheets("feuil28").Range("jy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jy1:jy5000")) 'compte 2945
Sheets("feuil28").Range("jz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jz1:jz5000")) 'compte 29495
Sheets("feuil5").Range("af29") = Sheets("feuil28").Range("jx5001") + Sheets("feuil28").Range("jy5001") + Sheets("feuil28").Range("jz5001")
'calcul
Sheets("feuil5").Range("ag29") = Sheets("feuil5").Range("ae29") - Sheets("feuil5").Range("af29")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("b27") = Sheets("feuil5").Range("ae29")

'affecte comptes 25 poste AQ
Sheets("feuil28").Range("bk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bk1:bk5000")) 'compte 25
Sheets("feuil5").Range("ae30") = Sheets("feuil28").Range("bk5001")
'affecte comptes 295 poste AQ
Sheets("feuil28").Range("bl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bl1:bl5000")) 'compte 295
Sheets("feuil5").Range("af30") = Sheets("feuil28").Range("bl5001")
'calcul
Sheets("feuil5").Range("ag30") = Sheets("feuil5").Range("ae30") - Sheets("feuil5").Range("af30")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("b29") = Sheets("feuil5").Range("ae30")

'affecte comptes 26 poste AS
Sheets("feuil28").Range("bm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bm1:bm5000")) 'compte 26
Sheets("feuil5").Range("ae32") = Sheets("feuil28").Range("bm5001")
'affecte comptes 296 poste AS
Sheets("feuil28").Range("bn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bn1:bn5000")) 'compte 296
Sheets("feuil5").Range("af32") = Sheets("feuil28").Range("bn5001")
'calcul
Sheets("feuil5").Range("ag32") = Sheets("feuil5").Range("ae32") - Sheets("feuil5").Range("af32")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("b33") = Sheets("feuil5").Range("ae32")

'affecte comptes 27 poste AT
Sheets("feuil28").Range("bo5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bo1:bo5000")) 'compte 27
Sheets("feuil5").Range("ae33") = Sheets("feuil28").Range("bo5001")
'affecte comptes 297 poste AT
Sheets("feuil28").Range("bp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bp1:bp5000")) 'compte 297
Sheets("feuil5").Range("af33") = Sheets("feuil28").Range("bp5001")
'calcul
Sheets("feuil5").Range("ag33") = Sheets("feuil5").Range("ae33") - Sheets("feuil5").Range("af33")
'affecte tableau 1 - Actif immobilisé
Sheets("feuil24").Range("b34") = Sheets("feuil5").Range("ae33")

'affecte comptes 3 poste BB
Sheets("feuil28").Range("bq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bq1:bq5000")) 'compte 3
Sheets("feuil5").Range("ae36") = Sheets("feuil28").Range("bq5001")
'affecte comptes 39 poste BB
Sheets("feuil28").Range("br5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("br1:br5000")) 'compte 39
Sheets("feuil5").Range("af36") = Sheets("feuil28").Range("br5001")
'calcul
Sheets("feuil5").Range("ag36") = Sheets("feuil5").Range("ae36") - Sheets("feuil5").Range("af36")


edite_bilan_n_2_suite


End Sub
Private Sub edite_bilan_n_2_suite()

For i = 3 To 5000
'recup compte 409
If Left(Sheets("feuil1").Cells(i, 1), 3) = 409 Then 'compte 409
Sheets("feuil28").Cells(i, 71) = Sheets("feuil1").Cells(i, 3) 'colonne BS
Else
End If

'recup compte 490
If Left(Sheets("feuil1").Cells(i, 1), 3) = 490 Then 'compte 490
Sheets("feuil28").Cells(i, 72) = Sheets("feuil1").Cells(i, 4) 'colonne BT
Else
End If

'recup compte 41
If Left(Sheets("feuil1").Cells(i, 1), 2) = 41 Then 'compte 41 sauf 419
If Left(Sheets("feuil1").Cells(i, 1), 3) = 419 Then
Else
Sheets("feuil28").Cells(i, 73) = Sheets("feuil1").Cells(i, 3) 'colonne BU
End If
Else
End If

'recup compte 491
If Left(Sheets("feuil1").Cells(i, 1), 3) = 491 Then 'compte 491
Sheets("feuil28").Cells(i, 74) = Sheets("feuil1").Cells(i, 4) 'colonne BV
Else
End If

'recup compte 42
If Left(Sheets("feuil1").Cells(i, 1), 2) = 42 Then 'compte 42
Sheets("feuil28").Cells(i, 75) = Sheets("feuil1").Cells(i, 3) 'colonne BW
Else
End If

'recup compte 43
If Left(Sheets("feuil1").Cells(i, 1), 2) = 43 Then 'compte 43
Sheets("feuil28").Cells(i, 76) = Sheets("feuil1").Cells(i, 3) 'colonne BX
Else
End If

'recup compte 44
If Left(Sheets("feuil1").Cells(i, 1), 2) = 44 Then 'compte 44
Sheets("feuil28").Cells(i, 77) = Sheets("feuil1").Cells(i, 3) 'colonne BY
Else
End If

'recup compte 45
If Left(Sheets("feuil1").Cells(i, 1), 2) = 45 Then 'compte 45
Sheets("feuil28").Cells(i, 78) = Sheets("feuil1").Cells(i, 3) 'colonne BZ
Else
End If

'recup compte 46
If Left(Sheets("feuil1").Cells(i, 1), 2) = 46 Then 'compte 46
Sheets("feuil28").Cells(i, 79) = Sheets("feuil1").Cells(i, 3) 'colonne CA
Else
End If

'recup compte 47
If Left(Sheets("feuil1").Cells(i, 1), 2) = 47 Then 'compte 47
If Left(Sheets("feuil1").Cells(i, 1), 3) = 479 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 3) = 478 Then
Else
Sheets("feuil28").Cells(i, 80) = Sheets("feuil1").Cells(i, 3) 'colonne CB
End If
End If
Else
End If

'recup compte 48
If Left(Sheets("feuil1").Cells(i, 1), 2) = 48 Then 'compte 48
Sheets("feuil28").Cells(i, 81) = Sheets("feuil1").Cells(i, 3) 'colonne CC
Else
End If

'recup compte 492
If Left(Sheets("feuil1").Cells(i, 1), 3) = 492 Then 'compte 492
Sheets("feuil28").Cells(i, 82) = Sheets("feuil1").Cells(i, 4) 'colonne CD
Else
End If

'recup compte 493
If Left(Sheets("feuil1").Cells(i, 1), 3) = 493 Then 'compte 493
Sheets("feuil28").Cells(i, 83) = Sheets("feuil1").Cells(i, 4) 'colonne CE
Else
End If

'recup compte 494
If Left(Sheets("feuil1").Cells(i, 1), 3) = 494 Then 'compte 494
Sheets("feuil28").Cells(i, 84) = Sheets("feuil1").Cells(i, 4) 'colonne CF
Else
End If

'recup compte 495
If Left(Sheets("feuil1").Cells(i, 1), 3) = 495 Then 'compte 495
Sheets("feuil28").Cells(i, 85) = Sheets("feuil1").Cells(i, 4) 'colonne CG
Else
End If

'recup compte 496
If Left(Sheets("feuil1").Cells(i, 1), 3) = 496 Then 'compte 496
Sheets("feuil28").Cells(i, 86) = Sheets("feuil1").Cells(i, 4) 'colonne CH
Else
End If

'adaptation SYSCOHADA révisé recup compte 497 + 4986
If Left(Sheets("feuil1").Cells(i, 1), 3) = 497 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4986 Then 'compte 497
Sheets("feuil28").Cells(i, 87) = Sheets("feuil1").Cells(i, 4) 'colonne CI
Else
End If

'adaptation SYSCOHADA révisé recup compte 498 sauf 4986
If Left(Sheets("feuil1").Cells(i, 1), 3) = 498 Then 'compte 498
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4986 Then
Else
Sheets("feuil28").Cells(i, 88) = Sheets("feuil1").Cells(i, 4) 'colonne CJ
End If
Else
End If

'recup compte 50
If Left(Sheets("feuil1").Cells(i, 1), 2) = 50 Then 'compte 50
Sheets("feuil28").Cells(i, 89) = Sheets("feuil1").Cells(i, 3) 'colonne CK
Else
End If

'recup compte 590
If Left(Sheets("feuil1").Cells(i, 1), 3) = 590 Then 'compte 590
Sheets("feuil28").Cells(i, 90) = Sheets("feuil1").Cells(i, 4) 'colonne CL
Else
End If

'recup compte 51
If Left(Sheets("feuil1").Cells(i, 1), 2) = 51 Then 'compte 51
Sheets("feuil28").Cells(i, 91) = Sheets("feuil1").Cells(i, 3) 'colonne CM
Else
End If

'recup compte 52
If Left(Sheets("feuil1").Cells(i, 1), 2) = 52 Then 'compte 52
Sheets("feuil28").Cells(i, 92) = Sheets("feuil1").Cells(i, 3) 'colonne CN
Else
End If

'recup compte 53
If Left(Sheets("feuil1").Cells(i, 1), 2) = 53 Then 'compte 53
Sheets("feuil28").Cells(i, 93) = Sheets("feuil1").Cells(i, 3) 'colonne CO
Else
End If

'recup compte 54
If Left(Sheets("feuil1").Cells(i, 1), 2) = 54 Then 'compte 54
Sheets("feuil28").Cells(i, 94) = Sheets("feuil1").Cells(i, 3) 'colonne CP
Else
End If

'recup compte 57+55
If Left(Sheets("feuil1").Cells(i, 1), 2) = 57 Or Left(Sheets("feuil1").Cells(i, 1), 2) = 55 Then 'compte 57+55
Sheets("feuil28").Cells(i, 95) = Sheets("feuil1").Cells(i, 3) 'colonne CQ
Else
End If

'recup compte 581
If Left(Sheets("feuil1").Cells(i, 1), 3) = 581 Then 'compte 581
Sheets("feuil28").Cells(i, 96) = Sheets("feuil1").Cells(i, 3) 'colonne CR
Else
End If

'recup compte 582
If Left(Sheets("feuil1").Cells(i, 1), 3) = 582 Then 'compte 582
Sheets("feuil28").Cells(i, 97) = Sheets("feuil1").Cells(i, 3) 'colonne CS
Else
End If

'recup compte 591
If Left(Sheets("feuil1").Cells(i, 1), 3) = 591 Then 'compte 591
Sheets("feuil28").Cells(i, 98) = Sheets("feuil1").Cells(i, 4) 'colonne CT
Else
End If

'recup compte 592
If Left(Sheets("feuil1").Cells(i, 1), 3) = 592 Then 'compte 592
Sheets("feuil28").Cells(i, 99) = Sheets("feuil1").Cells(i, 4) 'colonne CU
Else
End If

'recup compte 593
If Left(Sheets("feuil1").Cells(i, 1), 3) = 593 Then 'compte 593
Sheets("feuil28").Cells(i, 100) = Sheets("feuil1").Cells(i, 4) 'colonne CV
Else
End If

'recup compte 594
If Left(Sheets("feuil1").Cells(i, 1), 3) = 594 Then 'compte 594
Sheets("feuil28").Cells(i, 101) = Sheets("feuil1").Cells(i, 4) 'colonne CW
Else
End If


'recup PASSIF BILAN
'recup compte 101
If Left(Sheets("feuil1").Cells(i, 1), 3) = 101 Then 'compte 101
Sheets("feuil28").Cells(i, 102) = Sheets("feuil1").Cells(i, 4) 'colonne CX
Else
End If

'recup compte 102
If Left(Sheets("feuil1").Cells(i, 1), 3) = 102 Then 'compte 102
Sheets("feuil28").Cells(i, 103) = Sheets("feuil1").Cells(i, 4) 'colonne CY
Else
End If

'recup compte 103
If Left(Sheets("feuil1").Cells(i, 1), 3) = 103 Then 'compte 103
Sheets("feuil28").Cells(i, 104) = Sheets("feuil1").Cells(i, 4) 'colonne CZ
Else
End If

'recup compte 104c
If Left(Sheets("feuil1").Cells(i, 1), 3) = 104 Then 'compte 104c
Sheets("feuil28").Cells(i, 105) = Sheets("feuil1").Cells(i, 4) 'colonne DA
Else
End If

'recup compte 104d
If Left(Sheets("feuil1").Cells(i, 1), 3) = 104 Then 'compte 104d
Sheets("feuil28").Cells(i, 106) = Sheets("feuil1").Cells(i, 3) 'colonne DB
Else
End If

'recup compte 109
If Left(Sheets("feuil1").Cells(i, 1), 3) = 109 Then 'compte 109
Sheets("feuil28").Cells(i, 107) = Sheets("feuil1").Cells(i, 3) 'colonne DC
Else
End If

'recup compte 105
If Left(Sheets("feuil1").Cells(i, 1), 3) = 105 Then 'compte 105
Sheets("feuil28").Cells(i, 108) = Sheets("feuil1").Cells(i, 4) 'colonne DD
Else
End If

'recup compte 106
If Left(Sheets("feuil1").Cells(i, 1), 3) = 106 Then 'compte 106
Sheets("feuil28").Cells(i, 109) = Sheets("feuil1").Cells(i, 4) 'colonne DE
Else
End If

'recup compte 111
If Left(Sheets("feuil1").Cells(i, 1), 3) = 111 Then 'compte 111
Sheets("feuil28").Cells(i, 110) = Sheets("feuil1").Cells(i, 4) 'colonne DF
Else
End If

'recup compte 112
If Left(Sheets("feuil1").Cells(i, 1), 3) = 112 Then 'compte 112
Sheets("feuil28").Cells(i, 111) = Sheets("feuil1").Cells(i, 4) 'colonne DG
Else
End If

'recup compte 113
If Left(Sheets("feuil1").Cells(i, 1), 3) = 113 Then 'compte 113
Sheets("feuil28").Cells(i, 112) = Sheets("feuil1").Cells(i, 4) 'colonne DH
Else
End If

'recup compte 118
If Left(Sheets("feuil1").Cells(i, 1), 3) = 118 Then 'compte 118
Sheets("feuil28").Cells(i, 113) = Sheets("feuil1").Cells(i, 4) 'colonne DI
Else
End If

'recup compte 121
If Left(Sheets("feuil1").Cells(i, 1), 3) = 121 Then 'compte 121
Sheets("feuil28").Cells(i, 114) = Sheets("feuil1").Cells(i, 4) 'colonne DJ
Else
End If

'recup compte 129
If Left(Sheets("feuil1").Cells(i, 1), 3) = 129 Then 'compte 129
Sheets("feuil28").Cells(i, 115) = Sheets("feuil1").Cells(i, 3) 'colonne DK
Else
End If


'recup compte 15
If Left(Sheets("feuil1").Cells(i, 1), 2) = 15 Then 'compte 15
Sheets("feuil28").Cells(i, 120) = Sheets("feuil1").Cells(i, 4) 'colonne DP
Else
End If

'recup compte 14
If Left(Sheets("feuil1").Cells(i, 1), 2) = 14 Then 'compte 14
Sheets("feuil28").Cells(i, 121) = Sheets("feuil1").Cells(i, 4) 'colonne DQ
Else
End If

'recup compte 16
If Left(Sheets("feuil1").Cells(i, 1), 2) = 16 Then 'compte 16
Sheets("feuil28").Cells(i, 122) = Sheets("feuil1").Cells(i, 4) 'colonne DR
Else
End If

'recup compte 18
If Left(Sheets("feuil1").Cells(i, 1), 2) = 18 Then 'compte 18
Sheets("feuil28").Cells(i, 123) = Sheets("feuil1").Cells(i, 4) 'colonne DS
Else
End If

'recup compte 17
If Left(Sheets("feuil1").Cells(i, 1), 2) = 17 Then 'compte 17
Sheets("feuil28").Cells(i, 124) = Sheets("feuil1").Cells(i, 4) 'colonne DT
Else
End If

'recup compte 19
If Left(Sheets("feuil1").Cells(i, 1), 2) = 19 Then 'compte 19
Sheets("feuil28").Cells(i, 125) = Sheets("feuil1").Cells(i, 4) 'colonne DU
Else
End If

'recup compte 419
If Left(Sheets("feuil1").Cells(i, 1), 3) = 419 Then 'compte 419
Sheets("feuil28").Cells(i, 126) = Sheets("feuil1").Cells(i, 4) 'colonne DV
Else
End If

'recup compte 401
If Left(Sheets("feuil1").Cells(i, 1), 3) = 401 Then 'compte 401
Sheets("feuil28").Cells(i, 127) = Sheets("feuil1").Cells(i, 4) 'colonne DW
Else
End If

'recup compte 402
If Left(Sheets("feuil1").Cells(i, 1), 3) = 402 Then 'compte 402
Sheets("feuil28").Cells(i, 128) = Sheets("feuil1").Cells(i, 4) 'colonne DX
Else
End If

'recup compte 408+404
If Left(Sheets("feuil1").Cells(i, 1), 3) = 408 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 404 Then 'compte 408
Sheets("feuil28").Cells(i, 129) = Sheets("feuil1").Cells(i, 4) 'colonne DY
Else
End If

'recup compte 42
If Left(Sheets("feuil1").Cells(i, 1), 2) = 42 Then 'compte 42
Sheets("feuil28").Cells(i, 130) = Sheets("feuil1").Cells(i, 4) 'colonne DZ
Else
End If

'recup compte 43
If Left(Sheets("feuil1").Cells(i, 1), 2) = 43 Then 'compte 43
Sheets("feuil28").Cells(i, 131) = Sheets("feuil1").Cells(i, 4) 'colonne EA
Else
End If

'recup compte 44
If Left(Sheets("feuil1").Cells(i, 1), 2) = 44 Then 'compte 44
Sheets("feuil28").Cells(i, 132) = Sheets("feuil1").Cells(i, 4) 'colonne EB
Else
End If

'recup compte 45
If Left(Sheets("feuil1").Cells(i, 1), 2) = 45 Then 'compte 45
Sheets("feuil28").Cells(i, 133) = Sheets("feuil1").Cells(i, 4) 'colonne EC
Else
End If

'recup compte 46
If Left(Sheets("feuil1").Cells(i, 1), 2) = 46 Then 'compte 46
Sheets("feuil28").Cells(i, 134) = Sheets("feuil1").Cells(i, 4) 'colonne ED
Else
End If

'recup compte 47
If Left(Sheets("feuil1").Cells(i, 1), 2) = 47 Then 'compte 47
If Left(Sheets("feuil1").Cells(i, 1), 3) = 479 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 3) = 478 Then
Else
Sheets("feuil28").Cells(i, 135) = Sheets("feuil1").Cells(i, 4) 'colonne EE
End If
End If
Else
End If

'recup compte 48
If Left(Sheets("feuil1").Cells(i, 1), 2) = 48 Then 'compte 48
Sheets("feuil28").Cells(i, 136) = Sheets("feuil1").Cells(i, 4) 'colonne EF
Else
End If

'recup compte 499
If Left(Sheets("feuil1").Cells(i, 1), 3) = 499 Then 'compte 499
Sheets("feuil28").Cells(i, 137) = Sheets("feuil1").Cells(i, 4) 'colonne EG
Else
End If

'recup compte 599
If Left(Sheets("feuil1").Cells(i, 1), 3) = 599 Then 'compte 599
Sheets("feuil28").Cells(i, 138) = Sheets("feuil1").Cells(i, 4) 'colonne EH
Else
End If

'recup compte 564
If Left(Sheets("feuil1").Cells(i, 1), 3) = 564 Then 'compte 564
Sheets("feuil28").Cells(i, 139) = Sheets("feuil1").Cells(i, 4) 'colonne EI
Else
End If

'recup compte 565
If Left(Sheets("feuil1").Cells(i, 1), 3) = 565 Then 'compte 565
Sheets("feuil28").Cells(i, 140) = Sheets("feuil1").Cells(i, 4) 'colonne EJ
Else
End If

'recup compte 52c
If Left(Sheets("feuil1").Cells(i, 1), 2) = 52 Then 'compte 52
Sheets("feuil28").Cells(i, 141) = Sheets("feuil1").Cells(i, 4) 'colonne EK
Else
End If

'recup compte 561
If Left(Sheets("feuil1").Cells(i, 1), 3) = 561 Then 'compte 561
Sheets("feuil28").Cells(i, 142) = Sheets("feuil1").Cells(i, 4) 'colonne EL
Else
End If

'recup compte 566
If Left(Sheets("feuil1").Cells(i, 1), 3) = 566 Then 'compte 566
Sheets("feuil28").Cells(i, 143) = Sheets("feuil1").Cells(i, 4) 'colonne EM
Else
End If

'RATTRAPAGE DES COMPTES 53c et 54c
'recup compte 53c
If Left(Sheets("feuil1").Cells(i, 1), 2) = 53 Then
Sheets("feuil28").Cells(i, 274) = Sheets("feuil1").Cells(i, 4) 'colonne JN
Else
End If
'recup compte 54c
If Left(Sheets("feuil1").Cells(i, 1), 2) = 54 Then
Sheets("feuil28").Cells(i, 275) = Sheets("feuil1").Cells(i, 4) 'colonne JO
Else
End If

'recup compte 479
If Left(Sheets("feuil1").Cells(i, 1), 3) = 479 Then
Sheets("feuil28").Cells(i, 315) = Sheets("feuil1").Cells(i, 4) 'colonne LC
Else
End If



Next


'adaptation syscohada compte 48 H.A.O
Sheets("feuil28").Range("cc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cc1:cc5000")) 'compte 48
Sheets("feuil5").Range("ae35") = Sheets("feuil28").Range("cc5001")
'adaptation syscohada compte 498 H.A.O
Sheets("feuil28").Range("cj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cj1:cj5000")) 'compte 498
Sheets("feuil5").Range("af35") = Sheets("feuil28").Range("cj5001")
'calcul
Sheets("feuil5").Range("ag35") = Sheets("feuil5").Range("ae35") - Sheets("feuil5").Range("af35")

'affecte comptes 409 poste BH
Sheets("feuil28").Range("bs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bs1:bs5000")) 'compte 409
Sheets("feuil5").Range("ae38") = Sheets("feuil28").Range("bs5001")
'affecte comptes 490 poste BH
Sheets("feuil28").Range("bt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bt1:bt5000")) 'compte 490
Sheets("feuil5").Range("af38") = Sheets("feuil28").Range("bt5001")
'calcul
Sheets("feuil5").Range("ag38") = Sheets("feuil5").Range("ae38") - Sheets("feuil5").Range("af38")

'affecte comptes 41 poste BI
Sheets("feuil28").Range("bu5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bu1:bu5000")) 'compte 41
Sheets("feuil5").Range("ae39") = Sheets("feuil28").Range("bu5001")
'affecte comptes 491 poste BI
Sheets("feuil28").Range("bv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bv1:bv5000")) 'compte 491
Sheets("feuil5").Range("af39") = Sheets("feuil28").Range("bv5001")
'calcul
Sheets("feuil5").Range("ag39") = Sheets("feuil5").Range("ae39") - Sheets("feuil5").Range("af39")

'affecte comptes 42+43+44+45+46+47 sauf 48 poste BJ
Sheets("feuil28").Range("bw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bw1:bw5000")) 'compte 42
Sheets("feuil28").Range("bx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bx1:bx5000")) 'compte 43
Sheets("feuil28").Range("by5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("by1:by5000")) 'compte 44
Sheets("feuil28").Range("bz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("bz1:bz5000")) 'compte 45
Sheets("feuil28").Range("ca5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ca1:ca5000")) 'compte 46
Sheets("feuil28").Range("cb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cb1:cb5000")) 'compte 47
'Sheets("feuil28").Range("cc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cc1:cc5000")) 'compte 48
Sheets("feuil5").Range("ae40") = Sheets("feuil28").Range("bw5001") + Sheets("feuil28").Range("bx5001") + Sheets("feuil28").Range("by5001") + Sheets("feuil28").Range("bz5001") + Sheets("feuil28").Range("ca5001") + Sheets("feuil28").Range("cb5001") '+ Sheets("feuil28").Range("cc5001")
'affecte comptes 492+493+494+495+496+497 sauf 498 poste BJ
Sheets("feuil28").Range("cd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cd1:cd5000")) 'compte 492
Sheets("feuil28").Range("ce5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ce1:ce5000")) 'compte 493
Sheets("feuil28").Range("cf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cf1:cf5000")) 'compte 494
Sheets("feuil28").Range("cg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cg1:cg5000")) 'compte 495
Sheets("feuil28").Range("ch5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ch1:ch5000")) 'compte 496
Sheets("feuil28").Range("ci5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ci1:ci5000")) 'compte 497
'Sheets("feuil28").Range("cj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cj1:cj5000")) 'compte 498
Sheets("feuil5").Range("af40") = Sheets("feuil28").Range("cd5001") + Sheets("feuil28").Range("ce5001") + Sheets("feuil28").Range("cf5001") + Sheets("feuil28").Range("cg5001") + Sheets("feuil28").Range("ch5001") + Sheets("feuil28").Range("ci5001") '+ Sheets("feuil28").Range("cj5001")
'calcul
Sheets("feuil5").Range("ag40") = Sheets("feuil5").Range("ae40") - Sheets("feuil5").Range("af40")

'adaptation syscohada compte 478 ECA
Sheets("feuil28").Range("lb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lb1:lb5000")) 'compte 478
Sheets("feuil5").Range("ae46") = Sheets("feuil28").Range("lb5001")
'calcul
Sheets("feuil5").Range("ag46") = Sheets("feuil5").Range("ae46") - Sheets("feuil5").Range("af46")


'affecte comptes 50 poste BQ
Sheets("feuil28").Range("ck5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ck1:ck5000")) 'compte 50
Sheets("feuil5").Range("ae42") = Sheets("feuil28").Range("ck5001")
'affecte comptes 590 poste BQ
Sheets("feuil28").Range("cl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cl1:cl5000")) 'compte 590
Sheets("feuil5").Range("af42") = Sheets("feuil28").Range("cl5001")
'calcul
Sheets("feuil5").Range("ag42") = Sheets("feuil5").Range("ae42") - Sheets("feuil5").Range("af42")

'adaptation syscohada compte 51 poste BS
Sheets("feuil28").Range("cm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cm1:cm5000")) 'compte 51
Sheets("feuil5").Range("ae43") = Sheets("feuil28").Range("cm5001")
'adaptation syscohada compte 591 poste BS
Sheets("feuil28").Range("ct5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ct1:ct5000")) 'compte 591
Sheets("feuil5").Range("af43") = Sheets("feuil28").Range("ct5001")
'calcul
Sheets("feuil5").Range("ag43") = Sheets("feuil5").Range("ae43") - Sheets("feuil5").Range("af43")

'affecte comptes 52+53+54+57+581+582 poste BS
'Sheets("feuil28").Range("cm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cm1:cm5000")) 'compte 51
Sheets("feuil28").Range("cn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cn1:cn5000")) 'compte 52
Sheets("feuil28").Range("co5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("co1:co5000")) 'compte 53
Sheets("feuil28").Range("cp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cp1:cp5000")) 'compte 54
Sheets("feuil28").Range("cq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cq1:cq5000")) 'compte 57
Sheets("feuil28").Range("cr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cr1:cr5000")) 'compte 581
Sheets("feuil28").Range("cs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cs1:cs5000")) 'compte 582
Sheets("feuil5").Range("ae44") = Sheets("feuil28").Range("cn5001") + Sheets("feuil28").Range("co5001") + Sheets("feuil28").Range("cp5001") + Sheets("feuil28").Range("cq5001") + Sheets("feuil28").Range("cr5001") + Sheets("feuil28").Range("cs5001")
'affecte comptes 592+593+594 poste BS
'Sheets("feuil28").Range("ct5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ct1:ct5000")) 'compte 591
Sheets("feuil28").Range("cu5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cu1:cu5000")) 'compte 592
Sheets("feuil28").Range("cv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cv1:cv5000")) 'compte 593
Sheets("feuil28").Range("cw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cw1:cw5000")) 'compte 594
Sheets("feuil5").Range("af44") = Sheets("feuil28").Range("cu5001") + Sheets("feuil28").Range("cv5001") + Sheets("feuil28").Range("cw5001")
'calcul
Sheets("feuil5").Range("ag44") = Sheets("feuil5").Range("ae44") - Sheets("feuil5").Range("af44")

'_______________________________________________________________________________________________

'calcul TOTAUX DE L'ACTIF
'total actif immobilisé
Sheets("feuil5").Range("ae34") = WorksheetFunction.Sum(Sheets("feuil5").Range("ae14:ae33")) 'montants bruts
Sheets("feuil5").Range("af34") = WorksheetFunction.Sum(Sheets("feuil5").Range("af14:af33")) 'Amorts et provisions
Sheets("feuil5").Range("ag34") = WorksheetFunction.Sum(Sheets("feuil5").Range("ag14:ag33")) 'montants nets

'total actif circulant
Sheets("feuil5").Range("ae41") = WorksheetFunction.Sum(Sheets("feuil5").Range("ae35:ae40")) 'montants bruts
Sheets("feuil5").Range("af41") = WorksheetFunction.Sum(Sheets("feuil5").Range("af35:af40")) 'Amorts et provisions
Sheets("feuil5").Range("ag41") = WorksheetFunction.Sum(Sheets("feuil5").Range("ag35:ag40")) 'montants nets

'total trésorerie actif
Sheets("feuil5").Range("ae45") = WorksheetFunction.Sum(Sheets("feuil5").Range("ae42:ae44")) 'montants bruts
Sheets("feuil5").Range("af45") = WorksheetFunction.Sum(Sheets("feuil5").Range("af42:af44")) 'Amorts et provisions
Sheets("feuil5").Range("ag45") = WorksheetFunction.Sum(Sheets("feuil5").Range("ag42:ag44")) 'montants nets

'total général actif
Sheets("feuil5").Range("ae47") = Sheets("feuil5").Range("ae34") + Sheets("feuil5").Range("ae41") + Sheets("feuil5").Range("ae45") + Sheets("feuil5").Range("ae46") 'montants bruts
Sheets("feuil5").Range("af47") = Sheets("feuil5").Range("af34") + Sheets("feuil5").Range("af41") + Sheets("feuil5").Range("af45") + Sheets("feuil5").Range("af46") 'Amorts et provisions
Sheets("feuil5").Range("ag47") = Sheets("feuil5").Range("ag34") + Sheets("feuil5").Range("ag41") + Sheets("feuil5").Range("ag45") + Sheets("feuil5").Range("ag46") 'montants nets

'________________________________________________________________________________________

'affecte PASSIF BILAN
'affecte comptes 101+102+103+104(c/d) poste CA
Sheets("feuil28").Range("cx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cx1:cx5000")) 'compte 101
Sheets("feuil28").Range("cy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cy1:cy5000")) 'compte 102
Sheets("feuil28").Range("cz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("cz1:cz5000")) 'compte 103
Sheets("feuil28").Range("da5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("da1:da5000")) 'compte 104c
Sheets("feuil28").Range("db5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("db1:db5000")) 'compte 104d
Sheets("feuil5").Range("am13") = Sheets("feuil28").Range("cx5001") + Sheets("feuil28").Range("cy5001") + Sheets("feuil28").Range("cz5001") + Sheets("feuil28").Range("da5001") - Sheets("feuil28").Range("db5001")

'affecte comptes 109 poste CB
Sheets("feuil28").Range("dc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dc1:dc5000")) 'compte 109
Sheets("feuil5").Range("am14") = -Sheets("feuil28").Range("dc5001")

'affecte comptes 105 poste CD
Sheets("feuil28").Range("dd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dd1:dd5000")) 'compte 105
Sheets("feuil5").Range("am15") = Sheets("feuil28").Range("dd5001")

'affecte comptes 106 poste CE
Sheets("feuil28").Range("de5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("de1:de5000")) 'compte 106
Sheets("feuil5").Range("am16") = Sheets("feuil28").Range("de5001")

'affecte comptes 111+112+113 poste CF
Sheets("feuil28").Range("df5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("df1:df5000")) 'compte 111
Sheets("feuil28").Range("dg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dg1:dg5000")) 'compte 112
Sheets("feuil28").Range("dh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dh1:dh5000")) 'compte 113
Sheets("feuil5").Range("am17") = Sheets("feuil28").Range("df5001") + Sheets("feuil28").Range("dg5001") + Sheets("feuil28").Range("dh5001")

'affecte comptes 118 poste CG
Sheets("feuil28").Range("di5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("di1:di5000")) 'compte 118
Sheets("feuil5").Range("am18") = Sheets("feuil28").Range("di5001")

'affecte comptes 121+129 poste CH
Sheets("feuil28").Range("dj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dj1:dj5000")) 'compte 121
Sheets("feuil28").Range("dk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dk1:dk5000")) 'compte 129
Sheets("feuil5").Range("am19") = Sheets("feuil28").Range("dj5001") - Sheets("feuil28").Range("dk5001")

'affecte comptes 15 poste CM
Sheets("feuil28").Range("dp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dp1:dp5000")) 'compte 15
Sheets("feuil5").Range("am25") = Sheets("feuil28").Range("dp5001")

'affecte comptes 14 poste CL
Sheets("feuil28").Range("dq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dq1:dq5000")) 'compte 478
Sheets("feuil5").Range("am24") = Sheets("feuil28").Range("dq5001")

'affecte comptes 16 poste DA
Sheets("feuil28").Range("dr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dr1:dr5000")) 'compte 16
Sheets("feuil28").Range("ds5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ds1:ds5000")) 'compte 18
Sheets("feuil5").Range("am30") = Sheets("feuil28").Range("dr5001") + Sheets("feuil28").Range("ds5001")

'affecte comptes 17 poste DB
Sheets("feuil28").Range("dt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dt1:dt5000")) 'compte 17
Sheets("feuil5").Range("am31") = Sheets("feuil28").Range("dt5001")

'affecte comptes 19 poste DD
Sheets("feuil28").Range("du5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("du1:du5000")) 'compte 19
Sheets("feuil5").Range("am32") = Sheets("feuil28").Range("du5001")

'affecte comptes 419 poste DI
Sheets("feuil28").Range("dv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dv1:dv5000")) 'compte 419
Sheets("feuil5").Range("am36") = Sheets("feuil28").Range("dv5001")

'affecte comptes 401+402+408+404 poste DJ
Sheets("feuil28").Range("dw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dw1:dw5000")) 'compte 401
Sheets("feuil28").Range("dx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dx1:dx5000")) 'compte 402
Sheets("feuil28").Range("dy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dy1:dy5000")) 'compte 408
Sheets("feuil5").Range("am37") = Sheets("feuil28").Range("dw5001") + Sheets("feuil28").Range("dx5001") + Sheets("feuil28").Range("dy5001")

'adaptation syscohada compte 48 H.A.O
Sheets("feuil28").Range("ef5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ef1:ef5000")) 'compte 48
Sheets("feuil5").Range("am35") = Sheets("feuil28").Range("ef5001")

'affecte comptes 42+43+44 poste DK
Sheets("feuil28").Range("dz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("dz1:dz5000")) 'compte 42
Sheets("feuil28").Range("ea5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ea1:ea5000")) 'compte 43
Sheets("feuil28").Range("eb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eb1:eb5000")) 'compte 44
Sheets("feuil5").Range("am38") = Sheets("feuil28").Range("dz5001") + Sheets("feuil28").Range("ea5001") + Sheets("feuil28").Range("eb5001")


'affecte comptes 45+46+47 poste DM
Sheets("feuil28").Range("ec5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ec1:ec5000")) 'compte 45
Sheets("feuil28").Range("ed5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ed1:ed5000")) 'compte 46
Sheets("feuil28").Range("ee5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ee1:ee5000")) 'compte 47
'Sheets("feuil28").Range("ef5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ef1:ef5000")) 'compte 48
Sheets("feuil5").Range("am39") = Sheets("feuil28").Range("ec5001") + Sheets("feuil28").Range("ed5001") + Sheets("feuil28").Range("ee5001") '+ Sheets("feuil28").Range("ef5001")

'affecte comptes 499+599 poste DN
Sheets("feuil28").Range("eg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eg1:eg5000")) 'compte 499
Sheets("feuil28").Range("eh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("eh1:eh5000")) 'compte 599
Sheets("feuil5").Range("am40") = Sheets("feuil28").Range("eg5001") + Sheets("feuil28").Range("eh5001")

'affecte comptes 564+565 poste DQ
Sheets("feuil28").Range("ei5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ei1:ei5000")) 'compte 564
Sheets("feuil28").Range("ej5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ej1:ej5000")) 'compte 565
Sheets("feuil5").Range("am43") = Sheets("feuil28").Range("ei5001") + Sheets("feuil28").Range("ej5001")

'affecte comptes 52+(53+54 rattrapés) poste DS
Sheets("feuil28").Range("ek5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ek1:ek5000")) 'compte 52
Sheets("feuil28").Range("jn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jn1:jn5000")) 'compte 53c rattrapage
Sheets("feuil28").Range("jo5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jo1:jo5000")) 'compte 54c rattrapage
Sheets("feuil28").Range("el5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("el1:el5000")) 'compte 561
Sheets("feuil28").Range("em5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("em1:em5000")) 'compte 566
Sheets("feuil5").Range("am44") = Sheets("feuil28").Range("ek5001") + Sheets("feuil28").Range("jn5001") + Sheets("feuil28").Range("jo5001") + Sheets("feuil28").Range("el5001") + Sheets("feuil28").Range("em5001")

'adaptation syscohada compte 479 ECP
Sheets("feuil28").Range("lc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("lc1:lc5000")) 'compte 479
Sheets("feuil5").Range("am46") = Sheets("feuil28").Range("lc5001")

'___________________________________________________________________________________________________________

'calcul TOTAUX DU PASSIF
'récupération d'abord du résultat à partir du compte de résultat
'Sheets("feuil5").Range("m21") = Sheets("feuil6").Range("j54")

'calcul total capitaux propres
Sheets("feuil5").Range("am28") = WorksheetFunction.Sum(Sheets("feuil5").Range("am13:am25"))

'calcul total dettes financières
Sheets("feuil5").Range("am33") = WorksheetFunction.Sum(Sheets("feuil5").Range("am30:am32"))

'calcul total ressources stables
Sheets("feuil5").Range("am34") = Sheets("feuil5").Range("am28") + Sheets("feuil5").Range("am33")

'calcul total passif circulant
Sheets("feuil5").Range("am41") = WorksheetFunction.Sum(Sheets("feuil5").Range("am35:am40"))

'calcul total trésorerie passif
Sheets("feuil5").Range("am45") = WorksheetFunction.Sum(Sheets("feuil5").Range("am43:am44"))

'calcul total général passif
Sheets("feuil5").Range("am47") = Sheets("feuil5").Range("am34") + Sheets("feuil5").Range("am41") + Sheets("feuil5").Range("am45") + Sheets("feuil5").Range("am46")

'_______________________________________________________________________________________



'efface les données sur la feuil28
Sheets("feuil28").Range("a1:za5001").ClearContents
End Sub
Private Sub edite_tafire_n()
'animationv1
'mise en forme conditionnelle
Sheets("feuil28").Range("zc18") = 1

'délai d'essai
date_test = Now()
If Year(2020) > 2017 Then
MsgBox "Délai d'essai expiré 8!"
Else

'condition d'installation
'If Sheets("feuil12").Range("a100") = Left(Sheets("feuil12").Range("a101"), 10) Then


'condition d'édition
If WorksheetFunction.Sum(Sheets("feuil2").Range("g1:h5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à éditer."
Else

If Sheets("feuil5").Range("m47") = "" Then
MsgBox "Veuillez d'abord éditer le Bilan N !"
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition du Tableau de trésorerie N ?", vbYesNo, "Demande de confirmation") = vbYes Then

'efface les données note trésorerie - calcul CAFG
Sheets("feuil12").Range("e20:e26").ClearContents
Sheets("feuil12").Range("j19:j27").ClearContents
Sheets("feuil12").Range("j29").ClearContents
Sheets("feuil12").Range("e29").ClearContents
Sheets("feuil12").Range("e42:e47").ClearContents
Sheets("feuil12").Range("j42:j47").ClearContents
Sheets("feuil12").Range("e35").ClearContents

Sheets("feuil12").Range("e65:e71").ClearContents
Sheets("feuil12").Range("j65:j71").ClearContents

Sheets("feuil12").Range("e75:e88").ClearContents
Sheets("feuil12").Range("j75:j88").ClearContents
Sheets("feuil12").Range("e94:e96").ClearContents

'efface les données Tafire
Sheets("feuil7").Range("g12:g54").ClearContents
Sheets("feuil7").Range("d22").ClearContents
Sheets("feuil7").Range("j53").ClearContents 'message d'écart
Sheets("feuil7").Range("k53").ClearContents 'message d'écart

'recup des données pour le TAFIRE N
For i = 3 To 5000

'adaptation SYSCOHADA révisé recup compte 211+2191+2181 Augmentation des Frais de dévelop et prospection
If Left(Sheets("feuil2").Cells(i, 1), 3) = 211 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2191 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2181 Then
Sheets("feuil28").Cells(i, 208) = Sheets("feuil2").Cells(i, 5) 'colonne GZ
Else
End If

'recup compte 212 Augmentation des Brevets, licences, logiciels
If Left(Sheets("feuil2").Cells(i, 1), 3) = 212 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2192 Then
Sheets("feuil28").Cells(i, 209) = Sheets("feuil2").Cells(i, 5) 'colonne HA
Else
End If

'recup compte 213 Augmentation des Brevets, licences, logiciels
If Left(Sheets("feuil2").Cells(i, 1), 3) = 213 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2193 Then
Sheets("feuil28").Cells(i, 210) = Sheets("feuil2").Cells(i, 5) 'colonne HB
Else
End If

'recup compte 214 Augmentation des Brevets, licences, logiciels
If Left(Sheets("feuil2").Cells(i, 1), 3) = 214 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2194 Then
Sheets("feuil28").Cells(i, 211) = Sheets("feuil2").Cells(i, 5) 'colonne HC
Else
End If

'recup compte 215 Augmentation du Fonds commercial
If Left(Sheets("feuil2").Cells(i, 1), 3) = 215 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2195 Then
Sheets("feuil28").Cells(i, 212) = Sheets("feuil2").Cells(i, 5) 'colonne HD
Else
End If

'recup compte 216 Augmentation du Fonds commercial
If Left(Sheets("feuil2").Cells(i, 1), 3) = 216 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2196 Then
Sheets("feuil28").Cells(i, 213) = Sheets("feuil2").Cells(i, 5) 'colonne HE
Else
End If

'recup compte 217 Augmentation des Autres immob. incorporelles
If Left(Sheets("feuil2").Cells(i, 1), 3) = 217 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2197 Then
Sheets("feuil28").Cells(i, 214) = Sheets("feuil2").Cells(i, 5) 'colonne HF
Else
End If

'adaptation SYSCOHADA révisé recup compte 218 Augmentation des Autres immob. incorporelles
If Left(Sheets("feuil2").Cells(i, 1), 3) = 218 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2198 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2181 Then
Else
Sheets("feuil28").Cells(i, 215) = Sheets("feuil2").Cells(i, 5) 'colonne HG
End If
Else
End If

'recup compte 2191 Augmentation des Immob. incorporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2191 Then
Sheets("feuil28").Cells(i, 216) = Sheets("feuil2").Cells(i, 5) 'colonne HH
Else
End If

'recup compte 2193 Augmentation des Immob. incorporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2193 Then
Sheets("feuil28").Cells(i, 217) = Sheets("feuil2").Cells(i, 5) 'colonne HI
Else
End If

'recup compte 2198 Augmentation des Immob. incorporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2198 Then
Sheets("feuil28").Cells(i, 218) = Sheets("feuil2").Cells(i, 5) 'colonne HJ
Else
End If

'adaptation SYSCOHADA révisé recup compte 22 Augmentation des terrains
If Left(Sheets("feuil2").Cells(i, 1), 2) = 22 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2281 Then
Else
Sheets("feuil28").Cells(i, 219) = Sheets("feuil2").Cells(i, 5) 'colonne HK
End If
Else
End If

'recup compte 231 Augmentation des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 231 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2391 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2315 Then
Else
Sheets("feuil28").Cells(i, 220) = Sheets("feuil2").Cells(i, 5) 'colonne HL
End If
Else
End If

'recup compte 232 Augmentation des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 232 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2392 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2325 Then
Else
Sheets("feuil28").Cells(i, 221) = Sheets("feuil2").Cells(i, 5) 'colonne HM
End If
Else
End If

'recup compte 233 Augmentation des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 233 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2393 Then
Sheets("feuil28").Cells(i, 222) = Sheets("feuil2").Cells(i, 5) 'colonne HN
Else
End If

'recup compte 237 Augmentation des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 237 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2397 Then
Sheets("feuil28").Cells(i, 223) = Sheets("feuil2").Cells(i, 5) 'colonne HO
Else
End If

'recup compte 234 Augmentation des Installations et agenc.
If Left(Sheets("feuil2").Cells(i, 1), 3) = 234 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2394 Then
Sheets("feuil28").Cells(i, 224) = Sheets("feuil2").Cells(i, 5) 'colonne HP
Else
End If

'recup compte 235 Augmentation des Installations et agenc.
If Left(Sheets("feuil2").Cells(i, 1), 3) = 235 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2395 Then
Sheets("feuil28").Cells(i, 225) = Sheets("feuil2").Cells(i, 5) 'colonne HQ
Else
End If

'recup compte 238 Augmentation des Installations et agenc.
If Left(Sheets("feuil2").Cells(i, 1), 3) = 238 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2398 Then
Sheets("feuil28").Cells(i, 226) = Sheets("feuil2").Cells(i, 5) 'colonne HR
Else
End If

'recup compte 24 sauf 245 Augmentation du Matériel
If Left(Sheets("feuil2").Cells(i, 1), 2) = 24 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 245 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2495 Then
Else
Sheets("feuil28").Cells(i, 227) = Sheets("feuil2").Cells(i, 5) 'colonne HS
End If
End If
Else
End If

'recup compte 245 Augmentation du matériel de transport
If Left(Sheets("feuil2").Cells(i, 1), 3) = 245 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2495 Then
Sheets("feuil28").Cells(i, 228) = Sheets("feuil2").Cells(i, 5) 'colonne HT
Else
End If

'recup compte 239 Augmentation des Immob. corporelles encours
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 239 Then
'Sheets("feuil28").Cells(i, 229) = Sheets("feuil2").Cells(i, 5) 'colonne HU
'Else
'End If

'recup compte 249 Augmentation des Immob. corporelles encours
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 249 Then
'Sheets("feuil28").Cells(i, 230) = Sheets("feuil2").Cells(i, 5) 'colonne HV
'Else
'End If

'recup compte 25 Augmentation des Avances sur immob.
If Left(Sheets("feuil2").Cells(i, 1), 2) = 25 Then
Sheets("feuil28").Cells(i, 231) = Sheets("feuil2").Cells(i, 5) 'colonne HW
Else
End If

'recup compte 26 Augmentation des Titres de participation
If Left(Sheets("feuil2").Cells(i, 1), 2) = 26 Then
Sheets("feuil28").Cells(i, 232) = Sheets("feuil2").Cells(i, 5) 'colonne HX
Else
End If

'recup compte 27 Augmentation des Autres immob. financières
If Left(Sheets("feuil2").Cells(i, 1), 2) = 27 Then
Sheets("feuil28").Cells(i, 233) = Sheets("feuil2").Cells(i, 5) 'colonne HY
Else
End If


'adaptation SYSCOHADA révisé recup compte 211+2181 Diminution des Frais de dévelop et prospection
If Left(Sheets("feuil2").Cells(i, 1), 3) = 211 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2181 Then
Sheets("feuil28").Cells(i, 234) = Sheets("feuil2").Cells(i, 6) 'colonne HZ
Else
End If

'recup compte 212 Diminution des Brevets, licences, logiciels
If Left(Sheets("feuil2").Cells(i, 1), 3) = 212 Then
Sheets("feuil28").Cells(i, 235) = Sheets("feuil2").Cells(i, 6) 'colonne IA
Else
End If

'recup compte 213 Diminution des Brevets, licences, logiciels
If Left(Sheets("feuil2").Cells(i, 1), 3) = 213 Then
Sheets("feuil28").Cells(i, 236) = Sheets("feuil2").Cells(i, 6) 'colonne IB
Else
End If

'recup compte 214 Diminution des Brevets, licences, logiciels
If Left(Sheets("feuil2").Cells(i, 1), 3) = 214 Then
Sheets("feuil28").Cells(i, 237) = Sheets("feuil2").Cells(i, 6) 'colonne IC
Else
End If

'recup compte 215 Diminution du Fonds commercial
If Left(Sheets("feuil2").Cells(i, 1), 3) = 215 Then
Sheets("feuil28").Cells(i, 238) = Sheets("feuil2").Cells(i, 6) 'colonne ID
Else
End If

'recup compte 216 Diminution du Fonds commercial
If Left(Sheets("feuil2").Cells(i, 1), 3) = 216 Then
Sheets("feuil28").Cells(i, 239) = Sheets("feuil2").Cells(i, 6) 'colonne IE
Else
End If

'recup compte 217 Diminution des Autres immob. incorporelles
If Left(Sheets("feuil2").Cells(i, 1), 3) = 217 Then
Sheets("feuil28").Cells(i, 240) = Sheets("feuil2").Cells(i, 6) 'colonne IF
Else
End If

'recup compte 218 Diminution des Autres immob. incorporelles
If Left(Sheets("feuil2").Cells(i, 1), 3) = 218 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2181 Then
Else
Sheets("feuil28").Cells(i, 241) = Sheets("feuil2").Cells(i, 6) 'colonne IG
End If
Else
End If

'recup compte 2191 Diminution des Immob. incorporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2191 Then
Sheets("feuil28").Cells(i, 242) = Sheets("feuil2").Cells(i, 6) 'colonne IH
Else
End If

'recup compte 2193 Diminution des Immob. incorporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2193 Then
Sheets("feuil28").Cells(i, 243) = Sheets("feuil2").Cells(i, 6) 'colonne II
Else
End If

'recup compte 2198 Diminution des Immob. incorporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2198 Then
Sheets("feuil28").Cells(i, 244) = Sheets("feuil2").Cells(i, 6) 'colonne IJ
Else
End If

'recup compte 22 sauf 229 Diminution des Terrains
If Left(Sheets("feuil2").Cells(i, 1), 2) = 22 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 229 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2281 Then
Else
Sheets("feuil28").Cells(i, 245) = Sheets("feuil2").Cells(i, 6) 'colonne IK
End If
End If
Else
End If

'recup compte 231 Diminution des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 231 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2315 Then
Else
Sheets("feuil28").Cells(i, 246) = Sheets("feuil2").Cells(i, 6) 'colonne IL
End If
Else
End If

'recup compte 232 Diminution des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 232 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2325 Then
Else
Sheets("feuil28").Cells(i, 247) = Sheets("feuil2").Cells(i, 6) 'colonne IM
End If
Else
End If

'recup compte 233 Diminution des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 233 Then
Sheets("feuil28").Cells(i, 248) = Sheets("feuil2").Cells(i, 6) 'colonne IN
Else
End If

'recup compte 237 Diminution des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 237 Then
Sheets("feuil28").Cells(i, 249) = Sheets("feuil2").Cells(i, 6) 'colonne IO
Else
End If

'recup compte 234 Diminution des Installations et agenc.
If Left(Sheets("feuil2").Cells(i, 1), 3) = 234 Then
Sheets("feuil28").Cells(i, 250) = Sheets("feuil2").Cells(i, 6) 'colonne IP
Else
End If

'recup compte 235 Diminution des Installations et agenc.
If Left(Sheets("feuil2").Cells(i, 1), 3) = 235 Then
Sheets("feuil28").Cells(i, 251) = Sheets("feuil2").Cells(i, 6) 'colonne IQ
Else
End If

'recup compte 238 Diminution des Installations et agenc.
If Left(Sheets("feuil2").Cells(i, 1), 3) = 238 Then
Sheets("feuil28").Cells(i, 252) = Sheets("feuil2").Cells(i, 6) 'colonne IR
Else
End If

'recup compte 24 sauf 249 Diminution du Matériel sauf 245 Transport
If Left(Sheets("feuil2").Cells(i, 1), 2) = 24 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 249 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 3) = 245 Then
Else
Sheets("feuil28").Cells(i, 253) = Sheets("feuil2").Cells(i, 6) 'colonne IS
End If
End If
Else
End If

'adaptation SYSCOHADA révisé recup compte 229 Diminution des Immob. corporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 3) = 229 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 22981 Then
Else
Sheets("feuil28").Cells(i, 254) = Sheets("feuil2").Cells(i, 6) 'colonne IT
End If
Else
End If

'recup compte 239 Diminution des Immob. corporelles encours
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 239 Then
'Sheets("feuil28").Cells(i, 255) = Sheets("feuil2").Cells(i, 6) 'colonne IU
'Else
'End If

'recup compte 249 Diminution des Immob. corporelles encours sauf 2495
If Left(Sheets("feuil2").Cells(i, 1), 3) = 249 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2495 Then
Else
Sheets("feuil28").Cells(i, 256) = Sheets("feuil2").Cells(i, 6) 'colonne IV
End If
Else
End If

'recup compte 25 Diminution des Avances sur immob.
If Left(Sheets("feuil2").Cells(i, 1), 2) = 25 Then
Sheets("feuil28").Cells(i, 257) = Sheets("feuil2").Cells(i, 6) 'colonne IW
Else
End If

'recup compte 26 Diminution des Titres de participation
If Left(Sheets("feuil2").Cells(i, 1), 2) = 26 Then
Sheets("feuil28").Cells(i, 258) = Sheets("feuil2").Cells(i, 6) 'colonne IX
Else
End If

'recup compte 27 sauf 274 Diminution des Autres immob. financières
If Left(Sheets("feuil2").Cells(i, 1), 2) = 27 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 274 Then
Else
Sheets("feuil28").Cells(i, 259) = Sheets("feuil2").Cells(i, 6) 'colonne IY
End If
Else
End If

'recup compte 274 Diminution des Autres immob. financières
If Left(Sheets("feuil2").Cells(i, 1), 3) = 274 Then
Sheets("feuil28").Cells(i, 260) = Sheets("feuil2").Cells(i, 6) 'colonne IZ
Else
End If

'adaptation SYSCOHADA révisé
'recup compte 821+7541 Prix de cession des immob. incorporelles
If Left(Sheets("feuil2").Cells(i, 1), 3) = 821 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7541 Then
Sheets("feuil28").Cells(i, 261) = Sheets("feuil2").Cells(i, 8) 'colonne JA
Else
End If

'adaptation SYSCOHADA révisé
'recup compte 822+7542 Prix de cession des immob. corporelles
If Left(Sheets("feuil2").Cells(i, 1), 3) = 822 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7542 Then
Sheets("feuil28").Cells(i, 262) = Sheets("feuil2").Cells(i, 8) 'colonne JB
Else
End If

'recup compte 826 Prix de cession des immob. financières
If Left(Sheets("feuil2").Cells(i, 1), 3) = 826 Then
Sheets("feuil28").Cells(i, 263) = Sheets("feuil2").Cells(i, 8) 'colonne JC
Else
End If

'recup compte 10c Augmentation de capital
If Left(Sheets("feuil2").Cells(i, 1), 2) = 10 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 106 Then
Else
Sheets("feuil28").Cells(i, 264) = Sheets("feuil2").Cells(i, 6) 'colonne JD
End If
Else
End If

'recup compte 10d sauf 109 Réduction du capital
If Left(Sheets("feuil2").Cells(i, 1), 2) = 10 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 109 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 3) = 106 Then
Else
Sheets("feuil28").Cells(i, 265) = Sheets("feuil2").Cells(i, 5) 'colonne JE
End If
End If
Else
End If

'RATTRAPAGE COMPTE 109d
'recup compte 109d Augmentation de capital
If Left(Sheets("feuil2").Cells(i, 1), 3) = 109 Then
Sheets("feuil28").Cells(i, 276) = Sheets("feuil2").Cells(i, 5) 'colonne JP
Else
End If


'recup compte 465 Dividendes distribués
If Left(Sheets("feuil2").Cells(i, 1), 3) = 465 Then
Sheets("feuil28").Cells(i, 266) = Sheets("feuil2").Cells(i, 5) 'colonne JF
Else
End If

'recup compte 16 Augmentation des emprunts
If Left(Sheets("feuil2").Cells(i, 1), 2) = 16 Then
Sheets("feuil28").Cells(i, 267) = Sheets("feuil2").Cells(i, 6) 'colonne JG
Else
End If

'recup compte 17 Augmentation des emprunts
If Left(Sheets("feuil2").Cells(i, 1), 2) = 17 Then
Sheets("feuil28").Cells(i, 268) = Sheets("feuil2").Cells(i, 6) 'colonne JH
Else
End If

'recup compte 18 Augmentation des emprunts
If Left(Sheets("feuil2").Cells(i, 1), 2) = 18 Then
Sheets("feuil28").Cells(i, 269) = Sheets("feuil2").Cells(i, 6) 'colonne JI
Else
End If

'recup compte 16 Remboursement des emprunts
If Left(Sheets("feuil2").Cells(i, 1), 2) = 16 Then
Sheets("feuil28").Cells(i, 270) = Sheets("feuil2").Cells(i, 5) 'colonne JJ
Else
End If

'recup compte 17 Remboursement des emprunts
If Left(Sheets("feuil2").Cells(i, 1), 2) = 17 Then
Sheets("feuil28").Cells(i, 271) = Sheets("feuil2").Cells(i, 5) 'colonne JK
Else
End If

'recup compte 18 Remboursement des emprunts
If Left(Sheets("feuil2").Cells(i, 1), 2) = 18 Then
Sheets("feuil28").Cells(i, 272) = Sheets("feuil2").Cells(i, 5) 'colonne JL
Else
End If

'recup compte 14 Subvention d'investissement reçu
If Left(Sheets("feuil2").Cells(i, 1), 2) = 14 Then
Sheets("feuil28").Cells(i, 273) = Sheets("feuil2").Cells(i, 6) 'colonne JM
Else
End If

'Adaptation compte 206 SYSCOHADA
'recup compte 206 Dimunition des Primes de remboursement
If Left(Sheets("feuil2").Cells(i, 1), 3) = 206 Then
Sheets("feuil28").Cells(i, 277) = Sheets("feuil2").Cells(i, 6) 'colonne JQ
Else
End If

'recup compte 245 Dimunition du Matériel de transport
If Left(Sheets("feuil2").Cells(i, 1), 3) = 245 Then
Sheets("feuil28").Cells(i, 278) = Sheets("feuil2").Cells(i, 6) 'colonne JR
Else
End If

'recup compte 2495 Diminution du Matériel de transport encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2495 Then
Sheets("feuil28").Cells(i, 279) = Sheets("feuil2").Cells(i, 6) 'colonne JS
Else
End If

'adaptation SYSCOHADA révisé recup compte 2391+2392+2393+2397 Diminution des Bâtiments encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2391 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2392 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2393 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2397 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 23915 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 23925 Then
Else
Sheets("feuil28").Cells(i, 280) = Sheets("feuil2").Cells(i, 6) 'colonne JT
End If
Else
End If

'recup compte 2394+2395+2398 Diminution des Bâtiments encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2394 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2395 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2398 Then
Sheets("feuil28").Cells(i, 281) = Sheets("feuil2").Cells(i, 6) 'colonne JU
Else
End If



'ADAPTATION SYSCOHADA révisé - immeuble de placement
'recup compte 2281 Augmentation des terrains - immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2281 Then
Sheets("feuil28").Cells(i, 287) = Sheets("feuil2").Cells(i, 5) 'colonne KA
Else
End If

'recup compte 2315+2325 Augmentation des bâtiments - immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2315 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2325 Then
Sheets("feuil28").Cells(i, 288) = Sheets("feuil2").Cells(i, 5) 'colonne KB
Else
End If


'recup compte 2281 sauf 22981 Diminution des Terrains - immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2281 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 22981 Then
Else
Sheets("feuil28").Cells(i, 289) = Sheets("feuil2").Cells(i, 6) 'colonne KC
End If
Else
End If

'recup compte 2315+2325 sauf 23915+23925 Diminution des bâtiments - immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2315 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2325 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 23915 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 23925 Then
Else
Sheets("feuil28").Cells(i, 290) = Sheets("feuil2").Cells(i, 6) 'colonne KD
End If
Else
End If

'recup compte 22981 Diminution des terrains - immeuble de placement encours
If Left(Sheets("feuil2").Cells(i, 1), 5) = 22981 Then
Sheets("feuil28").Cells(i, 291) = Sheets("feuil2").Cells(i, 6) 'colonne KE
Else
End If

'recup compte 23915+23925 Diminution des bâtiments - immeuble de placement encours
If Left(Sheets("feuil2").Cells(i, 1), 5) = 23915 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 23925 Then
Sheets("feuil28").Cells(i, 292) = Sheets("feuil2").Cells(i, 6) 'colonne KF
Else
End If

'ADAPTATION SYSCOHADA révisé - Pour le calcul de la CAFG
'recup compte 85 à déduire des charges H.A.O. dans le calcul de la CAFG
If Left(Sheets("feuil2").Cells(i, 1), 2) = 85 Then
Sheets("feuil28").Cells(i, 293) = Sheets("feuil2").Cells(i, 7) 'colonne KG
Else
End If

'recup compte 86 à déduire des produits H.A.O. dans le calcul de la CAFG
If Left(Sheets("feuil2").Cells(i, 1), 2) = 86 Then
Sheets("feuil28").Cells(i, 294) = Sheets("feuil2").Cells(i, 8) 'colonne KH
Else
End If

'recup compte 654 à déduire des autres charges dans le calcul de la CAFG
If Left(Sheets("feuil2").Cells(i, 1), 3) = 654 Then
Sheets("feuil28").Cells(i, 295) = Sheets("feuil2").Cells(i, 7) 'colonne KI
Else
End If

'recup compte 754 à déduire des autres produits dans le calcul de la CAFG
If Left(Sheets("feuil2").Cells(i, 1), 3) = 754 Then
Sheets("feuil28").Cells(i, 296) = Sheets("feuil2").Cells(i, 8) 'colonne KJ
Else
End If


Next



'affecte comptes 211+2181 Augmentation des Frais de dévelop et prospection
Sheets("feuil28").Range("gz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gz1:gz5000")) 'compte 211
'Sheets("feuil23").Range("c16") = Sheets("feuil28").Range("gz5001")

'affecte comptes 212+213+214 Augmentation des Brevets, licences, logiciels
Sheets("feuil28").Range("ha5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ha1:ha5000")) 'compte 212
Sheets("feuil28").Range("hb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hb1:hb5000")) 'compte 213
Sheets("feuil28").Range("hc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hc1:hc5000")) 'compte 214
'Sheets("feuil23").Range("c17") = Sheets("feuil28").Range("ha5001")+Sheets("feuil28").Range("hb5001")+Sheets("feuil28").Range("hc5001")

'affecte comptes 215+216 Augmentation du Fonds commercial
Sheets("feuil28").Range("hd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hd1:hd5000")) 'compte 215
Sheets("feuil28").Range("he5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("he1:he5000")) 'compte 216
'Sheets("feuil23").Range("c18") = Sheets("feuil28").Range("hd5001")+Sheets("feuil28").Range("he5001")

'affecte comptes 217+218 Augmentation des Autres immob. incorporelles
Sheets("feuil28").Range("hf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hf1:hf5000")) 'compte 217
Sheets("feuil28").Range("hg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hg1:hg5000")) 'compte 218
'Sheets("feuil23").Range("c19") = Sheets("feuil28").Range("hf5001")+Sheets("feuil28").Range("hg5001")

'affecte comptes 2191+2193+2198 Augmentation des Immob. incorporelles encours
Sheets("feuil28").Range("hh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hh1:hh5000")) 'compte 2191
Sheets("feuil28").Range("hi5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hi1:hi5000")) 'compte 2193
Sheets("feuil28").Range("hj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hj1:hj5000")) 'compte 2198
'Sheets("feuil23").Range("c20") = Sheets("feuil28").Range("hh5001")+Sheets("feuil28").Range("hi5001")+Sheets("feuil28").Range("hj5001")

'affecte comptes 22 Augmentation des Terrains
Sheets("feuil28").Range("hk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hk1:hk5000")) 'compte 22
'Sheets("feuil23").Range("c22") = Sheets("feuil28").Range("hk5001")

'affecte comptes 231+232+233+237 Augmentation des Bâtiments
Sheets("feuil28").Range("hl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hl1:hl5000")) 'compte 231
Sheets("feuil28").Range("hm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hm1:hm5000")) 'compte 232
Sheets("feuil28").Range("hn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hn1:hn5000")) 'compte 233
Sheets("feuil28").Range("ho5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ho1:ho5000")) 'compte 237
'Sheets("feuil23").Range("c23") = Sheets("feuil28").Range("hl5001")+Sheets("feuil28").Range("hm5001")+Sheets("feuil28").Range("hn5001")+Sheets("feuil28").Range("ho5001")

'affecte comptes 234+235+238 Augmentation des Installations et agenc.
Sheets("feuil28").Range("hp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hp1:hp5000")) 'compte 234
Sheets("feuil28").Range("hq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hq1:hq5000")) 'compte 235
Sheets("feuil28").Range("hr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hr1:hr5000")) 'compte 238
'Sheets("feuil23").Range("c24") = Sheets("feuil28").Range("hp5001")+Sheets("feuil28").Range("hq5001")+Sheets("feuil28").Range("hr5001")

'affecte comptes 24 Augmentation du Matériel
Sheets("feuil28").Range("hs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hs1:hs5000")) 'compte 24 sauf 249
'Sheets("feuil23").Range("c25") = Sheets("feuil28").Range("hs5001")

'affecte comptes 245 Augmentation du Matériel de transport
Sheets("feuil28").Range("ht5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ht1:ht5000")) 'compte 245
'Sheets("feuil23").Range("c29") = Sheets("feuil28").Range("ht5001")

'affecte comptes 25 Augmentation des Avances sur immob.
Sheets("feuil28").Range("hw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hw1:hw5000")) 'compte 25
'Sheets("feuil23").Range("c28") = Sheets("feuil28").Range("hw5001")

'affecte comptes 26 Augmentation des Titres de participation
Sheets("feuil28").Range("hx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hx1:hx5000")) 'compte 26
'Sheets("feuil23").Range("c30") = Sheets("feuil28").Range("hx5001")

'affecte comptes 27 Augmentation des Autres immob. financières
Sheets("feuil28").Range("hy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hy1:hy5000")) 'compte 27
'Sheets("feuil23").Range("c31") = Sheets("feuil28").Range("hy5001")




'affecte comptes 211+2181 Diminution des Frais de dévelop et prospection
Sheets("feuil28").Range("hz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hz1:hz5000")) 'compte 211
'Sheets("feuil23").Range("f16") = Sheets("feuil28").Range("hz5001")

'affecte comptes 212+213+214 Diminution des Brevets, licences, logiciels
Sheets("feuil28").Range("ia5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ia1:ia5000")) 'compte 212
Sheets("feuil28").Range("ib5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ib1:ib5000")) 'compte 213
Sheets("feuil28").Range("ic5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ic1:ic5000")) 'compte 214
'Sheets("feuil23").Range("f17") = Sheets("feuil28").Range("ia5001")+Sheets("feuil28").Range("ib5001")+Sheets("feuil28").Range("ic5001")

'affecte comptes 215+216 Diminution du Fonds commercial
Sheets("feuil28").Range("id5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("id1:id5000")) 'compte 215
Sheets("feuil28").Range("ie5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ie1:ie5000")) 'compte 216
'Sheets("feuil23").Range("f18") = Sheets("feuil28").Range("id5001")+Sheets("feuil28").Range("ie5001")

'affecte comptes 217+218 Diminution des Autres immob. incorporelles
Sheets("feuil28").Range("if5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("if1:if5000")) 'compte 217
Sheets("feuil28").Range("ig5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ig1:ig5000")) 'compte 218
'Sheets("feuil23").Range("f19") = Sheets("feuil28").Range("if5001")+Sheets("feuil28").Range("ig5001")

'affecte comptes 2191+2193+2198 Diminution des Immob. incorporelles encours
Sheets("feuil28").Range("ih5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ih1:ih5000")) 'compte 2191
Sheets("feuil28").Range("ii5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ii1:ii5000")) 'compte 2193
Sheets("feuil28").Range("ij5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ij1:ij5000")) 'compte 2198
'Sheets("feuil23").Range("f20") = Sheets("feuil28").Range("ih5001")+Sheets("feuil28").Range("ii5001")+Sheets("feuil28").Range("ij5001")

'affecte comptes 22 Diminution des Terrains
Sheets("feuil28").Range("ik5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ik1:ik5000")) 'compte 22
'Sheets("feuil23").Range("f22") = Sheets("feuil28").Range("ik5001")

'affecte comptes 231+232+233+237 Diminution des Bâtiments
Sheets("feuil28").Range("il5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("il1:il5000")) 'compte 231
Sheets("feuil28").Range("im5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("im1:im5000")) 'compte 232
Sheets("feuil28").Range("in5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("in1:in5000")) 'compte 233
Sheets("feuil28").Range("io5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("io1:io5000")) 'compte 237
'Sheets("feuil23").Range("f23") = Sheets("feuil28").Range("il5001")+Sheets("feuil28").Range("im5001")+Sheets("feuil28").Range("in5001")+Sheets("feuil28").Range("io5001")

'affecte comptes 234+235+238 Diminution des Installations et agenc.
Sheets("feuil28").Range("ip5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ip1:ip5000")) 'compte 234
Sheets("feuil28").Range("iq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iq1:iq5000")) 'compte 235
Sheets("feuil28").Range("ir5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ir1:ir5000")) 'compte 238
'Sheets("feuil23").Range("f24") = Sheets("feuil28").Range("ip5001")+Sheets("feuil28").Range("iq5001")+Sheets("feuil28").Range("ir5001")

'affecte comptes 24 sauf 249 Diminution du Matériel
Sheets("feuil28").Range("is5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("is1:is5000")) 'compte 24 sauf 249
'Sheets("feuil23").Range("f25") = Sheets("feuil28").Range("is5001")

'affecte comptes 229 Diminution des terains encours
Sheets("feuil28").Range("it5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("it1:it5000")) 'compte 229
'Sheets("feuil23").Range("f26") = Sheets("feuil28").Range("it5001")

'affecte comptes+249 Diminution du Matériel encours
Sheets("feuil28").Range("iv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iv1:iv5000")) 'compte 249
'Sheets("feuil23").Range("f26") = Sheets("feuil28").Range("iv5001")

'affecte comptes 25 Diminution des Avances sur immob.
Sheets("feuil28").Range("iw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iw1:iw5000")) 'compte 25
'Sheets("feuil23").Range("f28") = Sheets("feuil28").Range("iw5001")

'affecte comptes 26 Diminution des Titres de participation
Sheets("feuil28").Range("ix5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ix1:ix5000")) 'compte 26
'Sheets("feuil23").Range("f30") = Sheets("feuil28").Range("ix5001")

'affecte comptes 27 sauf 274 + 274 Diminution des Autres immob. financières
Sheets("feuil28").Range("iy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iy1:iy5000")) 'compte 27 sauf 274
Sheets("feuil28").Range("iz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iz1:iz5000")) 'compte 274
'Sheets("feuil23").Range("f31") = Sheets("feuil28").Range("iy5001")+Sheets("feuil28").Range("iz5001")

'affecte comptes 821 Prix de cession des immob. incorporelles
Sheets("feuil28").Range("ja5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ja1:ja5000")) 'compte 821
'Sheets("feuil7").Range("i29") = Sheets("feuil28").Range("ja5001")

'affecte comptes 822 Prix de cession des immob. corporelles
Sheets("feuil28").Range("jb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jb1:jb5000")) 'compte 822
'Sheets("feuil7").Range("i30") = Sheets("feuil28").Range("jb5001")

'affecte comptes 826 Prix de cession des immob. financières
Sheets("feuil28").Range("jc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jc1:jc5000")) 'compte 826
'Sheets("feuil7").Range("i31") = Sheets("feuil28").Range("jc5001")

'affecte comptes 10c -109d Augmentation du capital
Sheets("feuil28").Range("jd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jd1:jd5000")) 'compte 10c
Sheets("feuil28").Range("jp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jp1:jp5000")) 'compte 109d
'Sheets("feuil7").Range("i35") = Sheets("feuil28").Range("jd5001")-Sheets("feuil28").Range("jp5001")

'affecte comptes 10d sauf 109 Réduction du capital
Sheets("feuil28").Range("je5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("je1:je5000")) 'compte 10d sauf 109
'Sheets("feuil7").Range("h36") = Sheets("feuil28").Range("je5001")

'affecte comptes 465d Dividendes distribués
Sheets("feuil28").Range("jf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jf1:jf5000")) 'compte 465d
'Sheets("feuil7").Range("h37") = Sheets("feuil28").Range("jf5001")

'affecte comptes 16c+17c+18c Augmentation des emprunts
Sheets("feuil28").Range("jg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jg1:jg5000")) 'compte 16c
Sheets("feuil28").Range("jh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jh1:jh5000")) 'compte 17c
Sheets("feuil28").Range("ji5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ji1:ji5000")) 'compte 18c
'Sheets("feuil7").Range("i41") = Sheets("feuil28").Range("jg5001")+Sheets("feuil28").Range("jh5001")+Sheets("feuil28").Range("ji5001")

'affecte comptes 16d+17d+18d Remboursement des emprunts
Sheets("feuil28").Range("jj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jj1:jj5000")) 'compte 16d
Sheets("feuil28").Range("jk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jk1:jk5000")) 'compte 17d
Sheets("feuil28").Range("jl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jl1:jl5000")) 'compte 18d
'Sheets("feuil7").Range("h42") = Sheets("feuil28").Range("jj5001")+Sheets("feuil28").Range("jk5001")+Sheets("feuil28").Range("jl5001")

'affecte comptes 478 Subvention d'investissement reçue
Sheets("feuil28").Range("jm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jm1:jm5000")) 'compte 478
'Sheets("feuil7").Range("i43") = Sheets("feuil28").Range("jm5001")

'affecte comptes 245 Diminution du Matériel de transport
Sheets("feuil28").Range("jr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jr1:jr5000")) 'compte 245
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2495Diminution du Matériel de transport encours
Sheets("feuil28").Range("js5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("js1:js5000")) 'compte 2495
'Sheets("feuil23").Range("g29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2391+2392+2393+2397 Diminution des Bâtiments encours
Sheets("feuil28").Range("jt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jt1:jt5000")) 'compte 2931/2/3/7
'Sheets("feuil23").Range("g29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2394+2395+2398 Diminution des Installations et agts encours
Sheets("feuil28").Range("ju5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ju1:ju5000")) 'compte 2934/5/8
'Sheets("feuil23").Range("g29") = Sheets("feuil28").Range("jr5001")


'ADAPATION SYSCOHADA révisé
'affecte comptes 2281 augmentation terrains - immeuble de placement
Sheets("feuil28").Range("ka5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ka1:ka5000")) 'compte 2281
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2315+2325 augmentation bâtiments - immeuble de placement
Sheets("feuil28").Range("kb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kb1:kb5000")) 'compte 2315+2325
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2281 diminution terrains - immeuble de placement
Sheets("feuil28").Range("kc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kc1:kc5000")) 'compte 2281
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2315+2325 diminution bâtiments - immeuble de placement
Sheets("feuil28").Range("kd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kd1:kd5000")) 'compte 2315+2325
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 22981 diminution terrains - immeuble de placement encours
Sheets("feuil28").Range("ke5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ke1:ke5000")) 'compte 22981
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 23915+23925 diminution bâtiments - immeuble de placement encours
Sheets("feuil28").Range("kf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kf1:kf5000")) 'compte 23915+23925
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 85 dotations H.A.O à déduire des charges H.A.O. dans le calcul de la CAFG
Sheets("feuil28").Range("kg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kg1:kg5000")) 'compte 85
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 86 reprises H.A.O à déduire des produits H.A.O. dans le calcul de la CAFG
Sheets("feuil28").Range("kh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kh1:kh5000")) 'compte 86
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 654 VNC courant à déduire de l'EBE dans le calcul de la CAFG
Sheets("feuil28").Range("ki5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ki1:ki5000")) 'compte 654
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 754 Prix de cession courant à déduire de l'EBE dans le calcul de la CAFG
Sheets("feuil28").Range("kj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kj1:kj5000")) 'compte 754
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")



'calcul de la CAFG
Sheets("feuil12").Range("j19") = Sheets("feuil6").Range("i36") + Sheets("feuil28").Range("ki5001") - Sheets("feuil28").Range("kj5001") 'EBE+Compte 645-Compte754
Sheets("feuil12").Range("e20") = -Sheets("feuil6").Range("i43") 'Frais financiers
'Sheets("feuil12").Range("e22") = Sheets("feuil6").Range("g20") 'Pertes de change
Sheets("feuil12").Range("e23") = -(Sheets("feuil6").Range("i50") + Sheets("feuil28").Range("kg5001")) 'Charges HAO-Dotations HAO
Sheets("feuil12").Range("e25") = -Sheets("feuil6").Range("i52") 'Participation des travailleurs
Sheets("feuil12").Range("e26") = -Sheets("feuil6").Range("i53") 'Impôt sur le résultat
'Sheets("feuil12").Range("j20") = Sheets("feuil6").Range("h41") 'Transfert de charges
Sheets("feuil12").Range("j22") = Sheets("feuil6").Range("i40") 'Revenus financiers
Sheets("feuil12").Range("j23") = Sheets("feuil6").Range("i42") 'Transfert de charges financières
'Sheets("feuil12").Range("j25") = Sheets("feuil6").Range("h18") 'Gain de change
Sheets("feuil12").Range("j26") = (Sheets("feuil6").Range("i48") + Sheets("feuil28").Range("kh5001")) 'Produits HAO-Reprises HAO
'Sheets("feuil12").Range("j27") = Sheets("feuil6").Range("h38") 'Transfert HAO
'calcul des totaux
Sheets("feuil12").Range("j29") = WorksheetFunction.Sum(Sheets("feuil12").Range("j19:j27"))
Sheets("feuil12").Range("e29") = WorksheetFunction.Sum(Sheets("feuil12").Range("e20:e26"))
'affectation dans le TAFIRE de la CAFG
Sheets("feuil7").Range("g15") = Sheets("feuil12").Range("j29") - Sheets("feuil12").Range("e29")


'VARIATION DES STOCKS
'adaptation SYSCOHADA révisé calcul variation des stocks et encours
If Sheets("feuil5").Range("g36") - Sheets("feuil5").Range("h36") > 0 Then
Sheets("feuil12").Range("e47") = Sheets("feuil5").Range("g36") - Sheets("feuil5").Range("h36")
Else
Sheets("feuil12").Range("j47") = -(Sheets("feuil5").Range("g36") - Sheets("feuil5").Range("h36"))
End If
'affectation dans le TAFIRE
Sheets("feuil7").Range("g17") = -(Sheets("feuil12").Range("e47") - Sheets("feuil12").Range("j47"))


'VARIATION DES CREANCES
'calcul variation des fournisseurs, avances
If Sheets("feuil5").Range("g38") - Sheets("feuil5").Range("h38") > 0 Then
Sheets("feuil12").Range("e65") = Sheets("feuil5").Range("g38") - Sheets("feuil5").Range("h38")
Else
Sheets("feuil12").Range("j65") = -(Sheets("feuil5").Range("g38") - Sheets("feuil5").Range("h38"))
End If

'calcul variation des clients
If Sheets("feuil5").Range("g39") - Sheets("feuil5").Range("h39") > 0 Then
Sheets("feuil12").Range("e66") = Sheets("feuil5").Range("g39") - Sheets("feuil5").Range("h39")
Else
Sheets("feuil12").Range("j66") = -(Sheets("feuil5").Range("g39") - Sheets("feuil5").Range("h39"))
End If

'calcul variation des autres créances
If Sheets("feuil5").Range("g40") - Sheets("feuil5").Range("h40") > 0 Then
Sheets("feuil12").Range("e67") = Sheets("feuil5").Range("g40") - Sheets("feuil5").Range("h40")
Else
Sheets("feuil12").Range("j67") = -(Sheets("feuil5").Range("g40") - Sheets("feuil5").Range("h40"))
End If

'calcul variation des ecarts de conversion ACTIF
If Sheets("feuil5").Range("g46") - Sheets("feuil5").Range("h46") > 0 Then
Sheets("feuil12").Range("e68") = Sheets("feuil5").Range("g46") - Sheets("feuil5").Range("h46")
Else
Sheets("feuil12").Range("j68") = -(Sheets("feuil5").Range("g46") - Sheets("feuil5").Range("h46"))
End If

'calcul variation globale nette des creances
If WorksheetFunction.Sum(Sheets("feuil12").Range("e65:e68")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j65:j68")) > 0 Then
Sheets("feuil12").Range("e70") = WorksheetFunction.Sum(Sheets("feuil12").Range("e65:e68")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j65:j68"))
Else
Sheets("feuil12").Range("j70") = -(WorksheetFunction.Sum(Sheets("feuil12").Range("e65:e68")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j65:j68")))
End If
'affectation dans le TAFIRE
Sheets("feuil7").Range("g18") = -(Sheets("feuil12").Range("e70") - Sheets("feuil12").Range("j70"))


'VARIATION DES CREANCES H.A.O
'calcul variation des creances HAO
If Sheets("feuil5").Range("g35") - Sheets("feuil5").Range("h35") > 0 Then
Sheets("feuil12").Range("e71") = Sheets("feuil5").Range("g35") - Sheets("feuil5").Range("h35")
Else
Sheets("feuil12").Range("j71") = -(Sheets("feuil5").Range("g35") - Sheets("feuil5").Range("h35"))
End If
'affectation dans le TAFIRE
Sheets("feuil7").Range("g16") = -(Sheets("feuil12").Range("e71") - Sheets("feuil12").Range("j71"))


'VARIATION DES DETTES FOURNISSEURS
'calcul variation des clients, avances
If Sheets("feuil5").Range("m36") - Sheets("feuil5").Range("n36") > 0 Then
Sheets("feuil12").Range("j75") = Sheets("feuil5").Range("m36") - Sheets("feuil5").Range("n36")
Else
Sheets("feuil12").Range("e75") = -(Sheets("feuil5").Range("m36") - Sheets("feuil5").Range("n36"))
End If

'calcul variation des fournisseurs
If Sheets("feuil5").Range("m37") - Sheets("feuil5").Range("n37") > 0 Then
Sheets("feuil12").Range("j76") = Sheets("feuil5").Range("m37") - Sheets("feuil5").Range("n37")
Else
Sheets("feuil12").Range("e76") = -(Sheets("feuil5").Range("m37") - Sheets("feuil5").Range("n37"))
End If

'adaptation SYSCOHADA révisé calcul variation des dettes fiscales et sociales
If Sheets("feuil5").Range("m38") - Sheets("feuil5").Range("n38") > 0 Then
Sheets("feuil12").Range("j77") = Sheets("feuil5").Range("m38") - Sheets("feuil5").Range("n38")
Else
Sheets("feuil12").Range("e77") = -(Sheets("feuil5").Range("m38") - Sheets("feuil5").Range("n38"))
End If

'calcul variation des autres dettes
If Sheets("feuil5").Range("m39") - Sheets("feuil5").Range("n39") > 0 Then
Sheets("feuil12").Range("j79") = Sheets("feuil5").Range("m39") - Sheets("feuil5").Range("n39")
Else
Sheets("feuil12").Range("e79") = -(Sheets("feuil5").Range("m39") - Sheets("feuil5").Range("n39"))
End If

'calcul variation des risques provisionnés
If Sheets("feuil5").Range("m40") - Sheets("feuil5").Range("n40") > 0 Then
Sheets("feuil12").Range("j80") = Sheets("feuil5").Range("m40") - Sheets("feuil5").Range("n40")
Else
Sheets("feuil12").Range("e80") = -(Sheets("feuil5").Range("m40") - Sheets("feuil5").Range("n40"))
End If

'calcul variation des écarts de conversion PASSIF
If Sheets("feuil5").Range("m46") - Sheets("feuil5").Range("n46") > 0 Then
Sheets("feuil12").Range("j81") = Sheets("feuil5").Range("m46") - Sheets("feuil5").Range("n46")
Else
Sheets("feuil12").Range("e81") = -(Sheets("feuil5").Range("m46") - Sheets("feuil5").Range("n46"))
End If

'calcul variation globale nette des dettes fournisseurs
If WorksheetFunction.Sum(Sheets("feuil12").Range("e75:e81")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j75:j81")) > 0 Then
Sheets("feuil12").Range("e84") = WorksheetFunction.Sum(Sheets("feuil12").Range("e75:e81")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j75:j81"))
Else
Sheets("feuil12").Range("j84") = -(WorksheetFunction.Sum(Sheets("feuil12").Range("e75:e81")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j75:j81")))
End If
'VARIATION DES DETTES H.A.O.
'variation des dettes H.A.O.
If Sheets("feuil5").Range("m35") - Sheets("feuil5").Range("n35") > 0 Then
Sheets("feuil12").Range("j85") = Sheets("feuil5").Range("m35") - Sheets("feuil5").Range("n35")
Else
Sheets("feuil12").Range("e85") = -(Sheets("feuil5").Range("m35") - Sheets("feuil5").Range("n35"))
End If
'affectation dans le TAFIRE (adaptation SYSCOHADA révisé)
Sheets("feuil7").Range("g19") = (Sheets("feuil12").Range("j84") + Sheets("feuil12").Range("j85")) - (Sheets("feuil12").Range("e84") + Sheets("feuil12").Range("e85"))


'CALCUL ETE
'Sheets("feuil12").Range("e94") = Sheets("feuil9").Range("f38") 'EBE
'Sheets("feuil12").Range("e95") = -(Sheets("feuil12").Range("e87") - Sheets("feuil12").Range("j87"))
'Sheets("feuil12").Range("e96") = -Sheets("feuil9").Range("h23")

'affectation dans le Tableau 1 - Actif immobilisé (AUGMENTATIONS)
'les acquisitions
Sheets("feuil23").Range("c16") = Sheets("feuil28").Range("gz5001") 'frais de développement et de prospection
Sheets("feuil23").Range("c17") = Sheets("feuil28").Range("ha5001") + Sheets("feuil28").Range("hb5001") + Sheets("feuil28").Range("hc5001") 'Brevets, licences, logiciels
Sheets("feuil23").Range("c18") = Sheets("feuil28").Range("hd5001") + Sheets("feuil28").Range("he5001") 'fonds commercial
Sheets("feuil23").Range("c19") = Sheets("feuil28").Range("hf5001") + Sheets("feuil28").Range("hg5001") 'autres immob. incorporelles

Sheets("feuil23").Range("c21") = Sheets("feuil28").Range("hk5001") 'Terrains
Sheets("feuil23").Range("c22") = Sheets("feuil28").Range("ka5001") 'Terrains - immeuble de placement
Sheets("feuil23").Range("c23") = Sheets("feuil28").Range("hl5001") + Sheets("feuil28").Range("hm5001") + Sheets("feuil28").Range("hn5001") + Sheets("feuil28").Range("ho5001") 'bâtiments
Sheets("feuil23").Range("c24") = Sheets("feuil28").Range("kb5001") 'bâtiments - immeuble de placement
Sheets("feuil23").Range("c25") = Sheets("feuil28").Range("hp5001") + Sheets("feuil28").Range("hq5001") + Sheets("feuil28").Range("hr5001") 'installations et agenc.
Sheets("feuil23").Range("c26") = Sheets("feuil28").Range("hs5001") 'matériel
Sheets("feuil23").Range("c27") = Sheets("feuil28").Range("ht5001") 'matériel de transport

Sheets("feuil23").Range("c29") = Sheets("feuil28").Range("hw5001") 'Avances sur immob.
Sheets("feuil23").Range("c33") = Sheets("feuil28").Range("hx5001") 'Titre de participation
Sheets("feuil23").Range("c34") = Sheets("feuil28").Range("hy5001") 'Autres immob. financières

'affectation dans le Tableau 1 - Actif immobilisé (DIMINUTIONS)
'les cessions
Sheets("feuil23").Range("f16") = Sheets("feuil28").Range("hz5001") 'frais de dévelop et prospection
Sheets("feuil23").Range("f17") = Sheets("feuil28").Range("ia5001") + Sheets("feuil28").Range("ib5001") + Sheets("feuil28").Range("ic5001") 'Brevets, licences, logiciels
Sheets("feuil23").Range("f18") = Sheets("feuil28").Range("id5001") + Sheets("feuil28").Range("ie5001") 'fonds commercial
Sheets("feuil23").Range("f19") = Sheets("feuil28").Range("if5001") + Sheets("feuil28").Range("ig5001") 'autres immob. incorporelles

Sheets("feuil23").Range("f21") = Sheets("feuil28").Range("ik5001") 'Terrains
Sheets("feuil23").Range("f22") = Sheets("feuil28").Range("kc5001") 'Terrains - immeuble de placement
Sheets("feuil23").Range("f23") = Sheets("feuil28").Range("il5001") + Sheets("feuil28").Range("im5001") + Sheets("feuil28").Range("in5001") + Sheets("feuil28").Range("io5001") 'bâtiments
Sheets("feuil23").Range("f24") = Sheets("feuil28").Range("kd5001") 'Bâtiments - immeuble de placement
Sheets("feuil23").Range("f25") = Sheets("feuil28").Range("ip5001") + Sheets("feuil28").Range("iq5001") + Sheets("feuil28").Range("ir5001") 'installations et agenc.
Sheets("feuil23").Range("f26") = Sheets("feuil28").Range("is5001") 'matériel
Sheets("feuil23").Range("f27") = Sheets("feuil28").Range("jr5001") 'matériel de transport

Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("iw5001") 'Avances sur immob.
Sheets("feuil23").Range("f33") = Sheets("feuil28").Range("ix5001") 'Titre de participation
Sheets("feuil23").Range("f34") = Sheets("feuil28").Range("iy5001") + Sheets("feuil28").Range("iz5001") 'Autres immob. financières

'affectation dans le Tableau 1 - Actif immobilisé (VIREMENTS POSTE A POSTE)
'Frais de recherche encours
Sheets("feuil23").Range("g16") = Sheets("feuil28").Range("ih5001")
Sheets("feuil23").Range("c16") = Sheets("feuil23").Range("c16") - Sheets("feuil23").Range("g16")
Sheets("feuil23").Range("d16") = Sheets("feuil23").Range("g16")
'Brevets, licences, logiciel encours
Sheets("feuil23").Range("g17") = Sheets("feuil28").Range("ii5001")
Sheets("feuil23").Range("c17") = Sheets("feuil23").Range("c17") - Sheets("feuil23").Range("g17")
Sheets("feuil23").Range("d17") = Sheets("feuil23").Range("g17")
'Autres immob. incorporelles encours
Sheets("feuil23").Range("g19") = Sheets("feuil28").Range("ij5001")
Sheets("feuil23").Range("c19") = Sheets("feuil23").Range("c19") - Sheets("feuil23").Range("g19")
Sheets("feuil23").Range("d19") = Sheets("feuil23").Range("g19")

'Terrains encours
Sheets("feuil23").Range("g21") = Sheets("feuil28").Range("it5001")
Sheets("feuil23").Range("c21") = Sheets("feuil23").Range("c21") - Sheets("feuil23").Range("g21")
Sheets("feuil23").Range("d21") = Sheets("feuil23").Range("g21")
'Terrains - immeuble de placement encours
Sheets("feuil23").Range("g22") = Sheets("feuil28").Range("ke5001")
Sheets("feuil23").Range("c22") = Sheets("feuil23").Range("c22") - Sheets("feuil23").Range("g22")
Sheets("feuil23").Range("d22") = Sheets("feuil23").Range("g22")
'Bâtiments encours
Sheets("feuil23").Range("g23") = Sheets("feuil28").Range("jt5001")
Sheets("feuil23").Range("c23") = Sheets("feuil23").Range("c23") - Sheets("feuil23").Range("g23")
Sheets("feuil23").Range("d23") = Sheets("feuil23").Range("g23")
'Bâtiments - immeuble de placement encours
Sheets("feuil23").Range("g24") = Sheets("feuil28").Range("kf5001")
Sheets("feuil23").Range("c24") = Sheets("feuil23").Range("c24") - Sheets("feuil23").Range("g24")
Sheets("feuil23").Range("d24") = Sheets("feuil23").Range("g24")
'Installations et agts encours
Sheets("feuil23").Range("g25") = Sheets("feuil28").Range("ju5001")
Sheets("feuil23").Range("c25") = Sheets("feuil23").Range("c25") - Sheets("feuil23").Range("g25")
Sheets("feuil23").Range("d25") = Sheets("feuil23").Range("g25")
'Matériel encours
Sheets("feuil23").Range("g26") = Sheets("feuil28").Range("iv5001")
Sheets("feuil23").Range("c26") = Sheets("feuil23").Range("c26") - Sheets("feuil23").Range("g26")
Sheets("feuil23").Range("d26") = Sheets("feuil23").Range("g26")
'Matériel de transport encours
Sheets("feuil23").Range("g27") = Sheets("feuil28").Range("js5001")
Sheets("feuil23").Range("c27") = Sheets("feuil23").Range("c27") - Sheets("feuil23").Range("g27")
Sheets("feuil23").Range("d27") = Sheets("feuil23").Range("g27")

'___________________________________________________________________________________________________________________________

'CALCUL DES TOTAUX du Tableau 1 - Actif immobilisé
'total immobilisation incorporelle
Sheets("feuil23").Range("b30") = WorksheetFunction.Sum(Sheets("feuil23").Range("b16:b19")) 'mtt brut à l'ouverture
Sheets("feuil23").Range("c30") = WorksheetFunction.Sum(Sheets("feuil23").Range("c16:c19")) 'augmentation/acquisition
Sheets("feuil23").Range("d30") = WorksheetFunction.Sum(Sheets("feuil23").Range("d16:d19")) 'augmentation/virement poste
Sheets("feuil23").Range("e30") = WorksheetFunction.Sum(Sheets("feuil23").Range("e16:e19")) 'augmentation/réévaluation
Sheets("feuil23").Range("f30") = WorksheetFunction.Sum(Sheets("feuil23").Range("f16:f19")) 'diminution/cessions
Sheets("feuil23").Range("g30") = WorksheetFunction.Sum(Sheets("feuil23").Range("g16:g19")) 'diminution/virement poste
Sheets("feuil23").Range("i30") = WorksheetFunction.Sum(Sheets("feuil23").Range("i16:i19")) 'mtt brut à la clôture

'total immobilisation corporelle
Sheets("feuil23").Range("b31") = WorksheetFunction.Sum(Sheets("feuil23").Range("b21:b29")) 'mtt brut à l'ouverture
Sheets("feuil23").Range("c31") = WorksheetFunction.Sum(Sheets("feuil23").Range("c21:c29")) 'augmentation/acquisition
Sheets("feuil23").Range("d31") = WorksheetFunction.Sum(Sheets("feuil23").Range("d21:d29")) 'augmentation/virement poste
Sheets("feuil23").Range("e31") = WorksheetFunction.Sum(Sheets("feuil23").Range("e21:e29")) 'augmentation/réévaluation
Sheets("feuil23").Range("f31") = WorksheetFunction.Sum(Sheets("feuil23").Range("f21:f29")) 'diminution/cessions
Sheets("feuil23").Range("g31") = WorksheetFunction.Sum(Sheets("feuil23").Range("g21:g29")) 'diminution/virement poste
Sheets("feuil23").Range("i31") = WorksheetFunction.Sum(Sheets("feuil23").Range("i21:i29")) 'mtt brut à la clôture

'total général
Sheets("feuil23").Range("b35") = WorksheetFunction.Sum(Sheets("feuil23").Range("b33:b34")) + Sheets("feuil23").Range("b30") + Sheets("feuil23").Range("b31") 'mtt brut à l'ouverture
Sheets("feuil23").Range("c35") = WorksheetFunction.Sum(Sheets("feuil23").Range("c33:c34")) + Sheets("feuil23").Range("c30") + Sheets("feuil23").Range("c31") 'augmentation/acquisition
Sheets("feuil23").Range("d35") = WorksheetFunction.Sum(Sheets("feuil23").Range("d33:d34")) + Sheets("feuil23").Range("d30") + Sheets("feuil23").Range("d31") 'augmentation/virement poste
Sheets("feuil23").Range("e35") = WorksheetFunction.Sum(Sheets("feuil23").Range("e33:e34")) + Sheets("feuil23").Range("e30") + Sheets("feuil23").Range("e31") 'augmentation/réévaluation
Sheets("feuil23").Range("f35") = WorksheetFunction.Sum(Sheets("feuil23").Range("f33:f34")) + Sheets("feuil23").Range("f30") + Sheets("feuil23").Range("f31") 'diminution/cessions
Sheets("feuil23").Range("g35") = WorksheetFunction.Sum(Sheets("feuil23").Range("g33:g34")) + Sheets("feuil23").Range("g30") + Sheets("feuil23").Range("g31") 'diminution/virement poste
Sheets("feuil23").Range("i35") = WorksheetFunction.Sum(Sheets("feuil23").Range("i33:i34")) + Sheets("feuil23").Range("i30") + Sheets("feuil23").Range("i31") 'mtt brut à la clôture

'CALCUL ET AFFICHE LES ECRATS DU TABLEAU 1
For i = 16 To 35
If Sheets("feuil23").Cells(i, 2) + Sheets("feuil23").Cells(i, 3) + Sheets("feuil23").Cells(i, 4) + Sheets("feuil23").Cells(i, 5) - Sheets("feuil23").Cells(i, 6) - Sheets("feuil23").Cells(i, 7) - Sheets("feuil23").Cells(i, 9) = 0 Then
Else
Sheets("feuil23").Cells(i, 10) = "Ecart"
Sheets("feuil23").Cells(i, 11) = Sheets("feuil23").Cells(i, 2) + Sheets("feuil23").Cells(i, 3) + Sheets("feuil23").Cells(i, 4) + Sheets("feuil23").Cells(i, 5) - Sheets("feuil23").Cells(i, 6) - Sheets("feuil23").Cells(i, 7) - Sheets("feuil23").Cells(i, 9)
End If
Next

'_______________________________________________________________________________________________________

'affectation du Tableau 1 - Actif immobilisé dans le TAFIRE
Sheets("feuil7").Range("g26") = -Sheets("feuil23").Range("c30") 'immob. incorporelles
Sheets("feuil7").Range("g27") = -Sheets("feuil23").Range("c31") 'immob. corporelles
Sheets("feuil7").Range("g28") = -WorksheetFunction.Sum(Sheets("feuil23").Range("c33:c34")) 'immob. financières

'affectation des prix de cession
Sheets("feuil7").Range("g29") = Sheets("feuil28").Range("ja5001") + Sheets("feuil28").Range("jb5001") + Sheets("feuil23").Range("f29") 'immob. incorporelles et corporelles
Sheets("feuil7").Range("g30") = Sheets("feuil28").Range("jc5001") + Sheets("feuil28").Range("iy5001")  'immob. financières

'affectation des capitaux propres
Sheets("feuil7").Range("g35") = Sheets("feuil28").Range("jd5001") - Sheets("feuil28").Range("jp5001") 'augmentation du capital
Sheets("feuil7").Range("g37") = -Sheets("feuil28").Range("je5001") 'remboursement du capital
Sheets("feuil7").Range("g38") = -Sheets("feuil28").Range("jf5001") 'dividendes distribués
Sheets("feuil7").Range("g36") = Sheets("feuil28").Range("jm5001") 'subvention d'investissement reçue
'affectation des dividendes pour le calcul de l'Autofinancement
Sheets("feuil12").Range("e35") = Sheets("feuil28").Range("jf5001") 'dividendes distribués

'affectation des capitaux étrangers
Sheets("feuil7").Range("g43") = Sheets("feuil28").Range("jg5001")  'augmentation des emprunts
Sheets("feuil7").Range("g44") = Sheets("feuil28").Range("jh5001") + Sheets("feuil28").Range("ji5001")  'augmentation des divers emprunts
Sheets("feuil7").Range("g45") = -(Sheets("feuil28").Range("jj5001") + Sheets("feuil28").Range("jk5001") + Sheets("feuil28").Range("jl5001")) 'remboursement des emprunts

'affectation de la trésorerie nette du bilan
'trésorerie à l'ouverture N-1
Sheets("feuil7").Range("g12") = Sheets("feuil5").Range("h45") - Sheets("feuil5").Range("n45")

'trésorerie à la clôture N
Sheets("feuil7").Range("g54") = Sheets("feuil5").Range("g45") - Sheets("feuil5").Range("m45")


edite_tafire_n_suite

'demande de confirmation
End If

'condition d'édition
End If
End If

'condition d'installation
'Else
'MsgBox "Désolé  !  Veuillez d'abord installer votre logiciel."
'End If

'délai d'essai
End If

'mise en forme conditionnelle
Sheets("feuil28").Range("zc18").ClearContents
End Sub
Private Sub annuler_notes_tresorerie()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

If Sheets("feuil12").Range("e81") + Sheets("feuil12").Range("j81") <> 0 Then
Sheets("feuil12").Range("e20:e23").ClearContents
Sheets("feuil12").Range("j19:j22").ClearContents
Sheets("feuil12").Range("e37:e41").ClearContents
Sheets("feuil12").Range("j37:j41").ClearContents
Sheets("feuil12").Range("e43").ClearContents
Sheets("feuil12").Range("j43").ClearContents
Sheets("feuil12").Range("e30").ClearContents

Sheets("feuil12").Range("e59:e61").ClearContents
Sheets("feuil12").Range("j59:j61").ClearContents
Sheets("feuil12").Range("e64").ClearContents
Sheets("feuil12").Range("j64").ClearContents

Sheets("feuil12").Range("e69:e73").ClearContents
Sheets("feuil12").Range("j69:j73").ClearContents
Sheets("feuil12").Range("e78").ClearContents
Sheets("feuil12").Range("j78").ClearContents

Sheets("feuil12").Range("e81").ClearContents
Sheets("feuil12").Range("j81").ClearContents

Sheets("feuil12").Range("e88:e90").ClearContents

Else
Sheets("feuil12").Range("j88:j90").ClearContents
Sheets("feuil12").Range("j26").ClearContents
Sheets("feuil12").Range("j30").ClearContents
End If

End If
End Sub
Private Sub retour_balance_n()
Sheets("feuil28").Activate
End Sub
Private Sub retour_balance_n_1()
Sheets("feuil28").Activate
End Sub
Private Sub effacer_balance_n()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
Sheets("feuil2").Range("a3:h5000").ClearContents
End If
End Sub
Private Sub effacer_balance_n_1()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
Sheets("feuil1").Range("a3:h5000").ClearContents
End If
End Sub
Private Sub annuler_tafire()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

If Sheets("feuil7").Range("g54") <> "" Then
'note trésorerie - calcul CAFG
Sheets("feuil12").Range("e20:e26").ClearContents
Sheets("feuil12").Range("j19:j27").ClearContents
Sheets("feuil12").Range("e42:e47").ClearContents
Sheets("feuil12").Range("j42:j47").ClearContents
Sheets("feuil12").Range("e35").ClearContents

Sheets("feuil12").Range("e65:e70").ClearContents
Sheets("feuil12").Range("j65:j70").ClearContents

Sheets("feuil12").Range("e75:e88").ClearContents
Sheets("feuil12").Range("j75:j88").ClearContents
Sheets("feuil12").Range("e94:e96").ClearContents

'Tafire
Sheets("feuil7").Range("g12:g54").ClearContents
Sheets("feuil7").Range("d22").ClearContents
Sheets("feuil7").Range("j53").ClearContents 'message d'écart
Sheets("feuil7").Range("k53").ClearContents 'message d'écart
Sheets("feuil23").Range("c16:g35").ClearContents 'tableau 1 - Actif immobilisé N
Sheets("feuil23").Range("j16:k35").ClearContents 'message d'écart du tableau 1

'pour les calaculs de l'analyse financière
Sheets("feuil31").Range("j1").ClearContents

'efface d'abord les données de N de la fiche
Sheets("feuil18").Range("g11:g107").ClearContents
Sheets("feuil18").Range("g110:g113").ClearContents
Sheets("feuil18").Range("d12").ClearContents
Sheets("feuil18").Range("d107").ClearContents

Else

'notes de trésorerie - calcul CAFG
Sheets("feuil12").Range("j94:j96").ClearContents
Sheets("feuil12").Range("j31").ClearContents
Sheets("feuil12").Range("j35").ClearContents

'Tafire
Sheets("feuil7").Range("h12:h54").ClearContents
Sheets("feuil7").Range("e22").ClearContents
Sheets("feuil7").Range("j54").ClearContents 'message d'écart
Sheets("feuil7").Range("k54").ClearContents 'message d'écart
Sheets("feuil24").Range("c16:g35").ClearContents 'tableau 1 - Actif immobilisé N-1
Sheets("feuil24").Range("j16:k35").ClearContents 'message d'écart du tableau 1

'pour les données de N-1 de la fiche explicative
Sheets("feuil18").Range("h11:h107").ClearContents
Sheets("feuil18").Range("h110:h113").ClearContents
Sheets("feuil18").Range("e12").ClearContents
Sheets("feuil18").Range("e107").ClearContents

End If

End If
End Sub
Private Sub annuler_tab1_n()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
Sheets("feuil23").Range("b16:k35").ClearContents
End If
End Sub
Private Sub annuler_tab1_n_1()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
Sheets("feuil24").Range("b16:i34").ClearContents
Sheets("feuil23").Range("b16:b34").ClearContents
End If
End Sub
Private Sub edite_tafire_n_1()
'animationv1
'mise en forme conditionnelle
Sheets("feuil28").Range("zc11") = 1

'délai d'essai
date_test = Now()
If Year(2020) > 2017 Then
MsgBox "Délai d'essai expiré 9!"
Else

'condition d'installation
'If Sheets("feuil12").Range("a100") = Left(Sheets("feuil12").Range("a101"), 10) Then


'condition d'édition
If WorksheetFunction.Sum(Sheets("feuil1").Range("g1:h5001")) = 0 Then
MsgBox "Désolé !  Aucune donnée à éditer."
Else

If Sheets("feuil5").Range("n47") = "" Then
MsgBox "Veuillez d'abord éditer le Bilan N-1 !"
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition du Tableau de trésorerie N-1 ?", vbYesNo, "Demande de confirmation") = vbYes Then

'annule bilan N-2
Sheets("feuil5").Range("ae14:ag47").ClearContents
Sheets("feuil5").Range("am13:am47").ClearContents
'edite bilan N-2
edite_bilan_n_2


'efface les données note trésorerie - calcul CAFG
Sheets("feuil12").Range("e20:e26").ClearContents
Sheets("feuil12").Range("j19:j27").ClearContents
Sheets("feuil12").Range("j29").ClearContents
Sheets("feuil12").Range("e29").ClearContents
Sheets("feuil12").Range("e42:e47").ClearContents
Sheets("feuil12").Range("j42:j47").ClearContents
Sheets("feuil12").Range("e35").ClearContents

Sheets("feuil12").Range("e65:e71").ClearContents
Sheets("feuil12").Range("j65:j71").ClearContents

Sheets("feuil12").Range("e75:e88").ClearContents
Sheets("feuil12").Range("j75:j88").ClearContents
Sheets("feuil12").Range("e94:e96").ClearContents

'efface les données Tafire
Sheets("feuil7").Range("h12:h54").ClearContents
Sheets("feuil7").Range("e22").ClearContents
Sheets("feuil7").Range("j54").ClearContents 'message d'écart
Sheets("feuil7").Range("k54").ClearContents 'message d'écart

'recup des données pour le TAFIRE N
For i = 3 To 5000

'adaptation SYSCOHADA révisé recup compte 211+2191+2181 Augmentation des Frais de dévelop et prospection
If Left(Sheets("feuil1").Cells(i, 1), 3) = 211 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2191 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2181 Then
Sheets("feuil28").Cells(i, 208) = Sheets("feuil1").Cells(i, 5) 'colonne GZ
Else
End If

'recup compte 212 Augmentation des Brevets, licences, logiciels
If Left(Sheets("feuil1").Cells(i, 1), 3) = 212 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2192 Then
Sheets("feuil28").Cells(i, 209) = Sheets("feuil1").Cells(i, 5) 'colonne HA
Else
End If

'recup compte 213 Augmentation des Brevets, licences, logiciels
If Left(Sheets("feuil1").Cells(i, 1), 3) = 213 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2193 Then
Sheets("feuil28").Cells(i, 210) = Sheets("feuil1").Cells(i, 5) 'colonne HB
Else
End If

'recup compte 214 Augmentation des Brevets, licences, logiciels
If Left(Sheets("feuil1").Cells(i, 1), 3) = 214 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2194 Then
Sheets("feuil28").Cells(i, 211) = Sheets("feuil1").Cells(i, 5) 'colonne HC
Else
End If

'recup compte 215 Augmentation du Fonds commercial
If Left(Sheets("feuil1").Cells(i, 1), 3) = 215 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2195 Then
Sheets("feuil28").Cells(i, 212) = Sheets("feuil1").Cells(i, 5) 'colonne HD
Else
End If

'recup compte 216 Augmentation du Fonds commercial
If Left(Sheets("feuil1").Cells(i, 1), 3) = 216 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2196 Then
Sheets("feuil28").Cells(i, 213) = Sheets("feuil1").Cells(i, 5) 'colonne HE
Else
End If

'recup compte 217 Augmentation des Autres immob. incorporelles
If Left(Sheets("feuil1").Cells(i, 1), 3) = 217 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2197 Then
Sheets("feuil28").Cells(i, 214) = Sheets("feuil1").Cells(i, 5) 'colonne HF
Else
End If

'adaptation SYSCOHADA révisé recup compte 218 Augmentation des Autres immob. incorporelles
If Left(Sheets("feuil1").Cells(i, 1), 3) = 218 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2198 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2181 Then
Else
Sheets("feuil28").Cells(i, 215) = Sheets("feuil1").Cells(i, 5) 'colonne HG
End If
Else
End If

'recup compte 2191 Augmentation des Immob. incorporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2191 Then
Sheets("feuil28").Cells(i, 216) = Sheets("feuil1").Cells(i, 5) 'colonne HH
Else
End If

'recup compte 2193 Augmentation des Immob. incorporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2193 Then
Sheets("feuil28").Cells(i, 217) = Sheets("feuil1").Cells(i, 5) 'colonne HI
Else
End If

'recup compte 2198 Augmentation des Immob. incorporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2198 Then
Sheets("feuil28").Cells(i, 218) = Sheets("feuil1").Cells(i, 5) 'colonne HJ
Else
End If

'adaptation SYSCOHADA révisé recup compte 22 Augmentation des terrains
If Left(Sheets("feuil1").Cells(i, 1), 2) = 22 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2281 Then
Else
Sheets("feuil28").Cells(i, 219) = Sheets("feuil1").Cells(i, 5) 'colonne HK
End If
Else
End If

'recup compte 231 Augmentation des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 231 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2391 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2315 Then
Else
Sheets("feuil28").Cells(i, 220) = Sheets("feuil1").Cells(i, 5) 'colonne HL
End If
Else
End If

'recup compte 232 Augmentation des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 232 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2392 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2325 Then
Else
Sheets("feuil28").Cells(i, 221) = Sheets("feuil1").Cells(i, 5) 'colonne HM
End If
Else
End If

'recup compte 233 Augmentation des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 233 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2393 Then
Sheets("feuil28").Cells(i, 222) = Sheets("feuil1").Cells(i, 5) 'colonne HN
Else
End If

'recup compte 237 Augmentation des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 237 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2397 Then
Sheets("feuil28").Cells(i, 223) = Sheets("feuil1").Cells(i, 5) 'colonne HO
Else
End If

'recup compte 234 Augmentation des Installations et agenc.
If Left(Sheets("feuil1").Cells(i, 1), 3) = 234 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2394 Then
Sheets("feuil28").Cells(i, 224) = Sheets("feuil1").Cells(i, 5) 'colonne HP
Else
End If

'recup compte 235 Augmentation des Installations et agenc.
If Left(Sheets("feuil1").Cells(i, 1), 3) = 235 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2395 Then
Sheets("feuil28").Cells(i, 225) = Sheets("feuil1").Cells(i, 5) 'colonne HQ
Else
End If

'recup compte 238 Augmentation des Installations et agenc.
If Left(Sheets("feuil1").Cells(i, 1), 3) = 238 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2398 Then
Sheets("feuil28").Cells(i, 226) = Sheets("feuil1").Cells(i, 5) 'colonne HR
Else
End If

'recup compte 24 sauf 245 Augmentation du Matériel
If Left(Sheets("feuil1").Cells(i, 1), 2) = 24 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 245 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2495 Then
Else
Sheets("feuil28").Cells(i, 227) = Sheets("feuil1").Cells(i, 5) 'colonne HS
End If
End If
Else
End If

'recup compte 245 Augmentation du matériel de transport
If Left(Sheets("feuil1").Cells(i, 1), 3) = 245 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2495 Then
Sheets("feuil28").Cells(i, 228) = Sheets("feuil1").Cells(i, 5) 'colonne HT
Else
End If

'recup compte 239 Augmentation des Immob. corporelles encours
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 239 Then
'Sheets("feuil28").Cells(i, 229) = Sheets("feuil2").Cells(i, 5) 'colonne HU
'Else
'End If

'recup compte 249 Augmentation des Immob. corporelles encours
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 249 Then
'Sheets("feuil28").Cells(i, 230) = Sheets("feuil2").Cells(i, 5) 'colonne HV
'Else
'End If

'recup compte 25 Augmentation des Avances sur immob.
If Left(Sheets("feuil1").Cells(i, 1), 2) = 25 Then
Sheets("feuil28").Cells(i, 231) = Sheets("feuil1").Cells(i, 5) 'colonne HW
Else
End If

'recup compte 26 Augmentation des Titres de participation
If Left(Sheets("feuil1").Cells(i, 1), 2) = 26 Then
Sheets("feuil28").Cells(i, 232) = Sheets("feuil1").Cells(i, 5) 'colonne HX
Else
End If

'recup compte 27 Augmentation des Autres immob. financières
If Left(Sheets("feuil1").Cells(i, 1), 2) = 27 Then
Sheets("feuil28").Cells(i, 233) = Sheets("feuil1").Cells(i, 5) 'colonne HY
Else
End If


'adaptation SYSCOHADA révisé recup compte 211+2181 Diminution des Frais de dévelop et prospection
If Left(Sheets("feuil1").Cells(i, 1), 3) = 211 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2181 Then
Sheets("feuil28").Cells(i, 234) = Sheets("feuil1").Cells(i, 6) 'colonne HZ
Else
End If

'recup compte 212 Diminution des Brevets, licences, logiciels
If Left(Sheets("feuil1").Cells(i, 1), 3) = 212 Then
Sheets("feuil28").Cells(i, 235) = Sheets("feuil1").Cells(i, 6) 'colonne IA
Else
End If

'recup compte 213 Diminution des Brevets, licences, logiciels
If Left(Sheets("feuil1").Cells(i, 1), 3) = 213 Then
Sheets("feuil28").Cells(i, 236) = Sheets("feuil1").Cells(i, 6) 'colonne IB
Else
End If

'recup compte 214 Diminution des Brevets, licences, logiciels
If Left(Sheets("feuil1").Cells(i, 1), 3) = 214 Then
Sheets("feuil28").Cells(i, 237) = Sheets("feuil1").Cells(i, 6) 'colonne IC
Else
End If

'recup compte 215 Diminution du Fonds commercial
If Left(Sheets("feuil1").Cells(i, 1), 3) = 215 Then
Sheets("feuil28").Cells(i, 238) = Sheets("feuil1").Cells(i, 6) 'colonne ID
Else
End If

'recup compte 216 Diminution du Fonds commercial
If Left(Sheets("feuil1").Cells(i, 1), 3) = 216 Then
Sheets("feuil28").Cells(i, 239) = Sheets("feuil1").Cells(i, 6) 'colonne IE
Else
End If

'recup compte 217 Diminution des Autres immob. incorporelles
If Left(Sheets("feuil1").Cells(i, 1), 3) = 217 Then
Sheets("feuil28").Cells(i, 240) = Sheets("feuil1").Cells(i, 6) 'colonne IF
Else
End If

'recup compte 218 Diminution des Autres immob. incorporelles
If Left(Sheets("feuil1").Cells(i, 1), 3) = 218 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2181 Then
Else
Sheets("feuil28").Cells(i, 241) = Sheets("feuil1").Cells(i, 6) 'colonne IG
End If
Else
End If

'recup compte 2191 Diminution des Immob. incorporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2191 Then
Sheets("feuil28").Cells(i, 242) = Sheets("feuil1").Cells(i, 6) 'colonne IH
Else
End If

'recup compte 2193 Diminution des Immob. incorporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2193 Then
Sheets("feuil28").Cells(i, 243) = Sheets("feuil1").Cells(i, 6) 'colonne II
Else
End If

'recup compte 2198 Diminution des Immob. incorporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2198 Then
Sheets("feuil28").Cells(i, 244) = Sheets("feuil1").Cells(i, 6) 'colonne IJ
Else
End If

'recup compte 22 sauf 229 Diminution des Terrains
If Left(Sheets("feuil1").Cells(i, 1), 2) = 22 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 229 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2281 Then
Else
Sheets("feuil28").Cells(i, 245) = Sheets("feuil1").Cells(i, 6) 'colonne IK
End If
End If
Else
End If

'recup compte 231 Diminution des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 231 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2315 Then
Else
Sheets("feuil28").Cells(i, 246) = Sheets("feuil1").Cells(i, 6) 'colonne IL
End If
Else
End If

'recup compte 232 Diminution des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 232 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2325 Then
Else
Sheets("feuil28").Cells(i, 247) = Sheets("feuil1").Cells(i, 6) 'colonne IM
End If
Else
End If

'recup compte 233 Diminution des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 233 Then
Sheets("feuil28").Cells(i, 248) = Sheets("feuil1").Cells(i, 6) 'colonne IN
Else
End If

'recup compte 237 Diminution des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 237 Then
Sheets("feuil28").Cells(i, 249) = Sheets("feuil1").Cells(i, 6) 'colonne IO
Else
End If

'recup compte 234 Diminution des Installations et agenc.
If Left(Sheets("feuil1").Cells(i, 1), 3) = 234 Then
Sheets("feuil28").Cells(i, 250) = Sheets("feuil1").Cells(i, 6) 'colonne IP
Else
End If

'recup compte 235 Diminution des Installations et agenc.
If Left(Sheets("feuil1").Cells(i, 1), 3) = 235 Then
Sheets("feuil28").Cells(i, 251) = Sheets("feuil1").Cells(i, 6) 'colonne IQ
Else
End If

'recup compte 238 Diminution des Installations et agenc.
If Left(Sheets("feuil1").Cells(i, 1), 3) = 238 Then
Sheets("feuil28").Cells(i, 252) = Sheets("feuil1").Cells(i, 6) 'colonne IR
Else
End If

'recup compte 24 sauf 249 Diminution du Matériel sauf 245 Transport
If Left(Sheets("feuil1").Cells(i, 1), 2) = 24 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 249 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 3) = 245 Then
Else
Sheets("feuil28").Cells(i, 253) = Sheets("feuil1").Cells(i, 6) 'colonne IS
End If
End If
Else
End If

'adaptation SYSCOHADA révisé recup compte 229 Diminution des Immob. corporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 3) = 229 Then
If Left(Sheets("feuil1").Cells(i, 1), 5) = 22981 Then
Else
Sheets("feuil28").Cells(i, 254) = Sheets("feuil1").Cells(i, 6) 'colonne IT
End If
Else
End If

'recup compte 239 Diminution des Immob. corporelles encours
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 239 Then
'Sheets("feuil28").Cells(i, 255) = Sheets("feuil2").Cells(i, 6) 'colonne IU
'Else
'End If

'recup compte 249 Diminution des Immob. corporelles encours sauf 2495
If Left(Sheets("feuil1").Cells(i, 1), 3) = 249 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2495 Then
Else
Sheets("feuil28").Cells(i, 256) = Sheets("feuil1").Cells(i, 6) 'colonne IV
End If
Else
End If

'recup compte 25 Diminution des Avances sur immob.
If Left(Sheets("feuil1").Cells(i, 1), 2) = 25 Then
Sheets("feuil28").Cells(i, 257) = Sheets("feuil1").Cells(i, 6) 'colonne IW
Else
End If

'recup compte 26 Diminution des Titres de participation
If Left(Sheets("feuil1").Cells(i, 1), 2) = 26 Then
Sheets("feuil28").Cells(i, 258) = Sheets("feuil1").Cells(i, 6) 'colonne IX
Else
End If

'recup compte 27 sauf 274 Diminution des Autres immob. financières
If Left(Sheets("feuil1").Cells(i, 1), 2) = 27 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 274 Then
Else
Sheets("feuil28").Cells(i, 259) = Sheets("feuil1").Cells(i, 6) 'colonne IY
End If
Else
End If

'recup compte 274 Diminution des Autres immob. financières
If Left(Sheets("feuil1").Cells(i, 1), 3) = 274 Then
Sheets("feuil28").Cells(i, 260) = Sheets("feuil1").Cells(i, 6) 'colonne IZ
Else
End If

'adaptation SYSCOHADA révisé
'recup compte 821+7541 Prix de cession des immob. incorporelles
If Left(Sheets("feuil1").Cells(i, 1), 3) = 821 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7541 Then
Sheets("feuil28").Cells(i, 261) = Sheets("feuil1").Cells(i, 8) 'colonne JA
Else
End If

'recup compte 822 Prix de cession des immob. corporelles
If Left(Sheets("feuil1").Cells(i, 1), 3) = 822 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7542 Then
Sheets("feuil28").Cells(i, 262) = Sheets("feuil1").Cells(i, 8) 'colonne JB
Else
End If

'recup compte 826 Prix de cession des immob. financières
If Left(Sheets("feuil1").Cells(i, 1), 3) = 826 Then
Sheets("feuil28").Cells(i, 263) = Sheets("feuil1").Cells(i, 8) 'colonne JC
Else
End If

'recup compte 10c Augmentation de capital
If Left(Sheets("feuil1").Cells(i, 1), 2) = 10 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 106 Then
Else
Sheets("feuil28").Cells(i, 264) = Sheets("feuil1").Cells(i, 6) 'colonne JD
End If
Else
End If

'recup compte 10d sauf 109 Réduction du capital
If Left(Sheets("feuil1").Cells(i, 1), 2) = 10 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 109 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 3) = 106 Then
Else
Sheets("feuil28").Cells(i, 265) = Sheets("feuil1").Cells(i, 5) 'colonne JE
End If
End If
Else
End If

'RATTRAPAGE COMPTE 109d
'recup compte 109d Augmentation de capital
If Left(Sheets("feuil1").Cells(i, 1), 3) = 109 Then
Sheets("feuil28").Cells(i, 276) = Sheets("feuil1").Cells(i, 5) 'colonne JP
Else
End If


'recup compte 465 Dividendes distribués
If Left(Sheets("feuil1").Cells(i, 1), 3) = 465 Then
Sheets("feuil28").Cells(i, 266) = Sheets("feuil1").Cells(i, 5) 'colonne JF
Else
End If

'recup compte 16 Augmentation des emprunts
If Left(Sheets("feuil1").Cells(i, 1), 2) = 16 Then
Sheets("feuil28").Cells(i, 267) = Sheets("feuil1").Cells(i, 6) 'colonne JG
Else
End If

'recup compte 17 Augmentation des emprunts
If Left(Sheets("feuil1").Cells(i, 1), 2) = 17 Then
Sheets("feuil28").Cells(i, 268) = Sheets("feuil1").Cells(i, 6) 'colonne JH
Else
End If

'recup compte 18 Augmentation des emprunts
If Left(Sheets("feuil1").Cells(i, 1), 2) = 18 Then
Sheets("feuil28").Cells(i, 269) = Sheets("feuil1").Cells(i, 6) 'colonne JI
Else
End If

'recup compte 16 Remboursement des emprunts
If Left(Sheets("feuil1").Cells(i, 1), 2) = 16 Then
Sheets("feuil28").Cells(i, 270) = Sheets("feuil1").Cells(i, 5) 'colonne JJ
Else
End If

'recup compte 17 Remboursement des emprunts
If Left(Sheets("feuil1").Cells(i, 1), 2) = 17 Then
Sheets("feuil28").Cells(i, 271) = Sheets("feuil1").Cells(i, 5) 'colonne JK
Else
End If

'recup compte 18 Remboursement des emprunts
If Left(Sheets("feuil1").Cells(i, 1), 2) = 18 Then
Sheets("feuil28").Cells(i, 272) = Sheets("feuil1").Cells(i, 5) 'colonne JL
Else
End If

'recup compte 14 Subvention d'investissement reçu
If Left(Sheets("feuil1").Cells(i, 1), 2) = 14 Then
Sheets("feuil28").Cells(i, 273) = Sheets("feuil1").Cells(i, 6) 'colonne JM
Else
End If

'Adaptation compte 206 SYSCOHADA
'recup compte 206 Dimunition des Primes de remboursement
If Left(Sheets("feuil1").Cells(i, 1), 3) = 206 Then
Sheets("feuil28").Cells(i, 277) = Sheets("feuil1").Cells(i, 6) 'colonne JQ
Else
End If

'recup compte 245 Dimunition du Matériel de transport
If Left(Sheets("feuil1").Cells(i, 1), 3) = 245 Then
Sheets("feuil28").Cells(i, 278) = Sheets("feuil1").Cells(i, 6) 'colonne JR
Else
End If

'recup compte 2495 Diminution du Matériel de transport encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2495 Then
Sheets("feuil28").Cells(i, 279) = Sheets("feuil1").Cells(i, 6) 'colonne JS
Else
End If

'adaptation SYSCOHADA révisé recup compte 2391+2392+2393+2397 Diminution des Bâtiments encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2391 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2392 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2393 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2397 Then
If Left(Sheets("feuil1").Cells(i, 1), 5) = 23915 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 23925 Then
Else
Sheets("feuil28").Cells(i, 280) = Sheets("feuil1").Cells(i, 6) 'colonne JT
End If
Else
End If

'recup compte 2394+2395+2398 Diminution des Bâtiments encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2394 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2395 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2398 Then
Sheets("feuil28").Cells(i, 281) = Sheets("feuil1").Cells(i, 6) 'colonne JU
Else
End If



'ADAPTATION SYSCOHADA révisé - immeuble de placement
'recup compte 2281 Augmentation des terrains - immeuble de placement
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2281 Then
Sheets("feuil28").Cells(i, 287) = Sheets("feuil1").Cells(i, 5) 'colonne KA
Else
End If

'recup compte 2315+2325 Augmentation des bâtiments - immeuble de placement
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2315 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2325 Then
Sheets("feuil28").Cells(i, 288) = Sheets("feuil1").Cells(i, 5) 'colonne KB
Else
End If


'recup compte 2281 sauf 22981 Diminution des Terrains - immeuble de placement
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2281 Then
If Left(Sheets("feuil1").Cells(i, 1), 5) = 22981 Then
Else
Sheets("feuil28").Cells(i, 289) = Sheets("feuil1").Cells(i, 6) 'colonne KC
End If
Else
End If

'recup compte 2315+2325 sauf 23915+23925 Diminution des bâtiments - immeuble de placement
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2315 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2325 Then
If Left(Sheets("feuil1").Cells(i, 1), 5) = 23915 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 23925 Then
Else
Sheets("feuil28").Cells(i, 290) = Sheets("feuil1").Cells(i, 6) 'colonne KD
End If
Else
End If

'recup compte 22981 Diminution des terrains - immeuble de placement encours
If Left(Sheets("feuil1").Cells(i, 1), 5) = 22981 Then
Sheets("feuil28").Cells(i, 291) = Sheets("feuil1").Cells(i, 6) 'colonne KE
Else
End If

'recup compte 23915+23925 Diminution des bâtiments - immeuble de placement encours
If Left(Sheets("feuil1").Cells(i, 1), 5) = 23915 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 23925 Then
Sheets("feuil28").Cells(i, 292) = Sheets("feuil1").Cells(i, 6) 'colonne KF
Else
End If



'ADAPTATION SYSCOHADA révisé - Pour le calcul de la CAFG
'recup compte 85 à déduire des charges H.A.O. dans le calcul de la CAFG
If Left(Sheets("feuil1").Cells(i, 1), 2) = 85 Then
Sheets("feuil28").Cells(i, 293) = Sheets("feuil1").Cells(i, 7) 'colonne KG
Else
End If

'recup compte 86 à déduire des produits H.A.O. dans le calcul de la CAFG
If Left(Sheets("feuil1").Cells(i, 1), 2) = 86 Then
Sheets("feuil28").Cells(i, 294) = Sheets("feuil1").Cells(i, 8) 'colonne KH
Else
End If

'recup compte 654 à déduire des autres charges dans le calcul de la CAFG
If Left(Sheets("feuil1").Cells(i, 1), 3) = 654 Then
Sheets("feuil28").Cells(i, 295) = Sheets("feuil1").Cells(i, 7) 'colonne KI
Else
End If

'recup compte 754 à déduire des autres produits dans le calcul de la CAFG
If Left(Sheets("feuil1").Cells(i, 1), 3) = 754 Then
Sheets("feuil28").Cells(i, 296) = Sheets("feuil1").Cells(i, 8) 'colonne KJ
Else
End If


Next



'affecte comptes 211+2181 Augmentation des Frais de dévelop et prospection
Sheets("feuil28").Range("gz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gz1:gz5000")) 'compte 211
'Sheets("feuil23").Range("c16") = Sheets("feuil28").Range("gz5001")

'affecte comptes 212+213+214 Augmentation des Brevets, licences, logiciels
Sheets("feuil28").Range("ha5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ha1:ha5000")) 'compte 212
Sheets("feuil28").Range("hb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hb1:hb5000")) 'compte 213
Sheets("feuil28").Range("hc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hc1:hc5000")) 'compte 214
'Sheets("feuil23").Range("c17") = Sheets("feuil28").Range("ha5001")+Sheets("feuil28").Range("hb5001")+Sheets("feuil28").Range("hc5001")

'affecte comptes 215+216 Augmentation du Fonds commercial
Sheets("feuil28").Range("hd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hd1:hd5000")) 'compte 215
Sheets("feuil28").Range("he5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("he1:he5000")) 'compte 216
'Sheets("feuil23").Range("c18") = Sheets("feuil28").Range("hd5001")+Sheets("feuil28").Range("he5001")

'affecte comptes 217+218 Augmentation des Autres immob. incorporelles
Sheets("feuil28").Range("hf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hf1:hf5000")) 'compte 217
Sheets("feuil28").Range("hg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hg1:hg5000")) 'compte 218
'Sheets("feuil23").Range("c19") = Sheets("feuil28").Range("hf5001")+Sheets("feuil28").Range("hg5001")

'affecte comptes 2191+2193+2198 Augmentation des Immob. incorporelles encours
Sheets("feuil28").Range("hh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hh1:hh5000")) 'compte 2191
Sheets("feuil28").Range("hi5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hi1:hi5000")) 'compte 2193
Sheets("feuil28").Range("hj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hj1:hj5000")) 'compte 2198
'Sheets("feuil23").Range("c20") = Sheets("feuil28").Range("hh5001")+Sheets("feuil28").Range("hi5001")+Sheets("feuil28").Range("hj5001")

'affecte comptes 22 Augmentation des Terrains
Sheets("feuil28").Range("hk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hk1:hk5000")) 'compte 22
'Sheets("feuil23").Range("c22") = Sheets("feuil28").Range("hk5001")

'affecte comptes 231+232+233+237 Augmentation des Bâtiments
Sheets("feuil28").Range("hl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hl1:hl5000")) 'compte 231
Sheets("feuil28").Range("hm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hm1:hm5000")) 'compte 232
Sheets("feuil28").Range("hn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hn1:hn5000")) 'compte 233
Sheets("feuil28").Range("ho5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ho1:ho5000")) 'compte 237
'Sheets("feuil23").Range("c23") = Sheets("feuil28").Range("hl5001")+Sheets("feuil28").Range("hm5001")+Sheets("feuil28").Range("hn5001")+Sheets("feuil28").Range("ho5001")

'affecte comptes 234+235+238 Augmentation des Installations et agenc.
Sheets("feuil28").Range("hp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hp1:hp5000")) 'compte 234
Sheets("feuil28").Range("hq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hq1:hq5000")) 'compte 235
Sheets("feuil28").Range("hr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hr1:hr5000")) 'compte 238
'Sheets("feuil23").Range("c24") = Sheets("feuil28").Range("hp5001")+Sheets("feuil28").Range("hq5001")+Sheets("feuil28").Range("hr5001")

'affecte comptes 24 Augmentation du Matériel
Sheets("feuil28").Range("hs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hs1:hs5000")) 'compte 24 sauf 249
'Sheets("feuil23").Range("c25") = Sheets("feuil28").Range("hs5001")

'affecte comptes 245 Augmentation du Matériel de transport
Sheets("feuil28").Range("ht5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ht1:ht5000")) 'compte 245
'Sheets("feuil23").Range("c29") = Sheets("feuil28").Range("ht5001")

'affecte comptes 25 Augmentation des Avances sur immob.
Sheets("feuil28").Range("hw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hw1:hw5000")) 'compte 25
'Sheets("feuil23").Range("c28") = Sheets("feuil28").Range("hw5001")

'affecte comptes 26 Augmentation des Titres de participation
Sheets("feuil28").Range("hx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hx1:hx5000")) 'compte 26
'Sheets("feuil23").Range("c30") = Sheets("feuil28").Range("hx5001")

'affecte comptes 27 Augmentation des Autres immob. financières
Sheets("feuil28").Range("hy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hy1:hy5000")) 'compte 27
'Sheets("feuil23").Range("c31") = Sheets("feuil28").Range("hy5001")




'affecte comptes 211+2181 Diminution des Frais de dévelop et prospection
Sheets("feuil28").Range("hz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hz1:hz5000")) 'compte 211
'Sheets("feuil23").Range("f16") = Sheets("feuil28").Range("hz5001")

'affecte comptes 212+213+214 Diminution des Brevets, licences, logiciels
Sheets("feuil28").Range("ia5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ia1:ia5000")) 'compte 212
Sheets("feuil28").Range("ib5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ib1:ib5000")) 'compte 213
Sheets("feuil28").Range("ic5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ic1:ic5000")) 'compte 214
'Sheets("feuil23").Range("f17") = Sheets("feuil28").Range("ia5001")+Sheets("feuil28").Range("ib5001")+Sheets("feuil28").Range("ic5001")

'affecte comptes 215+216 Diminution du Fonds commercial
Sheets("feuil28").Range("id5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("id1:id5000")) 'compte 215
Sheets("feuil28").Range("ie5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ie1:ie5000")) 'compte 216
'Sheets("feuil23").Range("f18") = Sheets("feuil28").Range("id5001")+Sheets("feuil28").Range("ie5001")

'affecte comptes 217+218 Diminution des Autres immob. incorporelles
Sheets("feuil28").Range("if5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("if1:if5000")) 'compte 217
Sheets("feuil28").Range("ig5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ig1:ig5000")) 'compte 218
'Sheets("feuil23").Range("f19") = Sheets("feuil28").Range("if5001")+Sheets("feuil28").Range("ig5001")

'affecte comptes 2191+2193+2198 Diminution des Immob. incorporelles encours
Sheets("feuil28").Range("ih5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ih1:ih5000")) 'compte 2191
Sheets("feuil28").Range("ii5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ii1:ii5000")) 'compte 2193
Sheets("feuil28").Range("ij5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ij1:ij5000")) 'compte 2198
'Sheets("feuil23").Range("f20") = Sheets("feuil28").Range("ih5001")+Sheets("feuil28").Range("ii5001")+Sheets("feuil28").Range("ij5001")

'affecte comptes 22 Diminution des Terrains
Sheets("feuil28").Range("ik5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ik1:ik5000")) 'compte 22
'Sheets("feuil23").Range("f22") = Sheets("feuil28").Range("ik5001")

'affecte comptes 231+232+233+237 Diminution des Bâtiments
Sheets("feuil28").Range("il5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("il1:il5000")) 'compte 231
Sheets("feuil28").Range("im5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("im1:im5000")) 'compte 232
Sheets("feuil28").Range("in5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("in1:in5000")) 'compte 233
Sheets("feuil28").Range("io5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("io1:io5000")) 'compte 237
'Sheets("feuil23").Range("f23") = Sheets("feuil28").Range("il5001")+Sheets("feuil28").Range("im5001")+Sheets("feuil28").Range("in5001")+Sheets("feuil28").Range("io5001")

'affecte comptes 234+235+238 Diminution des Installations et agenc.
Sheets("feuil28").Range("ip5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ip1:ip5000")) 'compte 234
Sheets("feuil28").Range("iq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iq1:iq5000")) 'compte 235
Sheets("feuil28").Range("ir5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ir1:ir5000")) 'compte 238
'Sheets("feuil23").Range("f24") = Sheets("feuil28").Range("ip5001")+Sheets("feuil28").Range("iq5001")+Sheets("feuil28").Range("ir5001")

'affecte comptes 24 sauf 249 Diminution du Matériel
Sheets("feuil28").Range("is5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("is1:is5000")) 'compte 24 sauf 249
'Sheets("feuil23").Range("f25") = Sheets("feuil28").Range("is5001")

'affecte comptes 229 Diminution des terains encours
Sheets("feuil28").Range("it5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("it1:it5000")) 'compte 229
'Sheets("feuil23").Range("f26") = Sheets("feuil28").Range("it5001")

'affecte comptes+249 Diminution du Matériel encours
Sheets("feuil28").Range("iv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iv1:iv5000")) 'compte 249
'Sheets("feuil23").Range("f26") = Sheets("feuil28").Range("iv5001")

'affecte comptes 25 Diminution des Avances sur immob.
Sheets("feuil28").Range("iw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iw1:iw5000")) 'compte 25
'Sheets("feuil23").Range("f28") = Sheets("feuil28").Range("iw5001")

'affecte comptes 26 Diminution des Titres de participation
Sheets("feuil28").Range("ix5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ix1:ix5000")) 'compte 26
'Sheets("feuil23").Range("f30") = Sheets("feuil28").Range("ix5001")

'affecte comptes 27 sauf 274 + 274 Diminution des Autres immob. financières
Sheets("feuil28").Range("iy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iy1:iy5000")) 'compte 27 sauf 274
Sheets("feuil28").Range("iz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iz1:iz5000")) 'compte 274
'Sheets("feuil23").Range("f31") = Sheets("feuil28").Range("iy5001")+Sheets("feuil28").Range("iz5001")

'affecte comptes 821 Prix de cession des immob. incorporelles
Sheets("feuil28").Range("ja5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ja1:ja5000")) 'compte 821
'Sheets("feuil7").Range("i29") = Sheets("feuil28").Range("ja5001")

'affecte comptes 822 Prix de cession des immob. corporelles
Sheets("feuil28").Range("jb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jb1:jb5000")) 'compte 822
'Sheets("feuil7").Range("i30") = Sheets("feuil28").Range("jb5001")

'affecte comptes 826 Prix de cession des immob. financières
Sheets("feuil28").Range("jc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jc1:jc5000")) 'compte 826
'Sheets("feuil7").Range("i31") = Sheets("feuil28").Range("jc5001")

'affecte comptes 10c -109d Augmentation du capital
Sheets("feuil28").Range("jd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jd1:jd5000")) 'compte 10c
Sheets("feuil28").Range("jp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jp1:jp5000")) 'compte 109d
'Sheets("feuil7").Range("i35") = Sheets("feuil28").Range("jd5001")-Sheets("feuil28").Range("jp5001")

'affecte comptes 10d sauf 109 Réduction du capital
Sheets("feuil28").Range("je5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("je1:je5000")) 'compte 10d sauf 109
'Sheets("feuil7").Range("h36") = Sheets("feuil28").Range("je5001")

'affecte comptes 465d Dividendes distribués
Sheets("feuil28").Range("jf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jf1:jf5000")) 'compte 465d
'Sheets("feuil7").Range("h37") = Sheets("feuil28").Range("jf5001")

'affecte comptes 16c+17c+18c Augmentation des emprunts
Sheets("feuil28").Range("jg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jg1:jg5000")) 'compte 16c
Sheets("feuil28").Range("jh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jh1:jh5000")) 'compte 17c
Sheets("feuil28").Range("ji5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ji1:ji5000")) 'compte 18c
'Sheets("feuil7").Range("i41") = Sheets("feuil28").Range("jg5001")+Sheets("feuil28").Range("jh5001")+Sheets("feuil28").Range("ji5001")

'affecte comptes 16d+17d+18d Remboursement des emprunts
Sheets("feuil28").Range("jj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jj1:jj5000")) 'compte 16d
Sheets("feuil28").Range("jk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jk1:jk5000")) 'compte 17d
Sheets("feuil28").Range("jl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jl1:jl5000")) 'compte 18d
'Sheets("feuil7").Range("h42") = Sheets("feuil28").Range("jj5001")+Sheets("feuil28").Range("jk5001")+Sheets("feuil28").Range("jl5001")

'affecte comptes 478 Subvention d'investissement reçue
Sheets("feuil28").Range("jm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jm1:jm5000")) 'compte 478
'Sheets("feuil7").Range("i43") = Sheets("feuil28").Range("jm5001")

'affecte comptes 245 Diminution du Matériel de transport
Sheets("feuil28").Range("jr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jr1:jr5000")) 'compte 245
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2495Diminution du Matériel de transport encours
Sheets("feuil28").Range("js5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("js1:js5000")) 'compte 2495
'Sheets("feuil23").Range("g29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2391+2392+2393+2397 Diminution des Bâtiments encours
Sheets("feuil28").Range("jt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jt1:jt5000")) 'compte 2931/2/3/7
'Sheets("feuil23").Range("g29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2394+2395+2398 Diminution des Installations et agts encours
Sheets("feuil28").Range("ju5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ju1:ju5000")) 'compte 2934/5/8
'Sheets("feuil23").Range("g29") = Sheets("feuil28").Range("jr5001")


'ADAPATION SYSCOHADA révisé
'affecte comptes 2281 augmentation terrains - immeuble de placement
Sheets("feuil28").Range("ka5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ka1:ka5000")) 'compte 2281
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2315+2325 augmentation bâtiments - immeuble de placement
Sheets("feuil28").Range("kb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kb1:kb5000")) 'compte 2315+2325
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2281 diminution terrains - immeuble de placement
Sheets("feuil28").Range("kc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kc1:kc5000")) 'compte 2281
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2315+2325 diminution bâtiments - immeuble de placement
Sheets("feuil28").Range("kd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kd1:kd5000")) 'compte 2315+2325
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 22981 diminution terrains - immeuble de placement encours
Sheets("feuil28").Range("ke5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ke1:ke5000")) 'compte 22981
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 23915+23925 diminution bâtiments - immeuble de placement encours
Sheets("feuil28").Range("kf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kf1:kf5000")) 'compte 23915+23925
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 85 dotations H.A.O à déduire des charges H.A.O. dans le calcul de la CAFG
Sheets("feuil28").Range("kg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kg1:kg5000")) 'compte 85
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 86 reprises H.A.O à déduire des produits H.A.O. dans le calcul de la CAFG
Sheets("feuil28").Range("kh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kh1:kh5000")) 'compte 86
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 654 VNC courant à déduire de l'EBE dans le calcul de la CAFG
Sheets("feuil28").Range("ki5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ki1:ki5000")) 'compte 654
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 754 Prix de cession courant à déduire de l'EBE dans le calcul de la CAFG
Sheets("feuil28").Range("kj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kj1:kj5000")) 'compte 754
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")


'calcul de la CAFG
Sheets("feuil12").Range("j19") = Sheets("feuil6").Range("j36") + Sheets("feuil28").Range("ki5001") - Sheets("feuil28").Range("kj5001") 'EBE+Compte654-Compte754
Sheets("feuil12").Range("e20") = -Sheets("feuil6").Range("j43") 'Frais financiers
'Sheets("feuil12").Range("e22") = Sheets("feuil6").Range("g20") 'Pertes de change
Sheets("feuil12").Range("e23") = -(Sheets("feuil6").Range("j50") + Sheets("feuil28").Range("kg5001")) 'Charges HAO-Dotations HAO
Sheets("feuil12").Range("e25") = -Sheets("feuil6").Range("j52") 'Participation des travailleurs
Sheets("feuil12").Range("e26") = -Sheets("feuil6").Range("j53") 'Impôt sur le résultat
'Sheets("feuil12").Range("j20") = Sheets("feuil6").Range("h41") 'Transfert de charges
Sheets("feuil12").Range("j22") = Sheets("feuil6").Range("j40") 'Revenus financiers
Sheets("feuil12").Range("j23") = Sheets("feuil6").Range("j42") 'Transfert de charges financières
'Sheets("feuil12").Range("j25") = Sheets("feuil6").Range("h18") 'Gain de change
Sheets("feuil12").Range("j26") = (Sheets("feuil6").Range("j48") + Sheets("feuil28").Range("kh5001")) 'Produits HAO-Reprises HAO
'Sheets("feuil12").Range("j27") = Sheets("feuil6").Range("h38") 'Transfert HAO
'calcul des totaux
Sheets("feuil12").Range("j29") = WorksheetFunction.Sum(Sheets("feuil12").Range("j19:j27"))
Sheets("feuil12").Range("e29") = WorksheetFunction.Sum(Sheets("feuil12").Range("e20:e26"))
'affectation dans le TAFIRE de la CAFG
Sheets("feuil7").Range("h15") = Sheets("feuil12").Range("j29") - Sheets("feuil12").Range("e29")


'VARIATION DES STOCKS
'adaptation SYSCOHADA révisé calcul variation des stocks et encours
If Sheets("feuil5").Range("h36") - Sheets("feuil5").Range("ag36") > 0 Then
Sheets("feuil12").Range("e47") = Sheets("feuil5").Range("h36") - Sheets("feuil5").Range("ag36")
Else
Sheets("feuil12").Range("j47") = -(Sheets("feuil5").Range("h36") - Sheets("feuil5").Range("ag36"))
End If
'affectation dans le TAFIRE
Sheets("feuil7").Range("h17") = -(Sheets("feuil12").Range("e47") - Sheets("feuil12").Range("j47"))


'VARIATION DES CREANCES
'calcul variation des fournisseurs, avances
If Sheets("feuil5").Range("h38") - Sheets("feuil5").Range("ag38") > 0 Then
Sheets("feuil12").Range("e65") = Sheets("feuil5").Range("h38") - Sheets("feuil5").Range("ag38")
Else
Sheets("feuil12").Range("j65") = -(Sheets("feuil5").Range("h38") - Sheets("feuil5").Range("ag38"))
End If

'calcul variation des clients
If Sheets("feuil5").Range("h39") - Sheets("feuil5").Range("ag39") > 0 Then
Sheets("feuil12").Range("e66") = Sheets("feuil5").Range("h39") - Sheets("feuil5").Range("ag39")
Else
Sheets("feuil12").Range("j66") = -(Sheets("feuil5").Range("h39") - Sheets("feuil5").Range("ag39"))
End If

'calcul variation des autres créances
If Sheets("feuil5").Range("h40") - Sheets("feuil5").Range("ag40") > 0 Then
Sheets("feuil12").Range("e67") = Sheets("feuil5").Range("h40") - Sheets("feuil5").Range("ag40")
Else
Sheets("feuil12").Range("j67") = -(Sheets("feuil5").Range("h40") - Sheets("feuil5").Range("ag40"))
End If

'calcul variation des ecarts de conversion ACTIF
If Sheets("feuil5").Range("h46") - Sheets("feuil5").Range("ag46") > 0 Then
Sheets("feuil12").Range("e68") = Sheets("feuil5").Range("h46") - Sheets("feuil5").Range("ag46")
Else
Sheets("feuil12").Range("j68") = -(Sheets("feuil5").Range("h46") - Sheets("feuil5").Range("ag46"))
End If

'calcul variation globale nette des creances
If WorksheetFunction.Sum(Sheets("feuil12").Range("e65:e68")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j65:j68")) > 0 Then
Sheets("feuil12").Range("e70") = WorksheetFunction.Sum(Sheets("feuil12").Range("e65:e68")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j65:j68"))
Else
Sheets("feuil12").Range("j70") = -(WorksheetFunction.Sum(Sheets("feuil12").Range("e65:e68")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j65:j68")))
End If
'affectation dans le TAFIRE
Sheets("feuil7").Range("h18") = -(Sheets("feuil12").Range("e70") - Sheets("feuil12").Range("j70"))


'VARIATION DES CREANCES H.A.O
'calcul variation des creances HAO
If Sheets("feuil5").Range("h35") - Sheets("feuil5").Range("ag35") > 0 Then
Sheets("feuil12").Range("e71") = Sheets("feuil5").Range("h35") - Sheets("feuil5").Range("ag35")
Else
Sheets("feuil12").Range("j71") = -(Sheets("feuil5").Range("h35") - Sheets("feuil5").Range("ag35"))
End If
'affectation dans le TAFIRE
Sheets("feuil7").Range("h16") = -(Sheets("feuil12").Range("e71") - Sheets("feuil12").Range("j71"))


'VARIATION DES DETTES FOURNISSEURS
'calcul variation des clients, avances
If Sheets("feuil5").Range("n36") - Sheets("feuil5").Range("am36") > 0 Then
Sheets("feuil12").Range("j75") = Sheets("feuil5").Range("n36") - Sheets("feuil5").Range("am36")
Else
Sheets("feuil12").Range("e75") = -(Sheets("feuil5").Range("n36") - Sheets("feuil5").Range("am36"))
End If

'calcul variation des fournisseurs
If Sheets("feuil5").Range("n37") - Sheets("feuil5").Range("am37") > 0 Then
Sheets("feuil12").Range("j76") = Sheets("feuil5").Range("n37") - Sheets("feuil5").Range("am37")
Else
Sheets("feuil12").Range("e76") = -(Sheets("feuil5").Range("n37") - Sheets("feuil5").Range("am37"))
End If

'adaptation SYSCOHADA révisé calcul variation des dettes fiscales et sociales
If Sheets("feuil5").Range("n38") - Sheets("feuil5").Range("am38") > 0 Then
Sheets("feuil12").Range("j77") = Sheets("feuil5").Range("n38") - Sheets("feuil5").Range("am38")
Else
Sheets("feuil12").Range("e77") = -(Sheets("feuil5").Range("n38") - Sheets("feuil5").Range("am38"))
End If

'calcul variation des autres dettes
If Sheets("feuil5").Range("n39") - Sheets("feuil5").Range("am39") > 0 Then
Sheets("feuil12").Range("j79") = Sheets("feuil5").Range("n39") - Sheets("feuil5").Range("am39")
Else
Sheets("feuil12").Range("e79") = -(Sheets("feuil5").Range("n39") - Sheets("feuil5").Range("am39"))
End If

'calcul variation des risques provisionnés
If Sheets("feuil5").Range("n40") - Sheets("feuil5").Range("am40") > 0 Then
Sheets("feuil12").Range("j80") = Sheets("feuil5").Range("n40") - Sheets("feuil5").Range("am40")
Else
Sheets("feuil12").Range("e80") = -(Sheets("feuil5").Range("n40") - Sheets("feuil5").Range("am40"))
End If

'calcul variation des écarts de conversion PASSIF
If Sheets("feuil5").Range("n46") - Sheets("feuil5").Range("am46") > 0 Then
Sheets("feuil12").Range("j81") = Sheets("feuil5").Range("n46") - Sheets("feuil5").Range("am46")
Else
Sheets("feuil12").Range("e81") = -(Sheets("feuil5").Range("n46") - Sheets("feuil5").Range("am46"))
End If

'calcul variation globale nette des dettes fournisseurs
If WorksheetFunction.Sum(Sheets("feuil12").Range("e75:e81")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j75:j81")) > 0 Then
Sheets("feuil12").Range("e84") = WorksheetFunction.Sum(Sheets("feuil12").Range("e75:e81")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j75:j81"))
Else
Sheets("feuil12").Range("j84") = -(WorksheetFunction.Sum(Sheets("feuil12").Range("e75:e81")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j75:j81")))
End If
'VARIATION DES DETTES H.A.O.
'variation des dettes H.A.O.
If Sheets("feuil5").Range("n35") - Sheets("feuil5").Range("am35") > 0 Then
Sheets("feuil12").Range("j85") = Sheets("feuil5").Range("n35") - Sheets("feuil5").Range("am35")
Else
Sheets("feuil12").Range("e85") = -(Sheets("feuil5").Range("n35") - Sheets("feuil5").Range("am35"))
End If
'affectation dans le TAFIRE (adaptation SYSCOHADA révisé)
Sheets("feuil7").Range("h19") = (Sheets("feuil12").Range("j84") + Sheets("feuil12").Range("j85")) - (Sheets("feuil12").Range("e84") + Sheets("feuil12").Range("e85"))


'CALCUL ETE
'Sheets("feuil12").Range("e94") = Sheets("feuil9").Range("f38") 'EBE
'Sheets("feuil12").Range("e95") = -(Sheets("feuil12").Range("e87") - Sheets("feuil12").Range("j87"))
'Sheets("feuil12").Range("e96") = -Sheets("feuil9").Range("h23")

'affectation dans le Tableau 1 - Actif immobilisé (AUGMENTATIONS)
'les acquisitions
Sheets("feuil24").Range("c16") = Sheets("feuil28").Range("gz5001") 'frais de développement et de prospection
Sheets("feuil24").Range("c17") = Sheets("feuil28").Range("ha5001") + Sheets("feuil28").Range("hb5001") + Sheets("feuil28").Range("hc5001") 'Brevets, licences, logiciels
Sheets("feuil24").Range("c18") = Sheets("feuil28").Range("hd5001") + Sheets("feuil28").Range("he5001") 'fonds commercial
Sheets("feuil24").Range("c19") = Sheets("feuil28").Range("hf5001") + Sheets("feuil28").Range("hg5001") 'autres immob. incorporelles

Sheets("feuil24").Range("c21") = Sheets("feuil28").Range("hk5001") 'Terrains
Sheets("feuil24").Range("c22") = Sheets("feuil28").Range("ka5001") 'Terrains - immeuble de placement
Sheets("feuil24").Range("c23") = Sheets("feuil28").Range("hl5001") + Sheets("feuil28").Range("hm5001") + Sheets("feuil28").Range("hn5001") + Sheets("feuil28").Range("ho5001") 'bâtiments
Sheets("feuil24").Range("c24") = Sheets("feuil28").Range("kb5001") 'bâtiments - immeuble de placement
Sheets("feuil24").Range("c25") = Sheets("feuil28").Range("hp5001") + Sheets("feuil28").Range("hq5001") + Sheets("feuil28").Range("hr5001") 'installations et agenc.
Sheets("feuil24").Range("c26") = Sheets("feuil28").Range("hs5001") 'matériel
Sheets("feuil24").Range("c27") = Sheets("feuil28").Range("ht5001") 'matériel de transport

Sheets("feuil24").Range("c29") = Sheets("feuil28").Range("hw5001") 'Avances sur immob.
Sheets("feuil24").Range("c33") = Sheets("feuil28").Range("hx5001") 'Titre de participation
Sheets("feuil24").Range("c34") = Sheets("feuil28").Range("hy5001") 'Autres immob. financières

'affectation dans le Tableau 1 - Actif immobilisé (DIMINUTIONS)
'les cessions
Sheets("feuil24").Range("f16") = Sheets("feuil28").Range("hz5001") 'frais de dévelop et prospection
Sheets("feuil24").Range("f17") = Sheets("feuil28").Range("ia5001") + Sheets("feuil28").Range("ib5001") + Sheets("feuil28").Range("ic5001") 'Brevets, licences, logiciels
Sheets("feuil24").Range("f18") = Sheets("feuil28").Range("id5001") + Sheets("feuil28").Range("ie5001") 'fonds commercial
Sheets("feuil24").Range("f19") = Sheets("feuil28").Range("if5001") + Sheets("feuil28").Range("ig5001") 'autres immob. incorporelles

Sheets("feuil24").Range("f21") = Sheets("feuil28").Range("ik5001") 'Terrains
Sheets("feuil24").Range("f22") = Sheets("feuil28").Range("kc5001") 'Terrains - immeuble de placement
Sheets("feuil24").Range("f23") = Sheets("feuil28").Range("il5001") + Sheets("feuil28").Range("im5001") + Sheets("feuil28").Range("in5001") + Sheets("feuil28").Range("io5001") 'bâtiments
Sheets("feuil24").Range("f24") = Sheets("feuil28").Range("kd5001") 'Bâtiments - immeuble de placement
Sheets("feuil24").Range("f25") = Sheets("feuil28").Range("ip5001") + Sheets("feuil28").Range("iq5001") + Sheets("feuil28").Range("ir5001") 'installations et agenc.
Sheets("feuil24").Range("f26") = Sheets("feuil28").Range("is5001") 'matériel
Sheets("feuil24").Range("f27") = Sheets("feuil28").Range("jr5001") 'matériel de transport

Sheets("feuil24").Range("f29") = Sheets("feuil28").Range("iw5001") 'Avances sur immob.
Sheets("feuil24").Range("f33") = Sheets("feuil28").Range("ix5001") 'Titre de participation
Sheets("feuil24").Range("f34") = Sheets("feuil28").Range("iy5001") + Sheets("feuil28").Range("iz5001") 'Autres immob. financières

'affectation dans le Tableau 1 - Actif immobilisé (VIREMENTS POSTE A POSTE)
'Frais de recherche encours
Sheets("feuil24").Range("g16") = Sheets("feuil28").Range("ih5001")
Sheets("feuil24").Range("c16") = Sheets("feuil24").Range("c16") - Sheets("feuil24").Range("g16")
Sheets("feuil24").Range("d16") = Sheets("feuil24").Range("g16")
'Brevets, licences, logiciel encours
Sheets("feuil24").Range("g17") = Sheets("feuil28").Range("ii5001")
Sheets("feuil24").Range("c17") = Sheets("feuil24").Range("c17") - Sheets("feuil24").Range("g17")
Sheets("feuil24").Range("d17") = Sheets("feuil24").Range("g17")
'Autres immob. incorporelles encours
Sheets("feuil24").Range("g19") = Sheets("feuil28").Range("ij5001")
Sheets("feuil24").Range("c19") = Sheets("feuil24").Range("c19") - Sheets("feuil24").Range("g19")
Sheets("feuil24").Range("d19") = Sheets("feuil24").Range("g19")

'Terrains encours
Sheets("feuil24").Range("g21") = Sheets("feuil28").Range("it5001")
Sheets("feuil24").Range("c21") = Sheets("feuil24").Range("c21") - Sheets("feuil24").Range("g21")
Sheets("feuil24").Range("d21") = Sheets("feuil24").Range("g21")
'Terrains - immeuble de placement encours
Sheets("feuil24").Range("g22") = Sheets("feuil28").Range("ke5001")
Sheets("feuil24").Range("c22") = Sheets("feuil24").Range("c22") - Sheets("feuil24").Range("g22")
Sheets("feuil24").Range("d22") = Sheets("feuil24").Range("g22")
'Bâtiments encours
Sheets("feuil24").Range("g23") = Sheets("feuil28").Range("jt5001")
Sheets("feuil24").Range("c23") = Sheets("feuil24").Range("c23") - Sheets("feuil24").Range("g23")
Sheets("feuil24").Range("d23") = Sheets("feuil24").Range("g23")
'Bâtiments - immeuble de placement encours
Sheets("feuil24").Range("g24") = Sheets("feuil28").Range("kf5001")
Sheets("feuil24").Range("c24") = Sheets("feuil24").Range("c24") - Sheets("feuil24").Range("g24")
Sheets("feuil24").Range("d24") = Sheets("feuil24").Range("g24")
'Installations et agts encours
Sheets("feuil24").Range("g25") = Sheets("feuil28").Range("ju5001")
Sheets("feuil24").Range("c25") = Sheets("feuil24").Range("c25") - Sheets("feuil24").Range("g25")
Sheets("feuil24").Range("d25") = Sheets("feuil24").Range("g25")
'Matériel encours
Sheets("feuil24").Range("g26") = Sheets("feuil28").Range("iv5001")
Sheets("feuil24").Range("c26") = Sheets("feuil24").Range("c26") - Sheets("feuil24").Range("g26")
Sheets("feuil24").Range("d26") = Sheets("feuil24").Range("g26")
'Matériel de transport encours
Sheets("feuil24").Range("g27") = Sheets("feuil28").Range("js5001")
Sheets("feuil24").Range("c27") = Sheets("feuil24").Range("c27") - Sheets("feuil24").Range("g27")
Sheets("feuil24").Range("d27") = Sheets("feuil24").Range("g27")

'___________________________________________________________________________________________________________________________

'CALCUL DES TOTAUX du Tableau 1 - Actif immobilisé
'total immobilisation incorporelle
Sheets("feuil24").Range("b30") = WorksheetFunction.Sum(Sheets("feuil24").Range("b16:b19")) 'mtt brut à l'ouverture
Sheets("feuil24").Range("c30") = WorksheetFunction.Sum(Sheets("feuil24").Range("c16:c19")) 'augmentation/acquisition
Sheets("feuil24").Range("d30") = WorksheetFunction.Sum(Sheets("feuil24").Range("d16:d19")) 'augmentation/virement poste
Sheets("feuil24").Range("e30") = WorksheetFunction.Sum(Sheets("feuil24").Range("e16:e19")) 'augmentation/réévaluation
Sheets("feuil24").Range("f30") = WorksheetFunction.Sum(Sheets("feuil24").Range("f16:f19")) 'diminution/cessions
Sheets("feuil24").Range("g30") = WorksheetFunction.Sum(Sheets("feuil24").Range("g16:g19")) 'diminution/virement poste
Sheets("feuil24").Range("i30") = WorksheetFunction.Sum(Sheets("feuil24").Range("i16:i19")) 'mtt brut à la clôture

'total immobilisation corporelle
Sheets("feuil24").Range("b31") = WorksheetFunction.Sum(Sheets("feuil24").Range("b21:b29")) 'mtt brut à l'ouverture
Sheets("feuil24").Range("c31") = WorksheetFunction.Sum(Sheets("feuil24").Range("c21:c29")) 'augmentation/acquisition
Sheets("feuil24").Range("d31") = WorksheetFunction.Sum(Sheets("feuil24").Range("d21:d29")) 'augmentation/virement poste
Sheets("feuil24").Range("e31") = WorksheetFunction.Sum(Sheets("feuil24").Range("e21:e29")) 'augmentation/réévaluation
Sheets("feuil24").Range("f31") = WorksheetFunction.Sum(Sheets("feuil24").Range("f21:f29")) 'diminution/cessions
Sheets("feuil24").Range("g31") = WorksheetFunction.Sum(Sheets("feuil24").Range("g21:g29")) 'diminution/virement poste
Sheets("feuil24").Range("i31") = WorksheetFunction.Sum(Sheets("feuil24").Range("i21:i29")) 'mtt brut à la clôture

'total général
Sheets("feuil24").Range("b35") = WorksheetFunction.Sum(Sheets("feuil24").Range("b33:b34")) + Sheets("feuil24").Range("b30") + Sheets("feuil24").Range("b31") 'mtt brut à l'ouverture
Sheets("feuil24").Range("c35") = WorksheetFunction.Sum(Sheets("feuil24").Range("c33:c34")) + Sheets("feuil24").Range("c30") + Sheets("feuil24").Range("c31") 'augmentation/acquisition
Sheets("feuil24").Range("d35") = WorksheetFunction.Sum(Sheets("feuil24").Range("d33:d34")) + Sheets("feuil24").Range("d30") + Sheets("feuil24").Range("d31") 'augmentation/virement poste
Sheets("feuil24").Range("e35") = WorksheetFunction.Sum(Sheets("feuil24").Range("e33:e34")) + Sheets("feuil24").Range("e30") + Sheets("feuil24").Range("e31") 'augmentation/réévaluation
Sheets("feuil24").Range("f35") = WorksheetFunction.Sum(Sheets("feuil24").Range("f33:f34")) + Sheets("feuil24").Range("f30") + Sheets("feuil24").Range("f31") 'diminution/cessions
Sheets("feuil24").Range("g35") = WorksheetFunction.Sum(Sheets("feuil24").Range("g33:g34")) + Sheets("feuil24").Range("g30") + Sheets("feuil24").Range("g31") 'diminution/virement poste
Sheets("feuil24").Range("i35") = WorksheetFunction.Sum(Sheets("feuil24").Range("i33:i34")) + Sheets("feuil24").Range("i30") + Sheets("feuil24").Range("i31") 'mtt brut à la clôture

'CALCUL ET AFFICHE LES ECRATS DU TABLEAU 1
For i = 16 To 35
If Sheets("feuil24").Cells(i, 2) + Sheets("feuil24").Cells(i, 3) + Sheets("feuil24").Cells(i, 4) + Sheets("feuil24").Cells(i, 5) - Sheets("feuil24").Cells(i, 6) - Sheets("feuil24").Cells(i, 7) - Sheets("feuil24").Cells(i, 9) = 0 Then
Else
Sheets("feuil24").Cells(i, 10) = "Ecart"
Sheets("feuil24").Cells(i, 11) = Sheets("feuil24").Cells(i, 2) + Sheets("feuil24").Cells(i, 3) + Sheets("feuil24").Cells(i, 4) + Sheets("feuil24").Cells(i, 5) - Sheets("feuil24").Cells(i, 6) - Sheets("feuil24").Cells(i, 7) - Sheets("feuil24").Cells(i, 9)
End If
Next

'_______________________________________________________________________________________________________

'affectation du Tableau 1 - Actif immobilisé dans le TAFIRE
Sheets("feuil7").Range("h26") = -Sheets("feuil24").Range("c30") 'immob. incorporelles
Sheets("feuil7").Range("h27") = -Sheets("feuil24").Range("c31") 'immob. corporelles
Sheets("feuil7").Range("h28") = -WorksheetFunction.Sum(Sheets("feuil24").Range("c33:c34")) 'immob. financières

'affectation des prix de cession
Sheets("feuil7").Range("h29") = Sheets("feuil28").Range("ja5001") + Sheets("feuil28").Range("jb5001") + Sheets("feuil24").Range("f29") 'immob. incorporelles et corporelles
Sheets("feuil7").Range("h30") = Sheets("feuil28").Range("jc5001") + Sheets("feuil28").Range("iy5001")  'immob. financières

'affectation des capitaux propres
Sheets("feuil7").Range("h35") = Sheets("feuil28").Range("jd5001") - Sheets("feuil28").Range("jp5001") 'augmentation du capital
Sheets("feuil7").Range("h37") = -Sheets("feuil28").Range("je5001") 'remboursement du capital
Sheets("feuil7").Range("h38") = -Sheets("feuil28").Range("jf5001") 'dividendes distribués
Sheets("feuil7").Range("h36") = Sheets("feuil28").Range("jm5001") 'subvention d'investissement reçue
'affectation des dividendes pour le calcul de l'Autofinancement
Sheets("feuil12").Range("e35") = Sheets("feuil28").Range("jf5001") 'dividendes distribués

'affectation des capitaux étrangers
Sheets("feuil7").Range("h43") = Sheets("feuil28").Range("jg5001")  'augmentation des emprunts
Sheets("feuil7").Range("h44") = Sheets("feuil28").Range("jh5001") + Sheets("feuil28").Range("ji5001")  'augmentation des divers emprunts
Sheets("feuil7").Range("h45") = -(Sheets("feuil28").Range("jj5001") + Sheets("feuil28").Range("jk5001") + Sheets("feuil28").Range("jl5001")) 'remboursement des emprunts

'affectation de la trésorerie nette du bilan
'trésorerie à l'ouverture N-1
Sheets("feuil7").Range("h12") = Sheets("feuil5").Range("ag45") - Sheets("feuil5").Range("am45")

'trésorerie à la clôture N
Sheets("feuil7").Range("h54") = Sheets("feuil5").Range("h45") - Sheets("feuil5").Range("n45")


edite_tafire_n_1_suite


'demande de confirmation
End If

'condition d'édition
End If
End If

'condition d'installation
'Else
'MsgBox "Désolé  !  Veuillez d'abord installer votre logiciel."
'End If

'délai d'essai
End If

'mise en forme conditionnelle
Sheets("feuil28").Range("zc11").ClearContents
End Sub
Private Sub affiche_bilan()
'animationv1
Sheets("feuil5").Activate
End Sub
Private Sub affiche_compte_resultat()
'animationv1
Sheets("feuil6").Activate
End Sub
Private Sub affiche_tafire()
'animationv1
Sheets("feuil7").Activate
End Sub
Private Sub affiche_tab1_n()
'animationv1
Sheets("feuil23").Activate
End Sub
Private Sub affiche_tab1_n_1()
'animationv1
Sheets("feuil24").Activate
End Sub
Private Sub reedite_tafire_tab1_n()
'condition d'édition
If WorksheetFunction.Sum(Sheets("feuil2").Range("g3:h5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à éditer."
Else

If Sheets("feuil5").Range("m47") = "" Then
MsgBox "Veuillez d'abord éditer le Bilan N !"
Else

If MsgBox("Confirmez vous l'édition à nouveau du T.F.T.  N  ?", vbYesNo, "Demande de confirmation") = vbYes Then

'efface les données note trésorerie - calcul CAFG
Sheets("feuil12").Range("e20:e26").ClearContents
Sheets("feuil12").Range("j19:j27").ClearContents
Sheets("feuil12").Range("e42:e47").ClearContents
Sheets("feuil12").Range("j42:j47").ClearContents
Sheets("feuil12").Range("e35").ClearContents

Sheets("feuil12").Range("e65:e70").ClearContents
Sheets("feuil12").Range("j65:j70").ClearContents

Sheets("feuil12").Range("e75:e88").ClearContents
Sheets("feuil12").Range("j75:j88").ClearContents
Sheets("feuil12").Range("e94:e96").ClearContents

'efface les données Tafire
Sheets("feuil7").Range("g12:g55").ClearContents
Sheets("feuil7").Range("d22").ClearContents
Sheets("feuil7").Range("j53").ClearContents 'message d'écart
Sheets("feuil7").Range("k53").ClearContents 'message d'écart

'recup des données pour le TAFIRE N
For i = 1 To 5000

'adaptation SYSCOHADA révisé recup compte 211+2191+2181 Augmentation des Frais de dévelop et prospection
If Left(Sheets("feuil2").Cells(i, 1), 3) = 211 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2191 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2181 Then
Sheets("feuil28").Cells(i, 208) = Sheets("feuil2").Cells(i, 5) 'colonne GZ
Else
End If

'recup compte 212 Augmentation des Brevets, licences, logiciels
If Left(Sheets("feuil2").Cells(i, 1), 3) = 212 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2192 Then
Sheets("feuil28").Cells(i, 209) = Sheets("feuil2").Cells(i, 5) 'colonne HA
Else
End If

'recup compte 213 Augmentation des Brevets, licences, logiciels
If Left(Sheets("feuil2").Cells(i, 1), 3) = 213 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2193 Then
Sheets("feuil28").Cells(i, 210) = Sheets("feuil2").Cells(i, 5) 'colonne HB
Else
End If

'recup compte 214 Augmentation des Brevets, licences, logiciels
If Left(Sheets("feuil2").Cells(i, 1), 3) = 214 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2194 Then
Sheets("feuil28").Cells(i, 211) = Sheets("feuil2").Cells(i, 5) 'colonne HC
Else
End If

'recup compte 215 Augmentation du Fonds commercial
If Left(Sheets("feuil2").Cells(i, 1), 3) = 215 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2195 Then
Sheets("feuil28").Cells(i, 212) = Sheets("feuil2").Cells(i, 5) 'colonne HD
Else
End If

'recup compte 216 Augmentation du Fonds commercial
If Left(Sheets("feuil2").Cells(i, 1), 3) = 216 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2196 Then
Sheets("feuil28").Cells(i, 213) = Sheets("feuil2").Cells(i, 5) 'colonne HE
Else
End If

'recup compte 217 Augmentation des Autres immob. incorporelles
If Left(Sheets("feuil2").Cells(i, 1), 3) = 217 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2197 Then
Sheets("feuil28").Cells(i, 214) = Sheets("feuil2").Cells(i, 5) 'colonne HF
Else
End If

'adaptation SYSCOHADA révisé recup compte 218 Augmentation des Autres immob. incorporelles
If Left(Sheets("feuil2").Cells(i, 1), 3) = 218 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2198 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2181 Then
Else
Sheets("feuil28").Cells(i, 215) = Sheets("feuil2").Cells(i, 5) 'colonne HG
End If
Else
End If

'recup compte 2191 Augmentation des Immob. incorporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2191 Then
Sheets("feuil28").Cells(i, 216) = Sheets("feuil2").Cells(i, 5) 'colonne HH
Else
End If

'recup compte 2193 Augmentation des Immob. incorporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2193 Then
Sheets("feuil28").Cells(i, 217) = Sheets("feuil2").Cells(i, 5) 'colonne HI
Else
End If

'recup compte 2198 Augmentation des Immob. incorporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2198 Then
Sheets("feuil28").Cells(i, 218) = Sheets("feuil2").Cells(i, 5) 'colonne HJ
Else
End If

'adaptation SYSCOHADA révisé recup compte 22 Augmentation des terrains
If Left(Sheets("feuil2").Cells(i, 1), 2) = 22 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2281 Then
Else
Sheets("feuil28").Cells(i, 219) = Sheets("feuil2").Cells(i, 5) 'colonne HK
End If
Else
End If

'recup compte 231 Augmentation des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 231 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2391 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2315 Then
Else
Sheets("feuil28").Cells(i, 220) = Sheets("feuil2").Cells(i, 5) 'colonne HL
End If
Else
End If

'recup compte 232 Augmentation des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 232 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2392 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2325 Then
Else
Sheets("feuil28").Cells(i, 221) = Sheets("feuil2").Cells(i, 5) 'colonne HM
End If
Else
End If

'recup compte 233 Augmentation des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 233 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2393 Then
Sheets("feuil28").Cells(i, 222) = Sheets("feuil2").Cells(i, 5) 'colonne HN
Else
End If

'recup compte 237 Augmentation des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 237 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2397 Then
Sheets("feuil28").Cells(i, 223) = Sheets("feuil2").Cells(i, 5) 'colonne HO
Else
End If

'recup compte 234 Augmentation des Installations et agenc.
If Left(Sheets("feuil2").Cells(i, 1), 3) = 234 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2394 Then
Sheets("feuil28").Cells(i, 224) = Sheets("feuil2").Cells(i, 5) 'colonne HP
Else
End If

'recup compte 235 Augmentation des Installations et agenc.
If Left(Sheets("feuil2").Cells(i, 1), 3) = 235 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2395 Then
Sheets("feuil28").Cells(i, 225) = Sheets("feuil2").Cells(i, 5) 'colonne HQ
Else
End If

'recup compte 238 Augmentation des Installations et agenc.
If Left(Sheets("feuil2").Cells(i, 1), 3) = 238 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2398 Then
Sheets("feuil28").Cells(i, 226) = Sheets("feuil2").Cells(i, 5) 'colonne HR
Else
End If

'recup compte 24 sauf 245 Augmentation du Matériel
If Left(Sheets("feuil2").Cells(i, 1), 2) = 24 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 245 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2495 Then
Else
Sheets("feuil28").Cells(i, 227) = Sheets("feuil2").Cells(i, 5) 'colonne HS
End If
End If
Else
End If

'recup compte 245 Augmentation du matériel de transport
If Left(Sheets("feuil2").Cells(i, 1), 3) = 245 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2495 Then
Sheets("feuil28").Cells(i, 228) = Sheets("feuil2").Cells(i, 5) 'colonne HT
Else
End If

'recup compte 239 Augmentation des Immob. corporelles encours
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 239 Then
'Sheets("feuil28").Cells(i, 229) = Sheets("feuil2").Cells(i, 5) 'colonne HU
'Else
'End If

'recup compte 249 Augmentation des Immob. corporelles encours
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 249 Then
'Sheets("feuil28").Cells(i, 230) = Sheets("feuil2").Cells(i, 5) 'colonne HV
'Else
'End If

'recup compte 25 Augmentation des Avances sur immob.
If Left(Sheets("feuil2").Cells(i, 1), 2) = 25 Then
Sheets("feuil28").Cells(i, 231) = Sheets("feuil2").Cells(i, 5) 'colonne HW
Else
End If

'recup compte 26 Augmentation des Titres de participation
If Left(Sheets("feuil2").Cells(i, 1), 2) = 26 Then
Sheets("feuil28").Cells(i, 232) = Sheets("feuil2").Cells(i, 5) 'colonne HX
Else
End If

'recup compte 27 Augmentation des Autres immob. financières
If Left(Sheets("feuil2").Cells(i, 1), 2) = 27 Then
Sheets("feuil28").Cells(i, 233) = Sheets("feuil2").Cells(i, 5) 'colonne HY
Else
End If


'adaptation SYSCOHADA révisé recup compte 211+2181 Diminution des Frais de dévelop et prospection
If Left(Sheets("feuil2").Cells(i, 1), 3) = 211 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2181 Then
Sheets("feuil28").Cells(i, 234) = Sheets("feuil2").Cells(i, 6) 'colonne HZ
Else
End If

'recup compte 212 Diminution des Brevets, licences, logiciels
If Left(Sheets("feuil2").Cells(i, 1), 3) = 212 Then
Sheets("feuil28").Cells(i, 235) = Sheets("feuil2").Cells(i, 6) 'colonne IA
Else
End If

'recup compte 213 Diminution des Brevets, licences, logiciels
If Left(Sheets("feuil2").Cells(i, 1), 3) = 213 Then
Sheets("feuil28").Cells(i, 236) = Sheets("feuil2").Cells(i, 6) 'colonne IB
Else
End If

'recup compte 214 Diminution des Brevets, licences, logiciels
If Left(Sheets("feuil2").Cells(i, 1), 3) = 214 Then
Sheets("feuil28").Cells(i, 237) = Sheets("feuil2").Cells(i, 6) 'colonne IC
Else
End If

'recup compte 215 Diminution du Fonds commercial
If Left(Sheets("feuil2").Cells(i, 1), 3) = 215 Then
Sheets("feuil28").Cells(i, 238) = Sheets("feuil2").Cells(i, 6) 'colonne ID
Else
End If

'recup compte 216 Diminution du Fonds commercial
If Left(Sheets("feuil2").Cells(i, 1), 3) = 216 Then
Sheets("feuil28").Cells(i, 239) = Sheets("feuil2").Cells(i, 6) 'colonne IE
Else
End If

'recup compte 217 Diminution des Autres immob. incorporelles
If Left(Sheets("feuil2").Cells(i, 1), 3) = 217 Then
Sheets("feuil28").Cells(i, 240) = Sheets("feuil2").Cells(i, 6) 'colonne IF
Else
End If

'recup compte 218 Diminution des Autres immob. incorporelles
If Left(Sheets("feuil2").Cells(i, 1), 3) = 218 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2181 Then
Else
Sheets("feuil28").Cells(i, 241) = Sheets("feuil2").Cells(i, 6) 'colonne IG
End If
Else
End If

'recup compte 2191 Diminution des Immob. incorporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2191 Then
Sheets("feuil28").Cells(i, 242) = Sheets("feuil2").Cells(i, 6) 'colonne IH
Else
End If

'recup compte 2193 Diminution des Immob. incorporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2193 Then
Sheets("feuil28").Cells(i, 243) = Sheets("feuil2").Cells(i, 6) 'colonne II
Else
End If

'recup compte 2198 Diminution des Immob. incorporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2198 Then
Sheets("feuil28").Cells(i, 244) = Sheets("feuil2").Cells(i, 6) 'colonne IJ
Else
End If

'recup compte 22 sauf 229 Diminution des Terrains
If Left(Sheets("feuil2").Cells(i, 1), 2) = 22 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 229 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2281 Then
Else
Sheets("feuil28").Cells(i, 245) = Sheets("feuil2").Cells(i, 6) 'colonne IK
End If
End If
Else
End If

'recup compte 231 Diminution des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 231 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2315 Then
Else
Sheets("feuil28").Cells(i, 246) = Sheets("feuil2").Cells(i, 6) 'colonne IL
End If
Else
End If

'recup compte 232 Diminution des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 232 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2325 Then
Else
Sheets("feuil28").Cells(i, 247) = Sheets("feuil2").Cells(i, 6) 'colonne IM
End If
Else
End If

'recup compte 233 Diminution des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 233 Then
Sheets("feuil28").Cells(i, 248) = Sheets("feuil2").Cells(i, 6) 'colonne IN
Else
End If

'recup compte 237 Diminution des Bâtiments
If Left(Sheets("feuil2").Cells(i, 1), 3) = 237 Then
Sheets("feuil28").Cells(i, 249) = Sheets("feuil2").Cells(i, 6) 'colonne IO
Else
End If

'recup compte 234 Diminution des Installations et agenc.
If Left(Sheets("feuil2").Cells(i, 1), 3) = 234 Then
Sheets("feuil28").Cells(i, 250) = Sheets("feuil2").Cells(i, 6) 'colonne IP
Else
End If

'recup compte 235 Diminution des Installations et agenc.
If Left(Sheets("feuil2").Cells(i, 1), 3) = 235 Then
Sheets("feuil28").Cells(i, 251) = Sheets("feuil2").Cells(i, 6) 'colonne IQ
Else
End If

'recup compte 238 Diminution des Installations et agenc.
If Left(Sheets("feuil2").Cells(i, 1), 3) = 238 Then
Sheets("feuil28").Cells(i, 252) = Sheets("feuil2").Cells(i, 6) 'colonne IR
Else
End If

'recup compte 24 sauf 249 Diminution du Matériel sauf 245 Transport
If Left(Sheets("feuil2").Cells(i, 1), 2) = 24 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 249 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 3) = 245 Then
Else
Sheets("feuil28").Cells(i, 253) = Sheets("feuil2").Cells(i, 6) 'colonne IS
End If
End If
Else
End If

'adaptation SYSCOHADA révisé recup compte 229 Diminution des Immob. corporelles encours
If Left(Sheets("feuil2").Cells(i, 1), 3) = 229 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 22981 Then
Else
Sheets("feuil28").Cells(i, 254) = Sheets("feuil2").Cells(i, 6) 'colonne IT
End If
Else
End If

'recup compte 239 Diminution des Immob. corporelles encours
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 239 Then
'Sheets("feuil28").Cells(i, 255) = Sheets("feuil2").Cells(i, 6) 'colonne IU
'Else
'End If

'recup compte 249 Diminution des Immob. corporelles encours sauf 2495
If Left(Sheets("feuil2").Cells(i, 1), 3) = 249 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2495 Then
Else
Sheets("feuil28").Cells(i, 256) = Sheets("feuil2").Cells(i, 6) 'colonne IV
End If
Else
End If

'recup compte 25 Diminution des Avances sur immob.
If Left(Sheets("feuil2").Cells(i, 1), 2) = 25 Then
Sheets("feuil28").Cells(i, 257) = Sheets("feuil2").Cells(i, 6) 'colonne IW
Else
End If

'recup compte 26 Diminution des Titres de participation
If Left(Sheets("feuil2").Cells(i, 1), 2) = 26 Then
Sheets("feuil28").Cells(i, 258) = Sheets("feuil2").Cells(i, 6) 'colonne IX
Else
End If

'recup compte 27 sauf 274 Diminution des Autres immob. financières
If Left(Sheets("feuil2").Cells(i, 1), 2) = 27 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 274 Then
Else
Sheets("feuil28").Cells(i, 259) = Sheets("feuil2").Cells(i, 6) 'colonne IY
End If
Else
End If

'recup compte 274 Diminution des Autres immob. financières
If Left(Sheets("feuil2").Cells(i, 1), 3) = 274 Then
Sheets("feuil28").Cells(i, 260) = Sheets("feuil2").Cells(i, 6) 'colonne IZ
Else
End If

'recup compte 821 Prix de cession des immob. incorporelles
If Left(Sheets("feuil2").Cells(i, 1), 3) = 821 Then
Sheets("feuil28").Cells(i, 261) = Sheets("feuil2").Cells(i, 6) 'colonne JA
Else
End If

'recup compte 822 Prix de cession des immob. corporelles
If Left(Sheets("feuil2").Cells(i, 1), 3) = 822 Then
Sheets("feuil28").Cells(i, 262) = Sheets("feuil2").Cells(i, 6) 'colonne JB
Else
End If

'recup compte 826 Prix de cession des immob. financières
If Left(Sheets("feuil2").Cells(i, 1), 3) = 826 Then
Sheets("feuil28").Cells(i, 263) = Sheets("feuil2").Cells(i, 6) 'colonne JC
Else
End If

'recup compte 10c Augmentation de capital
If Left(Sheets("feuil2").Cells(i, 1), 2) = 10 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 106 Then
Else
Sheets("feuil28").Cells(i, 264) = Sheets("feuil2").Cells(i, 6) 'colonne JD
End If
Else
End If

'recup compte 10d sauf 109 Réduction du capital
If Left(Sheets("feuil2").Cells(i, 1), 2) = 10 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 109 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 3) = 106 Then
Else
Sheets("feuil28").Cells(i, 265) = Sheets("feuil2").Cells(i, 5) 'colonne JE
End If
End If
Else
End If

'RATTRAPAGE COMPTE 109d
'recup compte 109d Augmentation de capital
If Left(Sheets("feuil2").Cells(i, 1), 3) = 109 Then
Sheets("feuil28").Cells(i, 276) = Sheets("feuil2").Cells(i, 5) 'colonne JP
Else
End If


'recup compte 465 Dividendes distribués
If Left(Sheets("feuil2").Cells(i, 1), 3) = 465 Then
Sheets("feuil28").Cells(i, 266) = Sheets("feuil2").Cells(i, 5) 'colonne JF
Else
End If

'recup compte 16 Augmentation des emprunts
If Left(Sheets("feuil2").Cells(i, 1), 2) = 16 Then
Sheets("feuil28").Cells(i, 267) = Sheets("feuil2").Cells(i, 6) 'colonne JG
Else
End If

'recup compte 17 Augmentation des emprunts
If Left(Sheets("feuil2").Cells(i, 1), 2) = 17 Then
Sheets("feuil28").Cells(i, 268) = Sheets("feuil2").Cells(i, 6) 'colonne JH
Else
End If

'recup compte 18 Augmentation des emprunts
If Left(Sheets("feuil2").Cells(i, 1), 2) = 18 Then
Sheets("feuil28").Cells(i, 269) = Sheets("feuil2").Cells(i, 6) 'colonne JI
Else
End If

'recup compte 16 Remboursement des emprunts
If Left(Sheets("feuil2").Cells(i, 1), 2) = 16 Then
Sheets("feuil28").Cells(i, 270) = Sheets("feuil2").Cells(i, 5) 'colonne JJ
Else
End If

'recup compte 17 Remboursement des emprunts
If Left(Sheets("feuil2").Cells(i, 1), 2) = 17 Then
Sheets("feuil28").Cells(i, 271) = Sheets("feuil2").Cells(i, 5) 'colonne JK
Else
End If

'recup compte 18 Remboursement des emprunts
If Left(Sheets("feuil2").Cells(i, 1), 2) = 18 Then
Sheets("feuil28").Cells(i, 272) = Sheets("feuil2").Cells(i, 5) 'colonne JL
Else
End If

'recup compte 14 Subvention d'investissement reçu
If Left(Sheets("feuil2").Cells(i, 1), 2) = 14 Then
Sheets("feuil28").Cells(i, 273) = Sheets("feuil2").Cells(i, 6) 'colonne JM
Else
End If

'Adaptation compte 206 SYSCOHADA
'recup compte 206 Dimunition des Primes de remboursement
If Left(Sheets("feuil2").Cells(i, 1), 3) = 206 Then
Sheets("feuil28").Cells(i, 277) = Sheets("feuil2").Cells(i, 6) 'colonne JQ
Else
End If

'recup compte 245 Dimunition du Matériel de transport
If Left(Sheets("feuil2").Cells(i, 1), 3) = 245 Then
Sheets("feuil28").Cells(i, 278) = Sheets("feuil2").Cells(i, 6) 'colonne JR
Else
End If

'recup compte 2495 Diminution du Matériel de transport encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2495 Then
Sheets("feuil28").Cells(i, 279) = Sheets("feuil2").Cells(i, 6) 'colonne JS
Else
End If

'adaptation SYSCOHADA révisé recup compte 2391+2392+2393+2397 Diminution des Bâtiments encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2391 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2392 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2393 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2397 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 23915 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 23925 Then
Else
Sheets("feuil28").Cells(i, 280) = Sheets("feuil2").Cells(i, 6) 'colonne JT
End If
Else
End If

'recup compte 2394+2395+2398 Diminution des Bâtiments encours
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2394 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2395 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2398 Then
Sheets("feuil28").Cells(i, 281) = Sheets("feuil2").Cells(i, 6) 'colonne JU
Else
End If



'ADAPTATION SYSCOHADA révisé - immeuble de placement
'recup compte 2281 Augmentation des terrains - immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2281 Then
Sheets("feuil28").Cells(i, 287) = Sheets("feuil2").Cells(i, 5) 'colonne KA
Else
End If

'recup compte 2315+2325 Augmentation des bâtiments - immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2315 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2325 Then
Sheets("feuil28").Cells(i, 288) = Sheets("feuil2").Cells(i, 5) 'colonne KB
Else
End If


'recup compte 2281 sauf 22981 Diminution des Terrains - immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2281 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 22981 Then
Else
Sheets("feuil28").Cells(i, 289) = Sheets("feuil2").Cells(i, 6) 'colonne KC
End If
Else
End If

'recup compte 2315+2325 sauf 23915+23925 Diminution des bâtiments - immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2315 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2325 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 23915 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 23925 Then
Else
Sheets("feuil28").Cells(i, 290) = Sheets("feuil2").Cells(i, 6) 'colonne KD
End If
Else
End If

'recup compte 22981 Diminution des terrains - immeuble de placement encours
If Left(Sheets("feuil2").Cells(i, 1), 5) = 22981 Then
Sheets("feuil28").Cells(i, 291) = Sheets("feuil2").Cells(i, 6) 'colonne KE
Else
End If

'recup compte 23915+23925 Diminution des bâtiments - immeuble de placement encours
If Left(Sheets("feuil2").Cells(i, 1), 5) = 23915 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 23925 Then
Sheets("feuil28").Cells(i, 292) = Sheets("feuil2").Cells(i, 6) 'colonne KF
Else
End If




Next



'affecte comptes 211+2181 Augmentation des Frais de dévelop et prospection
Sheets("feuil28").Range("gz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gz1:gz5000")) 'compte 211
'Sheets("feuil23").Range("c16") = Sheets("feuil28").Range("gz5001")

'affecte comptes 212+213+214 Augmentation des Brevets, licences, logiciels
Sheets("feuil28").Range("ha5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ha1:ha5000")) 'compte 212
Sheets("feuil28").Range("hb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hb1:hb5000")) 'compte 213
Sheets("feuil28").Range("hc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hc1:hc5000")) 'compte 214
'Sheets("feuil23").Range("c17") = Sheets("feuil28").Range("ha5001")+Sheets("feuil28").Range("hb5001")+Sheets("feuil28").Range("hc5001")

'affecte comptes 215+216 Augmentation du Fonds commercial
Sheets("feuil28").Range("hd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hd1:hd5000")) 'compte 215
Sheets("feuil28").Range("he5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("he1:he5000")) 'compte 216
'Sheets("feuil23").Range("c18") = Sheets("feuil28").Range("hd5001")+Sheets("feuil28").Range("he5001")

'affecte comptes 217+218 Augmentation des Autres immob. incorporelles
Sheets("feuil28").Range("hf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hf1:hf5000")) 'compte 217
Sheets("feuil28").Range("hg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hg1:hg5000")) 'compte 218
'Sheets("feuil23").Range("c19") = Sheets("feuil28").Range("hf5001")+Sheets("feuil28").Range("hg5001")

'affecte comptes 2191+2193+2198 Augmentation des Immob. incorporelles encours
Sheets("feuil28").Range("hh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hh1:hh5000")) 'compte 2191
Sheets("feuil28").Range("hi5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hi1:hi5000")) 'compte 2193
Sheets("feuil28").Range("hj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hj1:hj5000")) 'compte 2198
'Sheets("feuil23").Range("c20") = Sheets("feuil28").Range("hh5001")+Sheets("feuil28").Range("hi5001")+Sheets("feuil28").Range("hj5001")

'affecte comptes 22 Augmentation des Terrains
Sheets("feuil28").Range("hk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hk1:hk5000")) 'compte 22
'Sheets("feuil23").Range("c22") = Sheets("feuil28").Range("hk5001")

'affecte comptes 231+232+233+237 Augmentation des Bâtiments
Sheets("feuil28").Range("hl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hl1:hl5000")) 'compte 231
Sheets("feuil28").Range("hm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hm1:hm5000")) 'compte 232
Sheets("feuil28").Range("hn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hn1:hn5000")) 'compte 233
Sheets("feuil28").Range("ho5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ho1:ho5000")) 'compte 237
'Sheets("feuil23").Range("c23") = Sheets("feuil28").Range("hl5001")+Sheets("feuil28").Range("hm5001")+Sheets("feuil28").Range("hn5001")+Sheets("feuil28").Range("ho5001")

'affecte comptes 234+235+238 Augmentation des Installations et agenc.
Sheets("feuil28").Range("hp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hp1:hp5000")) 'compte 234
Sheets("feuil28").Range("hq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hq1:hq5000")) 'compte 235
Sheets("feuil28").Range("hr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hr1:hr5000")) 'compte 238
'Sheets("feuil23").Range("c24") = Sheets("feuil28").Range("hp5001")+Sheets("feuil28").Range("hq5001")+Sheets("feuil28").Range("hr5001")

'affecte comptes 24 Augmentation du Matériel
Sheets("feuil28").Range("hs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hs1:hs5000")) 'compte 24 sauf 249
'Sheets("feuil23").Range("c25") = Sheets("feuil28").Range("hs5001")

'affecte comptes 245 Augmentation du Matériel de transport
Sheets("feuil28").Range("ht5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ht1:ht5000")) 'compte 245
'Sheets("feuil23").Range("c29") = Sheets("feuil28").Range("ht5001")

'affecte comptes 25 Augmentation des Avances sur immob.
Sheets("feuil28").Range("hw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hw1:hw5000")) 'compte 25
'Sheets("feuil23").Range("c28") = Sheets("feuil28").Range("hw5001")

'affecte comptes 26 Augmentation des Titres de participation
Sheets("feuil28").Range("hx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hx1:hx5000")) 'compte 26
'Sheets("feuil23").Range("c30") = Sheets("feuil28").Range("hx5001")

'affecte comptes 27 Augmentation des Autres immob. financières
Sheets("feuil28").Range("hy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hy1:hy5000")) 'compte 27
'Sheets("feuil23").Range("c31") = Sheets("feuil28").Range("hy5001")




'affecte comptes 211+2181 Diminution des Frais de dévelop et prospection
Sheets("feuil28").Range("hz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hz1:hz5000")) 'compte 211
'Sheets("feuil23").Range("f16") = Sheets("feuil28").Range("hz5001")

'affecte comptes 212+213+214 Diminution des Brevets, licences, logiciels
Sheets("feuil28").Range("ia5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ia1:ia5000")) 'compte 212
Sheets("feuil28").Range("ib5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ib1:ib5000")) 'compte 213
Sheets("feuil28").Range("ic5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ic1:ic5000")) 'compte 214
'Sheets("feuil23").Range("f17") = Sheets("feuil28").Range("ia5001")+Sheets("feuil28").Range("ib5001")+Sheets("feuil28").Range("ic5001")

'affecte comptes 215+216 Diminution du Fonds commercial
Sheets("feuil28").Range("id5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("id1:id5000")) 'compte 215
Sheets("feuil28").Range("ie5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ie1:ie5000")) 'compte 216
'Sheets("feuil23").Range("f18") = Sheets("feuil28").Range("id5001")+Sheets("feuil28").Range("ie5001")

'affecte comptes 217+218 Diminution des Autres immob. incorporelles
Sheets("feuil28").Range("if5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("if1:if5000")) 'compte 217
Sheets("feuil28").Range("ig5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ig1:ig5000")) 'compte 218
'Sheets("feuil23").Range("f19") = Sheets("feuil28").Range("if5001")+Sheets("feuil28").Range("ig5001")

'affecte comptes 2191+2193+2198 Diminution des Immob. incorporelles encours
Sheets("feuil28").Range("ih5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ih1:ih5000")) 'compte 2191
Sheets("feuil28").Range("ii5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ii1:ii5000")) 'compte 2193
Sheets("feuil28").Range("ij5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ij1:ij5000")) 'compte 2198
'Sheets("feuil23").Range("f20") = Sheets("feuil28").Range("ih5001")+Sheets("feuil28").Range("ii5001")+Sheets("feuil28").Range("ij5001")

'affecte comptes 22 Diminution des Terrains
Sheets("feuil28").Range("ik5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ik1:ik5000")) 'compte 22
'Sheets("feuil23").Range("f22") = Sheets("feuil28").Range("ik5001")

'affecte comptes 231+232+233+237 Diminution des Bâtiments
Sheets("feuil28").Range("il5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("il1:il5000")) 'compte 231
Sheets("feuil28").Range("im5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("im1:im5000")) 'compte 232
Sheets("feuil28").Range("in5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("in1:in5000")) 'compte 233
Sheets("feuil28").Range("io5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("io1:io5000")) 'compte 237
'Sheets("feuil23").Range("f23") = Sheets("feuil28").Range("il5001")+Sheets("feuil28").Range("im5001")+Sheets("feuil28").Range("in5001")+Sheets("feuil28").Range("io5001")

'affecte comptes 234+235+238 Diminution des Installations et agenc.
Sheets("feuil28").Range("ip5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ip1:ip5000")) 'compte 234
Sheets("feuil28").Range("iq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iq1:iq5000")) 'compte 235
Sheets("feuil28").Range("ir5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ir1:ir5000")) 'compte 238
'Sheets("feuil23").Range("f24") = Sheets("feuil28").Range("ip5001")+Sheets("feuil28").Range("iq5001")+Sheets("feuil28").Range("ir5001")

'affecte comptes 24 sauf 249 Diminution du Matériel
Sheets("feuil28").Range("is5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("is1:is5000")) 'compte 24 sauf 249
'Sheets("feuil23").Range("f25") = Sheets("feuil28").Range("is5001")

'affecte comptes 229 Diminution des terains encours
Sheets("feuil28").Range("it5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("it1:it5000")) 'compte 229
'Sheets("feuil23").Range("f26") = Sheets("feuil28").Range("it5001")

'affecte comptes+249 Diminution du Matériel encours
Sheets("feuil28").Range("iv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iv1:iv5000")) 'compte 249
'Sheets("feuil23").Range("f26") = Sheets("feuil28").Range("iv5001")

'affecte comptes 25 Diminution des Avances sur immob.
Sheets("feuil28").Range("iw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iw1:iw5000")) 'compte 25
'Sheets("feuil23").Range("f28") = Sheets("feuil28").Range("iw5001")

'affecte comptes 26 Diminution des Titres de participation
Sheets("feuil28").Range("ix5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ix1:ix5000")) 'compte 26
'Sheets("feuil23").Range("f30") = Sheets("feuil28").Range("ix5001")

'affecte comptes 27 sauf 274 + 274 Diminution des Autres immob. financières
Sheets("feuil28").Range("iy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iy1:iy5000")) 'compte 27 sauf 274
Sheets("feuil28").Range("iz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iz1:iz5000")) 'compte 274
'Sheets("feuil23").Range("f31") = Sheets("feuil28").Range("iy5001")+Sheets("feuil28").Range("iz5001")

'affecte comptes 821 Prix de cession des immob. incorporelles
Sheets("feuil28").Range("ja5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ja1:ja5000")) 'compte 821
'Sheets("feuil7").Range("i29") = Sheets("feuil28").Range("ja5001")

'affecte comptes 822 Prix de cession des immob. corporelles
Sheets("feuil28").Range("jb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jb1:jb5000")) 'compte 822
'Sheets("feuil7").Range("i30") = Sheets("feuil28").Range("jb5001")

'affecte comptes 826 Prix de cession des immob. financières
Sheets("feuil28").Range("jc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jc1:jc5000")) 'compte 826
'Sheets("feuil7").Range("i31") = Sheets("feuil28").Range("jc5001")

'affecte comptes 10c -109d Augmentation du capital
Sheets("feuil28").Range("jd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jd1:jd5000")) 'compte 10c
Sheets("feuil28").Range("jp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jp1:jp5000")) 'compte 109d
'Sheets("feuil7").Range("i35") = Sheets("feuil28").Range("jd5001")-Sheets("feuil28").Range("jp5001")

'affecte comptes 10d sauf 109 Réduction du capital
Sheets("feuil28").Range("je5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("je1:je5000")) 'compte 10d sauf 109
'Sheets("feuil7").Range("h36") = Sheets("feuil28").Range("je5001")

'affecte comptes 465d Dividendes distribués
Sheets("feuil28").Range("jf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jf1:jf5000")) 'compte 465d
'Sheets("feuil7").Range("h37") = Sheets("feuil28").Range("jf5001")

'affecte comptes 16c+17c+18c Augmentation des emprunts
Sheets("feuil28").Range("jg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jg1:jg5000")) 'compte 16c
Sheets("feuil28").Range("jh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jh1:jh5000")) 'compte 17c
Sheets("feuil28").Range("ji5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ji1:ji5000")) 'compte 18c
'Sheets("feuil7").Range("i41") = Sheets("feuil28").Range("jg5001")+Sheets("feuil28").Range("jh5001")+Sheets("feuil28").Range("ji5001")

'affecte comptes 16d+17d+18d Remboursement des emprunts
Sheets("feuil28").Range("jj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jj1:jj5000")) 'compte 16d
Sheets("feuil28").Range("jk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jk1:jk5000")) 'compte 17d
Sheets("feuil28").Range("jl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jl1:jl5000")) 'compte 18d
'Sheets("feuil7").Range("h42") = Sheets("feuil28").Range("jj5001")+Sheets("feuil28").Range("jk5001")+Sheets("feuil28").Range("jl5001")

'affecte comptes 478 Subvention d'investissement reçue
Sheets("feuil28").Range("jm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jm1:jm5000")) 'compte 478
'Sheets("feuil7").Range("i43") = Sheets("feuil28").Range("jm5001")

'affecte comptes 245 Diminution du Matériel de transport
Sheets("feuil28").Range("jr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jr1:jr5000")) 'compte 245
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2495Diminution du Matériel de transport encours
Sheets("feuil28").Range("js5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("js1:js5000")) 'compte 2495
'Sheets("feuil23").Range("g29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2391+2392+2393+2397 Diminution des Bâtiments encours
Sheets("feuil28").Range("jt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jt1:jt5000")) 'compte 2931/2/3/7
'Sheets("feuil23").Range("g29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2394+2395+2398 Diminution des Installations et agts encours
Sheets("feuil28").Range("ju5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ju1:ju5000")) 'compte 2934/5/8
'Sheets("feuil23").Range("g29") = Sheets("feuil28").Range("jr5001")


'ADAPATION SYSCOHADA révisé
'affecte comptes 2281 augmentation terrains - immeuble de placement
Sheets("feuil28").Range("ka5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ka1:ka5000")) 'compte 2281
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2315+2325 augmentation bâtiments - immeuble de placement
Sheets("feuil28").Range("kb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kb1:kb5000")) 'compte 2315+2325
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2281 diminution terrains - immeuble de placement
Sheets("feuil28").Range("kc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kc1:kc5000")) 'compte 2281
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2315+2325 diminution bâtiments - immeuble de placement
Sheets("feuil28").Range("kd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kd1:kd5000")) 'compte 2315+2325
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 22981 diminution terrains - immeuble de placement encours
Sheets("feuil28").Range("ke5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ke1:ke5000")) 'compte 22981
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 23915+23925 diminution bâtiments - immeuble de placement encours
Sheets("feuil28").Range("kf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kf1:kf5000")) 'compte 23915+23925
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")



'calcul de la CAFG
Sheets("feuil12").Range("j19") = Sheets("feuil6").Range("i36") 'EBE
Sheets("feuil12").Range("e20") = -Sheets("feuil6").Range("i43") 'Frais financiers
'Sheets("feuil12").Range("e22") = Sheets("feuil6").Range("g20") 'Pertes de change
Sheets("feuil12").Range("e23") = -Sheets("feuil6").Range("i50") 'Charges HAO
Sheets("feuil12").Range("e25") = -Sheets("feuil6").Range("i52") 'Participation des travailleurs
Sheets("feuil12").Range("e26") = -Sheets("feuil6").Range("i53") 'Impôt sur le résultat
'Sheets("feuil12").Range("j20") = Sheets("feuil6").Range("h41") 'Transfert de charges
Sheets("feuil12").Range("j22") = Sheets("feuil6").Range("i40") 'Revenus financiers
Sheets("feuil12").Range("j23") = Sheets("feuil6").Range("i42") 'Transfert de charges financières
'Sheets("feuil12").Range("j25") = Sheets("feuil6").Range("h18") 'Gain de change
Sheets("feuil12").Range("j26") = Sheets("feuil6").Range("i48") 'Produits HAO
'Sheets("feuil12").Range("j27") = Sheets("feuil6").Range("h38") 'Transfert HAO
'affectation dans le TAFIRE de la CAFG
Sheets("feuil7").Range("g15") = Sheets("feuil12").Range("j29") - Sheets("feuil12").Range("e29")


'VARIATION DES STOCKS
'adaptation SYSCOHADA révisé calcul variation des stocks et encours
If Sheets("feuil5").Range("g36") - Sheets("feuil5").Range("h36") > 0 Then
Sheets("feuil12").Range("e47") = Sheets("feuil5").Range("g36") - Sheets("feuil5").Range("h36")
Else
Sheets("feuil12").Range("j47") = -(Sheets("feuil5").Range("g36") - Sheets("feuil5").Range("h36"))
End If
'affectation dans le TAFIRE
Sheets("feuil7").Range("g17") = -(Sheets("feuil12").Range("e47") - Sheets("feuil12").Range("j47"))


'VARIATION DES CREANCES
'calcul variation des fournisseurs, avances
If Sheets("feuil5").Range("g38") - Sheets("feuil5").Range("h38") > 0 Then
Sheets("feuil12").Range("e65") = Sheets("feuil5").Range("g38") - Sheets("feuil5").Range("h38")
Else
Sheets("feuil12").Range("j65") = -(Sheets("feuil5").Range("g38") - Sheets("feuil5").Range("h38"))
End If

'calcul variation des clients
If Sheets("feuil5").Range("g39") - Sheets("feuil5").Range("h39") > 0 Then
Sheets("feuil12").Range("e66") = Sheets("feuil5").Range("g39") - Sheets("feuil5").Range("h39")
Else
Sheets("feuil12").Range("j66") = -(Sheets("feuil5").Range("g39") - Sheets("feuil5").Range("h39"))
End If

'calcul variation des autres créances
If Sheets("feuil5").Range("g40") - Sheets("feuil5").Range("h40") > 0 Then
Sheets("feuil12").Range("e67") = Sheets("feuil5").Range("g40") - Sheets("feuil5").Range("h40")
Else
Sheets("feuil12").Range("j67") = -(Sheets("feuil5").Range("g40") - Sheets("feuil5").Range("h40"))
End If

'calcul variation des ecarts de conversion ACTIF
If Sheets("feuil5").Range("g46") - Sheets("feuil5").Range("h46") > 0 Then
Sheets("feuil12").Range("e68") = Sheets("feuil5").Range("g46") - Sheets("feuil5").Range("h46")
Else
Sheets("feuil12").Range("j68") = -(Sheets("feuil5").Range("g46") - Sheets("feuil5").Range("h46"))
End If

'calcul variation globale nette des creances
If WorksheetFunction.Sum(Sheets("feuil12").Range("e65:e68")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j65:j68")) > 0 Then
Sheets("feuil12").Range("e70") = WorksheetFunction.Sum(Sheets("feuil12").Range("e65:e68")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j65:j68"))
Else
Sheets("feuil12").Range("j70") = -(WorksheetFunction.Sum(Sheets("feuil12").Range("e65:e68")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j65:j68")))
End If
'affectation dans le TAFIRE
Sheets("feuil7").Range("g18") = -(Sheets("feuil12").Range("e70") - Sheets("feuil12").Range("j70"))


'VARIATION DES CREANCES H.A.O
'calcul variation des creances HAO
If Sheets("feuil5").Range("g35") - Sheets("feuil5").Range("h35") > 0 Then
Sheets("feuil12").Range("e71") = Sheets("feuil5").Range("g35") - Sheets("feuil5").Range("h35")
Else
Sheets("feuil12").Range("j71") = -(Sheets("feuil5").Range("g35") - Sheets("feuil5").Range("h35"))
End If
'affectation dans le TAFIRE
Sheets("feuil7").Range("g16") = -(Sheets("feuil12").Range("e71") - Sheets("feuil12").Range("j71"))


'VARIATION DES DETTES FOURNISSEURS
'calcul variation des clients, avances
If Sheets("feuil5").Range("m36") - Sheets("feuil5").Range("n36") > 0 Then
Sheets("feuil12").Range("j75") = Sheets("feuil5").Range("m36") - Sheets("feuil5").Range("n36")
Else
Sheets("feuil12").Range("e75") = -(Sheets("feuil5").Range("m36") - Sheets("feuil5").Range("n36"))
End If

'calcul variation des fournisseurs
If Sheets("feuil5").Range("m37") - Sheets("feuil5").Range("n37") > 0 Then
Sheets("feuil12").Range("j76") = Sheets("feuil5").Range("m37") - Sheets("feuil5").Range("n37")
Else
Sheets("feuil12").Range("e76") = -(Sheets("feuil5").Range("m37") - Sheets("feuil5").Range("n37"))
End If

'adaptation SYSCOHADA révisé calcul variation des dettes fiscales et sociales
If Sheets("feuil5").Range("m38") - Sheets("feuil5").Range("n38") > 0 Then
Sheets("feuil12").Range("j77") = Sheets("feuil5").Range("m38") - Sheets("feuil5").Range("n38")
Else
Sheets("feuil12").Range("e77") = -(Sheets("feuil5").Range("m38") - Sheets("feuil5").Range("n38"))
End If

'calcul variation des autres dettes
If Sheets("feuil5").Range("m39") - Sheets("feuil5").Range("n39") > 0 Then
Sheets("feuil12").Range("j79") = Sheets("feuil5").Range("m39") - Sheets("feuil5").Range("n39")
Else
Sheets("feuil12").Range("e79") = -(Sheets("feuil5").Range("m39") - Sheets("feuil5").Range("n39"))
End If

'calcul variation des risques provisionnés
If Sheets("feuil5").Range("m40") - Sheets("feuil5").Range("n40") > 0 Then
Sheets("feuil12").Range("j80") = Sheets("feuil5").Range("m40") - Sheets("feuil5").Range("n40")
Else
Sheets("feuil12").Range("e80") = -(Sheets("feuil5").Range("m40") - Sheets("feuil5").Range("n40"))
End If

'calcul variation des écarts de conversion PASSIF
If Sheets("feuil5").Range("m46") - Sheets("feuil5").Range("n46") > 0 Then
Sheets("feuil12").Range("j81") = Sheets("feuil5").Range("m46") - Sheets("feuil5").Range("n46")
Else
Sheets("feuil12").Range("e81") = -(Sheets("feuil5").Range("m46") - Sheets("feuil5").Range("n46"))
End If

'calcul variation globale nette des dettes fournisseurs
If WorksheetFunction.Sum(Sheets("feuil12").Range("e75:e81")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j75:j81")) > 0 Then
Sheets("feuil12").Range("e84") = WorksheetFunction.Sum(Sheets("feuil12").Range("e75:e81")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j75:j81"))
Else
Sheets("feuil12").Range("j84") = -(WorksheetFunction.Sum(Sheets("feuil12").Range("e75:e81")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j75:j81")))
End If
'VARIATION DES DETTES H.A.O.
'variation des dettes H.A.O.
If Sheets("feuil5").Range("m35") - Sheets("feuil5").Range("n35") > 0 Then
Sheets("feuil12").Range("j85") = Sheets("feuil5").Range("m35") - Sheets("feuil5").Range("n35")
Else
Sheets("feuil12").Range("e85") = -(Sheets("feuil5").Range("m35") - Sheets("feuil5").Range("n35"))
End If
'affectation dans le TAFIRE (adaptation SYSCOHADA révisé)
Sheets("feuil7").Range("g19") = (Sheets("feuil12").Range("j84") + Sheets("feuil12").Range("j85")) - (Sheets("feuil12").Range("e84") + Sheets("feuil12").Range("e85"))


'CALCUL ETE
'Sheets("feuil12").Range("e94") = Sheets("feuil9").Range("f38") 'EBE
'Sheets("feuil12").Range("e95") = -(Sheets("feuil12").Range("e87") - Sheets("feuil12").Range("j87"))
'Sheets("feuil12").Range("e96") = -Sheets("feuil9").Range("h23")

'affectation dans le Tableau 1 - Actif immobilisé (AUGMENTATIONS)
'les acquisitions
'Sheets("feuil23").Range("c16") = Sheets("feuil28").Range("gz5001") 'frais de développement et de prospection
'Sheets("feuil23").Range("c17") = Sheets("feuil28").Range("ha5001") + Sheets("feuil28").Range("hb5001") + Sheets("feuil28").Range("hc5001") 'Brevets, licences, logiciels
'Sheets("feuil23").Range("c18") = Sheets("feuil28").Range("hd5001") + Sheets("feuil28").Range("he5001") 'fonds commercial
'Sheets("feuil23").Range("c19") = Sheets("feuil28").Range("hf5001") + Sheets("feuil28").Range("hg5001") 'autres immob. incorporelles

'Sheets("feuil23").Range("c21") = Sheets("feuil28").Range("hk5001") 'Terrains
'Sheets("feuil23").Range("c22") = Sheets("feuil28").Range("ka5001") 'Terrains - immeuble de placement
'Sheets("feuil23").Range("c23") = Sheets("feuil28").Range("hl5001") + Sheets("feuil28").Range("hm5001") + Sheets("feuil28").Range("hn5001") + Sheets("feuil28").Range("ho5001") 'bâtiments
'Sheets("feuil23").Range("c24") = Sheets("feuil28").Range("kb5001") 'bâtiments - immeuble de placement
'Sheets("feuil23").Range("c25") = Sheets("feuil28").Range("hp5001") + Sheets("feuil28").Range("hq5001") + Sheets("feuil28").Range("hr5001") 'installations et agenc.
'Sheets("feuil23").Range("c26") = Sheets("feuil28").Range("hs5001") 'matériel
'Sheets("feuil23").Range("c27") = Sheets("feuil28").Range("ht5001") 'matériel de transport

'Sheets("feuil23").Range("c29") = Sheets("feuil28").Range("hw5001") 'Avances sur immob.
'Sheets("feuil23").Range("c33") = Sheets("feuil28").Range("hx5001") 'Titre de participation
'Sheets("feuil23").Range("c34") = Sheets("feuil28").Range("hy5001") 'Autres immob. financières

'affectation dans le Tableau 1 - Actif immobilisé (DIMINUTIONS)
'les cessions
'Sheets("feuil23").Range("f16") = Sheets("feuil28").Range("hz5001") 'frais de dévelop et prospection
'Sheets("feuil23").Range("f17") = Sheets("feuil28").Range("ia5001") + Sheets("feuil28").Range("ib5001") + Sheets("feuil28").Range("ic5001") 'Brevets, licences, logiciels
'Sheets("feuil23").Range("f18") = Sheets("feuil28").Range("id5001") + Sheets("feuil28").Range("ie5001") 'fonds commercial
'Sheets("feuil23").Range("f19") = Sheets("feuil28").Range("if5001") + Sheets("feuil28").Range("ig5001") 'autres immob. incorporelles

'Sheets("feuil23").Range("f21") = Sheets("feuil28").Range("ik5001") 'Terrains
'Sheets("feuil23").Range("f22") = Sheets("feuil28").Range("kc5001") 'Terrains - immeuble de placement
'Sheets("feuil23").Range("f23") = Sheets("feuil28").Range("il5001") + Sheets("feuil28").Range("im5001") + Sheets("feuil28").Range("in5001") + Sheets("feuil28").Range("io5001") 'bâtiments
'Sheets("feuil23").Range("f24") = Sheets("feuil28").Range("kd5001") 'Bâtiments - immeuble de placement
'Sheets("feuil23").Range("f25") = Sheets("feuil28").Range("ip5001") + Sheets("feuil28").Range("iq5001") + Sheets("feuil28").Range("ir5001") 'installations et agenc.
'Sheets("feuil23").Range("f26") = Sheets("feuil28").Range("is5001") 'matériel
'Sheets("feuil23").Range("f27") = Sheets("feuil28").Range("jr5001") 'matériel de transport

'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("iw5001") 'Avances sur immob.
'Sheets("feuil23").Range("f33") = Sheets("feuil28").Range("ix5001") 'Titre de participation
'Sheets("feuil23").Range("f34") = Sheets("feuil28").Range("iy5001") + Sheets("feuil28").Range("iz5001") 'Autres immob. financières

'affectation dans le Tableau 1 - Actif immobilisé (VIREMENTS POSTE A POSTE)
'Frais de recherche encours
'Sheets("feuil23").Range("g16") = Sheets("feuil28").Range("ih5001")
'Sheets("feuil23").Range("c16") = Sheets("feuil23").Range("c16") - Sheets("feuil23").Range("g16")
'Sheets("feuil23").Range("d16") = Sheets("feuil23").Range("g16")
'Brevets, licences, logiciel encours
'Sheets("feuil23").Range("g17") = Sheets("feuil28").Range("ii5001")
'Sheets("feuil23").Range("c17") = Sheets("feuil23").Range("c17") - Sheets("feuil23").Range("g17")
'Sheets("feuil23").Range("d17") = Sheets("feuil23").Range("g17")
'Autres immob. incorporelles encours
'Sheets("feuil23").Range("g19") = Sheets("feuil28").Range("ij5001")
'Sheets("feuil23").Range("c19") = Sheets("feuil23").Range("c19") - Sheets("feuil23").Range("g19")
'Sheets("feuil23").Range("d19") = Sheets("feuil23").Range("g19")

'Terrains encours
'Sheets("feuil23").Range("g21") = Sheets("feuil28").Range("it5001")
'Sheets("feuil23").Range("c21") = Sheets("feuil23").Range("c21") - Sheets("feuil23").Range("g21")
'Sheets("feuil23").Range("d21") = Sheets("feuil23").Range("g21")
'Terrains - immeuble de placement encours
'Sheets("feuil23").Range("g22") = Sheets("feuil28").Range("ke5001")
'Sheets("feuil23").Range("c22") = Sheets("feuil23").Range("c22") - Sheets("feuil23").Range("g22")
'Sheets("feuil23").Range("d22") = Sheets("feuil23").Range("g22")
'Bâtiments encours
'Sheets("feuil23").Range("g23") = Sheets("feuil28").Range("jt5001")
'Sheets("feuil23").Range("c23") = Sheets("feuil23").Range("c23") - Sheets("feuil23").Range("g23")
'Sheets("feuil23").Range("d23") = Sheets("feuil23").Range("g23")
'Bâtiments - immeuble de placement encours
'Sheets("feuil23").Range("g24") = Sheets("feuil28").Range("kf5001")
'Sheets("feuil23").Range("c24") = Sheets("feuil23").Range("c24") - Sheets("feuil23").Range("g24")
'Sheets("feuil23").Range("d24") = Sheets("feuil23").Range("g24")
'Installations et agts encours
'Sheets("feuil23").Range("g25") = Sheets("feuil28").Range("ju5001")
'Sheets("feuil23").Range("c25") = Sheets("feuil23").Range("c25") - Sheets("feuil23").Range("g25")
'Sheets("feuil23").Range("d25") = Sheets("feuil23").Range("g25")
'Matériel encours
'Sheets("feuil23").Range("g26") = Sheets("feuil28").Range("iv5001")
'Sheets("feuil23").Range("c26") = Sheets("feuil23").Range("c26") - Sheets("feuil23").Range("g26")
'Sheets("feuil23").Range("d26") = Sheets("feuil23").Range("g26")
'Matériel de transport encours
'Sheets("feuil23").Range("g27") = Sheets("feuil28").Range("js5001")
'Sheets("feuil23").Range("c27") = Sheets("feuil23").Range("c27") - Sheets("feuil23").Range("g27")
'Sheets("feuil23").Range("d27") = Sheets("feuil23").Range("g27")

'___________________________________________________________________________________________________________________________

'CALCUL DES TOTAUX du Tableau 1 - Actif immobilisé
'total immobilisation incorporelle
Sheets("feuil23").Range("b30") = WorksheetFunction.Sum(Sheets("feuil23").Range("b16:b19")) 'mtt brut à l'ouverture
Sheets("feuil23").Range("c30") = WorksheetFunction.Sum(Sheets("feuil23").Range("c16:c19")) 'augmentation/acquisition
Sheets("feuil23").Range("d30") = WorksheetFunction.Sum(Sheets("feuil23").Range("d16:d19")) 'augmentation/virement poste
Sheets("feuil23").Range("e30") = WorksheetFunction.Sum(Sheets("feuil23").Range("e16:e19")) 'augmentation/réévaluation
Sheets("feuil23").Range("f30") = WorksheetFunction.Sum(Sheets("feuil23").Range("f16:f19")) 'diminution/cessions
Sheets("feuil23").Range("g30") = WorksheetFunction.Sum(Sheets("feuil23").Range("g16:g19")) 'diminution/virement poste
Sheets("feuil23").Range("i30") = WorksheetFunction.Sum(Sheets("feuil23").Range("i16:i19")) 'mtt brut à la clôture

'total immobilisation corporelle
Sheets("feuil23").Range("b31") = WorksheetFunction.Sum(Sheets("feuil23").Range("b21:b29")) 'mtt brut à l'ouverture
Sheets("feuil23").Range("c31") = WorksheetFunction.Sum(Sheets("feuil23").Range("c21:c29")) 'augmentation/acquisition
Sheets("feuil23").Range("d31") = WorksheetFunction.Sum(Sheets("feuil23").Range("d21:d29")) 'augmentation/virement poste
Sheets("feuil23").Range("e31") = WorksheetFunction.Sum(Sheets("feuil23").Range("e21:e29")) 'augmentation/réévaluation
Sheets("feuil23").Range("f31") = WorksheetFunction.Sum(Sheets("feuil23").Range("f21:f29")) 'diminution/cessions
Sheets("feuil23").Range("g31") = WorksheetFunction.Sum(Sheets("feuil23").Range("g21:g29")) 'diminution/virement poste
Sheets("feuil23").Range("i31") = WorksheetFunction.Sum(Sheets("feuil23").Range("i21:i29")) 'mtt brut à la clôture

'total général
Sheets("feuil23").Range("b35") = WorksheetFunction.Sum(Sheets("feuil23").Range("b33:b34")) + Sheets("feuil23").Range("b30") + Sheets("feuil23").Range("b31") 'mtt brut à l'ouverture
Sheets("feuil23").Range("c35") = WorksheetFunction.Sum(Sheets("feuil23").Range("c33:c34")) + Sheets("feuil23").Range("c30") + Sheets("feuil23").Range("c31") 'augmentation/acquisition
Sheets("feuil23").Range("d35") = WorksheetFunction.Sum(Sheets("feuil23").Range("d33:d34")) + Sheets("feuil23").Range("d30") + Sheets("feuil23").Range("d31") 'augmentation/virement poste
Sheets("feuil23").Range("e35") = WorksheetFunction.Sum(Sheets("feuil23").Range("e33:e34")) + Sheets("feuil23").Range("e30") + Sheets("feuil23").Range("e31") 'augmentation/réévaluation
Sheets("feuil23").Range("f35") = WorksheetFunction.Sum(Sheets("feuil23").Range("f33:f34")) + Sheets("feuil23").Range("f30") + Sheets("feuil23").Range("f31") 'diminution/cessions
Sheets("feuil23").Range("g35") = WorksheetFunction.Sum(Sheets("feuil23").Range("g33:g34")) + Sheets("feuil23").Range("g30") + Sheets("feuil23").Range("g31") 'diminution/virement poste
Sheets("feuil23").Range("i35") = WorksheetFunction.Sum(Sheets("feuil23").Range("i33:i34")) + Sheets("feuil23").Range("i30") + Sheets("feuil23").Range("i31") 'mtt brut à la clôture

'CALCUL ET AFFICHE LES ECRATS DU TABLEAU 1
For i = 16 To 35
If Sheets("feuil23").Cells(i, 2) + Sheets("feuil23").Cells(i, 3) + Sheets("feuil23").Cells(i, 4) + Sheets("feuil23").Cells(i, 5) - Sheets("feuil23").Cells(i, 6) - Sheets("feuil23").Cells(i, 7) - Sheets("feuil23").Cells(i, 9) = 0 Then
Else
Sheets("feuil23").Cells(i, 10) = "Ecart"
Sheets("feuil23").Cells(i, 11) = Sheets("feuil23").Cells(i, 2) + Sheets("feuil23").Cells(i, 3) + Sheets("feuil23").Cells(i, 4) + Sheets("feuil23").Cells(i, 5) - Sheets("feuil23").Cells(i, 6) - Sheets("feuil23").Cells(i, 7) - Sheets("feuil23").Cells(i, 9)
End If
Next

'_______________________________________________________________________________________________________

'affectation du Tableau 1 - Actif immobilisé dans le TAFIRE
Sheets("feuil7").Range("g26") = -Sheets("feuil23").Range("c30") 'immob. incorporelles
Sheets("feuil7").Range("g27") = -Sheets("feuil23").Range("c31") 'immob. corporelles
Sheets("feuil7").Range("g28") = -WorksheetFunction.Sum(Sheets("feuil23").Range("c33:c34")) 'immob. financières

'affectation des prix de cession
Sheets("feuil7").Range("g29") = Sheets("feuil28").Range("ja5001") + Sheets("feuil28").Range("jb5001") + Sheets("feuil23").Range("f29") 'immob. incorporelles et corporelles
Sheets("feuil7").Range("g30") = Sheets("feuil28").Range("jc5001") + Sheets("feuil28").Range("iy5001")  'immob. financières

'affectation des capitaux propres
Sheets("feuil7").Range("g35") = Sheets("feuil28").Range("jd5001") - Sheets("feuil28").Range("jp5001") 'augmentation du capital
Sheets("feuil7").Range("g37") = -Sheets("feuil28").Range("je5001") 'remboursement du capital
Sheets("feuil7").Range("g38") = -Sheets("feuil28").Range("jf5001") 'dividendes distribués
Sheets("feuil7").Range("g36") = Sheets("feuil28").Range("jm5001") 'subvention d'investissement reçue
'affectation des dividendes pour le calcul de l'Autofinancement
Sheets("feuil12").Range("e35") = Sheets("feuil28").Range("jf5001") 'dividendes distribués

'affectation des capitaux étrangers
Sheets("feuil7").Range("g43") = Sheets("feuil28").Range("jg5001")  'augmentation des emprunts
Sheets("feuil7").Range("g44") = Sheets("feuil28").Range("jh5001") + Sheets("feuil28").Range("ji5001")  'augmentation des divers emprunts
Sheets("feuil7").Range("g45") = -(Sheets("feuil28").Range("jj5001") + Sheets("feuil28").Range("jk5001") + Sheets("feuil28").Range("jl5001")) 'remboursement des emprunts

'affectation de la trésorerie nette du bilan
'trésorerie à l'ouverture N-1
Sheets("feuil7").Range("g12") = Sheets("feuil5").Range("h45") - Sheets("feuil5").Range("n45")

'trésorerie à la clôture N
Sheets("feuil7").Range("g54") = Sheets("feuil5").Range("g45") - Sheets("feuil5").Range("m45")


edite_tafire_n_suite

'demande de confirmation
End If

'condition d'édition
End If
End If

End Sub
Private Sub reedite_tafire_tab1_n_1()

'condition d'édition
If WorksheetFunction.Sum(Sheets("feuil1").Range("g3:h5001")) = 0 Then
MsgBox "Désolé !  Aucune donnée à éditer."
Else

If Sheets("feuil5").Range("n47") = "" Then
MsgBox "Veuillez d'abord éditer le Bilan N-1 !"
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition à nouveau du T.F.T.  N-1  ?", vbYesNo, "Demande de confirmation") = vbYes Then

'annule bilan N-2
Sheets("feuil5").Range("ae14:ag47").ClearContents
Sheets("feuil5").Range("am13:am47").ClearContents
'edite bilan N-2
edite_bilan_n_2


'efface les données note trésorerie - calcul CAFG
Sheets("feuil12").Range("e20:e26").ClearContents
Sheets("feuil12").Range("j19:j27").ClearContents
Sheets("feuil12").Range("e42:e47").ClearContents
Sheets("feuil12").Range("j42:j47").ClearContents
Sheets("feuil12").Range("e35").ClearContents

Sheets("feuil12").Range("e65:e70").ClearContents
Sheets("feuil12").Range("j65:j70").ClearContents

Sheets("feuil12").Range("e75:e88").ClearContents
Sheets("feuil12").Range("j75:j88").ClearContents
Sheets("feuil12").Range("e94:e96").ClearContents

'efface les données Tafire
Sheets("feuil7").Range("h12:h54").ClearContents
Sheets("feuil7").Range("e22").ClearContents
Sheets("feuil7").Range("j54").ClearContents 'message d'écart
Sheets("feuil7").Range("k54").ClearContents 'message d'écart

'recup des données pour le TAFIRE N
For i = 1 To 5000

'adaptation SYSCOHADA révisé recup compte 211+2191+2181 Augmentation des Frais de dévelop et prospection
If Left(Sheets("feuil1").Cells(i, 1), 3) = 211 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2191 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2181 Then
Sheets("feuil28").Cells(i, 208) = Sheets("feuil1").Cells(i, 5) 'colonne GZ
Else
End If

'recup compte 212 Augmentation des Brevets, licences, logiciels
If Left(Sheets("feuil1").Cells(i, 1), 3) = 212 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2192 Then
Sheets("feuil28").Cells(i, 209) = Sheets("feuil1").Cells(i, 5) 'colonne HA
Else
End If

'recup compte 213 Augmentation des Brevets, licences, logiciels
If Left(Sheets("feuil1").Cells(i, 1), 3) = 213 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2193 Then
Sheets("feuil28").Cells(i, 210) = Sheets("feuil1").Cells(i, 5) 'colonne HB
Else
End If

'recup compte 214 Augmentation des Brevets, licences, logiciels
If Left(Sheets("feuil1").Cells(i, 1), 3) = 214 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2194 Then
Sheets("feuil28").Cells(i, 211) = Sheets("feuil1").Cells(i, 5) 'colonne HC
Else
End If

'recup compte 215 Augmentation du Fonds commercial
If Left(Sheets("feuil1").Cells(i, 1), 3) = 215 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2195 Then
Sheets("feuil28").Cells(i, 212) = Sheets("feuil1").Cells(i, 5) 'colonne HD
Else
End If

'recup compte 216 Augmentation du Fonds commercial
If Left(Sheets("feuil1").Cells(i, 1), 3) = 216 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2196 Then
Sheets("feuil28").Cells(i, 213) = Sheets("feuil1").Cells(i, 5) 'colonne HE
Else
End If

'recup compte 217 Augmentation des Autres immob. incorporelles
If Left(Sheets("feuil1").Cells(i, 1), 3) = 217 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2197 Then
Sheets("feuil28").Cells(i, 214) = Sheets("feuil1").Cells(i, 5) 'colonne HF
Else
End If

'adaptation SYSCOHADA révisé recup compte 218 Augmentation des Autres immob. incorporelles
If Left(Sheets("feuil1").Cells(i, 1), 3) = 218 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2198 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2181 Then
Else
Sheets("feuil28").Cells(i, 215) = Sheets("feuil1").Cells(i, 5) 'colonne HG
End If
Else
End If

'recup compte 2191 Augmentation des Immob. incorporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2191 Then
Sheets("feuil28").Cells(i, 216) = Sheets("feuil1").Cells(i, 5) 'colonne HH
Else
End If

'recup compte 2193 Augmentation des Immob. incorporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2193 Then
Sheets("feuil28").Cells(i, 217) = Sheets("feuil1").Cells(i, 5) 'colonne HI
Else
End If

'recup compte 2198 Augmentation des Immob. incorporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2198 Then
Sheets("feuil28").Cells(i, 218) = Sheets("feuil1").Cells(i, 5) 'colonne HJ
Else
End If

'adaptation SYSCOHADA révisé recup compte 22 Augmentation des terrains
If Left(Sheets("feuil1").Cells(i, 1), 2) = 22 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2281 Then
Else
Sheets("feuil28").Cells(i, 219) = Sheets("feuil1").Cells(i, 5) 'colonne HK
End If
Else
End If

'recup compte 231 Augmentation des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 231 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2391 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2315 Then
Else
Sheets("feuil28").Cells(i, 220) = Sheets("feuil1").Cells(i, 5) 'colonne HL
End If
Else
End If

'recup compte 232 Augmentation des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 232 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2392 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2325 Then
Else
Sheets("feuil28").Cells(i, 221) = Sheets("feuil1").Cells(i, 5) 'colonne HM
End If
Else
End If

'recup compte 233 Augmentation des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 233 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2393 Then
Sheets("feuil28").Cells(i, 222) = Sheets("feuil1").Cells(i, 5) 'colonne HN
Else
End If

'recup compte 237 Augmentation des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 237 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2397 Then
Sheets("feuil28").Cells(i, 223) = Sheets("feuil1").Cells(i, 5) 'colonne HO
Else
End If

'recup compte 234 Augmentation des Installations et agenc.
If Left(Sheets("feuil1").Cells(i, 1), 3) = 234 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2394 Then
Sheets("feuil28").Cells(i, 224) = Sheets("feuil1").Cells(i, 5) 'colonne HP
Else
End If

'recup compte 235 Augmentation des Installations et agenc.
If Left(Sheets("feuil1").Cells(i, 1), 3) = 235 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2395 Then
Sheets("feuil28").Cells(i, 225) = Sheets("feuil1").Cells(i, 5) 'colonne HQ
Else
End If

'recup compte 238 Augmentation des Installations et agenc.
If Left(Sheets("feuil1").Cells(i, 1), 3) = 238 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2398 Then
Sheets("feuil28").Cells(i, 226) = Sheets("feuil1").Cells(i, 5) 'colonne HR
Else
End If

'recup compte 24 sauf 245 Augmentation du Matériel
If Left(Sheets("feuil1").Cells(i, 1), 2) = 24 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 245 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2495 Then
Else
Sheets("feuil28").Cells(i, 227) = Sheets("feuil1").Cells(i, 5) 'colonne HS
End If
End If
Else
End If

'recup compte 245 Augmentation du matériel de transport
If Left(Sheets("feuil1").Cells(i, 1), 3) = 245 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2495 Then
Sheets("feuil28").Cells(i, 228) = Sheets("feuil1").Cells(i, 5) 'colonne HT
Else
End If

'recup compte 239 Augmentation des Immob. corporelles encours
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 239 Then
'Sheets("feuil28").Cells(i, 229) = Sheets("feuil2").Cells(i, 5) 'colonne HU
'Else
'End If

'recup compte 249 Augmentation des Immob. corporelles encours
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 249 Then
'Sheets("feuil28").Cells(i, 230) = Sheets("feuil2").Cells(i, 5) 'colonne HV
'Else
'End If

'recup compte 25 Augmentation des Avances sur immob.
If Left(Sheets("feuil1").Cells(i, 1), 2) = 25 Then
Sheets("feuil28").Cells(i, 231) = Sheets("feuil1").Cells(i, 5) 'colonne HW
Else
End If

'recup compte 26 Augmentation des Titres de participation
If Left(Sheets("feuil1").Cells(i, 1), 2) = 26 Then
Sheets("feuil28").Cells(i, 232) = Sheets("feuil1").Cells(i, 5) 'colonne HX
Else
End If

'recup compte 27 Augmentation des Autres immob. financières
If Left(Sheets("feuil1").Cells(i, 1), 2) = 27 Then
Sheets("feuil28").Cells(i, 233) = Sheets("feuil1").Cells(i, 5) 'colonne HY
Else
End If


'adaptation SYSCOHADA révisé recup compte 211+2181 Diminution des Frais de dévelop et prospection
If Left(Sheets("feuil1").Cells(i, 1), 3) = 211 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2181 Then
Sheets("feuil28").Cells(i, 234) = Sheets("feuil1").Cells(i, 6) 'colonne HZ
Else
End If

'recup compte 212 Diminution des Brevets, licences, logiciels
If Left(Sheets("feuil1").Cells(i, 1), 3) = 212 Then
Sheets("feuil28").Cells(i, 235) = Sheets("feuil1").Cells(i, 6) 'colonne IA
Else
End If

'recup compte 213 Diminution des Brevets, licences, logiciels
If Left(Sheets("feuil1").Cells(i, 1), 3) = 213 Then
Sheets("feuil28").Cells(i, 236) = Sheets("feuil1").Cells(i, 6) 'colonne IB
Else
End If

'recup compte 214 Diminution des Brevets, licences, logiciels
If Left(Sheets("feuil1").Cells(i, 1), 3) = 214 Then
Sheets("feuil28").Cells(i, 237) = Sheets("feuil1").Cells(i, 6) 'colonne IC
Else
End If

'recup compte 215 Diminution du Fonds commercial
If Left(Sheets("feuil1").Cells(i, 1), 3) = 215 Then
Sheets("feuil28").Cells(i, 238) = Sheets("feuil1").Cells(i, 6) 'colonne ID
Else
End If

'recup compte 216 Diminution du Fonds commercial
If Left(Sheets("feuil1").Cells(i, 1), 3) = 216 Then
Sheets("feuil28").Cells(i, 239) = Sheets("feuil1").Cells(i, 6) 'colonne IE
Else
End If

'recup compte 217 Diminution des Autres immob. incorporelles
If Left(Sheets("feuil1").Cells(i, 1), 3) = 217 Then
Sheets("feuil28").Cells(i, 240) = Sheets("feuil1").Cells(i, 6) 'colonne IF
Else
End If

'recup compte 218 Diminution des Autres immob. incorporelles
If Left(Sheets("feuil1").Cells(i, 1), 3) = 218 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2181 Then
Else
Sheets("feuil28").Cells(i, 241) = Sheets("feuil1").Cells(i, 6) 'colonne IG
End If
Else
End If

'recup compte 2191 Diminution des Immob. incorporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2191 Then
Sheets("feuil28").Cells(i, 242) = Sheets("feuil1").Cells(i, 6) 'colonne IH
Else
End If

'recup compte 2193 Diminution des Immob. incorporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2193 Then
Sheets("feuil28").Cells(i, 243) = Sheets("feuil1").Cells(i, 6) 'colonne II
Else
End If

'recup compte 2198 Diminution des Immob. incorporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2198 Then
Sheets("feuil28").Cells(i, 244) = Sheets("feuil1").Cells(i, 6) 'colonne IJ
Else
End If

'recup compte 22 sauf 229 Diminution des Terrains
If Left(Sheets("feuil1").Cells(i, 1), 2) = 22 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 229 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2281 Then
Else
Sheets("feuil28").Cells(i, 245) = Sheets("feuil1").Cells(i, 6) 'colonne IK
End If
End If
Else
End If

'recup compte 231 Diminution des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 231 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2315 Then
Else
Sheets("feuil28").Cells(i, 246) = Sheets("feuil1").Cells(i, 6) 'colonne IL
End If
Else
End If

'recup compte 232 Diminution des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 232 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2325 Then
Else
Sheets("feuil28").Cells(i, 247) = Sheets("feuil1").Cells(i, 6) 'colonne IM
End If
Else
End If

'recup compte 233 Diminution des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 233 Then
Sheets("feuil28").Cells(i, 248) = Sheets("feuil1").Cells(i, 6) 'colonne IN
Else
End If

'recup compte 237 Diminution des Bâtiments
If Left(Sheets("feuil1").Cells(i, 1), 3) = 237 Then
Sheets("feuil28").Cells(i, 249) = Sheets("feuil1").Cells(i, 6) 'colonne IO
Else
End If

'recup compte 234 Diminution des Installations et agenc.
If Left(Sheets("feuil1").Cells(i, 1), 3) = 234 Then
Sheets("feuil28").Cells(i, 250) = Sheets("feuil1").Cells(i, 6) 'colonne IP
Else
End If

'recup compte 235 Diminution des Installations et agenc.
If Left(Sheets("feuil1").Cells(i, 1), 3) = 235 Then
Sheets("feuil28").Cells(i, 251) = Sheets("feuil1").Cells(i, 6) 'colonne IQ
Else
End If

'recup compte 238 Diminution des Installations et agenc.
If Left(Sheets("feuil1").Cells(i, 1), 3) = 238 Then
Sheets("feuil28").Cells(i, 252) = Sheets("feuil1").Cells(i, 6) 'colonne IR
Else
End If

'recup compte 24 sauf 249 Diminution du Matériel sauf 245 Transport
If Left(Sheets("feuil1").Cells(i, 1), 2) = 24 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 249 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 3) = 245 Then
Else
Sheets("feuil28").Cells(i, 253) = Sheets("feuil1").Cells(i, 6) 'colonne IS
End If
End If
Else
End If

'adaptation SYSCOHADA révisé recup compte 229 Diminution des Immob. corporelles encours
If Left(Sheets("feuil1").Cells(i, 1), 3) = 229 Then
If Left(Sheets("feuil1").Cells(i, 1), 5) = 22981 Then
Else
Sheets("feuil28").Cells(i, 254) = Sheets("feuil1").Cells(i, 6) 'colonne IT
End If
Else
End If

'recup compte 239 Diminution des Immob. corporelles encours
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 239 Then
'Sheets("feuil28").Cells(i, 255) = Sheets("feuil2").Cells(i, 6) 'colonne IU
'Else
'End If

'recup compte 249 Diminution des Immob. corporelles encours sauf 2495
If Left(Sheets("feuil1").Cells(i, 1), 3) = 249 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2495 Then
Else
Sheets("feuil28").Cells(i, 256) = Sheets("feuil1").Cells(i, 6) 'colonne IV
End If
Else
End If

'recup compte 25 Diminution des Avances sur immob.
If Left(Sheets("feuil1").Cells(i, 1), 2) = 25 Then
Sheets("feuil28").Cells(i, 257) = Sheets("feuil1").Cells(i, 6) 'colonne IW
Else
End If

'recup compte 26 Diminution des Titres de participation
If Left(Sheets("feuil1").Cells(i, 1), 2) = 26 Then
Sheets("feuil28").Cells(i, 258) = Sheets("feuil1").Cells(i, 6) 'colonne IX
Else
End If

'recup compte 27 sauf 274 Diminution des Autres immob. financières
If Left(Sheets("feuil1").Cells(i, 1), 2) = 27 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 274 Then
Else
Sheets("feuil28").Cells(i, 259) = Sheets("feuil1").Cells(i, 6) 'colonne IY
End If
Else
End If

'recup compte 274 Diminution des Autres immob. financières
If Left(Sheets("feuil1").Cells(i, 1), 3) = 274 Then
Sheets("feuil28").Cells(i, 260) = Sheets("feuil1").Cells(i, 6) 'colonne IZ
Else
End If

'recup compte 821 Prix de cession des immob. incorporelles
If Left(Sheets("feuil1").Cells(i, 1), 3) = 821 Then
Sheets("feuil28").Cells(i, 261) = Sheets("feuil1").Cells(i, 6) 'colonne JA
Else
End If

'recup compte 822 Prix de cession des immob. corporelles
If Left(Sheets("feuil1").Cells(i, 1), 3) = 822 Then
Sheets("feuil28").Cells(i, 262) = Sheets("feuil1").Cells(i, 6) 'colonne JB
Else
End If

'recup compte 826 Prix de cession des immob. financières
If Left(Sheets("feuil1").Cells(i, 1), 3) = 826 Then
Sheets("feuil28").Cells(i, 263) = Sheets("feuil1").Cells(i, 6) 'colonne JC
Else
End If

'recup compte 10c Augmentation de capital
If Left(Sheets("feuil1").Cells(i, 1), 2) = 10 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 106 Then
Else
Sheets("feuil28").Cells(i, 264) = Sheets("feuil1").Cells(i, 6) 'colonne JD
End If
Else
End If

'recup compte 10d sauf 109 Réduction du capital
If Left(Sheets("feuil1").Cells(i, 1), 2) = 10 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 109 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 3) = 106 Then
Else
Sheets("feuil28").Cells(i, 265) = Sheets("feuil1").Cells(i, 5) 'colonne JE
End If
End If
Else
End If

'RATTRAPAGE COMPTE 109d
'recup compte 109d Augmentation de capital
If Left(Sheets("feuil1").Cells(i, 1), 3) = 109 Then
Sheets("feuil28").Cells(i, 276) = Sheets("feuil1").Cells(i, 5) 'colonne JP
Else
End If


'recup compte 465 Dividendes distribués
If Left(Sheets("feuil1").Cells(i, 1), 3) = 465 Then
Sheets("feuil28").Cells(i, 266) = Sheets("feuil1").Cells(i, 5) 'colonne JF
Else
End If

'recup compte 16 Augmentation des emprunts
If Left(Sheets("feuil1").Cells(i, 1), 2) = 16 Then
Sheets("feuil28").Cells(i, 267) = Sheets("feuil1").Cells(i, 6) 'colonne JG
Else
End If

'recup compte 17 Augmentation des emprunts
If Left(Sheets("feuil1").Cells(i, 1), 2) = 17 Then
Sheets("feuil28").Cells(i, 268) = Sheets("feuil1").Cells(i, 6) 'colonne JH
Else
End If

'recup compte 18 Augmentation des emprunts
If Left(Sheets("feuil1").Cells(i, 1), 2) = 18 Then
Sheets("feuil28").Cells(i, 269) = Sheets("feuil1").Cells(i, 6) 'colonne JI
Else
End If

'recup compte 16 Remboursement des emprunts
If Left(Sheets("feuil1").Cells(i, 1), 2) = 16 Then
Sheets("feuil28").Cells(i, 270) = Sheets("feuil1").Cells(i, 5) 'colonne JJ
Else
End If

'recup compte 17 Remboursement des emprunts
If Left(Sheets("feuil1").Cells(i, 1), 2) = 17 Then
Sheets("feuil28").Cells(i, 271) = Sheets("feuil1").Cells(i, 5) 'colonne JK
Else
End If

'recup compte 18 Remboursement des emprunts
If Left(Sheets("feuil1").Cells(i, 1), 2) = 18 Then
Sheets("feuil28").Cells(i, 272) = Sheets("feuil1").Cells(i, 5) 'colonne JL
Else
End If

'recup compte 14 Subvention d'investissement reçu
If Left(Sheets("feuil1").Cells(i, 1), 2) = 14 Then
Sheets("feuil28").Cells(i, 273) = Sheets("feuil1").Cells(i, 6) 'colonne JM
Else
End If

'Adaptation compte 206 SYSCOHADA
'recup compte 206 Dimunition des Primes de remboursement
If Left(Sheets("feuil1").Cells(i, 1), 3) = 206 Then
Sheets("feuil28").Cells(i, 277) = Sheets("feuil1").Cells(i, 6) 'colonne JQ
Else
End If

'recup compte 245 Dimunition du Matériel de transport
If Left(Sheets("feuil1").Cells(i, 1), 3) = 245 Then
Sheets("feuil28").Cells(i, 278) = Sheets("feuil1").Cells(i, 6) 'colonne JR
Else
End If

'recup compte 2495 Diminution du Matériel de transport encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2495 Then
Sheets("feuil28").Cells(i, 279) = Sheets("feuil1").Cells(i, 6) 'colonne JS
Else
End If

'adaptation SYSCOHADA révisé recup compte 2391+2392+2393+2397 Diminution des Bâtiments encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2391 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2392 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2393 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2397 Then
If Left(Sheets("feuil1").Cells(i, 1), 5) = 23915 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 23925 Then
Else
Sheets("feuil28").Cells(i, 280) = Sheets("feuil1").Cells(i, 6) 'colonne JT
End If
Else
End If

'recup compte 2394+2395+2398 Diminution des Bâtiments encours
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2394 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2395 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2398 Then
Sheets("feuil28").Cells(i, 281) = Sheets("feuil1").Cells(i, 6) 'colonne JU
Else
End If



'ADAPTATION SYSCOHADA révisé - immeuble de placement
'recup compte 2281 Augmentation des terrains - immeuble de placement
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2281 Then
Sheets("feuil28").Cells(i, 287) = Sheets("feuil1").Cells(i, 5) 'colonne KA
Else
End If

'recup compte 2315+2325 Augmentation des bâtiments - immeuble de placement
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2315 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2325 Then
Sheets("feuil28").Cells(i, 288) = Sheets("feuil1").Cells(i, 5) 'colonne KB
Else
End If


'recup compte 2281 sauf 22981 Diminution des Terrains - immeuble de placement
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2281 Then
If Left(Sheets("feuil1").Cells(i, 1), 5) = 22981 Then
Else
Sheets("feuil28").Cells(i, 289) = Sheets("feuil1").Cells(i, 6) 'colonne KC
End If
Else
End If

'recup compte 2315+2325 sauf 23915+23925 Diminution des bâtiments - immeuble de placement
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2315 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2325 Then
If Left(Sheets("feuil1").Cells(i, 1), 5) = 23915 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 23925 Then
Else
Sheets("feuil28").Cells(i, 290) = Sheets("feuil1").Cells(i, 6) 'colonne KD
End If
Else
End If

'recup compte 22981 Diminution des terrains - immeuble de placement encours
If Left(Sheets("feuil1").Cells(i, 1), 5) = 22981 Then
Sheets("feuil28").Cells(i, 291) = Sheets("feuil1").Cells(i, 6) 'colonne KE
Else
End If

'recup compte 23915+23925 Diminution des bâtiments - immeuble de placement encours
If Left(Sheets("feuil1").Cells(i, 1), 5) = 23915 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 23925 Then
Sheets("feuil28").Cells(i, 292) = Sheets("feuil1").Cells(i, 6) 'colonne KF
Else
End If




Next



'affecte comptes 211+2181 Augmentation des Frais de dévelop et prospection
Sheets("feuil28").Range("gz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("gz1:gz5000")) 'compte 211
'Sheets("feuil23").Range("c16") = Sheets("feuil28").Range("gz5001")

'affecte comptes 212+213+214 Augmentation des Brevets, licences, logiciels
Sheets("feuil28").Range("ha5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ha1:ha5000")) 'compte 212
Sheets("feuil28").Range("hb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hb1:hb5000")) 'compte 213
Sheets("feuil28").Range("hc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hc1:hc5000")) 'compte 214
'Sheets("feuil23").Range("c17") = Sheets("feuil28").Range("ha5001")+Sheets("feuil28").Range("hb5001")+Sheets("feuil28").Range("hc5001")

'affecte comptes 215+216 Augmentation du Fonds commercial
Sheets("feuil28").Range("hd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hd1:hd5000")) 'compte 215
Sheets("feuil28").Range("he5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("he1:he5000")) 'compte 216
'Sheets("feuil23").Range("c18") = Sheets("feuil28").Range("hd5001")+Sheets("feuil28").Range("he5001")

'affecte comptes 217+218 Augmentation des Autres immob. incorporelles
Sheets("feuil28").Range("hf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hf1:hf5000")) 'compte 217
Sheets("feuil28").Range("hg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hg1:hg5000")) 'compte 218
'Sheets("feuil23").Range("c19") = Sheets("feuil28").Range("hf5001")+Sheets("feuil28").Range("hg5001")

'affecte comptes 2191+2193+2198 Augmentation des Immob. incorporelles encours
Sheets("feuil28").Range("hh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hh1:hh5000")) 'compte 2191
Sheets("feuil28").Range("hi5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hi1:hi5000")) 'compte 2193
Sheets("feuil28").Range("hj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hj1:hj5000")) 'compte 2198
'Sheets("feuil23").Range("c20") = Sheets("feuil28").Range("hh5001")+Sheets("feuil28").Range("hi5001")+Sheets("feuil28").Range("hj5001")

'affecte comptes 22 Augmentation des Terrains
Sheets("feuil28").Range("hk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hk1:hk5000")) 'compte 22
'Sheets("feuil23").Range("c22") = Sheets("feuil28").Range("hk5001")

'affecte comptes 231+232+233+237 Augmentation des Bâtiments
Sheets("feuil28").Range("hl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hl1:hl5000")) 'compte 231
Sheets("feuil28").Range("hm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hm1:hm5000")) 'compte 232
Sheets("feuil28").Range("hn5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hn1:hn5000")) 'compte 233
Sheets("feuil28").Range("ho5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ho1:ho5000")) 'compte 237
'Sheets("feuil23").Range("c23") = Sheets("feuil28").Range("hl5001")+Sheets("feuil28").Range("hm5001")+Sheets("feuil28").Range("hn5001")+Sheets("feuil28").Range("ho5001")

'affecte comptes 234+235+238 Augmentation des Installations et agenc.
Sheets("feuil28").Range("hp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hp1:hp5000")) 'compte 234
Sheets("feuil28").Range("hq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hq1:hq5000")) 'compte 235
Sheets("feuil28").Range("hr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hr1:hr5000")) 'compte 238
'Sheets("feuil23").Range("c24") = Sheets("feuil28").Range("hp5001")+Sheets("feuil28").Range("hq5001")+Sheets("feuil28").Range("hr5001")

'affecte comptes 24 Augmentation du Matériel
Sheets("feuil28").Range("hs5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hs1:hs5000")) 'compte 24 sauf 249
'Sheets("feuil23").Range("c25") = Sheets("feuil28").Range("hs5001")

'affecte comptes 245 Augmentation du Matériel de transport
Sheets("feuil28").Range("ht5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ht1:ht5000")) 'compte 245
'Sheets("feuil23").Range("c29") = Sheets("feuil28").Range("ht5001")

'affecte comptes 25 Augmentation des Avances sur immob.
Sheets("feuil28").Range("hw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hw1:hw5000")) 'compte 25
'Sheets("feuil23").Range("c28") = Sheets("feuil28").Range("hw5001")

'affecte comptes 26 Augmentation des Titres de participation
Sheets("feuil28").Range("hx5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hx1:hx5000")) 'compte 26
'Sheets("feuil23").Range("c30") = Sheets("feuil28").Range("hx5001")

'affecte comptes 27 Augmentation des Autres immob. financières
Sheets("feuil28").Range("hy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hy1:hy5000")) 'compte 27
'Sheets("feuil23").Range("c31") = Sheets("feuil28").Range("hy5001")




'affecte comptes 211+2181 Diminution des Frais de dévelop et prospection
Sheets("feuil28").Range("hz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("hz1:hz5000")) 'compte 211
'Sheets("feuil23").Range("f16") = Sheets("feuil28").Range("hz5001")

'affecte comptes 212+213+214 Diminution des Brevets, licences, logiciels
Sheets("feuil28").Range("ia5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ia1:ia5000")) 'compte 212
Sheets("feuil28").Range("ib5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ib1:ib5000")) 'compte 213
Sheets("feuil28").Range("ic5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ic1:ic5000")) 'compte 214
'Sheets("feuil23").Range("f17") = Sheets("feuil28").Range("ia5001")+Sheets("feuil28").Range("ib5001")+Sheets("feuil28").Range("ic5001")

'affecte comptes 215+216 Diminution du Fonds commercial
Sheets("feuil28").Range("id5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("id1:id5000")) 'compte 215
Sheets("feuil28").Range("ie5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ie1:ie5000")) 'compte 216
'Sheets("feuil23").Range("f18") = Sheets("feuil28").Range("id5001")+Sheets("feuil28").Range("ie5001")

'affecte comptes 217+218 Diminution des Autres immob. incorporelles
Sheets("feuil28").Range("if5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("if1:if5000")) 'compte 217
Sheets("feuil28").Range("ig5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ig1:ig5000")) 'compte 218
'Sheets("feuil23").Range("f19") = Sheets("feuil28").Range("if5001")+Sheets("feuil28").Range("ig5001")

'affecte comptes 2191+2193+2198 Diminution des Immob. incorporelles encours
Sheets("feuil28").Range("ih5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ih1:ih5000")) 'compte 2191
Sheets("feuil28").Range("ii5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ii1:ii5000")) 'compte 2193
Sheets("feuil28").Range("ij5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ij1:ij5000")) 'compte 2198
'Sheets("feuil23").Range("f20") = Sheets("feuil28").Range("ih5001")+Sheets("feuil28").Range("ii5001")+Sheets("feuil28").Range("ij5001")

'affecte comptes 22 Diminution des Terrains
Sheets("feuil28").Range("ik5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ik1:ik5000")) 'compte 22
'Sheets("feuil23").Range("f22") = Sheets("feuil28").Range("ik5001")

'affecte comptes 231+232+233+237 Diminution des Bâtiments
Sheets("feuil28").Range("il5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("il1:il5000")) 'compte 231
Sheets("feuil28").Range("im5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("im1:im5000")) 'compte 232
Sheets("feuil28").Range("in5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("in1:in5000")) 'compte 233
Sheets("feuil28").Range("io5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("io1:io5000")) 'compte 237
'Sheets("feuil23").Range("f23") = Sheets("feuil28").Range("il5001")+Sheets("feuil28").Range("im5001")+Sheets("feuil28").Range("in5001")+Sheets("feuil28").Range("io5001")

'affecte comptes 234+235+238 Diminution des Installations et agenc.
Sheets("feuil28").Range("ip5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ip1:ip5000")) 'compte 234
Sheets("feuil28").Range("iq5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iq1:iq5000")) 'compte 235
Sheets("feuil28").Range("ir5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ir1:ir5000")) 'compte 238
'Sheets("feuil23").Range("f24") = Sheets("feuil28").Range("ip5001")+Sheets("feuil28").Range("iq5001")+Sheets("feuil28").Range("ir5001")

'affecte comptes 24 sauf 249 Diminution du Matériel
Sheets("feuil28").Range("is5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("is1:is5000")) 'compte 24 sauf 249
'Sheets("feuil23").Range("f25") = Sheets("feuil28").Range("is5001")

'affecte comptes 229 Diminution des terains encours
Sheets("feuil28").Range("it5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("it1:it5000")) 'compte 229
'Sheets("feuil23").Range("f26") = Sheets("feuil28").Range("it5001")

'affecte comptes+249 Diminution du Matériel encours
Sheets("feuil28").Range("iv5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iv1:iv5000")) 'compte 249
'Sheets("feuil23").Range("f26") = Sheets("feuil28").Range("iv5001")

'affecte comptes 25 Diminution des Avances sur immob.
Sheets("feuil28").Range("iw5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iw1:iw5000")) 'compte 25
'Sheets("feuil23").Range("f28") = Sheets("feuil28").Range("iw5001")

'affecte comptes 26 Diminution des Titres de participation
Sheets("feuil28").Range("ix5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ix1:ix5000")) 'compte 26
'Sheets("feuil23").Range("f30") = Sheets("feuil28").Range("ix5001")

'affecte comptes 27 sauf 274 + 274 Diminution des Autres immob. financières
Sheets("feuil28").Range("iy5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iy1:iy5000")) 'compte 27 sauf 274
Sheets("feuil28").Range("iz5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("iz1:iz5000")) 'compte 274
'Sheets("feuil23").Range("f31") = Sheets("feuil28").Range("iy5001")+Sheets("feuil28").Range("iz5001")

'affecte comptes 821 Prix de cession des immob. incorporelles
Sheets("feuil28").Range("ja5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ja1:ja5000")) 'compte 821
'Sheets("feuil7").Range("i29") = Sheets("feuil28").Range("ja5001")

'affecte comptes 822 Prix de cession des immob. corporelles
Sheets("feuil28").Range("jb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jb1:jb5000")) 'compte 822
'Sheets("feuil7").Range("i30") = Sheets("feuil28").Range("jb5001")

'affecte comptes 826 Prix de cession des immob. financières
Sheets("feuil28").Range("jc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jc1:jc5000")) 'compte 826
'Sheets("feuil7").Range("i31") = Sheets("feuil28").Range("jc5001")

'affecte comptes 10c -109d Augmentation du capital
Sheets("feuil28").Range("jd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jd1:jd5000")) 'compte 10c
Sheets("feuil28").Range("jp5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jp1:jp5000")) 'compte 109d
'Sheets("feuil7").Range("i35") = Sheets("feuil28").Range("jd5001")-Sheets("feuil28").Range("jp5001")

'affecte comptes 10d sauf 109 Réduction du capital
Sheets("feuil28").Range("je5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("je1:je5000")) 'compte 10d sauf 109
'Sheets("feuil7").Range("h36") = Sheets("feuil28").Range("je5001")

'affecte comptes 465d Dividendes distribués
Sheets("feuil28").Range("jf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jf1:jf5000")) 'compte 465d
'Sheets("feuil7").Range("h37") = Sheets("feuil28").Range("jf5001")

'affecte comptes 16c+17c+18c Augmentation des emprunts
Sheets("feuil28").Range("jg5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jg1:jg5000")) 'compte 16c
Sheets("feuil28").Range("jh5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jh1:jh5000")) 'compte 17c
Sheets("feuil28").Range("ji5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ji1:ji5000")) 'compte 18c
'Sheets("feuil7").Range("i41") = Sheets("feuil28").Range("jg5001")+Sheets("feuil28").Range("jh5001")+Sheets("feuil28").Range("ji5001")

'affecte comptes 16d+17d+18d Remboursement des emprunts
Sheets("feuil28").Range("jj5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jj1:jj5000")) 'compte 16d
Sheets("feuil28").Range("jk5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jk1:jk5000")) 'compte 17d
Sheets("feuil28").Range("jl5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jl1:jl5000")) 'compte 18d
'Sheets("feuil7").Range("h42") = Sheets("feuil28").Range("jj5001")+Sheets("feuil28").Range("jk5001")+Sheets("feuil28").Range("jl5001")

'affecte comptes 478 Subvention d'investissement reçue
Sheets("feuil28").Range("jm5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jm1:jm5000")) 'compte 478
'Sheets("feuil7").Range("i43") = Sheets("feuil28").Range("jm5001")

'affecte comptes 245 Diminution du Matériel de transport
Sheets("feuil28").Range("jr5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jr1:jr5000")) 'compte 245
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2495Diminution du Matériel de transport encours
Sheets("feuil28").Range("js5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("js1:js5000")) 'compte 2495
'Sheets("feuil23").Range("g29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2391+2392+2393+2397 Diminution des Bâtiments encours
Sheets("feuil28").Range("jt5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("jt1:jt5000")) 'compte 2931/2/3/7
'Sheets("feuil23").Range("g29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2394+2395+2398 Diminution des Installations et agts encours
Sheets("feuil28").Range("ju5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ju1:ju5000")) 'compte 2934/5/8
'Sheets("feuil23").Range("g29") = Sheets("feuil28").Range("jr5001")


'ADAPATION SYSCOHADA révisé
'affecte comptes 2281 augmentation terrains - immeuble de placement
Sheets("feuil28").Range("ka5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ka1:ka5000")) 'compte 2281
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2315+2325 augmentation bâtiments - immeuble de placement
Sheets("feuil28").Range("kb5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kb1:kb5000")) 'compte 2315+2325
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2281 diminution terrains - immeuble de placement
Sheets("feuil28").Range("kc5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kc1:kc5000")) 'compte 2281
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 2315+2325 diminution bâtiments - immeuble de placement
Sheets("feuil28").Range("kd5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kd1:kd5000")) 'compte 2315+2325
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 22981 diminution terrains - immeuble de placement encours
Sheets("feuil28").Range("ke5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("ke1:ke5000")) 'compte 22981
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")

'affecte comptes 23915+23925 diminution bâtiments - immeuble de placement encours
Sheets("feuil28").Range("kf5001") = WorksheetFunction.Sum(Sheets("feuil28").Range("kf1:kf5000")) 'compte 23915+23925
'Sheets("feuil23").Range("f29") = Sheets("feuil28").Range("jr5001")



'calcul de la CAFG
Sheets("feuil12").Range("j19") = Sheets("feuil6").Range("j36") 'EBE
Sheets("feuil12").Range("e20") = -Sheets("feuil6").Range("j43") 'Frais financiers
'Sheets("feuil12").Range("e22") = Sheets("feuil6").Range("g20") 'Pertes de change
Sheets("feuil12").Range("e23") = -Sheets("feuil6").Range("j50") 'Charges HAO
Sheets("feuil12").Range("e25") = -Sheets("feuil6").Range("j52") 'Participation des travailleurs
Sheets("feuil12").Range("e26") = -Sheets("feuil6").Range("j53") 'Impôt sur le résultat
'Sheets("feuil12").Range("j20") = Sheets("feuil6").Range("h41") 'Transfert de charges
Sheets("feuil12").Range("j22") = Sheets("feuil6").Range("j40") 'Revenus financiers
Sheets("feuil12").Range("j23") = Sheets("feuil6").Range("j42") 'Transfert de charges financières
'Sheets("feuil12").Range("j25") = Sheets("feuil6").Range("h18") 'Gain de change
Sheets("feuil12").Range("j26") = Sheets("feuil6").Range("j48") 'Produits HAO
'Sheets("feuil12").Range("j27") = Sheets("feuil6").Range("h38") 'Transfert HAO
'affectation dans le TAFIRE de la CAFG
Sheets("feuil7").Range("h15") = Sheets("feuil12").Range("j29") - Sheets("feuil12").Range("e29")


'VARIATION DES STOCKS
'adaptation SYSCOHADA révisé calcul variation des stocks et encours
If Sheets("feuil5").Range("h36") - Sheets("feuil5").Range("ag36") > 0 Then
Sheets("feuil12").Range("e47") = Sheets("feuil5").Range("h36") - Sheets("feuil5").Range("ag36")
Else
Sheets("feuil12").Range("j47") = -(Sheets("feuil5").Range("h36") - Sheets("feuil5").Range("ag36"))
End If
'affectation dans le TAFIRE
Sheets("feuil7").Range("h17") = -(Sheets("feuil12").Range("e47") - Sheets("feuil12").Range("j47"))


'VARIATION DES CREANCES
'calcul variation des fournisseurs, avances
If Sheets("feuil5").Range("h38") - Sheets("feuil5").Range("ag38") > 0 Then
Sheets("feuil12").Range("e65") = Sheets("feuil5").Range("h38") - Sheets("feuil5").Range("ag38")
Else
Sheets("feuil12").Range("j65") = -(Sheets("feuil5").Range("h38") - Sheets("feuil5").Range("ag38"))
End If

'calcul variation des clients
If Sheets("feuil5").Range("h39") - Sheets("feuil5").Range("ag39") > 0 Then
Sheets("feuil12").Range("e66") = Sheets("feuil5").Range("h39") - Sheets("feuil5").Range("ag39")
Else
Sheets("feuil12").Range("j66") = -(Sheets("feuil5").Range("h39") - Sheets("feuil5").Range("ag39"))
End If

'calcul variation des autres créances
If Sheets("feuil5").Range("h40") - Sheets("feuil5").Range("ag40") > 0 Then
Sheets("feuil12").Range("e67") = Sheets("feuil5").Range("h40") - Sheets("feuil5").Range("ag40")
Else
Sheets("feuil12").Range("j67") = -(Sheets("feuil5").Range("h40") - Sheets("feuil5").Range("ag40"))
End If

'calcul variation des ecarts de conversion ACTIF
If Sheets("feuil5").Range("h46") - Sheets("feuil5").Range("ag46") > 0 Then
Sheets("feuil12").Range("e68") = Sheets("feuil5").Range("h46") - Sheets("feuil5").Range("ag46")
Else
Sheets("feuil12").Range("j68") = -(Sheets("feuil5").Range("h46") - Sheets("feuil5").Range("ag46"))
End If

'calcul variation globale nette des creances
If WorksheetFunction.Sum(Sheets("feuil12").Range("e65:e68")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j65:j68")) > 0 Then
Sheets("feuil12").Range("e70") = WorksheetFunction.Sum(Sheets("feuil12").Range("e65:e68")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j65:j68"))
Else
Sheets("feuil12").Range("j70") = -(WorksheetFunction.Sum(Sheets("feuil12").Range("e65:e68")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j65:j68")))
End If
'affectation dans le TAFIRE
Sheets("feuil7").Range("h18") = -(Sheets("feuil12").Range("e70") - Sheets("feuil12").Range("j70"))


'VARIATION DES CREANCES H.A.O
'calcul variation des creances HAO
If Sheets("feuil5").Range("h35") - Sheets("feuil5").Range("ag35") > 0 Then
Sheets("feuil12").Range("e71") = Sheets("feuil5").Range("h35") - Sheets("feuil5").Range("ag35")
Else
Sheets("feuil12").Range("j71") = -(Sheets("feuil5").Range("h35") - Sheets("feuil5").Range("ag35"))
End If
'affectation dans le TAFIRE
Sheets("feuil7").Range("h16") = -(Sheets("feuil12").Range("e71") - Sheets("feuil12").Range("j71"))


'VARIATION DES DETTES FOURNISSEURS
'calcul variation des clients, avances
If Sheets("feuil5").Range("n36") - Sheets("feuil5").Range("am36") > 0 Then
Sheets("feuil12").Range("j75") = Sheets("feuil5").Range("n36") - Sheets("feuil5").Range("am36")
Else
Sheets("feuil12").Range("e75") = -(Sheets("feuil5").Range("n36") - Sheets("feuil5").Range("am36"))
End If

'calcul variation des fournisseurs
If Sheets("feuil5").Range("n37") - Sheets("feuil5").Range("am37") > 0 Then
Sheets("feuil12").Range("j76") = Sheets("feuil5").Range("n37") - Sheets("feuil5").Range("am37")
Else
Sheets("feuil12").Range("e76") = -(Sheets("feuil5").Range("n37") - Sheets("feuil5").Range("am37"))
End If

'adaptation SYSCOHADA révisé calcul variation des dettes fiscales et sociales
If Sheets("feuil5").Range("n38") - Sheets("feuil5").Range("am38") > 0 Then
Sheets("feuil12").Range("j77") = Sheets("feuil5").Range("n38") - Sheets("feuil5").Range("am38")
Else
Sheets("feuil12").Range("e77") = -(Sheets("feuil5").Range("n38") - Sheets("feuil5").Range("am38"))
End If

'calcul variation des autres dettes
If Sheets("feuil5").Range("n39") - Sheets("feuil5").Range("am39") > 0 Then
Sheets("feuil12").Range("j79") = Sheets("feuil5").Range("n39") - Sheets("feuil5").Range("am39")
Else
Sheets("feuil12").Range("e79") = -(Sheets("feuil5").Range("n39") - Sheets("feuil5").Range("am39"))
End If

'calcul variation des risques provisionnés
If Sheets("feuil5").Range("n40") - Sheets("feuil5").Range("am40") > 0 Then
Sheets("feuil12").Range("j80") = Sheets("feuil5").Range("n40") - Sheets("feuil5").Range("am40")
Else
Sheets("feuil12").Range("e80") = -(Sheets("feuil5").Range("n40") - Sheets("feuil5").Range("am40"))
End If

'calcul variation des écarts de conversion PASSIF
If Sheets("feuil5").Range("n46") - Sheets("feuil5").Range("am46") > 0 Then
Sheets("feuil12").Range("j81") = Sheets("feuil5").Range("n46") - Sheets("feuil5").Range("am46")
Else
Sheets("feuil12").Range("e81") = -(Sheets("feuil5").Range("n46") - Sheets("feuil5").Range("am46"))
End If

'calcul variation globale nette des dettes fournisseurs
If WorksheetFunction.Sum(Sheets("feuil12").Range("e75:e81")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j75:j81")) > 0 Then
Sheets("feuil12").Range("e84") = WorksheetFunction.Sum(Sheets("feuil12").Range("e75:e81")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j75:j81"))
Else
Sheets("feuil12").Range("j84") = -(WorksheetFunction.Sum(Sheets("feuil12").Range("e75:e81")) - WorksheetFunction.Sum(Sheets("feuil12").Range("j75:j81")))
End If
'VARIATION DES DETTES H.A.O.
'variation des dettes H.A.O.
If Sheets("feuil5").Range("n35") - Sheets("feuil5").Range("am35") > 0 Then
Sheets("feuil12").Range("j85") = Sheets("feuil5").Range("n35") - Sheets("feuil5").Range("am35")
Else
Sheets("feuil12").Range("e85") = -(Sheets("feuil5").Range("n35") - Sheets("feuil5").Range("am35"))
End If
'affectation dans le TAFIRE (adaptation SYSCOHADA révisé)
Sheets("feuil7").Range("h19") = (Sheets("feuil12").Range("j84") + Sheets("feuil12").Range("j85")) - (Sheets("feuil12").Range("e84") + Sheets("feuil12").Range("e85"))


'CALCUL ETE
'Sheets("feuil12").Range("e94") = Sheets("feuil9").Range("f38") 'EBE
'Sheets("feuil12").Range("e95") = -(Sheets("feuil12").Range("e87") - Sheets("feuil12").Range("j87"))
'Sheets("feuil12").Range("e96") = -Sheets("feuil9").Range("h23")

'affectation dans le Tableau 1 - Actif immobilisé (AUGMENTATIONS)
'les acquisitions
'Sheets("feuil24").Range("c16") = Sheets("feuil28").Range("gz5001") 'frais de développement et de prospection
'Sheets("feuil24").Range("c17") = Sheets("feuil28").Range("ha5001") + Sheets("feuil28").Range("hb5001") + Sheets("feuil28").Range("hc5001") 'Brevets, licences, logiciels
'Sheets("feuil24").Range("c18") = Sheets("feuil28").Range("hd5001") + Sheets("feuil28").Range("he5001") 'fonds commercial
'Sheets("feuil24").Range("c19") = Sheets("feuil28").Range("hf5001") + Sheets("feuil28").Range("hg5001") 'autres immob. incorporelles

'Sheets("feuil24").Range("c21") = Sheets("feuil28").Range("hk5001") 'Terrains
'Sheets("feuil24").Range("c22") = Sheets("feuil28").Range("ka5001") 'Terrains - immeuble de placement
'Sheets("feuil24").Range("c23") = Sheets("feuil28").Range("hl5001") + Sheets("feuil28").Range("hm5001") + Sheets("feuil28").Range("hn5001") + Sheets("feuil28").Range("ho5001") 'bâtiments
'Sheets("feuil24").Range("c24") = Sheets("feuil28").Range("kb5001") 'bâtiments - immeuble de placement
'Sheets("feuil24").Range("c25") = Sheets("feuil28").Range("hp5001") + Sheets("feuil28").Range("hq5001") + Sheets("feuil28").Range("hr5001") 'installations et agenc.
'Sheets("feuil24").Range("c26") = Sheets("feuil28").Range("hs5001") 'matériel
'Sheets("feuil24").Range("c27") = Sheets("feuil28").Range("ht5001") 'matériel de transport

'Sheets("feuil24").Range("c29") = Sheets("feuil28").Range("hw5001") 'Avances sur immob.
'Sheets("feuil24").Range("c33") = Sheets("feuil28").Range("hx5001") 'Titre de participation
'Sheets("feuil24").Range("c34") = Sheets("feuil28").Range("hy5001") 'Autres immob. financières

'affectation dans le Tableau 1 - Actif immobilisé (DIMINUTIONS)
'les cessions
'Sheets("feuil24").Range("f16") = Sheets("feuil28").Range("hz5001") 'frais de dévelop et prospection
'Sheets("feuil24").Range("f17") = Sheets("feuil28").Range("ia5001") + Sheets("feuil28").Range("ib5001") + Sheets("feuil28").Range("ic5001") 'Brevets, licences, logiciels
'Sheets("feuil24").Range("f18") = Sheets("feuil28").Range("id5001") + Sheets("feuil28").Range("ie5001") 'fonds commercial
'Sheets("feuil24").Range("f19") = Sheets("feuil28").Range("if5001") + Sheets("feuil28").Range("ig5001") 'autres immob. incorporelles

'Sheets("feuil24").Range("f21") = Sheets("feuil28").Range("ik5001") 'Terrains
'Sheets("feuil24").Range("f22") = Sheets("feuil28").Range("kc5001") 'Terrains - immeuble de placement
'Sheets("feuil24").Range("f23") = Sheets("feuil28").Range("il5001") + Sheets("feuil28").Range("im5001") + Sheets("feuil28").Range("in5001") + Sheets("feuil28").Range("io5001") 'bâtiments
'Sheets("feuil24").Range("f24") = Sheets("feuil28").Range("kd5001") 'Bâtiments - immeuble de placement
'Sheets("feuil24").Range("f25") = Sheets("feuil28").Range("ip5001") + Sheets("feuil28").Range("iq5001") + Sheets("feuil28").Range("ir5001") 'installations et agenc.
'Sheets("feuil24").Range("f26") = Sheets("feuil28").Range("is5001") 'matériel
'Sheets("feuil24").Range("f27") = Sheets("feuil28").Range("jr5001") 'matériel de transport

'Sheets("feuil24").Range("f29") = Sheets("feuil28").Range("iw5001") 'Avances sur immob.
'Sheets("feuil24").Range("f33") = Sheets("feuil28").Range("ix5001") 'Titre de participation
'Sheets("feuil24").Range("f34") = Sheets("feuil28").Range("iy5001") + Sheets("feuil28").Range("iz5001") 'Autres immob. financières

'affectation dans le Tableau 1 - Actif immobilisé (VIREMENTS POSTE A POSTE)
'Frais de recherche encours
'Sheets("feuil24").Range("g16") = Sheets("feuil28").Range("ih5001")
'Sheets("feuil24").Range("c16") = Sheets("feuil24").Range("c16") - Sheets("feuil24").Range("g16")
'Sheets("feuil24").Range("d16") = Sheets("feuil24").Range("g16")
'Brevets, licences, logiciel encours
'Sheets("feuil24").Range("g17") = Sheets("feuil28").Range("ii5001")
'Sheets("feuil24").Range("c17") = Sheets("feuil24").Range("c17") - Sheets("feuil24").Range("g17")
'Sheets("feuil24").Range("d17") = Sheets("feuil24").Range("g17")
'Autres immob. incorporelles encours
'Sheets("feuil24").Range("g19") = Sheets("feuil28").Range("ij5001")
'Sheets("feuil24").Range("c19") = Sheets("feuil24").Range("c19") - Sheets("feuil24").Range("g19")
'Sheets("feuil24").Range("d19") = Sheets("feuil24").Range("g19")

'Terrains encours
'Sheets("feuil24").Range("g21") = Sheets("feuil28").Range("it5001")
'Sheets("feuil24").Range("c21") = Sheets("feuil24").Range("c21") - Sheets("feuil24").Range("g21")
'Sheets("feuil24").Range("d21") = Sheets("feuil24").Range("g21")
'Terrains - immeuble de placement encours
'Sheets("feuil24").Range("g22") = Sheets("feuil28").Range("ke5001")
'Sheets("feuil24").Range("c22") = Sheets("feuil24").Range("c22") - Sheets("feuil24").Range("g22")
'Sheets("feuil24").Range("d22") = Sheets("feuil24").Range("g22")
'Bâtiments encours
'Sheets("feuil24").Range("g23") = Sheets("feuil28").Range("jt5001")
'Sheets("feuil24").Range("c23") = Sheets("feuil24").Range("c23") - Sheets("feuil24").Range("g23")
'Sheets("feuil24").Range("d23") = Sheets("feuil24").Range("g23")
'Bâtiments - immeuble de placement encours
'Sheets("feuil24").Range("g24") = Sheets("feuil28").Range("kf5001")
'Sheets("feuil24").Range("c24") = Sheets("feuil24").Range("c24") - Sheets("feuil24").Range("g24")
'Sheets("feuil24").Range("d24") = Sheets("feuil24").Range("g24")
'Installations et agts encours
'Sheets("feuil24").Range("g25") = Sheets("feuil28").Range("ju5001")
'Sheets("feuil24").Range("c25") = Sheets("feuil24").Range("c25") - Sheets("feuil24").Range("g25")
'Sheets("feuil24").Range("d25") = Sheets("feuil24").Range("g25")
'Matériel encours
'Sheets("feuil24").Range("g26") = Sheets("feuil28").Range("iv5001")
'Sheets("feuil24").Range("c26") = Sheets("feuil24").Range("c26") - Sheets("feuil24").Range("g26")
'Sheets("feuil24").Range("d26") = Sheets("feuil24").Range("g26")
'Matériel de transport encours
'Sheets("feuil24").Range("g27") = Sheets("feuil28").Range("js5001")
'Sheets("feuil24").Range("c27") = Sheets("feuil24").Range("c27") - Sheets("feuil24").Range("g27")
'Sheets("feuil24").Range("d27") = Sheets("feuil24").Range("g27")

'___________________________________________________________________________________________________________________________

'CALCUL DES TOTAUX du Tableau 1 - Actif immobilisé
'total immobilisation incorporelle
Sheets("feuil24").Range("b30") = WorksheetFunction.Sum(Sheets("feuil24").Range("b16:b19")) 'mtt brut à l'ouverture
Sheets("feuil24").Range("c30") = WorksheetFunction.Sum(Sheets("feuil24").Range("c16:c19")) 'augmentation/acquisition
Sheets("feuil24").Range("d30") = WorksheetFunction.Sum(Sheets("feuil24").Range("d16:d19")) 'augmentation/virement poste
Sheets("feuil24").Range("e30") = WorksheetFunction.Sum(Sheets("feuil24").Range("e16:e19")) 'augmentation/réévaluation
Sheets("feuil24").Range("f30") = WorksheetFunction.Sum(Sheets("feuil24").Range("f16:f19")) 'diminution/cessions
Sheets("feuil24").Range("g30") = WorksheetFunction.Sum(Sheets("feuil24").Range("g16:g19")) 'diminution/virement poste
Sheets("feuil24").Range("i30") = WorksheetFunction.Sum(Sheets("feuil24").Range("i16:i19")) 'mtt brut à la clôture

'total immobilisation corporelle
Sheets("feuil24").Range("b31") = WorksheetFunction.Sum(Sheets("feuil24").Range("b21:b29")) 'mtt brut à l'ouverture
Sheets("feuil24").Range("c31") = WorksheetFunction.Sum(Sheets("feuil24").Range("c21:c29")) 'augmentation/acquisition
Sheets("feuil24").Range("d31") = WorksheetFunction.Sum(Sheets("feuil24").Range("d21:d29")) 'augmentation/virement poste
Sheets("feuil24").Range("e31") = WorksheetFunction.Sum(Sheets("feuil24").Range("e21:e29")) 'augmentation/réévaluation
Sheets("feuil24").Range("f31") = WorksheetFunction.Sum(Sheets("feuil24").Range("f21:f29")) 'diminution/cessions
Sheets("feuil24").Range("g31") = WorksheetFunction.Sum(Sheets("feuil24").Range("g21:g29")) 'diminution/virement poste
Sheets("feuil24").Range("i31") = WorksheetFunction.Sum(Sheets("feuil24").Range("i21:i29")) 'mtt brut à la clôture

'total général
Sheets("feuil24").Range("b35") = WorksheetFunction.Sum(Sheets("feuil24").Range("b33:b34")) + Sheets("feuil24").Range("b30") + Sheets("feuil24").Range("b31") 'mtt brut à l'ouverture
Sheets("feuil24").Range("c35") = WorksheetFunction.Sum(Sheets("feuil24").Range("c33:c34")) + Sheets("feuil24").Range("c30") + Sheets("feuil24").Range("c31") 'augmentation/acquisition
Sheets("feuil24").Range("d35") = WorksheetFunction.Sum(Sheets("feuil24").Range("d33:d34")) + Sheets("feuil24").Range("d30") + Sheets("feuil24").Range("d31") 'augmentation/virement poste
Sheets("feuil24").Range("e35") = WorksheetFunction.Sum(Sheets("feuil24").Range("e33:e34")) + Sheets("feuil24").Range("e30") + Sheets("feuil24").Range("e31") 'augmentation/réévaluation
Sheets("feuil24").Range("f35") = WorksheetFunction.Sum(Sheets("feuil24").Range("f33:f34")) + Sheets("feuil24").Range("f30") + Sheets("feuil24").Range("f31") 'diminution/cessions
Sheets("feuil24").Range("g35") = WorksheetFunction.Sum(Sheets("feuil24").Range("g33:g34")) + Sheets("feuil24").Range("g30") + Sheets("feuil24").Range("g31") 'diminution/virement poste
Sheets("feuil24").Range("i35") = WorksheetFunction.Sum(Sheets("feuil24").Range("i33:i34")) + Sheets("feuil24").Range("i30") + Sheets("feuil24").Range("i31") 'mtt brut à la clôture

'CALCUL ET AFFICHE LES ECRATS DU TABLEAU 1
For i = 16 To 35
If Sheets("feuil24").Cells(i, 2) + Sheets("feuil24").Cells(i, 3) + Sheets("feuil24").Cells(i, 4) + Sheets("feuil24").Cells(i, 5) - Sheets("feuil24").Cells(i, 6) - Sheets("feuil24").Cells(i, 7) - Sheets("feuil24").Cells(i, 9) = 0 Then
Else
Sheets("feuil24").Cells(i, 10) = "Ecart"
Sheets("feuil24").Cells(i, 11) = Sheets("feuil24").Cells(i, 2) + Sheets("feuil24").Cells(i, 3) + Sheets("feuil24").Cells(i, 4) + Sheets("feuil24").Cells(i, 5) - Sheets("feuil24").Cells(i, 6) - Sheets("feuil24").Cells(i, 7) - Sheets("feuil24").Cells(i, 9)
End If
Next

'_______________________________________________________________________________________________________

'affectation du Tableau 1 - Actif immobilisé dans le TAFIRE
Sheets("feuil7").Range("h26") = -Sheets("feuil24").Range("c30") 'immob. incorporelles
Sheets("feuil7").Range("h27") = -Sheets("feuil24").Range("c31") 'immob. corporelles
Sheets("feuil7").Range("h28") = -WorksheetFunction.Sum(Sheets("feuil24").Range("c33:c34")) 'immob. financières

'affectation des prix de cession
Sheets("feuil7").Range("h29") = Sheets("feuil28").Range("ja5001") + Sheets("feuil28").Range("jb5001") + Sheets("feuil24").Range("f29") 'immob. incorporelles et corporelles
Sheets("feuil7").Range("h30") = Sheets("feuil28").Range("jc5001") + Sheets("feuil28").Range("iy5001")  'immob. financières

'affectation des capitaux propres
Sheets("feuil7").Range("h35") = Sheets("feuil28").Range("jd5001") - Sheets("feuil28").Range("jp5001") 'augmentation du capital
Sheets("feuil7").Range("h37") = -Sheets("feuil28").Range("je5001") 'remboursement du capital
Sheets("feuil7").Range("h38") = -Sheets("feuil28").Range("jf5001") 'dividendes distribués
Sheets("feuil7").Range("h36") = Sheets("feuil28").Range("jm5001") 'subvention d'investissement reçue
'affectation des dividendes pour le calcul de l'Autofinancement
Sheets("feuil12").Range("e35") = Sheets("feuil28").Range("jf5001") 'dividendes distribués

'affectation des capitaux étrangers
Sheets("feuil7").Range("h43") = Sheets("feuil28").Range("jg5001")  'augmentation des emprunts
Sheets("feuil7").Range("h44") = Sheets("feuil28").Range("jh5001") + Sheets("feuil28").Range("ji5001")  'augmentation des divers emprunts
Sheets("feuil7").Range("h45") = -(Sheets("feuil28").Range("jj5001") + Sheets("feuil28").Range("jk5001") + Sheets("feuil28").Range("jl5001")) 'remboursement des emprunts

'affectation de la trésorerie nette du bilan
'trésorerie à l'ouverture N-1
Sheets("feuil7").Range("h12") = Sheets("feuil5").Range("ag45") - Sheets("feuil5").Range("am45")

'trésorerie à la clôture N
Sheets("feuil7").Range("h54") = Sheets("feuil5").Range("h45") - Sheets("feuil5").Range("n45")


edite_tafire_n_1_suite


'demande de confirmation
End If

'condition d'édition
End If
End If

End Sub
Private Sub audit_des_soldes()
'condition d'audit
If WorksheetFunction.Sum(Sheets("feuil2").Range("g1:g5000")) <> 0 Then

If MsgBox("Confirmez vous l'audit des soldes ?", vbYesNo, "Demande de confirmation") = vbYes Then

Dim resultat As String
    resultat = InputBox("Veuillez saisir :" & Chr(10) & Chr(10) & "1  pour les SOLDES de l'exerice" & Chr(10) & Chr(10) & "2  pour le solde des REPORTS A NOUVEAU" & Chr(10), "AUDIT DES SOLDES") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    'MsgBox resultat
    End If

If resultat = "" Then
Else

If resultat = 1 Then
'contrôle équilibre de la balance N
If WorksheetFunction.Sum(Sheets("feuil2").Range("g1:g5000")) - WorksheetFunction.Sum(Sheets("feuil2").Range("h1:h5000")) = 0 Then
Else
MsgBox "Attention !  Le total de la balance générale est déséquilibré de :  " & Abs((WorksheetFunction.Sum(Sheets("feuil2").Range("g1:g5000")) - WorksheetFunction.Sum(Sheets("feuil2").Range("h1:h5000"))))
End If


'Audit des soldes de l'exercice
'MsgBox "Contrôle des SOLDES de l'exercice !"
MsgBox "CONTRÔLE DE LA CLASSE 1"
For i = 1 To 5000
       'contrôle comptes 109d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 109 Then
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 129d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 129 Then
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 13
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 13 Then
       If Sheets("feuil2").Cells(i, 8) + Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde de  " & Sheets("feuil2").Cells(i, 8) & Sheets("feuil2").Cells(i, 7) & "." & Chr(10) & Chr(10) & "NB : Le solde du compte doit être viré dans le compte 121 ou 129, pour une meilleure affectation dans le Bilan !"
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle des autres comptes 1c
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 1 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 109 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 129 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 13 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 104 Then
       Else
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       End If
       End If
       End If
       End If
       Else
       End If
Next


MsgBox "CONTRÔLE DE LA CLASSE 2"
For i = 1 To 5000
       'contrôle comptes 28c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 28 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
                     
       'contrôle comptes 29c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 29 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle des autres comptes 2d
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 2 Then
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 28 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 29 Then
       Else
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       End If
       End If
       Else
       End If
Next

MsgBox "CONTRÔLE DE LA CLASSE 3"
For i = 1 To 5000
       'contrôle comptes 39c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle des autres comptes 3d
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 3 Then
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
       Else
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       End If
       Else
       End If
Next

MsgBox "CONTRÔLE DE LA CLASSE 4"
For i = 1 To 5000
       'contrôle comptes 409d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 409 Then
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 40c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 40 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 409 Then
       Else
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       End If
       Else
       End If
       
       'contrôle comptes 419c
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 419 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 41d
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 41 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 419 Then
       Else
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       End If
       Else
       End If
       
       'contrôle comptes 4494d
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4494 Then
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 458d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 458 Then
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 467d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 467 Then
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 4711d
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4711 Then
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 4712c
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4712 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 4726c
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4726 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 4751d - SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4751 Then
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 4752c - SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4752 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 478d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Then
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 479c
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 49c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 49 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 485d et 488d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 485 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 488 Then
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       
       'contrôle comptes 48c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 48 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 485 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 488 Then
       Else
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       End If
       Else
       End If
       
           
Next

MsgBox "CONTRÔLE DE LA CLASSE 5"
For i = 1 To 5000
       'contrôle comptes 56c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 56 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 59c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 59 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 585nul
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 585 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Or Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde de  " & Sheets("feuil2").Cells(i, 7) & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 588nul
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 588 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Or Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde de  " & Sheets("feuil2").Cells(i, 7) & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle des autres comptes 5d
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 5 Then
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 56 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 59 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 52 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 53 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 54 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 585 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 588 Then
       Else
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       End If
       End If
       End If
       End If
       End If
       End If
       End If
       Else
       End If

Next

MsgBox "CONTRÔLE DE LA CLASSE 6"
For i = 1 To 5000
       'contrôle comptes 6019c
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6019 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 6029c
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6029 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 6049c
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6049 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 6059c
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6059 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 6089c
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6089 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 637nul
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 637 Then
       If Sheets("feuil2").Cells(i, 7) + Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde de  " & Sheets("feuil2").Cells(i, 7) & Sheets("feuil2").Cells(i, 8) & "." & Chr(10) & Chr(10) & "NB : En application du postulat de la prééminence de la réalité économique sur l'apparence juridique, le solde du compte doit être viré en fin d'année dans le compte 667 !"
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(0, 0, 255) 'Couleur bleu
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(0, 0, 255) 'Couleur bleu
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(0, 0, 255) 'Couleur bleu
       Else
       End If
       Else
       End If
       
       
       'contrôle des autres comptes 6d
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 6 Then
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6019 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6029 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6049 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6059 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 6089 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 603 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 637 Then
       Else
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       End If
       End If
       End If
       End If
       End If
       End If
       End If
       Else
       End If
Next


MsgBox "CONTRÔLE DE LA CLASSE 7"
For i = 1 To 5000
       
       'contrôle comptes 7019d, 7029d, 7039d, 7049d, 7059d et 7069d
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 7019 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7029 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7039 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7049 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7059 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7069 Then
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 7c
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 7 Then
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 73 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 7019 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7029 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7039 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7049 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7059 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7069 Then
       Else
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       End If
       End If
       Else
       End If
Next

MsgBox "CONTRÔLE DE LA CLASSE 8"
For i = 1 To 5000
       'contrôle comptes 82c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 82 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 84c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 84 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 86c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 86 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle comptes 88c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 88 Then
       If Sheets("feuil2").Cells(i, 7) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde débiteur de  " & Sheets("feuil2").Cells(i, 7)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 7).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       Else
       End If
       
       'contrôle des autres comptes 8d
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 8 Then
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 82 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 84 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 86 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 88 Then
       Else
       If Sheets("feuil2").Cells(i, 8) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde créditeur de  " & Sheets("feuil2").Cells(i, 8)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Sheets("feuil2").Cells(i, 8).Font.Color = RGB(255, 0, 0) 'Couleur rouge
       Else
       End If
       End If
       End If
       End If
       End If
       Else
       End If
       
Next

MsgBox "     FIN DU CONTRÔLE !"




Else



If resultat = 2 Then
'condition d'audit des REPORTS sur la balance N
If WorksheetFunction.Sum(Sheets("feuil2").Range("c1:c5000")) = 0 Then
MsgBox "Désolé ! Aucune donnée à auditer."
Else

'contrôle équilibre des REPORTS sur la balance N
If WorksheetFunction.Sum(Sheets("feuil2").Range("c1:c5000")) - WorksheetFunction.Sum(Sheets("feuil2").Range("d1:d5000")) = 0 Then
Else
MsgBox "Attention !  Vos reports A NOUVEAU sont déséquilibrés de :  " & Abs(WorksheetFunction.Sum(Sheets("feuil2").Range("c1:c5000")) - WorksheetFunction.Sum(Sheets("feuil2").Range("d1:d5000")))
End If

'Audit des reports
'MsgBox "Contrôle SOLDE des REPORTS A NOUVEAU !"
MsgBox "CONTRÔLE DE LA CLASSE 1"
For i = 1 To 5000
       'contrôle comptes 109d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 109 Then
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 129d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 129 Then
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 1309
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 1309 Then
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle des autres comptes 1c
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 1 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 109 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 129 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 1309 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 104 Then
       Else
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       End If
       End If
       End If
       End If
       Else
       End If
Next


MsgBox "CONTRÔLE DE LA CLASSE 2"
For i = 1 To 5000
       'contrôle comptes 28c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 28 Then
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
                     
       'contrôle comptes 29c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 29 Then
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle des autres comptes 2d
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 2 Then
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 28 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 29 Then
       Else
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       End If
       End If
       Else
       End If
Next

MsgBox "CONTRÔLE DE LA CLASSE 3"
For i = 1 To 5000
       'contrôle comptes 39c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle des autres comptes 3d
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 3 Then
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
       Else
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       End If
       Else
       End If
Next

MsgBox "CONTRÔLE DE LA CLASSE 4"
For i = 1 To 5000
       'contrôle comptes 409d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 409 Then
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 40c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 40 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 409 Then
       Else
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       End If
       Else
       End If
       
       'contrôle comptes 419c
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 419 Then
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 41d
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 41 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 419 Then
       Else
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       End If
       Else
       End If
       
       'contrôle comptes 4494d
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4494 Then
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 458d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 458 Then
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 467d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 467 Then
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 4711d
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4711 Then
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 4712c
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4712 Then
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 4726c
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4726 Then
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 4751d - SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4751 Then
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 4752c - SYSCOHADA révisé
       If Left(Sheets("feuil2").Cells(i, 1), 4) = 4752 Then
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 478d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Then
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 479c
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 49c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 49 Then
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 485d et 488d
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 485 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 488 Then
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 48c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 48 Then
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 485 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 488 Then
       Else
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       End If
       Else
       End If
       
                
Next

MsgBox "CONTRÔLE DE LA CLASSE 5"
For i = 1 To 5000
       'contrôle comptes 56c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 56 Then
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 59c
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 59 Then
       If Sheets("feuil2").Cells(i, 3) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU débiteur de  " & Sheets("feuil2").Cells(i, 3)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 585nul
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 585 Then
       If Sheets("feuil2").Cells(i, 3) <> 0 Or Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU de  " & Sheets("feuil2").Cells(i, 3) & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle comptes 588nul
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 588 Then
       If Sheets("feuil2").Cells(i, 3) <> 0 Or Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU de  " & Sheets("feuil2").Cells(i, 3) & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       Else
       End If
       
       'contrôle des autres comptes 5d
       If Left(Sheets("feuil2").Cells(i, 1), 1) = 5 Then
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 56 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 59 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 52 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 53 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 2) = 54 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 585 Then
       Else
       If Left(Sheets("feuil2").Cells(i, 1), 3) = 588 Then
       Else
       If Sheets("feuil2").Cells(i, 4) <> 0 Then
       Cells(i, 1).Select
       MsgBox "Attention  !  le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un solde A NOUVEAU créditeur de  " & Sheets("feuil2").Cells(i, 4)
       Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 108, 0) 'Couleur orange
       Else
       End If
       End If
       End If
       End If
       End If
       End If
       End If
       End If
       Else
       End If

Next


MsgBox "     FIN DU CONTRÔLE !"

'si la colonne C est vide
End If

Else
End If
End If



'si annuler sur imputbox
End If


'demande de confirmation
End If

'condition d'audit
Else
MsgBox "Désolé ! Aucune donnée à auditer."
End If
End Sub
Private Sub contrôle_des_reports()
'condition de contrôle
If WorksheetFunction.Sum(Sheets("feuil2").Range("g3:g5000")) <> 0 Then

If WorksheetFunction.Sum(Sheets("feuil1").Range("g3:g5000")) <> 0 Then
'contrôle des reports de N-1 à N
'MsgBox "Contrôle des REPORTS de N-1 à N !"

If MsgBox("Confirmez vous le contrôle des REPORTS ?", vbYesNo, "Demande de confirmation") = vbYes Then

'pour avoir la variable de la boucle While
For i = 3 To 5000
If Left(Sheets("feuil2").Cells(i, 1), 1) > 0 Then
If Left(Sheets("feuil2").Cells(i, 1), 1) <= 6 Then
Sheets("feuil2").Cells(i, 9) = 1
Else
End If
Else
End If
Next

Dim numero As Integer
    numero = 3

Dim variable As Variant
    variable = (WorksheetFunction.Sum(Sheets("feuil2").Range("i3:i5000")) + 50)

    
    While numero <= variable
       
    For i = 2 To variable
       
If Left(Sheets("feuil1").Cells(numero, 1), 1) > 5 Then
Else
If Left(Sheets("feuil1").Cells(numero, 1), 20) = Left(Sheets("feuil2").Cells(i + 1, 1), 20) Then
If Sheets("feuil1").Cells(numero, 7) = Sheets("feuil2").Cells(i + 1, 3) Then
If Sheets("feuil1").Cells(numero, 8) = Sheets("feuil2").Cells(i + 1, 4) Then
Sheets("feuil1").Activate
Cells(numero, 1).Select
Sheets("feuil1").Cells(numero, 1).Font.Color = RGB(220, 50, 255) 'Couleur violet foncé
Sheets("feuil1").Cells(numero, 7).Font.Color = RGB(220, 50, 255) 'Couleur violet foncé
Sheets("feuil1").Cells(numero, 8).Font.Color = RGB(220, 50, 255) 'Couleur violet foncé
Sheets("feuil2").Cells(i + 1, 1).Font.Color = RGB(220, 50, 255) 'Couleur violet foncé
Sheets("feuil2").Cells(i + 1, 3).Font.Color = RGB(220, 50, 255) 'Couleur violet foncé
Sheets("feuil2").Cells(i + 1, 4).Font.Color = RGB(220, 50, 255) 'Couleur violet foncé
Else
End If
Else
End If
Else
End If
End If

    
       Next
   
   numero = numero + 1
    
    Wend

MsgBox "VEUILLEZ CONTRÔLER LE REPORT DES EVENTUELS COMPTES non coloriés en violet sur les BALANCES N-1 et N !"

'pour effacer les nombres de la variable de la boucle While
Sheets("feuil2").Range("i1:i5000").ClearContents


'Contrôle équilibre des reports de N-2
If WorksheetFunction.Sum(Sheets("feuil1").Range("c3:c5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("d3:d5000")) = 0 Then
Else
MsgBox "     Contrôle équilibre des REPORTS N-2 !"
MsgBox "Attention !  Vos reports A NOUVEAU N-2 sont déséquilibrés de :  " & WorksheetFunction.Sum(Sheets("feuil1").Range("c3:c5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("d3:d5000"))
End If


'contrôle des comptes 6 et 7 avec un report sur la balance N
For i = 3 To 5000
If Left(Sheets("feuil2").Cells(i, 1), 1) < 6 Then
Else
If Sheets("feuil2").Cells(i, 3) + Sheets("feuil2").Cells(i, 4) = 0 Then
Else
Sheets("feuil2").Activate
MsgBox "Contrôle des REPORTS sur la balance N des comptes de la classe 6 à 8 !"
Cells(i, 1).Select
Sheets("feuil2").Cells(i, 1).Font.Color = RGB(255, 0, 0) 'Couleur rouge
Sheets("feuil2").Cells(i, 2).Font.Color = RGB(255, 0, 0) 'Couleur rouge
Sheets("feuil2").Cells(i, 3).Font.Color = RGB(255, 0, 0) 'Couleur rouge
Sheets("feuil2").Cells(i, 4).Font.Color = RGB(255, 0, 0) 'Couleur rouge
MsgBox "Attention !  Le compte  " & Sheets("feuil2").Cells(i, 1) & "  a un report A NOUVEAU sur la balance N de  " & Sheets("feuil2").Cells(i, 3) & Sheets("feuil2").Cells(i, 4)
End If
End If
Next


MsgBox "      FIN DU CONTRÔLE !"

'demande de confirmation
End If

Else
MsgBox "Veuillez renseigner la balance N-1 pour ce contrôle !"
End If

'condition de contrôle
Else
MsgBox "Désolé !  Aucune donnée à contrôler."
End If
End Sub
Private Sub audit_des_mouvements()
'condition d'audit
If WorksheetFunction.Sum(Sheets("feuil2").Range("g3:g5000")) <> 0 Then

If MsgBox("Confirmez vous l'audit des mouvements ?", vbYesNo, "Demande de confirmation") = vbYes Then

'annulation des écritures
Sheets("feuil25").Range("c7:f72").ClearContents

For i = 1 To 5000
'recup écritures de dotation aux amortissements
If Left(Sheets("feuil2").Cells(i, 1), 2) = 68 Then
Sheets("feuil25").Cells(i, 15) = Sheets("feuil2").Cells(i, 5) 'colonne O
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 28 Then
Sheets("feuil25").Cells(i, 16) = Sheets("feuil2").Cells(i, 6) 'colonne P
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 20 Then
Sheets("feuil25").Cells(i, 17) = Sheets("feuil2").Cells(i, 6) 'colonne Q
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 852 Then
Sheets("feuil25").Cells(i, 18) = Sheets("feuil2").Cells(i, 5) 'colonne R
Else
End If

'recup écritures de dotation aux provisions
If Left(Sheets("feuil2").Cells(i, 1), 2) = 69 Then
Sheets("feuil25").Cells(i, 19) = Sheets("feuil2").Cells(i, 5) 'colonne S
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 853 Then
Sheets("feuil25").Cells(i, 20) = Sheets("feuil2").Cells(i, 5) 'colonne T
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 854 Then
Sheets("feuil25").Cells(i, 21) = Sheets("feuil2").Cells(i, 5) 'colonne U
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 19 Then
Sheets("feuil25").Cells(i, 22) = Sheets("feuil2").Cells(i, 6) 'colonne V
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 29 Then
Sheets("feuil25").Cells(i, 23) = Sheets("feuil2").Cells(i, 6) 'colonne W
Else
End If

'recup écritures de reprises de provisions
If Left(Sheets("feuil2").Cells(i, 1), 2) = 19 Then
Sheets("feuil25").Cells(i, 24) = Sheets("feuil2").Cells(i, 5) 'colonne X
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 29 Then
Sheets("feuil25").Cells(i, 25) = Sheets("feuil2").Cells(i, 5) 'colonne Y
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 79 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 798 Then
Else
Sheets("feuil25").Cells(i, 26) = Sheets("feuil2").Cells(i, 6) 'colonne Z
End If
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 863 Then
Sheets("feuil25").Cells(i, 27) = Sheets("feuil2").Cells(i, 6) 'colonne AA
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 864 Then
Sheets("feuil25").Cells(i, 28) = Sheets("feuil2").Cells(i, 6) 'colonne AB
Else
End If

'recup écritures de dotations aux charges provisionnées
If Left(Sheets("feuil2").Cells(i, 1), 3) = 659 Then
Sheets("feuil25").Cells(i, 29) = Sheets("feuil2").Cells(i, 5) 'colonne AC
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 679 Then
Sheets("feuil25").Cells(i, 30) = Sheets("feuil2").Cells(i, 5) 'colonne AD
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 839 Then
Sheets("feuil25").Cells(i, 31) = Sheets("feuil2").Cells(i, 5) 'colonne AE
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
Sheets("feuil25").Cells(i, 32) = Sheets("feuil2").Cells(i, 6) 'colonne AF
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 49 Then
Sheets("feuil25").Cells(i, 33) = Sheets("feuil2").Cells(i, 6) 'colonne AG
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 59 Then
Sheets("feuil25").Cells(i, 34) = Sheets("feuil2").Cells(i, 6) 'colonne AH
Else
End If

'recup écritures de reprises de charges provisionnées
If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
Sheets("feuil25").Cells(i, 35) = Sheets("feuil2").Cells(i, 5) 'colonne AI
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 49 Then
Sheets("feuil25").Cells(i, 36) = Sheets("feuil2").Cells(i, 5) 'colonne AJ
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 59 Then
Sheets("feuil25").Cells(i, 37) = Sheets("feuil2").Cells(i, 5) 'colonne AK
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 759 Then
Sheets("feuil25").Cells(i, 38) = Sheets("feuil2").Cells(i, 6) 'colonne AL
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 779 Then
Sheets("feuil25").Cells(i, 39) = Sheets("feuil2").Cells(i, 6) 'colonne AM
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 849 Then
Sheets("feuil25").Cells(i, 40) = Sheets("feuil2").Cells(i, 6) 'colonne AN
Else
End If

'recup écritures de dotations et reprises : provisions réglémentées
If Left(Sheets("feuil2").Cells(i, 1), 3) = 851 Then
Sheets("feuil25").Cells(i, 41) = Sheets("feuil2").Cells(i, 5) 'colonne AO
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 15 Then
Sheets("feuil25").Cells(i, 42) = Sheets("feuil2").Cells(i, 5) 'colonne AP
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 861 Then
Sheets("feuil25").Cells(i, 43) = Sheets("feuil2").Cells(i, 6) 'colonne AQ
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 15 Then
Sheets("feuil25").Cells(i, 44) = Sheets("feuil2").Cells(i, 6) 'colonne AR
Else
End If

'recup écritures de sorties d'immobilisations
If Left(Sheets("feuil2").Cells(i, 1), 2) = 81 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 654 Then
Sheets("feuil25").Cells(i, 45) = Sheets("feuil2").Cells(i, 5) 'colonne AS
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 28 Then
Sheets("feuil25").Cells(i, 46) = Sheets("feuil2").Cells(i, 5) 'colonne AT
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 81 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 654 Then
Sheets("feuil25").Cells(i, 47) = Sheets("feuil2").Cells(i, 6) 'colonne AU
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 1) = 2 Then
If Left(Sheets("feuil2").Cells(i, 1), 2) = 20 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 2) = 28 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 2) = 29 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 2) = 25 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 2) = 27 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 3) = 219 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 3) = 229 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 3) = 239 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 3) = 249 Then
Else
Sheets("feuil25").Cells(i, 48) = Sheets("feuil2").Cells(i, 6) 'colonne AV
End If
End If
End If
End If
End If
End If
End If
End If
End If
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 274 Then
Sheets("feuil25").Cells(i, 49) = Sheets("feuil2").Cells(i, 6) 'colonne AW
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 798 Then
Sheets("feuil25").Cells(i, 50) = Sheets("feuil2").Cells(i, 6) 'colonne AX
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 862 Then
Sheets("feuil25").Cells(i, 51) = Sheets("feuil2").Cells(i, 6) 'colonne AY
Else
End If

'recup écritures de reprises de subvention
If Left(Sheets("feuil2").Cells(i, 1), 2) = 14 Then
Sheets("feuil25").Cells(i, 52) = Sheets("feuil2").Cells(i, 5) 'colonne AZ
Else
End If

'adaptation SYSCOHADA révisé (799 doit remplacer 865)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 865 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 799 Then
Sheets("feuil25").Cells(i, 53) = Sheets("feuil2").Cells(i, 6) 'colonne BA
Else
End If

'recup écritures de mouvements de stocks
If Left(Sheets("feuil2").Cells(i, 1), 1) = 3 Then
If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
Else
Sheets("feuil25").Cells(i, 54) = Sheets("feuil2").Cells(i, 5) 'colonne BB
End If
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 73 Then
Sheets("feuil25").Cells(i, 55) = Sheets("feuil2").Cells(i, 5) 'colonne BC
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 603 Then
Sheets("feuil25").Cells(i, 56) = Sheets("feuil2").Cells(i, 5) 'colonne BD
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 1) = 3 Then
If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
Else
Sheets("feuil25").Cells(i, 57) = Sheets("feuil2").Cells(i, 6) 'colonne BE
End If
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 73 Then
Sheets("feuil25").Cells(i, 58) = Sheets("feuil2").Cells(i, 6) 'colonne BF
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 603 Then
Sheets("feuil25").Cells(i, 59) = Sheets("feuil2").Cells(i, 6) 'colonne BG
Else
End If

'recup écritures de crédit-bail
If Left(Sheets("feuil2").Cells(i, 1), 3) = 672 Then
Sheets("feuil25").Cells(i, 60) = Sheets("feuil2").Cells(i, 5) 'colonne BH
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 17 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 176 Then
Else
Sheets("feuil25").Cells(i, 61) = Sheets("feuil2").Cells(i, 5) 'colonne BI
End If
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 623 Then
Sheets("feuil25").Cells(i, 62) = Sheets("feuil2").Cells(i, 6) 'colonne BJ
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 176 Then
Sheets("feuil25").Cells(i, 63) = Sheets("feuil2").Cells(i, 6) 'colonne BK
Else
End If

'recup opération sur les marchandises
If Left(Sheets("feuil2").Cells(i, 1), 3) = 601 Then
Sheets("feuil25").Cells(i, 64) = Sheets("feuil2").Cells(i, 7) 'colonne BL
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 4) = 6031 Then
Sheets("feuil25").Cells(i, 65) = Sheets("feuil2").Cells(i, 7) + Sheets("feuil2").Cells(i, 8) 'colonne BM
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 31 Then
Sheets("feuil25").Cells(i, 66) = Sheets("feuil2").Cells(i, 7) 'colonne BN
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 381 Then
Sheets("feuil25").Cells(i, 67) = Sheets("feuil2").Cells(i, 7) 'colonne BO
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 701 Then
Sheets("feuil25").Cells(i, 68) = Sheets("feuil2").Cells(i, 8) 'colonne BP
Else
End If

'recup opérations sur les produits et matières premières
If Left(Sheets("feuil2").Cells(i, 1), 3) = 602 Then
Sheets("feuil25").Cells(i, 69) = Sheets("feuil2").Cells(i, 7) 'colonne BQ
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 4) = 6032 Then
Sheets("feuil25").Cells(i, 70) = Sheets("feuil2").Cells(i, 7) + Sheets("feuil2").Cells(i, 8) 'colonne BR
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 32 Then
Sheets("feuil25").Cells(i, 71) = Sheets("feuil2").Cells(i, 7) 'colonne BS
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 382 Then
Sheets("feuil25").Cells(i, 72) = Sheets("feuil2").Cells(i, 7) 'colonne BT
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 702 Then
Sheets("feuil25").Cells(i, 73) = Sheets("feuil2").Cells(i, 8) 'colonne BU
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 703 Then
Sheets("feuil25").Cells(i, 74) = Sheets("feuil2").Cells(i, 8) 'colonne BV
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 704 Then
Sheets("feuil25").Cells(i, 75) = Sheets("feuil2").Cells(i, 8) 'colonne BW
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 73 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 735 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7342 Then
Else
Sheets("feuil25").Cells(i, 76) = Sheets("feuil2").Cells(i, 7) + Sheets("feuil2").Cells(i, 8) 'colonne BX
End If
End If
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 34 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 342 Then
Else
Sheets("feuil25").Cells(i, 77) = Sheets("feuil2").Cells(i, 7) 'colonne BY
End If
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 36 Then
Sheets("feuil25").Cells(i, 78) = Sheets("feuil2").Cells(i, 7) 'colonne BZ
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 37 Then
Sheets("feuil25").Cells(i, 79) = Sheets("feuil2").Cells(i, 7) 'colonne CA
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 386 Then
Sheets("feuil25").Cells(i, 80) = Sheets("feuil2").Cells(i, 7) 'colonne CB
Else
End If

'recup opérations financières
If Left(Sheets("feuil2").Cells(i, 1), 3) = 671 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6713 Then
Else
Sheets("feuil25").Cells(i, 81) = Sheets("feuil2").Cells(i, 7) 'colonne CC
End If
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 16 Then
Sheets("feuil25").Cells(i, 82) = Sheets("feuil2").Cells(i, 8) + Sheets("feuil2").Cells(i, 4) + Sheets("feuil2").Cells(i, 6) 'colonne CD
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 4) = 6713 Then
Sheets("feuil25").Cells(i, 83) = Sheets("feuil2").Cells(i, 7) 'colonne CE
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 18 Then
Sheets("feuil25").Cells(i, 84) = Sheets("feuil2").Cells(i, 8) + Sheets("feuil2").Cells(i, 4) + Sheets("feuil2").Cells(i, 6) 'colonne CF
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 677 Then
Sheets("feuil25").Cells(i, 85) = Sheets("feuil2").Cells(i, 7) 'colonne CG
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 50 Then
Sheets("feuil25").Cells(i, 86) = Sheets("feuil2").Cells(i, 7) + Sheets("feuil2").Cells(i, 3) + Sheets("feuil2").Cells(i, 5) 'colonne CH
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 771 Then
Sheets("feuil25").Cells(i, 87) = Sheets("feuil2").Cells(i, 8) 'colonne CI
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 271 Then
Sheets("feuil25").Cells(i, 88) = Sheets("feuil2").Cells(i, 7) + Sheets("feuil2").Cells(i, 3) + Sheets("feuil2").Cells(i, 5) 'colonne CJ
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 272 Then
Sheets("feuil25").Cells(i, 89) = Sheets("feuil2").Cells(i, 7) + Sheets("feuil2").Cells(i, 3) + Sheets("feuil2").Cells(i, 5) 'colonne CK
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 772 Then
Sheets("feuil25").Cells(i, 90) = Sheets("feuil2").Cells(i, 8) 'colonne CL
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 274 Then
Sheets("feuil25").Cells(i, 91) = Sheets("feuil2").Cells(i, 7) + Sheets("feuil2").Cells(i, 3) + Sheets("feuil2").Cells(i, 5) 'colonne CM
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 277 Then
Sheets("feuil25").Cells(i, 92) = Sheets("feuil2").Cells(i, 7) + Sheets("feuil2").Cells(i, 3) + Sheets("feuil2").Cells(i, 5) 'colonne CN
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 278 Then
Sheets("feuil25").Cells(i, 93) = Sheets("feuil2").Cells(i, 7) + Sheets("feuil2").Cells(i, 3) + Sheets("feuil2").Cells(i, 5) 'colonne CO
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 26 Then
Sheets("feuil25").Cells(i, 94) = Sheets("feuil2").Cells(i, 7) + Sheets("feuil2").Cells(i, 3) + Sheets("feuil2").Cells(i, 5) 'colonne CP
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 774 Then
Sheets("feuil25").Cells(i, 95) = Sheets("feuil2").Cells(i, 8) 'colonne CQ
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 3) = 777 Then
Sheets("feuil25").Cells(i, 96) = Sheets("feuil2").Cells(i, 8) 'colonne CR
Else
End If

Next



'A- AUDIT DES ECRITURES
'affectation écritures de dotation aux amortissements
'compte 68
Sheets("feuil25").Range("c7") = WorksheetFunction.Sum(Sheets("feuil25").Range("o1:o5001"))
'compte 28
Sheets("feuil25").Range("d10") = WorksheetFunction.Sum(Sheets("feuil25").Range("p1:p5001"))
'compte 20
Sheets("feuil25").Range("d9") = WorksheetFunction.Sum(Sheets("feuil25").Range("q1:q5001"))
'compte 852
Sheets("feuil25").Range("c8") = WorksheetFunction.Sum(Sheets("feuil25").Range("r1:r5001"))
'message d'équilibre
If (Sheets("feuil25").Range("c7") + Sheets("feuil25").Range("c8")) = 0 And (Sheets("feuil25").Range("d9") + Sheets("feuil25").Range("d10")) = 0 Then
Sheets("feuil25").Range("e9") = "Aucun mouvement !"
Else
If (Sheets("feuil25").Range("c7") + Sheets("feuil25").Range("c8")) - (Sheets("feuil25").Range("d9") + Sheets("feuil25").Range("d10")) = 0 Then
Sheets("feuil25").Range("e9") = "Equilibré !"
Else
Sheets("feuil25").Range("e9") = "Déséquilibré"
Sheets("feuil25").Range("f9") = (Sheets("feuil25").Range("c7") + Sheets("feuil25").Range("c8")) - (Sheets("feuil25").Range("d9") + Sheets("feuil25").Range("d10"))
End If
End If

'affectation écritures de dotation aux provisions
'compte 69
Sheets("feuil25").Range("c13") = WorksheetFunction.Sum(Sheets("feuil25").Range("s1:s5001"))
'compte 853
Sheets("feuil25").Range("c14") = WorksheetFunction.Sum(Sheets("feuil25").Range("t1:t5001"))
'compte 854
Sheets("feuil25").Range("c15") = WorksheetFunction.Sum(Sheets("feuil25").Range("u1:u5001"))
'compte 19
Sheets("feuil25").Range("d16") = WorksheetFunction.Sum(Sheets("feuil25").Range("v1:v5001"))
'compte 29
Sheets("feuil25").Range("d17") = WorksheetFunction.Sum(Sheets("feuil25").Range("w1:w5001"))
'message d'équilibre
If (Sheets("feuil25").Range("c13") + Sheets("feuil25").Range("c14") + Sheets("feuil25").Range("c15")) = 0 And (Sheets("feuil25").Range("d16") + Sheets("feuil25").Range("d17")) = 0 Then
Sheets("feuil25").Range("e16") = "Aucun mouvement !"
Else
If (Sheets("feuil25").Range("c13") + Sheets("feuil25").Range("c14") + Sheets("feuil25").Range("c15")) - (Sheets("feuil25").Range("d16") + Sheets("feuil25").Range("d17")) = 0 Then
Sheets("feuil25").Range("e16") = "Equilibré !"
Else
Sheets("feuil25").Range("e16") = "Déséquilibré"
Sheets("feuil25").Range("f16") = (Sheets("feuil25").Range("c13") + Sheets("feuil25").Range("c14") + Sheets("feuil25").Range("c15")) - (Sheets("feuil25").Range("d16") + Sheets("feuil25").Range("d17"))
End If
End If

'affectation écritures de reprise de provisions
'compte 19
Sheets("feuil25").Range("c20") = WorksheetFunction.Sum(Sheets("feuil25").Range("x1:x5001"))
'compte 29
Sheets("feuil25").Range("c21") = WorksheetFunction.Sum(Sheets("feuil25").Range("y1:y5001"))
'compte 79 sauf 798
Sheets("feuil25").Range("d22") = WorksheetFunction.Sum(Sheets("feuil25").Range("z1:z5001"))
'compte 863
Sheets("feuil25").Range("d23") = WorksheetFunction.Sum(Sheets("feuil25").Range("aa1:aa5001"))
'compte 864
Sheets("feuil25").Range("d24") = WorksheetFunction.Sum(Sheets("feuil25").Range("ab1:ab5001"))
'message d'équilibre
If (Sheets("feuil25").Range("c20") + Sheets("feuil25").Range("c21")) = 0 And (Sheets("feuil25").Range("d22") + Sheets("feuil25").Range("d23") + Sheets("feuil25").Range("d24")) = 0 Then
Sheets("feuil25").Range("e22") = "Aucun mouvement !"
Else
If (Sheets("feuil25").Range("c20") + Sheets("feuil25").Range("c21")) - (Sheets("feuil25").Range("d22") + Sheets("feuil25").Range("d23") + Sheets("feuil25").Range("d24")) = 0 Then
Sheets("feuil25").Range("e22") = "Equilibré !"
Else
Sheets("feuil25").Range("e22") = "Déséquilibré"
Sheets("feuil25").Range("f22") = (Sheets("feuil25").Range("c20") + Sheets("feuil25").Range("c21")) - (Sheets("feuil25").Range("d22") + Sheets("feuil25").Range("d23") + Sheets("feuil25").Range("d24"))
End If
End If

'affectation écritures de dotations aux charges provisionnées
'compte 659
Sheets("feuil25").Range("c27") = WorksheetFunction.Sum(Sheets("feuil25").Range("ac1:ac5001"))
'compte 679
Sheets("feuil25").Range("c28") = WorksheetFunction.Sum(Sheets("feuil25").Range("ad1:ad5001"))
'compte 839
Sheets("feuil25").Range("c29") = WorksheetFunction.Sum(Sheets("feuil25").Range("ae1:ae5001"))
'compte 39
Sheets("feuil25").Range("d30") = WorksheetFunction.Sum(Sheets("feuil25").Range("af1:af5001"))
'compte 49
Sheets("feuil25").Range("d31") = WorksheetFunction.Sum(Sheets("feuil25").Range("ag1:ag5001"))
'compte 59
Sheets("feuil25").Range("d32") = WorksheetFunction.Sum(Sheets("feuil25").Range("ah1:ah5001"))
'message d'équilibre
If (Sheets("feuil25").Range("c27") + Sheets("feuil25").Range("c28") + Sheets("feuil25").Range("c29")) = 0 And (Sheets("feuil25").Range("d30") + Sheets("feuil25").Range("d31") + Sheets("feuil25").Range("d32")) = 0 Then
Sheets("feuil25").Range("e30") = "Aucun mouvement !"
Else
If (Sheets("feuil25").Range("c27") + Sheets("feuil25").Range("c28") + Sheets("feuil25").Range("c29")) - (Sheets("feuil25").Range("d30") + Sheets("feuil25").Range("d31") + Sheets("feuil25").Range("d32")) = 0 Then
Sheets("feuil25").Range("e30") = "Equilibré !"
Else
Sheets("feuil25").Range("e30") = "Déséquilibré"
Sheets("feuil25").Range("f30") = (Sheets("feuil25").Range("c27") + Sheets("feuil25").Range("c28") + Sheets("feuil25").Range("c29")) - (Sheets("feuil25").Range("d30") + Sheets("feuil25").Range("d31") + Sheets("feuil25").Range("d32"))
End If
End If

'affectation écritures de reprises de charges provisionnées
'compte 39
Sheets("feuil25").Range("c35") = WorksheetFunction.Sum(Sheets("feuil25").Range("ai1:ai5001"))
'compte 49
Sheets("feuil25").Range("c36") = WorksheetFunction.Sum(Sheets("feuil25").Range("aj1:aj5001"))
'compte 59
Sheets("feuil25").Range("c37") = WorksheetFunction.Sum(Sheets("feuil25").Range("ak1:ak5001"))
'compte 759
Sheets("feuil25").Range("d38") = WorksheetFunction.Sum(Sheets("feuil25").Range("al1:al5001"))
'compte 779
Sheets("feuil25").Range("d39") = WorksheetFunction.Sum(Sheets("feuil25").Range("am1:am5001"))
'compte 849
Sheets("feuil25").Range("d40") = WorksheetFunction.Sum(Sheets("feuil25").Range("an1:an5001"))
'message d'équilibre
If (Sheets("feuil25").Range("c35") + Sheets("feuil25").Range("c36") + Sheets("feuil25").Range("c37")) = 0 And (Sheets("feuil25").Range("d38") + Sheets("feuil25").Range("d39") + Sheets("feuil25").Range("d40")) = 0 Then
Sheets("feuil25").Range("e38") = "Aucun mouvement !"
Else
If (Sheets("feuil25").Range("c35") + Sheets("feuil25").Range("c36") + Sheets("feuil25").Range("c37")) - (Sheets("feuil25").Range("d38") + Sheets("feuil25").Range("d39") + Sheets("feuil25").Range("d40")) = 0 Then
Sheets("feuil25").Range("e38") = "Equilibré !"
Else
Sheets("feuil25").Range("e38") = "Déséquilibré"
Sheets("feuil25").Range("f38") = (Sheets("feuil25").Range("c35") + Sheets("feuil25").Range("c36") + Sheets("feuil25").Range("c37")) - (Sheets("feuil25").Range("d38") + Sheets("feuil25").Range("d39") + Sheets("feuil25").Range("d40"))
End If
End If

'affectation écritures de dotations et reprises : provisions réglémentées
'compte 851
Sheets("feuil25").Range("c43") = WorksheetFunction.Sum(Sheets("feuil25").Range("ao1:ao5001"))
'compte 15
Sheets("feuil25").Range("c44") = WorksheetFunction.Sum(Sheets("feuil25").Range("ap1:ap5001"))
'compte 861
Sheets("feuil25").Range("d45") = WorksheetFunction.Sum(Sheets("feuil25").Range("aq1:aq5001"))
'compte 15
Sheets("feuil25").Range("d46") = WorksheetFunction.Sum(Sheets("feuil25").Range("ar1:ar5001"))
'message d'équilibre
If (Sheets("feuil25").Range("c43") + Sheets("feuil25").Range("c44")) = 0 And (Sheets("feuil25").Range("d45") + Sheets("feuil25").Range("d46")) = 0 Then
Sheets("feuil25").Range("e45") = "Aucun mouvement !"
Else
If (Sheets("feuil25").Range("c43") + Sheets("feuil25").Range("c44")) - (Sheets("feuil25").Range("d45") + Sheets("feuil25").Range("d46")) = 0 Then
Sheets("feuil25").Range("e45") = "Equilibré !"
Else
Sheets("feuil25").Range("e45") = "Déséquilibré"
Sheets("feuil25").Range("f45") = (Sheets("feuil25").Range("c43") + Sheets("feuil25").Range("c44")) - (Sheets("feuil25").Range("d45") + Sheets("feuil25").Range("d46"))
End If
End If

'affectation écritures de sorties d'immobilisations
'compte 81
Sheets("feuil25").Range("c49") = WorksheetFunction.Sum(Sheets("feuil25").Range("as1:as5001"))
'compte 28
Sheets("feuil25").Range("c50") = WorksheetFunction.Sum(Sheets("feuil25").Range("at1:at5001"))
'compte 81
Sheets("feuil25").Range("d51") = WorksheetFunction.Sum(Sheets("feuil25").Range("au1:au5001"))
'compte 2
Sheets("feuil25").Range("d52") = WorksheetFunction.Sum(Sheets("feuil25").Range("av1:av5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("aw1:aw5001"))
'compte 798
Sheets("feuil25").Range("d53") = WorksheetFunction.Sum(Sheets("feuil25").Range("ax1:ax5001"))
'compte 862
Sheets("feuil25").Range("d54") = WorksheetFunction.Sum(Sheets("feuil25").Range("ay1:ay5001"))
'message d'équilibre
If (Sheets("feuil25").Range("c49") + Sheets("feuil25").Range("c50")) = 0 And (Sheets("feuil25").Range("d51") + Sheets("feuil25").Range("d52") + Sheets("feuil25").Range("d53") + Sheets("feuil25").Range("d54")) = 0 Then
Sheets("feuil25").Range("e51") = "Aucun mouvement !"
Else
If (Sheets("feuil25").Range("c49") + Sheets("feuil25").Range("c50")) - (Sheets("feuil25").Range("d51") + Sheets("feuil25").Range("d52") + Sheets("feuil25").Range("d53") + Sheets("feuil25").Range("d54")) = 0 Then
Sheets("feuil25").Range("e51") = "Equilibré !"
Else
Sheets("feuil25").Range("e51") = "Déséquilibré"
Sheets("feuil25").Range("f51") = (Sheets("feuil25").Range("c49") + Sheets("feuil25").Range("c50")) - (Sheets("feuil25").Range("d51") + Sheets("feuil25").Range("d52") + Sheets("feuil25").Range("d53") + Sheets("feuil25").Range("d54"))
End If
End If

'affectation des écritures de reprises de subventions
'compte 14
Sheets("feuil25").Range("c57") = WorksheetFunction.Sum(Sheets("feuil25").Range("az1:az5001"))
'compte 865
Sheets("feuil25").Range("d58") = WorksheetFunction.Sum(Sheets("feuil25").Range("ba1:ba5001"))
'message d'équilibre
If (Sheets("feuil25").Range("c57")) = 0 And (Sheets("feuil25").Range("d58")) = 0 Then
Sheets("feuil25").Range("e58") = "Aucun mouvement !"
Else
If (Sheets("feuil25").Range("c57")) - (Sheets("feuil25").Range("d58")) = 0 Then
Sheets("feuil25").Range("e58") = "Equilibré !"
Else
Sheets("feuil25").Range("e58") = "Déséquilibré"
Sheets("feuil25").Range("f58") = (Sheets("feuil25").Range("c57")) - (Sheets("feuil25").Range("d58"))
End If
End If

'affectation écritures de mouvements de stocks
'compte 3
Sheets("feuil25").Range("c61") = WorksheetFunction.Sum(Sheets("feuil25").Range("bb1:bb5001"))
'compte 73
Sheets("feuil25").Range("c62") = WorksheetFunction.Sum(Sheets("feuil25").Range("bc1:bc5001"))
'compte 603
Sheets("feuil25").Range("c63") = WorksheetFunction.Sum(Sheets("feuil25").Range("bd1:bd5001"))
'compte 3
Sheets("feuil25").Range("d64") = WorksheetFunction.Sum(Sheets("feuil25").Range("be1:be5001"))
'compte 73
Sheets("feuil25").Range("d65") = WorksheetFunction.Sum(Sheets("feuil25").Range("bf1:bf5001"))
'compte 603
Sheets("feuil25").Range("d66") = WorksheetFunction.Sum(Sheets("feuil25").Range("bg1:bg5001"))
'message d'équilibre
If (Sheets("feuil25").Range("c61") + Sheets("feuil25").Range("c62") + Sheets("feuil25").Range("c63")) = 0 And (Sheets("feuil25").Range("d64") + Sheets("feuil25").Range("d65") + Sheets("feuil25").Range("d66")) = 0 Then
Sheets("feuil25").Range("e64") = "Aucun mouvement !"
Else
If (Sheets("feuil25").Range("c61") + Sheets("feuil25").Range("c62") + Sheets("feuil25").Range("c63")) - (Sheets("feuil25").Range("d64") + Sheets("feuil25").Range("d65") + Sheets("feuil25").Range("d66")) = 0 Then
Sheets("feuil25").Range("e64") = "Equilibré !"
Else
Sheets("feuil25").Range("e64") = "Déséquilibré"
Sheets("feuil25").Range("f64") = (Sheets("feuil25").Range("c61") + Sheets("feuil25").Range("c62") + Sheets("feuil25").Range("c63")) - (Sheets("feuil25").Range("d64") + Sheets("feuil25").Range("d65") + Sheets("feuil25").Range("d66"))
End If
End If

'affectation écritures de crédit-bail
'compte 672
Sheets("feuil25").Range("c69") = WorksheetFunction.Sum(Sheets("feuil25").Range("bh1:bh5001"))
'compte 17 sauf 176
Sheets("feuil25").Range("c70") = WorksheetFunction.Sum(Sheets("feuil25").Range("bi1:bi5001"))
'compte 623
Sheets("feuil25").Range("d71") = WorksheetFunction.Sum(Sheets("feuil25").Range("bj1:bj5001"))
'compte 176
Sheets("feuil25").Range("d72") = WorksheetFunction.Sum(Sheets("feuil25").Range("bk1:bk5001"))
'message d'équilibre
If (Sheets("feuil25").Range("c69") + Sheets("feuil25").Range("c70")) = 0 And (Sheets("feuil25").Range("d71") + Sheets("feuil25").Range("d72")) = 0 Then
Sheets("feuil25").Range("e71") = "Aucun mouvement !"
Else
If (Sheets("feuil25").Range("c69") + Sheets("feuil25").Range("c70")) - (Sheets("feuil25").Range("d71") + Sheets("feuil25").Range("d72")) = 0 Then
Sheets("feuil25").Range("e71") = "Equilibré !"
Else
Sheets("feuil25").Range("e71") = "Déséquilibré"
Sheets("feuil25").Range("f71") = (Sheets("feuil25").Range("c69") + Sheets("feuil25").Range("c70")) - (Sheets("feuil25").Range("d71") + Sheets("feuil25").Range("d72"))
End If
End If


'B-AUDIT DES OPERATIONS
'analyse opérations sur les marchandises
'sur les achats
If WorksheetFunction.Sum(Sheets("feuil25").Range("bl1:bl5001")) <> 0 Then 'compte 601
If WorksheetFunction.Sum(Sheets("feuil25").Range("bn1:bn5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bo1:bo5001")) = 0 Then 'compte 31+381
Sheets("feuil25").Range("a78") = "Attention ! Vous faîtes des Achats de marchandises sans Stocks de marchandises !"
Else
Sheets("feuil25").Range("a78") = "Rien à signaler sur les Achats de marchandises !"
End If
Else
Sheets("feuil25").Range("a78") = "Rien à signaler sur les Achats de marchandises !"
End If

'sur les variations de stocks de marchandises
If WorksheetFunction.Sum(Sheets("feuil25").Range("bm1:bm5001")) <> 0 Then 'compte 6031
If WorksheetFunction.Sum(Sheets("feuil25").Range("bn1:bn5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bo1:bo5001")) = 0 Then 'compte 31+381
Sheets("feuil25").Range("a79") = "Attention ! Vous faîtes des Variations de stocks de marchandises sans Stocks de marchandises !"
Else
Sheets("feuil25").Range("a79") = "Rien à signaler sur les Variations de stocks de marchandises !"
End If
Else
Sheets("feuil25").Range("a79") = "Rien à signaler sur les Variations de stocks de marchandises !"
End If

'sur les stocks de marchandises
If WorksheetFunction.Sum(Sheets("feuil25").Range("bn1:bn5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bo1:bo5001")) <> 0 Then 'compte 31+381
If WorksheetFunction.Sum(Sheets("feuil25").Range("bl1:bl5001")) = 0 Then  'compte 601
Sheets("feuil25").Range("a80") = "Attention ! Vous avez du Stock de marchandises sans Achats de marchandises !"
Else
Sheets("feuil25").Range("a80") = "Rien à signaler sur les Stocks de marchandises !"
End If
Else
Sheets("feuil25").Range("a80") = "Rien à signaler sur les Stocks de marchandises !"
End If

'sur les ventes de marchandises
If WorksheetFunction.Sum(Sheets("feuil25").Range("bp1:bp5001")) <> 0 Then 'compte 701
If WorksheetFunction.Sum(Sheets("feuil25").Range("bl1:bl5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bn1:bn5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bo1:bo5001")) = 0 Then 'compte 601+31+381
Sheets("feuil25").Range("a81") = "Attention ! Vous faîtes des Ventes de marchandises sans Stocks et sans Achats de marchandises !"
Else
Sheets("feuil25").Range("a81") = "Rien à signaler sur les Ventes de marchandises !"
End If
Else
Sheets("feuil25").Range("a81") = "Rien à signaler sur les Ventes de marchandises !"
End If

'analyse opérations sur les produits et matières premières
'sur les achats de matières premières
If WorksheetFunction.Sum(Sheets("feuil25").Range("bq1:bq5001")) <> 0 Then 'compte 602
If WorksheetFunction.Sum(Sheets("feuil25").Range("bs1:bs5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bt1:bt5001")) = 0 Then 'compte 32+382
Sheets("feuil25").Range("a84") = "Attention ! Vous faîtes des Achats de matières premières sans Stocks de matières premières !"
Else
Sheets("feuil25").Range("a84") = "Rien à signaler sur les Achats de matières premières !"
End If
Else
Sheets("feuil25").Range("a84") = "Rien à signaler sur les Achats de matières premières !"
End If

'sur les variations de stocks de matières premières
If WorksheetFunction.Sum(Sheets("feuil25").Range("br1:br5001")) <> 0 Then 'compte 6032
If WorksheetFunction.Sum(Sheets("feuil25").Range("bs1:bs5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bt1:bt5001")) = 0 Then 'compte 32+382
Sheets("feuil25").Range("a85") = "Attention ! Vous faîtes des Variations de stocks de matières sans Stocks de matières premières !"
Else
Sheets("feuil25").Range("a85") = "Rien à signaler sur les Variations de stocks de matières premières !"
End If
Else
Sheets("feuil25").Range("a85") = "Rien à signaler sur les Variations de stocks de matières premières !"
End If

'sur les stocks de matières premières
If WorksheetFunction.Sum(Sheets("feuil25").Range("bs1:bs5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bt1:bt5001")) <> 0 Then 'compte 6032
If WorksheetFunction.Sum(Sheets("feuil25").Range("bq1:bq5001")) = 0 Then 'compte 602
Sheets("feuil25").Range("a86") = "Attention ! Vous avez du Stock de matières premières sans Achats de matières premières !"
Else
Sheets("feuil25").Range("a86") = "Rien à signaler sur les Stocks de matières premières !"
End If
Else
Sheets("feuil25").Range("a86") = "Rien à signaler sur les Stocks de matières premières !"
End If

'sur les ventes de produits finis
If WorksheetFunction.Sum(Sheets("feuil25").Range("bu1:bu5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bv1:bv5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bw1:bw5001")) <> 0 Then 'compte 702+703+704
If WorksheetFunction.Sum(Sheets("feuil25").Range("bq1:bq5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bs1:bs5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bt1:bt5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("by1:by5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bz1:bz5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("ca1:ca5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("cb1:cb5001")) = 0 Then 'compte 602+32+382+34+36+37+386
Sheets("feuil25").Range("a87") = "Attention ! Vous faîtes des Ventes de produits sans Stocks de produits et sans Achats de matières !"
Else
Sheets("feuil25").Range("a87") = "Rien à signaler sur les Ventes de produits finis !"
End If
Else
Sheets("feuil25").Range("a87") = "Rien à signaler sur les Ventes de produits finis !"
End If

'sur les variations de stocks de produits finis et encours
If WorksheetFunction.Sum(Sheets("feuil25").Range("bx1:bx5001")) <> 0 Then 'compte 73
If WorksheetFunction.Sum(Sheets("feuil25").Range("by1:by5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bz1:bz5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("ca1:ca5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("cb1:cb5001")) = 0 Then 'compte 34+36+37+386
Sheets("feuil25").Range("a88") = "Attention ! Vous faîtes des Variations de stocks de produits sans Stocks de produits !"
Else
Sheets("feuil25").Range("a88") = "Rien à signaler sur les Variations de stocks de produits !"
End If
Else
Sheets("feuil25").Range("a88") = "Rien à signaler sur les Variations de stocks de produits !"
End If

'sur les stocks de produits finis et encours
If WorksheetFunction.Sum(Sheets("feuil25").Range("by1:by5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bz1:bz5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("ca1:ca5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("cb1:cb5001")) <> 0 Then 'compte 34+36+37+386
If WorksheetFunction.Sum(Sheets("feuil25").Range("bu1:bu5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bv1:bv5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bw1:bw5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bq1:bq5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bs1:bs5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("bt1:bt5001")) = 0 Then 'compte 702+703+704+602+32+387
Sheets("feuil25").Range("a89") = "Attention ! Vous faîtes des Variations de stocks de produits sans Stocks de produits !"
Else
Sheets("feuil25").Range("a89") = "Rien à signaler sur les Stocks de produits finis et encours de produits !"
End If
Else
Sheets("feuil25").Range("a89") = "Rien à signaler sur les Stocks de produits finis et encours de produits !"
End If

'analyse des opérations financières
'intérêts des emprunts
If WorksheetFunction.Sum(Sheets("feuil25").Range("cc1:cc5001")) <> 0 Then 'compte 671 sauf 6713
If WorksheetFunction.Sum(Sheets("feuil25").Range("cd1:cd5001")) = 0 Then 'compte 16
Sheets("feuil25").Range("a92") = "Attention ! Vous avez des intérêts comptablisés sans Emprunts dans le bilan !"
Else
Sheets("feuil25").Range("a92") = "Rien à signaler sur les intérêts d'Emprunts !"
End If
Else
Sheets("feuil25").Range("a92") = "Rien à signaler sur les intérêts d'Emprunts !"
End If

'intérêts des dettes participatives
If WorksheetFunction.Sum(Sheets("feuil25").Range("ce1:ce5001")) <> 0 Then 'compte 6713
If WorksheetFunction.Sum(Sheets("feuil25").Range("cf1:cf5001")) = 0 Then 'compte 18
Sheets("feuil25").Range("a93") = "Attention ! Vous avez des intérêts comptablisés sans Dettes participatives dans le bilan !"
Else
Sheets("feuil25").Range("a93") = "Rien à signaler sur les intérêts des Dettes participatives !"
End If
Else
Sheets("feuil25").Range("a93") = "Rien à signaler sur les intérêts des Dettes participatives !"
End If

'pertes sur titres de placement
If WorksheetFunction.Sum(Sheets("feuil25").Range("cg1:cg5001")) <> 0 Then 'compte 677
If WorksheetFunction.Sum(Sheets("feuil25").Range("ch1:ch5001")) = 0 Then 'compte 50
Sheets("feuil25").Range("a94") = "Attention ! Vous avez des pertes comptablisées sans Titres de placement dans le bilan !"
Else
Sheets("feuil25").Range("a94") = "Rien à signaler sur les pertes de titres de placement !"
End If
Else
Sheets("feuil25").Range("a94") = "Rien à signaler sur les pertes de titres de placement !"
End If

'revenus sur prêts
If WorksheetFunction.Sum(Sheets("feuil25").Range("ci1:ci5001")) <> 0 Then 'compte 771
If WorksheetFunction.Sum(Sheets("feuil25").Range("cj1:cj5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("ck1:ck5001")) = 0 Then 'compte 271+272
Sheets("feuil25").Range("a95") = "Attention ! Vous avez des revenus comptablisés sans des Prêts dans le bilan !"
Else
Sheets("feuil25").Range("a95") = "Rien à signaler sur les revenus de Prêts !"
End If
Else
Sheets("feuil25").Range("a95") = "Rien à signaler sur les revenus de Prêts !"
End If

'revenus des participations
If WorksheetFunction.Sum(Sheets("feuil25").Range("cl1:cl5001")) <> 0 Then 'compte 772
If WorksheetFunction.Sum(Sheets("feuil25").Range("cm1:cm5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("cn1:cn5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("co1:co5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("cp1:cp5001")) = 0 Then 'compte 274+277+278+26
Sheets("feuil25").Range("a96") = "Attention ! Vous avez des revenus comptablisés sans des Participations dans le bilan !"
Else
Sheets("feuil25").Range("a96") = "Rien à signaler sur les revenus de Participations !"
End If
Else
Sheets("feuil25").Range("a96") = "Rien à signaler sur les revenus de Participations !"
End If

'revenus des titres de placement
If WorksheetFunction.Sum(Sheets("feuil25").Range("cq1:cq5001")) + WorksheetFunction.Sum(Sheets("feuil25").Range("cr1:cr5001")) <> 0 Then 'compte 774+777
If WorksheetFunction.Sum(Sheets("feuil25").Range("ch1:ch5001")) = 0 Then 'compte 50
Sheets("feuil25").Range("a97") = "Attention ! Vous avez des revenus comptablisés sans Titres de placement dans le bilan !"
Else
Sheets("feuil25").Range("a97") = "Rien à signaler sur les revenus de Titres de placement !"
End If
Else
Sheets("feuil25").Range("a97") = "Rien à signaler sur les revenus de Titres de placement !"
End If



'annulation des recups
Sheets("feuil25").Range("o1:za5001").ClearContents

'affiche la feuil25 d'audit
Sheets("feuil25").Activate


'demande de confirmation
End If

'condition d'audit
Else
MsgBox "Désolé !  Aucune donnée à auditer."
End If
End Sub
Private Sub retour_audit_mouvements()
Sheets("feuil2").Activate
End Sub
Private Sub rechercher_tafire_n()
'condition générale
If Sheets("feuil7").Range("g54") <> "" Then

'condition de recherche sur la balance n
If WorksheetFunction.Sum(Sheets("feuil2").Range("g3:g5000")) <> 0 Then

'TAFIRE N
'1- Recherche du montant du déséquilibre sur la balance n
If Sheets("feuil7").Range("g54") - Sheets("feuil7").Range("g53") = 0 Then
MsgBox "Votre Tableau de trésorerie N est équilibré !"
Else
MsgBox "Recherche du montant du déséquilibre  " & Abs(Sheets("feuil7").Range("g54") - Sheets("feuil7").Range("g53")) & "  sur la balance N !"
Sheets("feuil2").Activate

'pour avoir la variable de la boucle While
For i = 3 To 5000
If Left(Sheets("feuil2").Cells(i, 1), 1) > 0 Then
Sheets("feuil2").Cells(i, 9) = 1
Else
End If
Next

Dim numero As Integer
    numero = 3

Dim variable As Variant
    variable = WorksheetFunction.Sum(Sheets("feuil2").Range("i3:i5000"))
    
    While numero <= 8
       
    For i = 3 To variable
If Sheets("feuil2").Cells(i, numero) = Abs(Sheets("feuil7").Range("g54") - Sheets("feuil7").Range("g53")) Then
Sheets("feuil2").Cells(i, numero).Select
Sheets("feuil2").Cells(i, numero).Font.Color = RGB(136, 255, 0) 'Couleur vert fluor
'Sheets("feuil2").Cells(i, numero).Font.Bold = True 'gras
'Sheets("feuil2").Cells(i, numero).Font.Italic = True 'italie
Else
End If
    Next
    
numero = numero + 1
   Wend


'pour effacer les nombres de la variable de la boucle While
Sheets("feuil2").Range("i1:i5000").ClearContents

MsgBox "Fin de la recherche du montant !"


'0- Contrôle du report du résultat de N-1 sur la balance N
For i = 3 To 5000
'recup des comptes 12 et 13 sur la balance n
If Left(Sheets("feuil2").Cells(i, 1), 2) = 12 Then 'compte 12c
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 4) 'colonne Z
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 13 Then 'compte 13c
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 4) 'colonne AA
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 12 Then 'compte 12d
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 3) 'colonne AB
Else
End If

If Left(Sheets("feuil2").Cells(i, 1), 2) = 13 Then 'compte 13d
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 3) 'colonne AC
Else
End If


'recup des comptes 12 et 13 sur la balance n-1
If Left(Sheets("feuil1").Cells(i, 1), 2) = 12 Then 'compte 12c
Sheets("feuil2").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'colonne AD
Else
End If

If Left(Sheets("feuil1").Cells(i, 1), 2) = 13 Then 'compte 13c
Sheets("feuil2").Cells(i, 31) = Sheets("feuil1").Cells(i, 8) 'colonne AE
Else
End If

If Left(Sheets("feuil1").Cells(i, 1), 2) = 12 Then 'compte 12d
Sheets("feuil2").Cells(i, 32) = Sheets("feuil1").Cells(i, 7) 'colonne AF
Else
End If

If Left(Sheets("feuil1").Cells(i, 1), 2) = 13 Then 'compte 13d
Sheets("feuil2").Cells(i, 33) = Sheets("feuil1").Cells(i, 7) 'colonne AG
Else
End If
Next

'contrôle de l'affectation du résultat de n-1
If Sheets("feuil6").Range("i54") <> "" Then

If WorksheetFunction.Sum(Sheets("feuil1").Range("g3:g5000")) = 0 Then
MsgBox "CONTRÔLE DU REPORT DU RESULTAT DE N-1 en N :" & Chr(10) & Chr(10) & "NB : Veuillez renseigner la balance N-1 pour le contrôle du REPORT du RESULTAT de N-1 en N !"
Else

If ((WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) + WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000"))) - (WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) + WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")))) - ((WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) + WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000"))) - (WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000")) + WorksheetFunction.Sum(Sheets("feuil2").Range("ag1:ag5000")))) = Sheets("feuil6").Range("j54") Then
Else
MsgBox "Attention !  Attention !" & Chr(10) & Chr(10) & "Veuillez contrôler le REPORT du RESULTAT de N-1 en N qui a été de  " & ((WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) + WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000"))) - (WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) + WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")))) - ((WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) + WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000"))) - (WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000")) + WorksheetFunction.Sum(Sheets("feuil2").Range("ag1:ag5000")))) & "  au lieu de  " & Sheets("feuil6").Range("j54") & "."
End If

End If

Else
End If

'efface les recups pour le contrôle du report du résultat de n-1
Sheets("feuil2").Range("z1:ag5000").ClearContents


'SYSCOHADA révisé : Contrôle du constat des réévaluation dans la Note 3A - Actif immobilisé
For i = 3 To 5000
If Left(Sheets("feuil2").Cells(i, 1), 3) = 106 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 154 Then
If Sheets("feuil2").Cells(i, 6) <> 0 And Sheets("feuil23").Range("e35") = 0 Then
MsgBox "Contrôle des Réévaluations du Bilan !"
Sheets("feuil2").Cells(i, 6).Select
Sheets("feuil2").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 6).Font.Bold = True 'gras
Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 1).Font.Bold = True 'gras
MsgBox "Attention  !  Il y a eu réévaluation du Bilan de  " & Sheets("feuil2").Cells(i, 6) & "  et la Note 3A  N  n'est pas renseignée dans ce sens."
Else
End If
Else
End If
Next


'2- Contrôle des prix de cession dans le compte 82
For i = 3 To 5000
If Left(Sheets("feuil2").Cells(i, 1), 2) = 82 Then
If Sheets("feuil2").Cells(i, 5) <> 0 Then
MsgBox "Contrôle des Prix de cession dans les comptes 82 !"
Sheets("feuil2").Cells(i, 5).Select
Sheets("feuil2").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 5).Font.Bold = True 'gras
Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 1).Font.Bold = True 'gras
MsgBox "Veuillez vérifier le prix de cession dans le compte  " & Sheets("feuil2").Cells(i, 1)
Else
End If
Else
End If
Next

'3- Contrôle des dividendes bruts dans le compte 465
For i = 3 To 5000
If Left(Sheets("feuil2").Cells(i, 1), 3) = 465 Then
If Sheets("feuil2").Cells(i, 5) <> 0 Then
MsgBox "Contrôle des Dividendes bruts dans les comptes 465 !"
Sheets("feuil2").Cells(i, 5).Select
Sheets("feuil2").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 5).Font.Bold = True 'gras
Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 1).Font.Bold = True 'gras
MsgBox "Veuillez vérifier si le dividende dans le compte  " & Sheets("feuil2").Cells(i, 1) & "  est le montant brut !"
Else
End If
Else
End If
Next

'4- Contrôle des mouvements dans les comptes 10
For i = 3 To 5000
If Left(Sheets("feuil2").Cells(i, 1), 2) = 10 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 106 Then
Else
If Sheets("feuil2").Cells(i, 5) + Sheets("feuil2").Cells(i, 6) <> 0 Then
MsgBox "Contrôle des Mouvements dans les comptes 10 !"
Sheets("feuil2").Cells(i, 1).Select
Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 1).Font.Bold = True 'gras
Sheets("feuil2").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 5).Font.Bold = True 'gras
Sheets("feuil2").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 6).Font.Bold = True 'gras
MsgBox "Veuillez vérifier les écritures de l'exercice dans le compte  " & Sheets("feuil2").Cells(i, 1)
Else
End If
End If
Else
End If
Next

'5- Contrôle des mouvements dans les comptes 11
For i = 3 To 5000
If Left(Sheets("feuil2").Cells(i, 1), 2) = 11 Then
If Sheets("feuil2").Cells(i, 5) + Sheets("feuil2").Cells(i, 6) <> 0 Then
MsgBox "Contrôle des Mouvements dans les comptes 11 !"
Sheets("feuil2").Cells(i, 1).Select
Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 1).Font.Bold = True 'gras
Sheets("feuil2").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 5).Font.Bold = True 'gras
Sheets("feuil2").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 6).Font.Bold = True 'gras
MsgBox "Veuillez vérifier les écritures de l'exercice dans le compte  " & Sheets("feuil2").Cells(i, 1)
Else
End If
Else
End If
Next

'6- Contrôle des mouvements dans les comptes 12
For i = 3 To 5000
If Left(Sheets("feuil2").Cells(i, 1), 2) = 12 Then
If Sheets("feuil2").Cells(i, 5) + Sheets("feuil2").Cells(i, 6) <> 0 Then
MsgBox "Contrôle des Mouvements dans les comptes 12 !"
Sheets("feuil2").Cells(i, 1).Select
Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 1).Font.Bold = True 'gras
Sheets("feuil2").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 5).Font.Bold = True 'gras
Sheets("feuil2").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 6).Font.Bold = True 'gras
MsgBox "Veuillez vérifier les écritures de l'exercice dans le compte  " & Sheets("feuil2").Cells(i, 1)
Else
End If
Else
End If
Next

'7- Contrôle des mouvements dans les comptes 16
'For i = 3 To 5000
'If Left(Sheets("feuil2").Cells(i, 1), 2) = 16 Then
'If Sheets("feuil2").Cells(i, 5) + Sheets("feuil2").Cells(i, 6) <> 0 Then
'MsgBox "Contrôle des Mouvements dans les comptes 16 !"
'Sheets("feuil2").Cells(i, 1).Select
'Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 1).Font.Bold = True 'gras
'Sheets("feuil2").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 5).Font.Bold = True 'gras
'Sheets("feuil2").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 6).Font.Bold = True 'gras
'MsgBox "Veuillez vérifier que les mouvements dans le compte  " & Sheets("feuil2").Cells(i, 1) & "  sont réels."
'Else
'End If
'Else
'End If
'Next

'8- Contrôle des mouvements dans les comptes 17
'For i = 3 To 5000
'If Left(Sheets("feuil2").Cells(i, 1), 2) = 17 Then
'If Sheets("feuil2").Cells(i, 5) + Sheets("feuil2").Cells(i, 6) <> 0 Then
'MsgBox "Contrôle des Mouvements dans les comptes 17 !"
'Sheets("feuil2").Cells(i, 1).Select
'Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 1).Font.Bold = True 'gras
'Sheets("feuil2").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 5).Font.Bold = True 'gras
'Sheets("feuil2").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 6).Font.Bold = True 'gras
'MsgBox "Veuillez vérifier que les mouvements dans le compte  " & Sheets("feuil2").Cells(i, 1) & "  sont réels."
'Else
'End If
'Else
'End If
'Next

'9- Contrôle des mouvements dans les comptes 18
'For i = 3 To 5000
'If Left(Sheets("feuil2").Cells(i, 1), 2) = 18 Then
'If Sheets("feuil2").Cells(i, 5) + Sheets("feuil2").Cells(i, 6) <> 0 Then
'MsgBox "Contrôle des Mouvements dans les comptes 18 !"
'Sheets("feuil2").Cells(i, 1).Select
'Sheets("feuil2").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 1).Font.Bold = True 'gras
'Sheets("feuil2").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 5).Font.Bold = True 'gras
'Sheets("feuil2").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil2").Cells(i, 6).Font.Bold = True 'gras
'MsgBox "Veuillez vérifier que les mouvements dans le compte  " & Sheets("feuil2").Cells(i, 1) & "  sont réels."
'Else
'End If
'Else
'End If
'Next


'fin de la recherche du déséquilibre
MsgBox "  FIN DE LA RECHERCHE DU DESEQUILIBRE N !"
End If


'condition de recherche sur la balance n
Else
MsgBox "Veuillez renseigner la Balance N pour cette recherche !"
End If

'condition de recherche tafire n
Else
MsgBox "Désolé !  Aucune donnée à rechercher."
End If

End Sub
Private Sub rechercher_tafire_n_1()
'condition générale
If Sheets("feuil7").Range("h54") = "" Then
MsgBox "Désolé  !  Aucune donnée à rechercher."
Else

'condition de recherche sur la balance n-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("g3:g5000")) = 0 Then
MsgBox "Veuillez renseigner la Balance N-1 pour cette recherche !"
Else

'TAFIRE N-1
'1- Recherche du montant du déséquilibre sur la balance n-1
If Sheets("feuil7").Range("h54") - Sheets("feuil7").Range("h53") = 0 Then
MsgBox "Votre Tableau de trésorerie N-1 est équilibré !"
Else
MsgBox "Recherche du montant du déséquilibre  " & Abs(Sheets("feuil7").Range("h54") - Sheets("feuil7").Range("h53")) & "  sur la balance N-1 !"
Sheets("feuil1").Activate

'pour avoir la variable de la boucle While
For i = 3 To 5000
If Left(Sheets("feuil1").Cells(i, 1), 1) > 0 Then
Sheets("feuil1").Cells(i, 9) = 1
Else
End If
Next

Dim numero As Integer
    numero = 3

Dim variable As Variant
    variable = WorksheetFunction.Sum(Sheets("feuil1").Range("i3:i5000"))
    
    While numero <= 8
       
    For i = 3 To variable
If Sheets("feuil1").Cells(i, numero) = Abs(Sheets("feuil7").Range("h54") - Sheets("feuil7").Range("h53")) Then
Sheets("feuil1").Cells(i, numero).Select
Sheets("feuil1").Cells(i, numero).Font.Color = RGB(136, 255, 0) 'Couleur vert fluor
'Sheets("feuil1").Cells(i, numero).Font.Bold = True 'gras
'Sheets("feuil1").Cells(i, numero).Font.Italic = True 'italie
Else
End If
    Next
    
numero = numero + 1
   Wend


'pour effacer les nombres de la variable de la boucle While
Sheets("feuil1").Range("i3:i5000").ClearContents

MsgBox "Fin de la recherche du montant !"


'SYSCOHADA révisé Contrôle du constat de la réévaluation du bilan dans le Tableau 1 - Actif immobilisé
For i = 3 To 5000
If Left(Sheets("feuil1").Cells(i, 1), 3) = 106 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 154 Then
If Sheets("feuil1").Cells(i, 6) <> 0 And Sheets("feuil24").Range("e35") = 0 Then
MsgBox "Contrôle des réévaluations du Bilan !"
Sheets("feuil1").Cells(i, 6).Select
Sheets("feuil1").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 6).Font.Bold = True 'gras
Sheets("feuil1").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 1).Font.Bold = True 'gras
MsgBox "Attention  !  Il y a eu réévaluation du Bilan de  " & Sheets("feuil1").Cells(i, 6) & "  et la Note 3A  N-1  n'est pas renseignée dans ce sens."
Else
End If
Else
End If
Next


'2- Contrôle des prix de cession dans le compte 82
For i = 3 To 5000
If Left(Sheets("feuil1").Cells(i, 1), 2) = 82 Then
If Sheets("feuil1").Cells(i, 5) <> 0 Then
MsgBox "Contrôle des Prix de cession dans les comptes 82 !"
Sheets("feuil1").Cells(i, 5).Select
Sheets("feuil1").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 5).Font.Bold = True 'gras
Sheets("feuil1").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 1).Font.Bold = True 'gras
MsgBox "Veuillez vérifier le prix de cession dans le compte  " & Sheets("feuil1").Cells(i, 1)
Else
End If
Else
End If
Next

'3- Contrôle des dividendes bruts dans le compte 465
For i = 1 To 5000
If Left(Sheets("feuil1").Cells(i, 1), 3) = 465 Then
If Sheets("feuil1").Cells(i, 5) <> 0 Then
MsgBox "Contrôle des Dividendes bruts dans les comptes 465 !"
Sheets("feuil1").Cells(i, 5).Select
Sheets("feuil1").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 5).Font.Bold = True 'gras
Sheets("feuil1").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 1).Font.Bold = True 'gras
MsgBox "Veuillez vérifier si le dividende dans le compte  " & Sheets("feuil1").Cells(i, 1) & "  est le montant brut !"
Else
End If
Else
End If
Next

'4- Contrôle des mouvements dans les comptes 10
For i = 1 To 5000
If Left(Sheets("feuil1").Cells(i, 1), 2) = 10 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 106 Then
Else
If Sheets("feuil1").Cells(i, 5) + Sheets("feuil1").Cells(i, 6) <> 0 Then
MsgBox "Contrôle des Mouvements dans les comptes 10 !"
Sheets("feuil1").Cells(i, 1).Select
Sheets("feuil1").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 1).Font.Bold = True 'gras
Sheets("feuil1").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 5).Font.Bold = True 'gras
Sheets("feuil1").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 6).Font.Bold = True 'gras
MsgBox "Veuillez vérifier les écritures de l'exercice dans le compte  " & Sheets("feuil1").Cells(i, 1)
Else
End If
End If
Else
End If
Next

'5- Contrôle des mouvements dans les comptes 11
For i = 1 To 5000
If Left(Sheets("feuil1").Cells(i, 1), 2) = 11 Then
If Sheets("feuil1").Cells(i, 5) + Sheets("feuil1").Cells(i, 6) <> 0 Then
MsgBox "Contrôle des Mouvements dans les comptes 11 !"
Sheets("feuil1").Cells(i, 1).Select
Sheets("feuil1").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 1).Font.Bold = True 'gras
Sheets("feuil1").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 5).Font.Bold = True 'gras
Sheets("feuil1").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 6).Font.Bold = True 'gras
MsgBox "Veuillez vérifier les écritures de l'exercice dans le compte  " & Sheets("feuil1").Cells(i, 1)
Else
End If
Else
End If
Next

'6- Contrôle des mouvements dans les comptes 12
For i = 1 To 5000
If Left(Sheets("feuil1").Cells(i, 1), 2) = 12 Then
If Sheets("feuil1").Cells(i, 5) + Sheets("feuil1").Cells(i, 6) <> 0 Then
MsgBox "Contrôle des Mouvements dans les comptes 12 !"
Sheets("feuil1").Cells(i, 1).Select
Sheets("feuil1").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 1).Font.Bold = True 'gras
Sheets("feuil1").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 5).Font.Bold = True 'gras
Sheets("feuil1").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 6).Font.Bold = True 'gras
MsgBox "Veuillez vérifier les écritures de l'exercice dans le compte  " & Sheets("feuil1").Cells(i, 1)
Else
End If
Else
End If
Next

'7- Contrôle des mouvements dans les comptes 16
'For i = 1 To 5000
'If Left(Sheets("feuil1").Cells(i, 1), 2) = 16 Then
'If Sheets("feuil1").Cells(i, 5) + Sheets("feuil1").Cells(i, 6) <> 0 Then
'MsgBox "Contrôle des Mouvements dans les comptes 16 !"
'Sheets("feuil1").Cells(i, 1).Select
'Sheets("feuil1").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 1).Font.Bold = True 'gras
'Sheets("feuil1").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 5).Font.Bold = True 'gras
'Sheets("feuil1").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 6).Font.Bold = True 'gras
'MsgBox "Veuillez vérifier que les mouvements dans le compte  " & Sheets("feuil1").Cells(i, 1) & "  sont réels."
'Else
'End If
'Else
'End If
'Next

'8- Contrôle des mouvements dans les comptes 17
'For i = 1 To 5000
'If Left(Sheets("feuil1").Cells(i, 1), 2) = 17 Then
'If Sheets("feuil1").Cells(i, 5) + Sheets("feuil1").Cells(i, 6) <> 0 Then
'MsgBox "Contrôle des Mouvements dans les comptes 17 !"
'Sheets("feuil1").Cells(i, 1).Select
'Sheets("feuil1").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 1).Font.Bold = True 'gras
'Sheets("feuil1").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 5).Font.Bold = True 'gras
'Sheets("feuil1").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 6).Font.Bold = True 'gras
'MsgBox "Veuillez vérifier que les mouvements dans le compte  " & Sheets("feuil1").Cells(i, 1) & "  sont réels."
'Else
'End If
'Else
'End If
'Next

'9- Contrôle des mouvements dans les comptes 18
'For i = 1 To 5000
'If Left(Sheets("feuil1").Cells(i, 1), 2) = 18 Then
'If Sheets("feuil1").Cells(i, 5) + Sheets("feuil1").Cells(i, 6) <> 0 Then
'MsgBox "Contrôle des Mouvements dans les comptes 18 !"
'Sheets("feuil1").Cells(i, 1).Select
'Sheets("feuil1").Cells(i, 1).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 1).Font.Bold = True 'gras
'Sheets("feuil1").Cells(i, 5).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 5).Font.Bold = True 'gras
'Sheets("feuil1").Cells(i, 6).Font.Color = RGB(136, 0, 900) 'Couleur bleu
'Sheets("feuil1").Cells(i, 6).Font.Bold = True 'gras
'MsgBox "Veuillez vérifier que les mouvements dans le compte  " & Sheets("feuil1").Cells(i, 1) & "  sont réels."
'Else
'End If
'Else
'End If
'Next



'fin de la recherche du déséquilibre
MsgBox "  FIN DE LA RECHERCHE DU DESEQUILIBRE N-1 !"
End If


'condition de recherche sur la balance n-1
End If

'condition de recherche tafire n-1
End If

End Sub
Private Sub quitter_l_application()
Sheets("feuil28").Range("a20") = 1
If MsgBox("Êtes-vous certain de vouloir quitter ILLICO_LIASSE.vba.18 ?", vbYesNo, "Demande de confirmation") = vbYes Then
Application.ThisWorkbook.Save
Application.Quit
End If
End Sub
Private Sub imprimer_bilan()
Application.Sheets("feuil5").PrintPreview
End Sub
Private Sub imprimer_compte_résultat()
Application.Sheets("feuil6").PrintPreview
End Sub
Private Sub imprimer_tafire()
Application.Sheets("feuil7").PrintPreview
End Sub
Private Sub imprimer_audit_mouvements()
Application.Sheets("feuil25").PrintPreview
End Sub
Private Sub affiche_fiche_identification()
'animationv1
Sheets("feuil4").Activate
End Sub
Sub lunaone()
'animationv1
Sheets("feuil12").Activate
End Sub
Sub matrix1()
'animationv1
Sheets("feuil4").Activate
End Sub
Private Sub affiche_couvertures()
'animationv1
Sheets("feuil3").Activate
End Sub
Private Sub imprimer_couvertures()
Application.Sheets("feuil3").PrintPreview
End Sub
Private Sub imprimer_fiche_identification()
Application.Sheets("feuil4").PrintPreview
End Sub
Private Sub dates_et_heures()
    'Now renvoie la date et l'heure en cours (07.02.2012 09:09:02)
    date_test = Now()
    
    'Renvoie : 07.02.12
    Sheets("feuil20").Range("a15") = Format(date_test, "dd.mm.yy")
End Sub
Private Sub edite_tafire_n_suite()
'Calcul des flux de trésorerie dans le tableau du TAFIRE

'total flux de trésorerie opérationnelle
Sheets("feuil7").Range("g23") = WorksheetFunction.Sum(Sheets("feuil7").Range("g15:g19"))
'variation BF opérationelle
Sheets("feuil7").Range("d22") = WorksheetFunction.Sum(Sheets("feuil7").Range("g16:g19"))

'total flux de trésorerie investissements
Sheets("feuil7").Range("g32") = WorksheetFunction.Sum(Sheets("feuil7").Range("g26:g30"))

'total flux de trésorerie financements propres
Sheets("feuil7").Range("g40") = WorksheetFunction.Sum(Sheets("feuil7").Range("g35:g38"))

'total flux de trésorerie financements étrangers
Sheets("feuil7").Range("g47") = WorksheetFunction.Sum(Sheets("feuil7").Range("g43:g45"))

'total flux de trésorerie financements total
Sheets("feuil7").Range("g49") = Sheets("feuil7").Range("g40") + Sheets("feuil7").Range("g47")

'variation de la trésorerie de la période
Sheets("feuil7").Range("g51") = Sheets("feuil7").Range("g23") + Sheets("feuil7").Range("g32") + Sheets("feuil7").Range("g49")

'trésorerie nette au 31 décemnre
Sheets("feuil7").Range("g53") = Sheets("feuil7").Range("g12") + Sheets("feuil7").Range("g51")






'affiche le TAFIRE
Sheets("feuil7").Activate

'message d'équilibre
If Sheets("feuil7").Range("g53") - Sheets("feuil7").Range("g54") = 0 Then
MsgBox "Votre Tableau de trésorerie N est équilibré !"
Sheets("feuil7").Range("j53") = "T.F.T.  N  équilibré  !"
Else
MsgBox "Votre tableau de trésorerie N est déséquilibré de  " & Abs(Sheets("feuil7").Range("g53") - Sheets("feuil7").Range("g54"))
Sheets("feuil7").Range("j53") = "Ecart  T.F.T.  N"
Sheets("feuil7").Range("k53") = Abs(Sheets("feuil7").Range("g53") - Sheets("feuil7").Range("g54"))
End If

'efface les données de la feuil28
Sheets("feuil28").Range("a1:za5001").ClearContents
End Sub
Private Sub edite_tafire_n_1_suite()
'Calcul des flux de trésorerie dans le tableau du TAFIRE

'total flux de trésorerie opérationnelle
Sheets("feuil7").Range("h23") = WorksheetFunction.Sum(Sheets("feuil7").Range("h15:h19"))
'variation BF opérationelle
Sheets("feuil7").Range("e22") = WorksheetFunction.Sum(Sheets("feuil7").Range("h16:h19"))

'total flux de trésorerie investissements
Sheets("feuil7").Range("h32") = WorksheetFunction.Sum(Sheets("feuil7").Range("h26:h30"))

'total flux de trésorerie financements propres
Sheets("feuil7").Range("h40") = WorksheetFunction.Sum(Sheets("feuil7").Range("h35:h38"))

'total flux de trésorerie financements étrangers
Sheets("feuil7").Range("h47") = WorksheetFunction.Sum(Sheets("feuil7").Range("h43:h45"))

'total flux de trésorerie financements total
Sheets("feuil7").Range("h49") = Sheets("feuil7").Range("h40") + Sheets("feuil7").Range("h47")

'variation de la trésorerie de la période
Sheets("feuil7").Range("h51") = Sheets("feuil7").Range("h23") + Sheets("feuil7").Range("h32") + Sheets("feuil7").Range("h49")

'trésorerie nette au 31 décemnre
Sheets("feuil7").Range("h53") = Sheets("feuil7").Range("h12") + Sheets("feuil7").Range("h51")



'affiche le TAFIRE
Sheets("feuil7").Activate

'message d'équilibre
If Sheets("feuil7").Range("h53") - Sheets("feuil7").Range("h54") = 0 Then
MsgBox "Votre Tableau de trésorerie N-1 est équilibré !"
Sheets("feuil7").Range("j54") = "T.F.T.  N-1  équilibré  !"
Else
MsgBox "Votre tableau de trésorerie N-1 est déséquilibré de  " & Abs(Sheets("feuil7").Range("h53") - Sheets("feuil7").Range("h54"))
Sheets("feuil7").Range("j54") = "Ecart  T.F.T.  N-1"
Sheets("feuil7").Range("k54") = Abs(Sheets("feuil7").Range("h53") - Sheets("feuil7").Range("h54"))
End If

'efface les données de la feuil28
Sheets("feuil28").Range("a1:za5001").ClearContents


End Sub
Private Sub note_3C()
'condition générale de traitement de la NOTE 3C
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 3C
If Sheets("feuil5").Range("f34") = 0 Then
MsgBox "Désolé  !  Aucun amortissement pratiqué."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données du TABLEAU 2 - AMORTISSEMENTS
'annule les données du Tableau 2
Sheets("feuil23").Range("b119:k133").ClearContents


For i = 3 To 5000
'recup SOLDE N
'compte 2811+28181
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2811 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 28181 Then
Sheets("feuil23").Cells(i, 20) = Sheets("feuil2").Cells(i, 8) 'T
Else
End If

'compte 2812
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2812 Then
Sheets("feuil23").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
Else
End If
'compte 2813
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2813 Then
Sheets("feuil23").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
Else
End If
'compte 2814
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2814 Then
Sheets("feuil23").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
Else
End If

'compte 2815
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2815 Then
Sheets("feuil23").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
Else
End If
'compte 2816
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2816 Then
Sheets("feuil23").Cells(i, 25) = Sheets("feuil2").Cells(i, 8) 'Y
Else
End If

'compte 2817
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2817 Then
Sheets("feuil23").Cells(i, 26) = Sheets("feuil2").Cells(i, 8) 'Z
Else
End If
'compte 2818
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2818 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28181 Then
Else
Sheets("feuil23").Cells(i, 27) = Sheets("feuil2").Cells(i, 8) 'AA
End If
Else
End If

'compte 282
If Left(Sheets("feuil2").Cells(i, 1), 3) = 282 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28281 Then
Else
Sheets("feuil23").Cells(i, 28) = Sheets("feuil2").Cells(i, 8) 'AB
End If
Else
End If

'compte 2831
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2831 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28315 Then
Else
Sheets("feuil23").Cells(i, 29) = Sheets("feuil2").Cells(i, 8) 'AC
End If
Else
End If
'compte 2832
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2832 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28325 Then
Else
Sheets("feuil23").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
End If
Else
End If
'compte 2833
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2833 Then
Sheets("feuil23").Cells(i, 31) = Sheets("feuil2").Cells(i, 8) 'AE
Else
End If
'compte 2837
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2837 Then
Sheets("feuil23").Cells(i, 32) = Sheets("feuil2").Cells(i, 8) 'AF
Else
End If

'compte 2834
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2834 Then
Sheets("feuil23").Cells(i, 33) = Sheets("feuil2").Cells(i, 8) 'AG
Else
End If
'compte 2835
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2835 Then
Sheets("feuil23").Cells(i, 34) = Sheets("feuil2").Cells(i, 8) 'AH
Else
End If
'compte 2838
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2838 Then
Sheets("feuil23").Cells(i, 35) = Sheets("feuil2").Cells(i, 8) 'AI
Else
End If

'compte 284 sauf 2845
If Left(Sheets("feuil2").Cells(i, 1), 3) = 284 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2845 Then
Else
Sheets("feuil23").Cells(i, 36) = Sheets("feuil2").Cells(i, 8) 'AJ
End If
Else
End If

'compte 2845
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2845 Then
Sheets("feuil23").Cells(i, 37) = Sheets("feuil2").Cells(i, 8) 'AK
Else
End If

'recup SOLDE N-1
'compte 2811+28181
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2811 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 28181 Then
Sheets("feuil23").Cells(i, 38) = Sheets("feuil1").Cells(i, 8) 'AL
Else
End If

'compte 2812
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2812 Then
Sheets("feuil23").Cells(i, 39) = Sheets("feuil1").Cells(i, 8) 'AM
Else
End If
'compte 2813
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2813 Then
Sheets("feuil23").Cells(i, 40) = Sheets("feuil1").Cells(i, 8) 'AN
Else
End If
'compte 2814
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2814 Then
Sheets("feuil23").Cells(i, 41) = Sheets("feuil1").Cells(i, 8) 'AO
Else
End If

'compte 2815
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2815 Then
Sheets("feuil23").Cells(i, 42) = Sheets("feuil1").Cells(i, 8) 'AP
Else
End If
'compte 2816
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2816 Then
Sheets("feuil23").Cells(i, 43) = Sheets("feuil1").Cells(i, 8) 'AQ
Else
End If

'compte 2817
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2817 Then
Sheets("feuil23").Cells(i, 44) = Sheets("feuil1").Cells(i, 8) 'AR
Else
End If
'compte 2818
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2818 Then
If Left(Sheets("feuil1").Cells(i, 1), 5) = 28181 Then
Else
Sheets("feuil23").Cells(i, 45) = Sheets("feuil1").Cells(i, 8) 'AS
End If
Else
End If

'compte 282
If Left(Sheets("feuil1").Cells(i, 1), 3) = 282 Then
If Left(Sheets("feuil1").Cells(i, 1), 5) = 28281 Then
Else
Sheets("feuil23").Cells(i, 46) = Sheets("feuil1").Cells(i, 8) 'AT
End If
Else
End If

'compte 2831
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2831 Then
If Left(Sheets("feuil1").Cells(i, 1), 5) = 28315 Then
Else
Sheets("feuil23").Cells(i, 47) = Sheets("feuil1").Cells(i, 8) 'AU
End If
Else
End If
'compte 2832
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2832 Then
If Left(Sheets("feuil1").Cells(i, 1), 5) = 28325 Then
Else
Sheets("feuil23").Cells(i, 48) = Sheets("feuil1").Cells(i, 8) 'AV
End If
Else
End If
'compte 2833
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2833 Then
Sheets("feuil23").Cells(i, 49) = Sheets("feuil1").Cells(i, 8) 'AW
Else
End If
'compte 2837
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2837 Then
Sheets("feuil23").Cells(i, 50) = Sheets("feuil1").Cells(i, 8) 'AX
Else
End If

'compte 2834
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2834 Then
Sheets("feuil23").Cells(i, 51) = Sheets("feuil1").Cells(i, 8) 'AY
Else
End If
'compte 2835
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2835 Then
Sheets("feuil23").Cells(i, 52) = Sheets("feuil1").Cells(i, 8) 'AZ
Else
End If
'compte 2838
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2838 Then
Sheets("feuil23").Cells(i, 53) = Sheets("feuil1").Cells(i, 8) 'BA
Else
End If

'compte 284 sauf 2845
If Left(Sheets("feuil1").Cells(i, 1), 3) = 284 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2845 Then
Else
Sheets("feuil23").Cells(i, 54) = Sheets("feuil1").Cells(i, 8) 'BB
End If
Else
End If

'compte 2845
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2845 Then
Sheets("feuil23").Cells(i, 55) = Sheets("feuil1").Cells(i, 8) 'BC
Else
End If


'recup DIMINUTIONS N
'compte 2811+28181
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2811 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 28181 Then
Sheets("feuil23").Cells(i, 56) = Sheets("feuil2").Cells(i, 5) 'BD
Else
End If

'compte 2812
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2812 Then
Sheets("feuil23").Cells(i, 57) = Sheets("feuil2").Cells(i, 5) 'BE
Else
End If
'compte 2813
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2813 Then
Sheets("feuil23").Cells(i, 58) = Sheets("feuil2").Cells(i, 5) 'BF
Else
End If
'compte 2814
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2814 Then
Sheets("feuil23").Cells(i, 59) = Sheets("feuil2").Cells(i, 5) 'BG
Else
End If

'compte 2815
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2815 Then
Sheets("feuil23").Cells(i, 60) = Sheets("feuil2").Cells(i, 5) 'BH
Else
End If
'compte 2816
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2816 Then
Sheets("feuil23").Cells(i, 61) = Sheets("feuil2").Cells(i, 5) 'BI
Else
End If

'compte 2817
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2817 Then
Sheets("feuil23").Cells(i, 62) = Sheets("feuil2").Cells(i, 5) 'BJ
Else
End If
'compte 2818
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2818 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28181 Then
Else
Sheets("feuil23").Cells(i, 63) = Sheets("feuil2").Cells(i, 5) 'BK
End If
Else
End If

'compte 282
If Left(Sheets("feuil2").Cells(i, 1), 3) = 282 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28281 Then
Else
Sheets("feuil23").Cells(i, 64) = Sheets("feuil2").Cells(i, 5) 'BL
End If
Else
End If

'compte 2831
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2831 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28315 Then
Else
Sheets("feuil23").Cells(i, 65) = Sheets("feuil2").Cells(i, 5) 'BM
End If
Else
End If
'compte 2832
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2832 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28325 Then
Else
Sheets("feuil23").Cells(i, 66) = Sheets("feuil2").Cells(i, 5) 'BN
End If
Else
End If
'compte 2833
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2833 Then
Sheets("feuil23").Cells(i, 67) = Sheets("feuil2").Cells(i, 5) 'BO
Else
End If
'compte 2837
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2837 Then
Sheets("feuil23").Cells(i, 68) = Sheets("feuil2").Cells(i, 5) 'BP
Else
End If

'compte 2834
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2834 Then
Sheets("feuil23").Cells(i, 69) = Sheets("feuil2").Cells(i, 5) 'BQ
Else
End If
'compte 2835
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2835 Then
Sheets("feuil23").Cells(i, 70) = Sheets("feuil2").Cells(i, 5) 'BR
Else
End If
'compte 2838
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2838 Then
Sheets("feuil23").Cells(i, 71) = Sheets("feuil2").Cells(i, 5) 'BS
Else
End If

'compte 284 sauf 2845
If Left(Sheets("feuil2").Cells(i, 1), 3) = 284 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2845 Then
Else
Sheets("feuil23").Cells(i, 72) = Sheets("feuil2").Cells(i, 5) 'BT
End If
Else
End If

'compte 2845
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2845 Then
Sheets("feuil23").Cells(i, 73) = Sheets("feuil2").Cells(i, 5) 'BU
Else
End If



'recup AUGMENTATIONS N
'compte 2811+28181
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2811 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 28181 Then
Sheets("feuil23").Cells(i, 77) = Sheets("feuil2").Cells(i, 6) 'BY
Else
End If

'compte 2812
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2812 Then
Sheets("feuil23").Cells(i, 78) = Sheets("feuil2").Cells(i, 6) 'BZ
Else
End If
'compte 2813
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2813 Then
Sheets("feuil23").Cells(i, 79) = Sheets("feuil2").Cells(i, 6) 'CA
Else
End If
'compte 2814
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2814 Then
Sheets("feuil23").Cells(i, 80) = Sheets("feuil2").Cells(i, 6) 'CB
Else
End If

'compte 2815
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2815 Then
Sheets("feuil23").Cells(i, 81) = Sheets("feuil2").Cells(i, 6) 'CC
Else
End If
'compte 2816
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2816 Then
Sheets("feuil23").Cells(i, 82) = Sheets("feuil2").Cells(i, 6) 'CD
Else
End If

'compte 2817
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2817 Then
Sheets("feuil23").Cells(i, 83) = Sheets("feuil2").Cells(i, 6) 'CE
Else
End If
'compte 2818
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2818 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28181 Then
Else
Sheets("feuil23").Cells(i, 84) = Sheets("feuil2").Cells(i, 6) 'CF
End If
Else
End If

'compte 282
If Left(Sheets("feuil2").Cells(i, 1), 3) = 282 Then
Sheets("feuil23").Cells(i, 85) = Sheets("feuil2").Cells(i, 6) 'CG
Else
End If

'compte 2831
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2831 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28315 Then
Else
Sheets("feuil23").Cells(i, 86) = Sheets("feuil2").Cells(i, 6) 'CH
End If
Else
End If
'compte 2832
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2832 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28325 Then
Else
Sheets("feuil23").Cells(i, 87) = Sheets("feuil2").Cells(i, 6) 'CI
End If
Else
End If
'compte 2833
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2833 Then
Sheets("feuil23").Cells(i, 88) = Sheets("feuil2").Cells(i, 6) 'CJ
Else
End If
'compte 2837
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2837 Then
Sheets("feuil23").Cells(i, 89) = Sheets("feuil2").Cells(i, 6) 'CK
Else
End If

'compte 2834
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2834 Then
Sheets("feuil23").Cells(i, 90) = Sheets("feuil2").Cells(i, 6) 'CL
Else
End If
'compte 2835
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2835 Then
Sheets("feuil23").Cells(i, 91) = Sheets("feuil2").Cells(i, 6) 'CM
Else
End If
'compte 2838
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2838 Then
Sheets("feuil23").Cells(i, 92) = Sheets("feuil2").Cells(i, 6) 'CN
Else
End If

'compte 284 sauf 2845
If Left(Sheets("feuil2").Cells(i, 1), 3) = 284 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2845 Then
Else
Sheets("feuil23").Cells(i, 93) = Sheets("feuil2").Cells(i, 6) 'CO
End If
Else
End If

'compte 2845
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2845 Then
Sheets("feuil23").Cells(i, 94) = Sheets("feuil2").Cells(i, 6) 'CP
Else
End If


'ADAPTATION SYSCOHADA révisé (immeuble de placement)
'recup SOLDE N
'compte 28281 terrain-immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28281 Then
Sheets("feuil23").Cells(i, 99) = Sheets("feuil2").Cells(i, 8) 'CU
Else
End If

'compte 28315+28325 bâtiment-immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28315 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 28325 Then
Sheets("feuil23").Cells(i, 100) = Sheets("feuil2").Cells(i, 8) 'CV
Else
End If


'recup SOLDE N-1
'compte 28281 terrain-immeuble de placement
If Left(Sheets("feuil1").Cells(i, 1), 5) = 28281 Then
Sheets("feuil23").Cells(i, 101) = Sheets("feuil1").Cells(i, 8) 'CW
Else
End If

'compte 28315+28325 bâtiment-immeuble de placement
If Left(Sheets("feuil1").Cells(i, 1), 5) = 28315 Or Left(Sheets("feuil1").Cells(i, 1), 5) = 28325 Then
Sheets("feuil23").Cells(i, 102) = Sheets("feuil1").Cells(i, 8) 'CX
Else
End If


'recup DIMINUTION N
'compte 28281 terrain-immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28281 Then
Sheets("feuil23").Cells(i, 103) = Sheets("feuil2").Cells(i, 5) 'CY
Else
End If

'compte 28315+28325 bâtiment-immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28315 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 28325 Then
Sheets("feuil23").Cells(i, 104) = Sheets("feuil2").Cells(i, 5) 'CZ
Else
End If


'recup AUGMENTATION N
'compte 28281 terrain-immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28281 Then
Sheets("feuil23").Cells(i, 105) = Sheets("feuil2").Cells(i, 6) 'DA
Else
End If

'compte 28315+28325 bâtiment-immeuble de placement
If Left(Sheets("feuil2").Cells(i, 1), 5) = 28315 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 28325 Then
Sheets("feuil23").Cells(i, 106) = Sheets("feuil2").Cells(i, 6) 'DB
Else
End If


Next

'affecte SOLDE N Tableau 2 - Amortissements
'compte 2811+28181
Sheets("feuil23").Range("g119") = WorksheetFunction.Sum(Sheets("feuil23").Range("t1:t5000"))
'compte 2812+2813+2814
Sheets("feuil23").Range("g120") = WorksheetFunction.Sum(Sheets("feuil23").Range("u1:u5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("v1:v5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("w1:w5000"))
'compte 2815+2816
Sheets("feuil23").Range("g121") = WorksheetFunction.Sum(Sheets("feuil23").Range("x1:x5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("y1:y5000"))
'compte 2817+2818
Sheets("feuil23").Range("g122") = WorksheetFunction.Sum(Sheets("feuil23").Range("z1:z5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("aa1:aa5000"))
'compte 282
Sheets("feuil23").Range("g125") = WorksheetFunction.Sum(Sheets("feuil23").Range("ab1:ab5000"))
'compte 28281 terrain-immeuble de placement
Sheets("feuil23").Range("g126") = WorksheetFunction.Sum(Sheets("feuil23").Range("cu1:cu5000"))
'compte 2831+2832+2833+2837
Sheets("feuil23").Range("g127") = WorksheetFunction.Sum(Sheets("feuil23").Range("ac1:ac5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("ad1:ad5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("ae1:ae5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("af1:af5000"))
'compte 28315+28325 bâtiment-immeuble de placement
Sheets("feuil23").Range("g128") = WorksheetFunction.Sum(Sheets("feuil23").Range("cv1:cv5000"))
'compte 2834+2835+2838
Sheets("feuil23").Range("g129") = WorksheetFunction.Sum(Sheets("feuil23").Range("ag1:ag5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("ah1:ah5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("ai1:ai5000"))
'compte 284 sauf 2845
Sheets("feuil23").Range("g130") = WorksheetFunction.Sum(Sheets("feuil23").Range("aj1:aj5000"))
'compte 2845
Sheets("feuil23").Range("g131") = WorksheetFunction.Sum(Sheets("feuil23").Range("ak1:ak5000"))

'affecte SOLDE N-1 Tableau 2 - Amortissements
'compte 2811+28181
Sheets("feuil23").Range("b119") = WorksheetFunction.Sum(Sheets("feuil23").Range("al1:al5000"))
'compte 2812+2813+2814
Sheets("feuil23").Range("b120") = WorksheetFunction.Sum(Sheets("feuil23").Range("am1:am5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("an1:an5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("ao1:ao5000"))
'compte 2815+2816
Sheets("feuil23").Range("b121") = WorksheetFunction.Sum(Sheets("feuil23").Range("ap1:ap5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("aq1:aq5000"))
'compte 2817+2818
Sheets("feuil23").Range("b122") = WorksheetFunction.Sum(Sheets("feuil23").Range("ar1:ar5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("as1:as5000"))
'compte 282
Sheets("feuil23").Range("b125") = WorksheetFunction.Sum(Sheets("feuil23").Range("at1:at5000"))
'compte 28281
Sheets("feuil23").Range("b126") = WorksheetFunction.Sum(Sheets("feuil23").Range("cw1:cw5000"))
'compte 2831+2832+2833+2837
Sheets("feuil23").Range("b127") = WorksheetFunction.Sum(Sheets("feuil23").Range("au1:au5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("av1:av5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("aw1:aw5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("ax1:ax5000"))
'compte 28315+28325
Sheets("feuil23").Range("b128") = WorksheetFunction.Sum(Sheets("feuil23").Range("cx1:cx5000"))
'compte 2834+2835+2838
Sheets("feuil23").Range("b129") = WorksheetFunction.Sum(Sheets("feuil23").Range("ay1:ay5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("az1:az5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("ba1:ba5000"))
'compte 284 sauf 2845
Sheets("feuil23").Range("b130") = WorksheetFunction.Sum(Sheets("feuil23").Range("bb1:bb5000"))
'compte 2845
Sheets("feuil23").Range("b131") = WorksheetFunction.Sum(Sheets("feuil23").Range("bc1:bc5000"))

'affecte DIMINUTIONS Tableau 2 - Amortissements
'compte 2811+28181
Sheets("feuil23").Range("e119") = WorksheetFunction.Sum(Sheets("feuil23").Range("bd1:bd5000"))
'compte 2812+2813+2814
Sheets("feuil23").Range("e120") = WorksheetFunction.Sum(Sheets("feuil23").Range("be1:be5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("bf1:bf5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("bg1:bg5000"))
'compte 2815+2816
Sheets("feuil23").Range("e121") = WorksheetFunction.Sum(Sheets("feuil23").Range("bh1:bh5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("bi1:bi5000"))
'compte 2817+2818
Sheets("feuil23").Range("e122") = WorksheetFunction.Sum(Sheets("feuil23").Range("bj1:bj5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("bk1:bk5000"))
'compte 282
Sheets("feuil23").Range("e125") = WorksheetFunction.Sum(Sheets("feuil23").Range("bl1:bl5000"))
'compte 28281
Sheets("feuil23").Range("e126") = WorksheetFunction.Sum(Sheets("feuil23").Range("cy1:cy5000"))
'compte 2831+2832+2833+2837
Sheets("feuil23").Range("e127") = WorksheetFunction.Sum(Sheets("feuil23").Range("bm1:bm5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("bn1:bn5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("bo1:bo5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("bp1:bp5000"))
'compte 28315+28325
Sheets("feuil23").Range("e128") = WorksheetFunction.Sum(Sheets("feuil23").Range("cz1:cz5000"))
'compte 2834+2835+2838
Sheets("feuil23").Range("e129") = WorksheetFunction.Sum(Sheets("feuil23").Range("bq1:bq5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("br1:br5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("bs1:bs5000"))
'compte 284 sauf 2845
Sheets("feuil23").Range("e130") = WorksheetFunction.Sum(Sheets("feuil23").Range("bt1:bt5000"))
'compte 2845
Sheets("feuil23").Range("e131") = WorksheetFunction.Sum(Sheets("feuil23").Range("bu1:bu5000"))

'affecte AUGMENTATIONS Tableau 2 - Amortissements
'compte 2811+28181
Sheets("feuil23").Range("c119") = WorksheetFunction.Sum(Sheets("feuil23").Range("by1:by5000"))
'compte 2812+2813+2814
Sheets("feuil23").Range("c120") = WorksheetFunction.Sum(Sheets("feuil23").Range("bz1:bz5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("ca1:ca5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("cb1:cb5000"))
'compte 2815+2816
Sheets("feuil23").Range("c121") = WorksheetFunction.Sum(Sheets("feuil23").Range("cc1:cc5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("cd1:cd5000"))
'compte 2817+2818
Sheets("feuil23").Range("c122") = WorksheetFunction.Sum(Sheets("feuil23").Range("ce1:ce5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("cf1:cf5000"))
'compte 282
Sheets("feuil23").Range("c125") = WorksheetFunction.Sum(Sheets("feuil23").Range("cg1:cg5000"))
'compte 28281
Sheets("feuil23").Range("c126") = WorksheetFunction.Sum(Sheets("feuil23").Range("da1:da5000"))
'compte 2831+2832+2833+2837
Sheets("feuil23").Range("c127") = WorksheetFunction.Sum(Sheets("feuil23").Range("ch1:ch5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("ci1:ci5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("cj1:cj5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("ck1:ck5000"))
'compte 28315+28325
Sheets("feuil23").Range("c128") = WorksheetFunction.Sum(Sheets("feuil23").Range("db1:db5000"))
'compte 2834+2835+2838
Sheets("feuil23").Range("c129") = WorksheetFunction.Sum(Sheets("feuil23").Range("cl1:cl5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("cm1:cm5000")) + WorksheetFunction.Sum(Sheets("feuil23").Range("cn1:cn5000"))
'compte 284 sauf 2845
Sheets("feuil23").Range("c130") = WorksheetFunction.Sum(Sheets("feuil23").Range("co1:co5000"))
'compte 2845
Sheets("feuil23").Range("c131") = WorksheetFunction.Sum(Sheets("feuil23").Range("cp1:cp5000"))
'__________________________________________________________________________________________________
'Calculs du tableau 2 - Amortissements

'sous-total immob. incorporelles
Sheets("feuil23").Range("b123") = WorksheetFunction.Sum(Sheets("feuil23").Range("b119:b122")) 'SOLDE N-1
Sheets("feuil23").Range("c123") = WorksheetFunction.Sum(Sheets("feuil23").Range("c119:c122")) 'augmentation
Sheets("feuil23").Range("e123") = WorksheetFunction.Sum(Sheets("feuil23").Range("e119:e122")) 'diminution
Sheets("feuil23").Range("g123") = WorksheetFunction.Sum(Sheets("feuil23").Range("g119:g122")) 'SOLDE N

'sous-total immob. corporelles
Sheets("feuil23").Range("b132") = WorksheetFunction.Sum(Sheets("feuil23").Range("b125:b131")) 'SOLDE N-1
Sheets("feuil23").Range("c132") = WorksheetFunction.Sum(Sheets("feuil23").Range("c125:c131")) 'augmentation
Sheets("feuil23").Range("e132") = WorksheetFunction.Sum(Sheets("feuil23").Range("e125:e131")) 'diminution
Sheets("feuil23").Range("g132") = WorksheetFunction.Sum(Sheets("feuil23").Range("g125:g131")) 'SOLDE N

'total général
Sheets("feuil23").Range("b133") = Sheets("feuil23").Range("b123") + Sheets("feuil23").Range("b132") 'SOLDE N-1
Sheets("feuil23").Range("c133") = Sheets("feuil23").Range("c123") + Sheets("feuil23").Range("c132") 'augmentation
Sheets("feuil23").Range("e133") = Sheets("feuil23").Range("e123") + Sheets("feuil23").Range("e132") 'diminution
Sheets("feuil23").Range("g133") = Sheets("feuil23").Range("g123") + Sheets("feuil23").Range("g132") 'SOLDE N

'CALCUL ET AFFICHE LES ECRATS DU TABLEAU 2
For i = 119 To 133
If Sheets("feuil23").Cells(i, 2) + Sheets("feuil23").Cells(i, 3) - Sheets("feuil23").Cells(i, 5) - Sheets("feuil23").Cells(i, 7) = 0 Then
Else
Sheets("feuil23").Cells(i, 10) = "Ecart"
Sheets("feuil23").Cells(i, 11) = Sheets("feuil23").Cells(i, 2) + Sheets("feuil23").Cells(i, 3) - Sheets("feuil23").Cells(i, 5) - Sheets("feuil23").Cells(i, 7)
End If
Next
'___________________________________________________________________________________________________


'efface les recups de la feuil23
Sheets("feuil23").Range("t1:za5001").ClearContents


MsgBox "    FIN DE L'EDITION  !"

'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub annuler_note_3C()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du Tableau 2
Sheets("feuil23").Range("b119:k133").ClearContents
End If
End Sub
Private Sub note_28()
'condition générale de traitement de la NOTE 28
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 28
If Sheets("feuil5").Range("f47") + Sheets("feuil5").Range("m40") + Sheets("feuil5").Range("n40") = 0 Then
MsgBox "Désolé  !  Aucune provision au bilan comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 28
'annule les données du Tableau
Sheets("feuil10").Range("b15:l35").ClearContents


For i = 3 To 5000

'recup SOLDE N
'compte 15
If Left(Sheets("feuil2").Cells(i, 1), 2) = 15 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 8) 'T
Else
End If

'compte 19
If Left(Sheets("feuil2").Cells(i, 1), 2) = 19 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
Else
End If

'compte 29
If Left(Sheets("feuil2").Cells(i, 1), 2) = 29 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
Else
End If

'compte 39
If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
Else
End If

'compte 498
If Left(Sheets("feuil2").Cells(i, 1), 3) = 498 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
Else
End If

'compte 490
If Left(Sheets("feuil2").Cells(i, 1), 3) = 490 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 8) 'Y
Else
End If

'compte 491
If Left(Sheets("feuil2").Cells(i, 1), 3) = 491 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 8) 'Z
Else
End If

'compte 492 + 493 + 494 + 495 + 496 + 497
If Left(Sheets("feuil2").Cells(i, 1), 3) = 492 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 493 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 494 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 495 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 496 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 497 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 8) 'AA
Else
End If

'compte 590
If Left(Sheets("feuil2").Cells(i, 1), 3) = 590 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 8) 'AB
Else
End If

'compte 591
If Left(Sheets("feuil2").Cells(i, 1), 3) = 591 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 8) 'AC
Else
End If

'compte 592 + 593 + 594
If Left(Sheets("feuil2").Cells(i, 1), 3) = 592 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 593 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 594 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
Else
End If

'compte 499
If Left(Sheets("feuil2").Cells(i, 1), 3) = 499 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 8) 'AE
Else
End If

'compte 599
If Left(Sheets("feuil2").Cells(i, 1), 3) = 599 Then
Sheets("feuil2").Cells(i, 32) = Sheets("feuil2").Cells(i, 8) 'AF
Else
End If



'recup AUGMENTATIONS N
'compte 15
If Left(Sheets("feuil2").Cells(i, 1), 2) = 15 Then
Sheets("feuil2").Cells(i, 33) = Sheets("feuil2").Cells(i, 6) 'AG
Else
End If

'compte 19
If Left(Sheets("feuil2").Cells(i, 1), 2) = 19 Then
Sheets("feuil2").Cells(i, 34) = Sheets("feuil2").Cells(i, 6) 'AH
Else
End If

'compte 29
If Left(Sheets("feuil2").Cells(i, 1), 2) = 29 Then
Sheets("feuil2").Cells(i, 35) = Sheets("feuil2").Cells(i, 6) 'AI
Else
End If

'compte 39
If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
Sheets("feuil2").Cells(i, 36) = Sheets("feuil2").Cells(i, 6) 'AJ
Else
End If

'compte 498
If Left(Sheets("feuil2").Cells(i, 1), 3) = 498 Then
Sheets("feuil2").Cells(i, 37) = Sheets("feuil2").Cells(i, 6) 'AK
Else
End If

'compte 490
If Left(Sheets("feuil2").Cells(i, 1), 3) = 490 Then
Sheets("feuil2").Cells(i, 38) = Sheets("feuil2").Cells(i, 6) 'AL
Else
End If

'compte 491
If Left(Sheets("feuil2").Cells(i, 1), 3) = 491 Then
Sheets("feuil2").Cells(i, 39) = Sheets("feuil2").Cells(i, 6) 'AM
Else
End If

'compte 492 + 493 + 494 + 495 + 496 + 497
If Left(Sheets("feuil2").Cells(i, 1), 3) = 492 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 493 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 494 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 495 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 496 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 497 Then
Sheets("feuil2").Cells(i, 40) = Sheets("feuil2").Cells(i, 6) 'AN
Else
End If

'compte 590
If Left(Sheets("feuil2").Cells(i, 1), 3) = 590 Then
Sheets("feuil2").Cells(i, 41) = Sheets("feuil2").Cells(i, 6) 'AO
Else
End If

'compte 591
If Left(Sheets("feuil2").Cells(i, 1), 3) = 591 Then
Sheets("feuil2").Cells(i, 42) = Sheets("feuil2").Cells(i, 6) 'AP
Else
End If

'compte 592 + 593 + 594
If Left(Sheets("feuil2").Cells(i, 1), 3) = 592 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 593 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 594 Then
Sheets("feuil2").Cells(i, 43) = Sheets("feuil2").Cells(i, 6) 'AQ
Else
End If

'compte 499
If Left(Sheets("feuil2").Cells(i, 1), 3) = 499 Then
Sheets("feuil2").Cells(i, 44) = Sheets("feuil2").Cells(i, 6) 'AR
Else
End If

'compte 599
If Left(Sheets("feuil2").Cells(i, 1), 3) = 599 Then
Sheets("feuil2").Cells(i, 45) = Sheets("feuil2").Cells(i, 6) 'AS
Else
End If



'recup DIMINUTIONS N
'compte 15
If Left(Sheets("feuil2").Cells(i, 1), 2) = 15 Then
Sheets("feuil2").Cells(i, 46) = Sheets("feuil2").Cells(i, 5) 'AT
Else
End If

'compte 19
If Left(Sheets("feuil2").Cells(i, 1), 2) = 19 Then
Sheets("feuil2").Cells(i, 47) = Sheets("feuil2").Cells(i, 5) 'AU
Else
End If

'compte 29
If Left(Sheets("feuil2").Cells(i, 1), 2) = 29 Then
Sheets("feuil2").Cells(i, 48) = Sheets("feuil2").Cells(i, 5) 'AV
Else
End If

'compte 39
If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
Sheets("feuil2").Cells(i, 49) = Sheets("feuil2").Cells(i, 5) 'AW
Else
End If

'compte 498
If Left(Sheets("feuil2").Cells(i, 1), 3) = 498 Then
Sheets("feuil2").Cells(i, 50) = Sheets("feuil2").Cells(i, 5) 'AX
Else
End If

'compte 490
If Left(Sheets("feuil2").Cells(i, 1), 3) = 490 Then
Sheets("feuil2").Cells(i, 51) = Sheets("feuil2").Cells(i, 5) 'AY
Else
End If

'compte 491
If Left(Sheets("feuil2").Cells(i, 1), 3) = 491 Then
Sheets("feuil2").Cells(i, 52) = Sheets("feuil2").Cells(i, 5) 'AZ
Else
End If

'compte 492 + 493 + 494 + 495 + 496 + 497
If Left(Sheets("feuil2").Cells(i, 1), 3) = 492 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 493 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 494 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 495 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 496 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 497 Then
Sheets("feuil2").Cells(i, 53) = Sheets("feuil2").Cells(i, 5) 'BA
Else
End If

'compte 590
If Left(Sheets("feuil2").Cells(i, 1), 3) = 590 Then
Sheets("feuil2").Cells(i, 54) = Sheets("feuil2").Cells(i, 5) 'BB
Else
End If

'compte 591
If Left(Sheets("feuil2").Cells(i, 1), 3) = 591 Then
Sheets("feuil2").Cells(i, 55) = Sheets("feuil2").Cells(i, 5) 'BC
Else
End If

'compte 592 + 593 + 594
If Left(Sheets("feuil2").Cells(i, 1), 3) = 592 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 593 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 594 Then
Sheets("feuil2").Cells(i, 56) = Sheets("feuil2").Cells(i, 5) 'BD
Else
End If

'compte 499
If Left(Sheets("feuil2").Cells(i, 1), 3) = 499 Then
Sheets("feuil2").Cells(i, 57) = Sheets("feuil2").Cells(i, 5) 'BE
Else
End If

'compte 599
If Left(Sheets("feuil2").Cells(i, 1), 3) = 599 Then
Sheets("feuil2").Cells(i, 58) = Sheets("feuil2").Cells(i, 5) 'BF
Else
End If




'recup SOLDE N-1
'compte 15
If Left(Sheets("feuil1").Cells(i, 1), 2) = 15 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 8) 'T
Else
End If

'compte 19
If Left(Sheets("feuil1").Cells(i, 1), 2) = 19 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'U
Else
End If

'compte 29
If Left(Sheets("feuil1").Cells(i, 1), 2) = 29 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
Else
End If

'compte 39
If Left(Sheets("feuil1").Cells(i, 1), 2) = 39 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'W
Else
End If

'compte 498
If Left(Sheets("feuil1").Cells(i, 1), 3) = 498 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 8) 'X
Else
End If

'compte 490
If Left(Sheets("feuil1").Cells(i, 1), 3) = 490 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 8) 'Y
Else
End If

'compte 491
If Left(Sheets("feuil1").Cells(i, 1), 3) = 491 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 8) 'Z
Else
End If

'compte 492 + 493 + 494 + 495 + 496 + 497
If Left(Sheets("feuil1").Cells(i, 1), 3) = 492 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 493 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 494 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 495 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 496 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 497 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 8) 'AA
Else
End If

'compte 590
If Left(Sheets("feuil1").Cells(i, 1), 3) = 590 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 8) 'AB
Else
End If

'compte 591
If Left(Sheets("feuil1").Cells(i, 1), 3) = 591 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 8) 'AC
Else
End If

'compte 592 + 593 + 594
If Left(Sheets("feuil1").Cells(i, 1), 3) = 592 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 593 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 594 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'AD
Else
End If

'compte 499
If Left(Sheets("feuil1").Cells(i, 1), 3) = 499 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 8) 'AE
Else
End If

'compte 599
If Left(Sheets("feuil1").Cells(i, 1), 3) = 599 Then
Sheets("feuil1").Cells(i, 32) = Sheets("feuil1").Cells(i, 8) 'AF
Else
End If


Next

'____________________________________________________________________________________________________________


'affectation des SOLDES N
Sheets("feuil10").Range("j15") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'provisions reglementées
Sheets("feuil10").Range("j16") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'provisions financières
Sheets("feuil10").Range("j17") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'provisions immob.
Sheets("feuil10").Range("j20") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'provisions stocks
Sheets("feuil10").Range("j21") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'provisions actif HAO
Sheets("feuil10").Range("j22") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'provisions fournisseurs
Sheets("feuil10").Range("j23") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'provisions clients
Sheets("feuil10").Range("j24") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'provisions autres créances
Sheets("feuil10").Range("j25") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'provisions titres de placement
Sheets("feuil10").Range("j26") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'provisions valeurs à encaisser
Sheets("feuil10").Range("j27") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'provisions disponibilié
Sheets("feuil10").Range("j29") = WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000")) 'provisions risques d'exploitation
Sheets("feuil10").Range("j31") = WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000")) 'provisions risques financiers

'affectation des AUGMENTATIONS
Sheets("feuil10").Range("e15") = WorksheetFunction.Sum(Sheets("feuil2").Range("ag1:ag5000")) 'provisions reglementées
Sheets("feuil10").Range("d16") = WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000")) 'provisions financières
Sheets("feuil10").Range("c17") = WorksheetFunction.Sum(Sheets("feuil2").Range("ai1:ai5000")) 'provisions immob.
Sheets("feuil10").Range("c20") = WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) 'provisions stocks
Sheets("feuil10").Range("e21") = WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) 'provisions actif HAO
Sheets("feuil10").Range("c22") = WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) 'provisions fournisseurs
Sheets("feuil10").Range("c23") = WorksheetFunction.Sum(Sheets("feuil2").Range("am1:am5000")) 'provisions clients
Sheets("feuil10").Range("c24") = WorksheetFunction.Sum(Sheets("feuil2").Range("an1:an5000")) 'provisions autres créances
Sheets("feuil10").Range("d25") = WorksheetFunction.Sum(Sheets("feuil2").Range("ao1:ao5000")) 'provisions titres de placement
Sheets("feuil10").Range("d26") = WorksheetFunction.Sum(Sheets("feuil2").Range("ap1:ap5000")) 'provisions valeurs à encaisser
Sheets("feuil10").Range("d27") = WorksheetFunction.Sum(Sheets("feuil2").Range("aq1:aq5000")) 'provisions disponibilié
Sheets("feuil10").Range("c29") = WorksheetFunction.Sum(Sheets("feuil2").Range("ar1:ar5000")) 'provisions risques d'exploitation
Sheets("feuil10").Range("d31") = WorksheetFunction.Sum(Sheets("feuil2").Range("as1:as5000")) 'provisions risques financiers

'affectation des DIMINUTIONS
Sheets("feuil10").Range("h15") = WorksheetFunction.Sum(Sheets("feuil2").Range("at1:at5000")) 'provisions reglementées
Sheets("feuil10").Range("g16") = WorksheetFunction.Sum(Sheets("feuil2").Range("au1:au5000")) 'provisions financières
Sheets("feuil10").Range("f17") = WorksheetFunction.Sum(Sheets("feuil2").Range("av1:av5000")) 'provisions immob.
Sheets("feuil10").Range("f20") = WorksheetFunction.Sum(Sheets("feuil2").Range("aw1:aw5000")) 'provisions stocks
Sheets("feuil10").Range("h21") = WorksheetFunction.Sum(Sheets("feuil2").Range("ax1:ax5000")) 'provisions actif HAO
Sheets("feuil10").Range("f22") = WorksheetFunction.Sum(Sheets("feuil2").Range("ay1:ay5000")) 'provisions fournisseurs
Sheets("feuil10").Range("f23") = WorksheetFunction.Sum(Sheets("feuil2").Range("az1:az5000")) 'provisions clients
Sheets("feuil10").Range("f24") = WorksheetFunction.Sum(Sheets("feuil2").Range("ba1:ba5000")) 'provisions autres créances
Sheets("feuil10").Range("g25") = WorksheetFunction.Sum(Sheets("feuil2").Range("bb1:bb5000")) 'provisions titres de placement
Sheets("feuil10").Range("g26") = WorksheetFunction.Sum(Sheets("feuil2").Range("bc1:bc5000")) 'provisions valeurs à encaisser
Sheets("feuil10").Range("g27") = WorksheetFunction.Sum(Sheets("feuil2").Range("bd1:bd5000")) 'provisions disponibilié
Sheets("feuil10").Range("f29") = WorksheetFunction.Sum(Sheets("feuil2").Range("be1:be5000")) 'provisions risques d'exploitation
Sheets("feuil10").Range("g31") = WorksheetFunction.Sum(Sheets("feuil2").Range("bf1:bf5000")) 'provisions risques financiers

'affectation des SOLDES N-1
Sheets("feuil10").Range("b15") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'provisions reglementées
Sheets("feuil10").Range("b16") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'provisions financières
Sheets("feuil10").Range("b17") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'provisions immob.
Sheets("feuil10").Range("b20") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'provisions stocks
Sheets("feuil10").Range("b21") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'provisions actif HAO
Sheets("feuil10").Range("b22") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'provisions fournisseurs
Sheets("feuil10").Range("b23") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'provisions clients
Sheets("feuil10").Range("b24") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'provisions autres créances
Sheets("feuil10").Range("b25") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'provisions titres de placement
Sheets("feuil10").Range("b26") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'provisions valeurs à encaisser
Sheets("feuil10").Range("b27") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'provisions disponibilié
Sheets("feuil10").Range("b29") = WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000")) 'provisions risques d'exploitation
Sheets("feuil10").Range("b31") = WorksheetFunction.Sum(Sheets("feuil1").Range("af1:af5000")) 'provisions risques financiers

'________________________________________________________________________________________________________________

'Calculs du tableau
'Total dotations
Sheets("feuil10").Range("b18") = WorksheetFunction.Sum(Sheets("feuil10").Range("b15:b17")) 'mtt à l'ouverture
Sheets("feuil10").Range("c18") = WorksheetFunction.Sum(Sheets("feuil10").Range("c15:c17")) 'augmentation exploitation
Sheets("feuil10").Range("d18") = WorksheetFunction.Sum(Sheets("feuil10").Range("d15:d17")) 'augmentation financier
Sheets("feuil10").Range("e18") = WorksheetFunction.Sum(Sheets("feuil10").Range("e15:e17")) 'augmentation HAO
Sheets("feuil10").Range("f18") = WorksheetFunction.Sum(Sheets("feuil10").Range("f15:f17")) 'diminution exploitation
Sheets("feuil10").Range("g18") = WorksheetFunction.Sum(Sheets("feuil10").Range("g15:g17")) 'diminution financier
Sheets("feuil10").Range("h18") = WorksheetFunction.Sum(Sheets("feuil10").Range("h15:h17")) 'diminution HAO
Sheets("feuil10").Range("j18") = WorksheetFunction.Sum(Sheets("feuil10").Range("j15:j17")) 'mtt à la clôture

'Total charges pour dépréciations
Sheets("feuil10").Range("b32") = WorksheetFunction.Sum(Sheets("feuil10").Range("b20:b31")) 'mtt à l'ouverture
Sheets("feuil10").Range("c32") = WorksheetFunction.Sum(Sheets("feuil10").Range("c20:c31")) 'augmentation exploitation
Sheets("feuil10").Range("d32") = WorksheetFunction.Sum(Sheets("feuil10").Range("d20:d31")) 'augmentation financier
Sheets("feuil10").Range("e32") = WorksheetFunction.Sum(Sheets("feuil10").Range("e20:e31")) 'augmentation HAO
Sheets("feuil10").Range("f32") = WorksheetFunction.Sum(Sheets("feuil10").Range("f20:f31")) 'diminution exploitation
Sheets("feuil10").Range("g32") = WorksheetFunction.Sum(Sheets("feuil10").Range("g20:g31")) 'diminution financier
Sheets("feuil10").Range("h32") = WorksheetFunction.Sum(Sheets("feuil10").Range("h20:h31")) 'diminution HAO
Sheets("feuil10").Range("j32") = WorksheetFunction.Sum(Sheets("feuil10").Range("j20:j31")) 'mtt à la clôture

'Total général
Sheets("feuil10").Range("b34") = Sheets("feuil10").Range("b18") + Sheets("feuil10").Range("b32") 'mtt à l'ouverture
Sheets("feuil10").Range("c34") = Sheets("feuil10").Range("c18") + Sheets("feuil10").Range("c32") 'augmentation exploitation
Sheets("feuil10").Range("d34") = Sheets("feuil10").Range("d18") + Sheets("feuil10").Range("d32") 'augmentation financier
Sheets("feuil10").Range("e34") = Sheets("feuil10").Range("e18") + Sheets("feuil10").Range("e32") 'augmentation HAO
Sheets("feuil10").Range("f34") = Sheets("feuil10").Range("f18") + Sheets("feuil10").Range("f32") 'diminution exploitation
Sheets("feuil10").Range("g34") = Sheets("feuil10").Range("g18") + Sheets("feuil10").Range("g32") 'diminution financier
Sheets("feuil10").Range("h34") = Sheets("feuil10").Range("h18") + Sheets("feuil10").Range("h32") 'diminution HAO
Sheets("feuil10").Range("j34") = Sheets("feuil10").Range("j18") + Sheets("feuil10").Range("j32") 'mtt à la clôture


'CALCUL ET AFFICHE LES ECRATS DE LA NOTE 28
For i = 15 To 34
If Sheets("feuil10").Cells(i, 2) + Sheets("feuil10").Cells(i, 3) + Sheets("feuil10").Cells(i, 4) + Sheets("feuil10").Cells(i, 5) - Sheets("feuil10").Cells(i, 6) - Sheets("feuil10").Cells(i, 7) - Sheets("feuil10").Cells(i, 8) - Sheets("feuil10").Cells(i, 10) = 0 Then
Else
Sheets("feuil10").Cells(i, 11) = "Ecart"
Sheets("feuil10").Cells(i, 12) = Sheets("feuil10").Cells(i, 2) + Sheets("feuil10").Cells(i, 3) + Sheets("feuil10").Cells(i, 4) + Sheets("feuil10").Cells(i, 5) - Sheets("feuil10").Cells(i, 6) - Sheets("feuil10").Cells(i, 7) - Sheets("feuil10").Cells(i, 8) - Sheets("feuil10").Cells(i, 10)
End If

Next

'____________________________________________________________________________________________________________________


'annule les données de la feuil1 et feuil2
Sheets("feuil1").Range("t1:za5001").ClearContents
Sheets("feuil2").Range("t1:za5001").ClearContents


MsgBox "    FIN DE L'EDITION  !"


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale d'édition
End If

End Sub
Private Sub annuler_note_28()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du Tableau
Sheets("feuil10").Range("b15:l35").ClearContents
End If
End Sub
Private Sub note_31()
'condition générale de traitement de la NOTE 31
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else


'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 31
'annule les données du tableau
Sheets("feuil16").Range("f13:g34").ClearContents

For i = 3 To 5000

'recup Masse salariale N
'compte 661+662+663
If Left(Sheets("feuil2").Cells(i, 1), 3) = 661 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 662 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 663 Then
Sheets("feuil16").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'recup Avantages sociaux N
'compte 664+668
If Left(Sheets("feuil2").Cells(i, 1), 3) = 664 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 668 Then
Sheets("feuil16").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'recup Personnel extérieur N
'compte 667
If Left(Sheets("feuil2").Cells(i, 1), 3) = 667 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 637 Then
Sheets("feuil16").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If


'recup Masse salariale N-1
'compte 661+662+663
If Left(Sheets("feuil1").Cells(i, 1), 3) = 661 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 662 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 663 Then
Sheets("feuil16").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'recup Avantages sociaux N-1
'compte 664+668
If Left(Sheets("feuil1").Cells(i, 1), 3) = 664 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 668 Then
Sheets("feuil16").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'recup Personnel extérieur N-1
'compte 667
If Left(Sheets("feuil1").Cells(i, 1), 3) = 667 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 637 Then
Sheets("feuil16").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If


Next


'_____________________________________________________________________________________________________________

'affectation colonne N
Sheets("feuil16").Range("f13") = Sheets("feuil5").Range("m13") 'capital social
Sheets("feuil16").Range("f20") = Sheets("feuil6").Range("i20") 'chiffre d'affaires
Sheets("feuil16").Range("f22") = Sheets("feuil6").Range("i36") + Sheets("feuil6").Range("i40") + Sheets("feuil6").Range("i42") + Sheets("feuil6").Range("i43") 'résultat A.O. sauf dotations et reprises
Sheets("feuil16").Range("f23") = -Sheets("feuil6").Range("i52") 'participation des travailleurs
Sheets("feuil16").Range("f24") = -Sheets("feuil6").Range("i53") 'impôts sur le résultat
Sheets("feuil16").Range("f25") = Sheets("feuil6").Range("i54") 'résultat net
Sheets("feuil16").Range("f32") = WorksheetFunction.Sum(Sheets("feuil16").Range("t1:t5000")) 'masse salariale
Sheets("feuil16").Range("f33") = WorksheetFunction.Sum(Sheets("feuil16").Range("u1:u5000")) 'avantages sociaux
Sheets("feuil16").Range("f34") = WorksheetFunction.Sum(Sheets("feuil16").Range("v1:v5000")) 'personnel extérieur

'affectation colonne N-1
Sheets("feuil16").Range("g13") = Sheets("feuil5").Range("n13") 'capital social
Sheets("feuil16").Range("g20") = Sheets("feuil6").Range("j20") 'chiffre d'affaires
Sheets("feuil16").Range("g22") = Sheets("feuil6").Range("j36") + Sheets("feuil6").Range("j40") + Sheets("feuil6").Range("j42") + Sheets("feuil6").Range("j43") 'résultat A.O. sauf dotations et reprises
Sheets("feuil16").Range("g23") = -Sheets("feuil6").Range("j52") 'participation des travailleurs
Sheets("feuil16").Range("g24") = -Sheets("feuil6").Range("j53") 'impôts sur le résultat
Sheets("feuil16").Range("g25") = Sheets("feuil6").Range("j54") 'résultat net
Sheets("feuil16").Range("g27") = Sheets("feuil5").Range("n21") - (Sheets("feuil5").Range("m17") + Sheets("feuil5").Range("m18") + Sheets("feuil5").Range("m19") - Sheets("feuil5").Range("n17") - Sheets("feuil5").Range("n18") - Sheets("feuil5").Range("n19")) 'résultat distribué
Sheets("feuil16").Range("g32") = WorksheetFunction.Sum(Sheets("feuil16").Range("w1:w5000")) 'masse salariale
Sheets("feuil16").Range("g33") = WorksheetFunction.Sum(Sheets("feuil16").Range("x1:x5000")) 'avantages sociaux
Sheets("feuil16").Range("g34") = WorksheetFunction.Sum(Sheets("feuil16").Range("y1:y5000")) 'personnel extérieur

'__________________________________________________________________________________________________________


'efface les données sur la feuil16
Sheets("feuil16").Range("t1:za5001").ClearContents

MsgBox "    FIN DE L'EDITION  !"


'demande de confirmation
End If

'condition d'édition
End If
End Sub
Private Sub annuler_note_31()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil16").Range("f13:g34").ClearContents
End If
End Sub
Private Sub détail_charges_dgi()
'condition d'édition du détail charges dgi
If WorksheetFunction.Sum(Sheets("feuil2").Range("g1:h5000")) = 0 Then

'affiche uniquement le détail charges dgi
Sheets("feuil20").Activate
Else

'condition de traitement des données du détail charges dgi
If WorksheetFunction.Sum(Sheets("feuil7").Range("h18:h22")) + WorksheetFunction.Sum(Sheets("feuil13").Range("g24:g49")) = 0 Then
MsgBox "Veuillez éditer vos Etats N pour renseigner le Détail des charges DGI !"
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition du Détail des charges DGI ?", vbYesNo, "Demande de confirmation") = vbYes Then

For i = 1 To 5000
'traitement du Détail des charges dgi
'recup SOLDE N
'compte 6011
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6011 Then
Sheets("feuil20").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 6012
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6012 Then
Sheets("feuil20").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 6013
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6013 Then
Sheets("feuil20").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 6014
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6014 Then
Sheets("feuil20").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 6019
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6019 Then
Sheets("feuil20").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
Else
End If

'compte 6031
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6031 Then
Sheets("feuil20").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) - Sheets("feuil2").Cells(i, 8) 'Y
Else
End If

'compte 6021
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6021 Then
Sheets("feuil20").Cells(i, 26) = Sheets("feuil2").Cells(i, 7) 'Z
Else
End If

'compte 6022
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6022 Then
Sheets("feuil20").Cells(i, 27) = Sheets("feuil2").Cells(i, 7) 'AA
Else
End If

'compte 6023
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6023 Then
Sheets("feuil20").Cells(i, 28) = Sheets("feuil2").Cells(i, 7) 'AB
Else
End If

'compte 6024
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6024 Then
Sheets("feuil20").Cells(i, 29) = Sheets("feuil2").Cells(i, 7) 'AC
Else
End If

'compte 6029
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6029 Then
Sheets("feuil20").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
Else
End If

'compte 6032
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6032 Then
Sheets("feuil20").Cells(i, 31) = Sheets("feuil2").Cells(i, 7) - Sheets("feuil2").Cells(i, 8) 'AE
Else
End If

'compte 6041
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6041 Then
Sheets("feuil20").Cells(i, 32) = Sheets("feuil2").Cells(i, 7) 'AF
Else
End If

'compte 6042
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6042 Then
Sheets("feuil20").Cells(i, 33) = Sheets("feuil2").Cells(i, 7) 'AG
Else
End If

'compte 6043
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6043 Then
Sheets("feuil20").Cells(i, 34) = Sheets("feuil2").Cells(i, 7) 'AH
Else
End If

'compte 6044
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6044 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6045 Then
Sheets("feuil20").Cells(i, 35) = Sheets("feuil2").Cells(i, 7) 'AI
Else
End If

'compte 6046
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6046 Then
Sheets("feuil20").Cells(i, 36) = Sheets("feuil2").Cells(i, 7) 'AJ
Else
End If

'compte 6047
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6047 Then
Sheets("feuil20").Cells(i, 37) = Sheets("feuil2").Cells(i, 7) 'AK
Else
End If

'compte 6049
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6049 Then
Sheets("feuil20").Cells(i, 38) = Sheets("feuil2").Cells(i, 8) 'AL
Else
End If

'compte 6051
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6051 Then
Sheets("feuil20").Cells(i, 39) = Sheets("feuil2").Cells(i, 7) 'AM
Else
End If

'compte 6052
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6052 Then
Sheets("feuil20").Cells(i, 40) = Sheets("feuil2").Cells(i, 7) 'AN
Else
End If

'compte 6053
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6053 Then
Sheets("feuil20").Cells(i, 41) = Sheets("feuil2").Cells(i, 7) 'AO
Else
End If

'compte 6054
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6054 Then
Sheets("feuil20").Cells(i, 42) = Sheets("feuil2").Cells(i, 7) 'AP
Else
End If

'compte 6055
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6055 Then
Sheets("feuil20").Cells(i, 43) = Sheets("feuil2").Cells(i, 7) 'AQ
Else
End If

'compte 6056
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6056 Then
Sheets("feuil20").Cells(i, 44) = Sheets("feuil2").Cells(i, 7) 'AR
Else
End If

'compte 6057
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6057 Then
Sheets("feuil20").Cells(i, 45) = Sheets("feuil2").Cells(i, 7) 'AS
Else
End If

'compte 6058
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6058 Then
Sheets("feuil20").Cells(i, 46) = Sheets("feuil2").Cells(i, 7) 'AT
Else
End If

'compte 6059
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6059 Then
Sheets("feuil20").Cells(i, 47) = Sheets("feuil2").Cells(i, 8) 'AU
Else
End If

'compte 6081
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6081 Then
Sheets("feuil20").Cells(i, 48) = Sheets("feuil2").Cells(i, 7) 'AV
Else
End If

'compte 6082
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6082 Then
Sheets("feuil20").Cells(i, 49) = Sheets("feuil2").Cells(i, 7) 'AW
Else
End If

'compte 6083
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6083 Then
Sheets("feuil20").Cells(i, 50) = Sheets("feuil2").Cells(i, 7) 'AX
Else
End If

'compte 6089
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6089 Then
Sheets("feuil20").Cells(i, 51) = Sheets("feuil2").Cells(i, 8) 'AY
Else
End If

'compte 6033
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6033 Then
Sheets("feuil20").Cells(i, 52) = Sheets("feuil2").Cells(i, 7) - Sheets("feuil2").Cells(i, 8) 'AZ
Else
End If

'compte 611
If Left(Sheets("feuil2").Cells(i, 1), 3) = 611 Then
Sheets("feuil20").Cells(i, 53) = Sheets("feuil2").Cells(i, 7) 'BA
Else
End If

'compte 612
If Left(Sheets("feuil2").Cells(i, 1), 3) = 612 Then
Sheets("feuil20").Cells(i, 54) = Sheets("feuil2").Cells(i, 7) 'BB
Else
End If

'compte 613
If Left(Sheets("feuil2").Cells(i, 1), 3) = 613 Then
Sheets("feuil20").Cells(i, 55) = Sheets("feuil2").Cells(i, 7) 'BC
Else
End If

'compte 614
If Left(Sheets("feuil2").Cells(i, 1), 3) = 614 Then
Sheets("feuil20").Cells(i, 56) = Sheets("feuil2").Cells(i, 7) 'BD
Else
End If

'compte 616
If Left(Sheets("feuil2").Cells(i, 1), 3) = 616 Then
Sheets("feuil20").Cells(i, 57) = Sheets("feuil2").Cells(i, 7) 'BE
Else
End If

'compte 6181
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6181 Then
Sheets("feuil20").Cells(i, 58) = Sheets("feuil2").Cells(i, 7) 'BF
Else
End If

'compte 6182
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6182 Then
Sheets("feuil20").Cells(i, 59) = Sheets("feuil2").Cells(i, 7) 'BG
Else
End If

'compte 6183
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6183 Then
Sheets("feuil20").Cells(i, 60) = Sheets("feuil2").Cells(i, 7) 'BH
Else
End If

'compte 621
If Left(Sheets("feuil2").Cells(i, 1), 3) = 621 Then
Sheets("feuil20").Cells(i, 61) = Sheets("feuil2").Cells(i, 7) 'BI
Else
End If

'compte 6221
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6221 Then
Sheets("feuil20").Cells(i, 62) = Sheets("feuil2").Cells(i, 7) 'BJ
Else
End If

'compte 6222
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6222 Then
Sheets("feuil20").Cells(i, 63) = Sheets("feuil2").Cells(i, 7) 'BK
Else
End If

'compte 6223
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6223 Then
Sheets("feuil20").Cells(i, 64) = Sheets("feuil2").Cells(i, 7) 'BL
Else
End If

'compte 6224
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6224 Then
Sheets("feuil20").Cells(i, 65) = Sheets("feuil2").Cells(i, 7) 'BM
Else
End If

'compte 6225
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6225 Then
Sheets("feuil20").Cells(i, 66) = Sheets("feuil2").Cells(i, 7) 'BN
Else
End If

'compte 6228
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6228 Then
Sheets("feuil20").Cells(i, 67) = Sheets("feuil2").Cells(i, 7) 'BO
Else
End If

'compte 623
If Left(Sheets("feuil2").Cells(i, 1), 3) = 623 Then
Sheets("feuil20").Cells(i, 68) = Sheets("feuil2").Cells(i, 7) 'BP
Else
End If

'compte 6241
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6241 Then
Sheets("feuil20").Cells(i, 69) = Sheets("feuil2").Cells(i, 7) 'BQ
Else
End If

'compte 6242
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6242 Then
Sheets("feuil20").Cells(i, 70) = Sheets("feuil2").Cells(i, 7) 'BR
Else
End If

'compte 6243
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6243 Then
Sheets("feuil20").Cells(i, 71) = Sheets("feuil2").Cells(i, 7) 'BS
Else
End If

'compte 6248
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6248 Then
Sheets("feuil20").Cells(i, 72) = Sheets("feuil2").Cells(i, 7) 'BT
Else
End If

'compte 625
If Left(Sheets("feuil2").Cells(i, 1), 3) = 625 Then
Sheets("feuil20").Cells(i, 73) = Sheets("feuil2").Cells(i, 7) 'BU
Else
End If

'compte 6261
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6261 Then
Sheets("feuil20").Cells(i, 74) = Sheets("feuil2").Cells(i, 7) 'BV
Else
End If

'compte 6265
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6265 Then
Sheets("feuil20").Cells(i, 75) = Sheets("feuil2").Cells(i, 7) 'BW
Else
End If

'compte 6266
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6266 Then
Sheets("feuil20").Cells(i, 76) = Sheets("feuil2").Cells(i, 7) 'BX
Else
End If

'compte 627
If Left(Sheets("feuil2").Cells(i, 1), 3) = 627 Then
Sheets("feuil20").Cells(i, 77) = Sheets("feuil2").Cells(i, 7) 'BY
Else
End If

'compte 628
If Left(Sheets("feuil2").Cells(i, 1), 3) = 628 Then
Sheets("feuil20").Cells(i, 78) = Sheets("feuil2").Cells(i, 7) 'BZ
Else
End If

'compte 631
If Left(Sheets("feuil2").Cells(i, 1), 3) = 631 Then
Sheets("feuil20").Cells(i, 79) = Sheets("feuil2").Cells(i, 7) 'CA
Else
End If

'compte 6321
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6321 Then
Sheets("feuil20").Cells(i, 80) = Sheets("feuil2").Cells(i, 7) 'CB
Else
End If

'compte 6322
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6322 Then
Sheets("feuil20").Cells(i, 81) = Sheets("feuil2").Cells(i, 7) 'CC
Else
End If

'compte 6323
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6323 Then
Sheets("feuil20").Cells(i, 82) = Sheets("feuil2").Cells(i, 7) 'CD
Else
End If

'compte 6324
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6324 Then
Sheets("feuil20").Cells(i, 83) = Sheets("feuil2").Cells(i, 7) 'CE
Else
End If

'compte 6325
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6325 Then
Sheets("feuil20").Cells(i, 84) = Sheets("feuil2").Cells(i, 7) 'CF
Else
End If

'compte 6328
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6328 Then
Sheets("feuil20").Cells(i, 85) = Sheets("feuil2").Cells(i, 7) 'CG
Else
End If

'compte 6329
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6329 Then
Sheets("feuil20").Cells(i, 86) = Sheets("feuil2").Cells(i, 7) 'CH
Else
End If

'compte 633
If Left(Sheets("feuil2").Cells(i, 1), 3) = 633 Then
Sheets("feuil20").Cells(i, 87) = Sheets("feuil2").Cells(i, 7) 'CI
Else
End If

'compte 634
If Left(Sheets("feuil2").Cells(i, 1), 3) = 634 Then
Sheets("feuil20").Cells(i, 88) = Sheets("feuil2").Cells(i, 7) 'CJ
Else
End If

'compte 635
If Left(Sheets("feuil2").Cells(i, 1), 3) = 635 Then
Sheets("feuil20").Cells(i, 89) = Sheets("feuil2").Cells(i, 7) 'CK
Else
End If

'compte 637
If Left(Sheets("feuil2").Cells(i, 1), 3) = 637 Then
Sheets("feuil20").Cells(i, 90) = Sheets("feuil2").Cells(i, 7) 'CL
Else
End If

'compte 6381
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6381 Then
Sheets("feuil20").Cells(i, 91) = Sheets("feuil2").Cells(i, 7) 'CM
Else
End If

'compte 6382
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6382 Then
Sheets("feuil20").Cells(i, 92) = Sheets("feuil2").Cells(i, 7) 'CN
Else
End If

'compte 6383
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6383 Then
Sheets("feuil20").Cells(i, 93) = Sheets("feuil2").Cells(i, 7) 'CO
Else
End If

'compte 6384
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6384 Then
Sheets("feuil20").Cells(i, 94) = Sheets("feuil2").Cells(i, 7) 'CP
Else
End If

'compte 6411
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6411 Then
Sheets("feuil20").Cells(i, 95) = Sheets("feuil2").Cells(i, 7) 'CQ
Else
End If

'compte 6412
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6412 Then
Sheets("feuil20").Cells(i, 96) = Sheets("feuil2").Cells(i, 7) 'CR
Else
End If

'compte 6413 sauf 64132
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6413 Then
If Left(Sheets("feuil2").Cells(i, 1), 5) = 64132 Then
Else
Sheets("feuil20").Cells(i, 97) = Sheets("feuil2").Cells(i, 7) 'CS
End If
Else
End If

'compte 64132
If Left(Sheets("feuil2").Cells(i, 1), 5) = 64132 Then
Sheets("feuil20").Cells(i, 98) = Sheets("feuil2").Cells(i, 7) 'CT
Else
End If

'compte 6414
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6414 Then
Sheets("feuil20").Cells(i, 99) = Sheets("feuil2").Cells(i, 7) 'CU
Else
End If

'compte 6415
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6415 Then
Sheets("feuil20").Cells(i, 100) = Sheets("feuil2").Cells(i, 7) 'CV
Else
End If

'compte 6418
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6418 Then
Sheets("feuil20").Cells(i, 101) = Sheets("feuil2").Cells(i, 7) 'CW
Else
End If

'compte 645
If Left(Sheets("feuil2").Cells(i, 1), 3) = 645 Then
Sheets("feuil20").Cells(i, 102) = Sheets("feuil2").Cells(i, 7) 'CX
Else
End If

'compte 646
If Left(Sheets("feuil2").Cells(i, 1), 3) = 646 Then
Sheets("feuil20").Cells(i, 103) = Sheets("feuil2").Cells(i, 7) 'CY
Else
End If

'compte 647
If Left(Sheets("feuil2").Cells(i, 1), 3) = 647 Then
Sheets("feuil20").Cells(i, 104) = Sheets("feuil2").Cells(i, 7) 'CZ
Else
End If

'compte 648
If Left(Sheets("feuil2").Cells(i, 1), 3) = 648 Then
Sheets("feuil20").Cells(i, 105) = Sheets("feuil2").Cells(i, 7) 'DA
Else
End If

'compte 651
If Left(Sheets("feuil2").Cells(i, 1), 3) = 651 Then
Sheets("feuil20").Cells(i, 106) = Sheets("feuil2").Cells(i, 7) 'DB
Else
End If

'compte 652+653
If Left(Sheets("feuil2").Cells(i, 1), 3) = 652 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 653 Then
Sheets("feuil20").Cells(i, 107) = Sheets("feuil2").Cells(i, 7) 'DC
Else
End If

'compte 654
If Left(Sheets("feuil2").Cells(i, 1), 3) = 654 Then
Sheets("feuil20").Cells(i, 108) = Sheets("feuil2").Cells(i, 7) 'DD
Else
End If

'compte 6581
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6581 Then
Sheets("feuil20").Cells(i, 109) = Sheets("feuil2").Cells(i, 7) 'DE
Else
End If

'compte 6582
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6582 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6588 Then
Sheets("feuil20").Cells(i, 110) = Sheets("feuil2").Cells(i, 7) 'DF
Else
End If

'compte 6583
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6583 Then
Sheets("feuil20").Cells(i, 111) = Sheets("feuil2").Cells(i, 7) 'DG
Else
End If

'compte 659
If Left(Sheets("feuil2").Cells(i, 1), 3) = 659 Then
Sheets("feuil20").Cells(i, 112) = Sheets("feuil2").Cells(i, 7) 'DH
Else
End If

'compte 661
If Left(Sheets("feuil2").Cells(i, 1), 3) = 661 Then
Sheets("feuil20").Cells(i, 113) = Sheets("feuil2").Cells(i, 7) 'DI
Else
End If

'compte 662
If Left(Sheets("feuil2").Cells(i, 1), 3) = 662 Then
Sheets("feuil20").Cells(i, 114) = Sheets("feuil2").Cells(i, 7) 'DJ
Else
End If

'compte 663
If Left(Sheets("feuil2").Cells(i, 1), 3) = 663 Then
Sheets("feuil20").Cells(i, 115) = Sheets("feuil2").Cells(i, 7) 'DK
Else
End If

'compte 6641
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6641 Then
Sheets("feuil20").Cells(i, 116) = Sheets("feuil2").Cells(i, 7) 'DL
Else
End If

'compte 6642
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6642 Then
Sheets("feuil20").Cells(i, 117) = Sheets("feuil2").Cells(i, 7) 'DM
Else
End If

'compte 666
If Left(Sheets("feuil2").Cells(i, 1), 3) = 666 Then
Sheets("feuil20").Cells(i, 118) = Sheets("feuil2").Cells(i, 7) 'DN
Else
End If

'compte 667
If Left(Sheets("feuil2").Cells(i, 1), 3) = 667 Then
Sheets("feuil20").Cells(i, 119) = Sheets("feuil2").Cells(i, 7) 'DO
Else
End If

'compte 668
If Left(Sheets("feuil2").Cells(i, 1), 3) = 668 Then
Sheets("feuil20").Cells(i, 120) = Sheets("feuil2").Cells(i, 7) 'DP
Else
End If

'compte 671+672+673+674+675
If Left(Sheets("feuil2").Cells(i, 1), 3) = 671 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 672 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 673 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 674 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 675 Then
Sheets("feuil20").Cells(i, 121) = Sheets("feuil2").Cells(i, 7) 'DQ
Else
End If

'compte 677
If Left(Sheets("feuil2").Cells(i, 1), 3) = 677 Then
Sheets("feuil20").Cells(i, 122) = Sheets("feuil2").Cells(i, 7) 'DR
Else
End If

'compte 678
If Left(Sheets("feuil2").Cells(i, 1), 3) = 678 Then
Sheets("feuil20").Cells(i, 123) = Sheets("feuil2").Cells(i, 7) 'DS
Else
End If

'compte 679
If Left(Sheets("feuil2").Cells(i, 1), 3) = 679 Then
Sheets("feuil20").Cells(i, 124) = Sheets("feuil2").Cells(i, 7) 'DT
Else
End If

'compte 676
If Left(Sheets("feuil2").Cells(i, 1), 3) = 676 Then
Sheets("feuil20").Cells(i, 125) = Sheets("feuil2").Cells(i, 7) 'DU
Else
End If

'compte 681
If Left(Sheets("feuil2").Cells(i, 1), 3) = 681 Then
Sheets("feuil20").Cells(i, 126) = Sheets("feuil2").Cells(i, 7) 'DV
Else
End If

'compte 691
If Left(Sheets("feuil2").Cells(i, 1), 3) = 691 Then
Sheets("feuil20").Cells(i, 127) = Sheets("feuil2").Cells(i, 7) 'DW
Else
End If

'compte 687
If Left(Sheets("feuil2").Cells(i, 1), 3) = 687 Then
Sheets("feuil20").Cells(i, 128) = Sheets("feuil2").Cells(i, 7) 'DX
Else
End If

'compte 697
If Left(Sheets("feuil2").Cells(i, 1), 3) = 697 Then
Sheets("feuil20").Cells(i, 129) = Sheets("feuil2").Cells(i, 7) 'DY
Else
End If

Next



'affectation des charges dans le tableau
'annule les données du tableau
Sheets("feuil20").Range("h11:h15").ClearContents
Sheets("feuil20").Range("h17").ClearContents
Sheets("feuil20").Range("h19:h23").ClearContents
Sheets("feuil20").Range("h25").ClearContents
Sheets("feuil20").Range("h27:h46").ClearContents
Sheets("feuil20").Range("h48").ClearContents
Sheets("feuil20").Range("h63:h70").ClearContents
Sheets("feuil20").Range("h72:h105").ClearContents
Sheets("feuil20").Range("h116:h126").ClearContents
Sheets("feuil20").Range("h128:h134").ClearContents
Sheets("feuil20").Range("h136:h143").ClearContents
Sheets("feuil20").Range("h145:h148").ClearContents
Sheets("feuil20").Range("h150").ClearContents
Sheets("feuil20").Range("h152:h153").ClearContents
Sheets("feuil20").Range("h155:h156").ClearContents


Sheets("feuil20").Range("h11") = WorksheetFunction.Sum(Sheets("feuil20").Range("t1:t5000")) '6011
Sheets("feuil20").Range("h12") = WorksheetFunction.Sum(Sheets("feuil20").Range("u1:u5000")) '6012
Sheets("feuil20").Range("h13") = WorksheetFunction.Sum(Sheets("feuil20").Range("v1:v5000")) '6013
Sheets("feuil20").Range("h14") = WorksheetFunction.Sum(Sheets("feuil20").Range("w1:w5000")) '6014
Sheets("feuil20").Range("h15") = -(WorksheetFunction.Sum(Sheets("feuil20").Range("x1:x5000"))) '6019
Sheets("feuil20").Range("h17") = WorksheetFunction.Sum(Sheets("feuil20").Range("y1:y5000")) '6031

Sheets("feuil20").Range("h19") = WorksheetFunction.Sum(Sheets("feuil20").Range("z1:z5000")) '6021
Sheets("feuil20").Range("h20") = WorksheetFunction.Sum(Sheets("feuil20").Range("aa1:aa5000")) '6022
Sheets("feuil20").Range("h21") = WorksheetFunction.Sum(Sheets("feuil20").Range("ab1:ab5000")) '6023
Sheets("feuil20").Range("h22") = WorksheetFunction.Sum(Sheets("feuil20").Range("ac1:ac5000")) '6024
Sheets("feuil20").Range("h23") = -(WorksheetFunction.Sum(Sheets("feuil20").Range("ad1:ad5000"))) '6029
Sheets("feuil20").Range("h25") = WorksheetFunction.Sum(Sheets("feuil20").Range("ae1:ae5000")) '6032

Sheets("feuil20").Range("h27") = WorksheetFunction.Sum(Sheets("feuil20").Range("af1:af5000")) '6041
Sheets("feuil20").Range("h28") = WorksheetFunction.Sum(Sheets("feuil20").Range("ag1:ag5000")) '6042
Sheets("feuil20").Range("h29") = WorksheetFunction.Sum(Sheets("feuil20").Range("ah1:ah5000")) '6043
Sheets("feuil20").Range("h30") = WorksheetFunction.Sum(Sheets("feuil20").Range("ai1:ai5000")) '6044
Sheets("feuil20").Range("h31") = WorksheetFunction.Sum(Sheets("feuil20").Range("aj1:aj5000")) '6046
Sheets("feuil20").Range("h32") = WorksheetFunction.Sum(Sheets("feuil20").Range("ak1:ak5000")) '6047
Sheets("feuil20").Range("h33") = -(WorksheetFunction.Sum(Sheets("feuil20").Range("al1:al5000"))) '6049

Sheets("feuil20").Range("h34") = WorksheetFunction.Sum(Sheets("feuil20").Range("am1:am5000")) '6051
Sheets("feuil20").Range("h35") = WorksheetFunction.Sum(Sheets("feuil20").Range("an1:an5000")) '6052
Sheets("feuil20").Range("h36") = WorksheetFunction.Sum(Sheets("feuil20").Range("ao1:ao5000")) '6053
Sheets("feuil20").Range("h37") = WorksheetFunction.Sum(Sheets("feuil20").Range("ap1:ap5000")) '6054
Sheets("feuil20").Range("h38") = WorksheetFunction.Sum(Sheets("feuil20").Range("aq1:aq5000")) '6055
Sheets("feuil20").Range("h39") = WorksheetFunction.Sum(Sheets("feuil20").Range("ar1:ar5000")) '6056
Sheets("feuil20").Range("h40") = WorksheetFunction.Sum(Sheets("feuil20").Range("as1:as5000")) '6057
Sheets("feuil20").Range("h41") = WorksheetFunction.Sum(Sheets("feuil20").Range("at1:at5000")) '6058
Sheets("feuil20").Range("h42") = -(WorksheetFunction.Sum(Sheets("feuil20").Range("au1:au5000"))) '6059

Sheets("feuil20").Range("h43") = WorksheetFunction.Sum(Sheets("feuil20").Range("av1:av5000")) '6081
Sheets("feuil20").Range("h44") = WorksheetFunction.Sum(Sheets("feuil20").Range("aw1:aw5000")) '6082
Sheets("feuil20").Range("h45") = WorksheetFunction.Sum(Sheets("feuil20").Range("ax1:ax5000")) '6083
Sheets("feuil20").Range("h46") = -(WorksheetFunction.Sum(Sheets("feuil20").Range("ay1:ay5000"))) '6089

Sheets("feuil20").Range("h48") = WorksheetFunction.Sum(Sheets("feuil20").Range("az1:az5000")) '6033

Sheets("feuil20").Range("h63") = WorksheetFunction.Sum(Sheets("feuil20").Range("ba1:ba5000")) '611
Sheets("feuil20").Range("h64") = WorksheetFunction.Sum(Sheets("feuil20").Range("bb1:bb5000")) '612
Sheets("feuil20").Range("h65") = WorksheetFunction.Sum(Sheets("feuil20").Range("bc1:bc5000")) '613
Sheets("feuil20").Range("h66") = WorksheetFunction.Sum(Sheets("feuil20").Range("bd1:bd5000")) '614
Sheets("feuil20").Range("h67") = WorksheetFunction.Sum(Sheets("feuil20").Range("be1:be5000")) '616
Sheets("feuil20").Range("h68") = WorksheetFunction.Sum(Sheets("feuil20").Range("bf1:bf5000")) '6181
Sheets("feuil20").Range("h69") = WorksheetFunction.Sum(Sheets("feuil20").Range("bg1:bg5000")) '6182
Sheets("feuil20").Range("h70") = WorksheetFunction.Sum(Sheets("feuil20").Range("bh1:bh5000")) '6183

Sheets("feuil20").Range("h72") = WorksheetFunction.Sum(Sheets("feuil20").Range("bi1:bi5000")) '621
Sheets("feuil20").Range("h73") = WorksheetFunction.Sum(Sheets("feuil20").Range("bj1:bj5000")) '6221
Sheets("feuil20").Range("h74") = WorksheetFunction.Sum(Sheets("feuil20").Range("bk1:bk5000")) '6222
Sheets("feuil20").Range("h75") = WorksheetFunction.Sum(Sheets("feuil20").Range("bl1:bl5000")) '6223
Sheets("feuil20").Range("h76") = WorksheetFunction.Sum(Sheets("feuil20").Range("bm1:bm5000")) '6224
Sheets("feuil20").Range("h77") = WorksheetFunction.Sum(Sheets("feuil20").Range("bn1:bn5000")) '6225
Sheets("feuil20").Range("h78") = WorksheetFunction.Sum(Sheets("feuil20").Range("bo1:bo5000")) '6228
Sheets("feuil20").Range("h79") = WorksheetFunction.Sum(Sheets("feuil20").Range("bp1:bp5000")) '623
Sheets("feuil20").Range("h80") = WorksheetFunction.Sum(Sheets("feuil20").Range("bq1:bq5000")) '6241
Sheets("feuil20").Range("h81") = WorksheetFunction.Sum(Sheets("feuil20").Range("br1:br5000")) '6242
Sheets("feuil20").Range("h82") = WorksheetFunction.Sum(Sheets("feuil20").Range("bs1:bs5000")) '6243
Sheets("feuil20").Range("h83") = WorksheetFunction.Sum(Sheets("feuil20").Range("bt1:bt5000")) '6248
Sheets("feuil20").Range("h84") = WorksheetFunction.Sum(Sheets("feuil20").Range("bu1:bu5000")) '625
Sheets("feuil20").Range("h85") = WorksheetFunction.Sum(Sheets("feuil20").Range("bv1:bv5000")) '6261
Sheets("feuil20").Range("h86") = WorksheetFunction.Sum(Sheets("feuil20").Range("bw1:bw5000")) '6265
Sheets("feuil20").Range("h87") = WorksheetFunction.Sum(Sheets("feuil20").Range("bx1:bx5000")) '6266
Sheets("feuil20").Range("h88") = WorksheetFunction.Sum(Sheets("feuil20").Range("by1:by5000")) '627
Sheets("feuil20").Range("h89") = WorksheetFunction.Sum(Sheets("feuil20").Range("bz1:bz5000")) '628
Sheets("feuil20").Range("h90") = WorksheetFunction.Sum(Sheets("feuil20").Range("ca1:ca5000")) '631
Sheets("feuil20").Range("h91") = WorksheetFunction.Sum(Sheets("feuil20").Range("cb1:cb5000")) '6321
Sheets("feuil20").Range("h92") = WorksheetFunction.Sum(Sheets("feuil20").Range("cc1:cc5000")) '6322
Sheets("feuil20").Range("h93") = WorksheetFunction.Sum(Sheets("feuil20").Range("cd1:cd5000")) '6323
Sheets("feuil20").Range("h94") = WorksheetFunction.Sum(Sheets("feuil20").Range("ce1:ce5000")) '6324
Sheets("feuil20").Range("h95") = WorksheetFunction.Sum(Sheets("feuil20").Range("cf1:cf5000")) '6325
Sheets("feuil20").Range("h96") = WorksheetFunction.Sum(Sheets("feuil20").Range("cg1:cg5000")) '6328
Sheets("feuil20").Range("h97") = WorksheetFunction.Sum(Sheets("feuil20").Range("ch1:ch5000")) '6329
Sheets("feuil20").Range("h98") = WorksheetFunction.Sum(Sheets("feuil20").Range("ci1:ci5000")) '633
Sheets("feuil20").Range("h99") = WorksheetFunction.Sum(Sheets("feuil20").Range("cj1:cj5000")) '634
Sheets("feuil20").Range("h100") = WorksheetFunction.Sum(Sheets("feuil20").Range("ck1:ck5000")) '635
Sheets("feuil20").Range("h101") = WorksheetFunction.Sum(Sheets("feuil20").Range("cl1:cl5000")) '637
Sheets("feuil20").Range("h102") = WorksheetFunction.Sum(Sheets("feuil20").Range("cm1:cm5000")) '6381
Sheets("feuil20").Range("h103") = WorksheetFunction.Sum(Sheets("feuil20").Range("cn1:cn5000")) '6382
Sheets("feuil20").Range("h104") = WorksheetFunction.Sum(Sheets("feuil20").Range("co1:co5000")) '6383
Sheets("feuil20").Range("h105") = WorksheetFunction.Sum(Sheets("feuil20").Range("cp1:cp5000")) '6384

Sheets("feuil20").Range("h116") = WorksheetFunction.Sum(Sheets("feuil20").Range("cq1:cq5000")) '6411
Sheets("feuil20").Range("h117") = WorksheetFunction.Sum(Sheets("feuil20").Range("cr1:cr5000")) '6412
Sheets("feuil20").Range("h118") = WorksheetFunction.Sum(Sheets("feuil20").Range("cs1:cs5000")) '641310
Sheets("feuil20").Range("h119") = WorksheetFunction.Sum(Sheets("feuil20").Range("ct1:ct5000")) '641320
Sheets("feuil20").Range("h120") = WorksheetFunction.Sum(Sheets("feuil20").Range("cu1:cu5000")) '6414
Sheets("feuil20").Range("h121") = WorksheetFunction.Sum(Sheets("feuil20").Range("cv1:cv5000")) '6415
Sheets("feuil20").Range("h122") = WorksheetFunction.Sum(Sheets("feuil20").Range("cw1:cw5000")) '6418
Sheets("feuil20").Range("h123") = WorksheetFunction.Sum(Sheets("feuil20").Range("cx1:cx5000")) '645
Sheets("feuil20").Range("h124") = WorksheetFunction.Sum(Sheets("feuil20").Range("cy1:cy5000")) '646
Sheets("feuil20").Range("h125") = WorksheetFunction.Sum(Sheets("feuil20").Range("cz1:cz5000")) '647
Sheets("feuil20").Range("h126") = WorksheetFunction.Sum(Sheets("feuil20").Range("da1:da5000")) '648

Sheets("feuil20").Range("h128") = WorksheetFunction.Sum(Sheets("feuil20").Range("db1:db5000")) '651
Sheets("feuil20").Range("h129") = WorksheetFunction.Sum(Sheets("feuil20").Range("dc1:dc5000")) '652+653
Sheets("feuil20").Range("h130") = WorksheetFunction.Sum(Sheets("feuil20").Range("dd1:dd5000")) '654
Sheets("feuil20").Range("h131") = WorksheetFunction.Sum(Sheets("feuil20").Range("de1:de5000")) '6581
Sheets("feuil20").Range("h132") = WorksheetFunction.Sum(Sheets("feuil20").Range("df1:df5000")) '6582
Sheets("feuil20").Range("h133") = WorksheetFunction.Sum(Sheets("feuil20").Range("dg1:dg5000")) '6583
Sheets("feuil20").Range("h134") = WorksheetFunction.Sum(Sheets("feuil20").Range("dh1:dh5000")) '659

Sheets("feuil20").Range("h136") = WorksheetFunction.Sum(Sheets("feuil20").Range("di1:di5000")) '661
Sheets("feuil20").Range("h137") = WorksheetFunction.Sum(Sheets("feuil20").Range("dj1:dj5000")) '662
Sheets("feuil20").Range("h138") = WorksheetFunction.Sum(Sheets("feuil20").Range("dk1:dk5000")) '663
Sheets("feuil20").Range("h139") = WorksheetFunction.Sum(Sheets("feuil20").Range("dl1:dl5000")) '6641
Sheets("feuil20").Range("h140") = WorksheetFunction.Sum(Sheets("feuil20").Range("dm1:dm5000")) '6642
Sheets("feuil20").Range("h141") = WorksheetFunction.Sum(Sheets("feuil20").Range("dn1:dn5000")) '666
Sheets("feuil20").Range("h142") = WorksheetFunction.Sum(Sheets("feuil20").Range("do1:do5000")) '667
Sheets("feuil20").Range("h143") = WorksheetFunction.Sum(Sheets("feuil20").Range("dp1:dp5000")) '668

Sheets("feuil20").Range("h145") = WorksheetFunction.Sum(Sheets("feuil20").Range("dq1:dq5000")) '671-675
Sheets("feuil20").Range("h146") = WorksheetFunction.Sum(Sheets("feuil20").Range("dr1:dr5000")) '677
Sheets("feuil20").Range("h147") = WorksheetFunction.Sum(Sheets("feuil20").Range("ds1:ds5000")) '678
Sheets("feuil20").Range("h148") = WorksheetFunction.Sum(Sheets("feuil20").Range("dt1:dt5000")) '679

Sheets("feuil20").Range("h150") = WorksheetFunction.Sum(Sheets("feuil20").Range("du1:du5000")) '676

Sheets("feuil20").Range("h152") = WorksheetFunction.Sum(Sheets("feuil20").Range("dv1:dv5000")) '681
Sheets("feuil20").Range("h153") = WorksheetFunction.Sum(Sheets("feuil20").Range("dw1:dw5000")) '691

Sheets("feuil20").Range("h155") = WorksheetFunction.Sum(Sheets("feuil20").Range("dx1:dx5000")) '687
Sheets("feuil20").Range("h156") = WorksheetFunction.Sum(Sheets("feuil20").Range("dy1:dy5000")) '697


'annule les données de la feuil20
Sheets("feuil20").Range("t1:za5001").ClearContents

'affiche le détail charges dgi
Sheets("feuil20").Activate

'demande de confirmation
End If

'condition de traitement
End If
'condition d'édition
End If
End Sub
Private Sub annuler_détail_charges()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
Sheets("feuil20").Range("h11:h15").ClearContents
Sheets("feuil20").Range("h17").ClearContents
Sheets("feuil20").Range("h19:h23").ClearContents
Sheets("feuil20").Range("h25").ClearContents
Sheets("feuil20").Range("h27:h46").ClearContents
Sheets("feuil20").Range("h48").ClearContents
Sheets("feuil20").Range("h63:h70").ClearContents
Sheets("feuil20").Range("h72:h105").ClearContents
Sheets("feuil20").Range("h116:h126").ClearContents
Sheets("feuil20").Range("h128:h134").ClearContents
Sheets("feuil20").Range("h136:h143").ClearContents
Sheets("feuil20").Range("h145:h148").ClearContents
Sheets("feuil20").Range("h150").ClearContents
Sheets("feuil20").Range("h152:h153").ClearContents
Sheets("feuil20").Range("h155:h156").ClearContents
End If
End Sub
Private Sub état_annxexé()
'condition d'édition de l'état annexé
If WorksheetFunction.Sum(Sheets("feuil2").Range("g1:h5000")) = 0 Then

'affiche uniquement l'état annexé
Sheets("feuil14").Activate
Else

'condition de traitement des données de l'état annexé
If WorksheetFunction.Sum(Sheets("feuil7").Range("h18:h22")) + WorksheetFunction.Sum(Sheets("feuil13").Range("g24:g49")) = 0 Then
MsgBox "Veuillez éditer vos Etats N pour renseigner l'Etat annexé !"
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition de l'Etat annexé ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traite les données du détail des charges pour les récupérer
détail_charges_état_annexé

For i = 1 To 5000
'traitement de l'état annexé
'recup cotisations sociales imputées
'compte 6614+6615+6616+6624+6625+6626
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6614 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6615 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6616 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6624 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6625 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6626 Then
Sheets("feuil14").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'recup intérêts échus versés
'compte 671+672+674
If Left(Sheets("feuil2").Cells(i, 1), 3) = 671 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 672 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 674 Then
Sheets("feuil14").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

Next


'annule d'abord les données
Sheets("feuil14").Range("s425").ClearContents
Sheets("feuil14").Range("s433").ClearContents

'affecte cotisations sociales imputées
Sheets("feuil14").Range("s425") = WorksheetFunction.Sum(Sheets("feuil14").Range("t1:t5000"))
'affecte les intérêts échus versés
Sheets("feuil14").Range("s433") = WorksheetFunction.Sum(Sheets("feuil14").Range("u1:u5000"))



'efface les données de la feuil14
Sheets("feuil14").Range("t1:za5001").ClearContents

'affiche l'état annexé
Sheets("feuil14").Activate


'demande de confirmation
End If

'condition de traitement
End If
'condition d'édition
End If
End Sub
Private Sub couverure_dgi()
Sheets("feuil18").Activate
End Sub
Private Sub complément_tab13()
Sheets("feuil19").Activate
End Sub
Private Sub statistique_uemoa()
Sheets("feuil21").Activate
End Sub
Private Sub répartition_fiscale()
Sheets("feuil22").Activate
End Sub
Private Sub affiche_patente()
Sheets("feuil29").Activate
End Sub
Private Sub précédent_feuil3()
Sheets("feuil28").Activate
Sheets("feuil28").Range("a2").Select
End Sub
Private Sub suivant_feuil3()
Sheets("feuil4").Activate
Sheets("feuil4").Range("a2").Select
End Sub
Private Sub précédent_feuil4()
Sheets("feuil3").Activate
Sheets("feuil3").Range("a2").Select
End Sub
Private Sub suivant_feuil4()
Sheets("feuil5").Activate
Sheets("feuil5").Range("a2").Select
End Sub
Private Sub précédent_feuil5()
Sheets("feuil4").Activate
Sheets("feuil4").Range("a2").Select
End Sub
Private Sub suivant_feuil5()
Sheets("feuil6").Activate
Sheets("feuil6").Range("a2").Select
End Sub
Private Sub précédent_feuil6()
Sheets("feuil5").Activate
Sheets("feuil5").Range("a2").Select
End Sub
Private Sub suivant_feuil6()
Sheets("feuil7").Activate
Sheets("feuil7").Range("a2").Select
End Sub
Private Sub précédent_feuil7()
Sheets("feuil6").Activate
Sheets("feuil6").Range("a2").Select
End Sub
Private Sub suivant_feuil7()
Sheets("feuil14").Activate
Sheets("feuil14").Range("a2").Select
End Sub
Private Sub précédent_feuil14()
Sheets("feuil7").Activate
Sheets("feuil7").Range("a2").Select
End Sub
Private Sub suivant_feuil14()
Sheets("feuil23").Activate
Sheets("feuil23").Range("a2").Select
End Sub
Private Sub précédent_feuil23()
Sheets("feuil14").Activate
Sheets("feuil14").Range("a2").Select
End Sub
Private Sub suivant_feuil23()
Sheets("feuil15").Activate
Sheets("feuil15").Range("a2").Select
End Sub
Private Sub précédent_feuil15()
Sheets("feuil23").Activate
Sheets("feuil23").Range("a2").Select
End Sub
Private Sub suivant_feuil15()
Sheets("feuil11").Activate
Sheets("feuil11").Range("a2").Select
End Sub
Private Sub précédent_feuil11()
Sheets("feuil15").Activate
Sheets("feuil15").Range("a2").Select
End Sub
Private Sub suivant_feuil11()
Sheets("feuil10").Activate
Sheets("feuil10").Range("a2").Select
End Sub
Private Sub précédent_feuil10()
Sheets("feuil11").Activate
Sheets("feuil11").Range("a2").Select
End Sub
Private Sub suivant_feuil10()
Sheets("feuil8").Activate
Sheets("feuil8").Range("a2").Select
End Sub
Private Sub précédent_feuil8()
Sheets("feuil10").Activate
Sheets("feuil10").Range("a2").Select
End Sub
Private Sub suivant_feuil8()
Sheets("feuil16").Activate
Sheets("feuil16").Range("a2").Select
End Sub
Private Sub précédent_feuil16()
Sheets("feuil8").Activate
Sheets("feuil8").Range("a2").Select
End Sub
Private Sub suivant_feuil16()
Sheets("feuil17").Activate
Sheets("feuil17").Range("a2").Select
End Sub
Private Sub précédent_feuil17()
Sheets("feuil16").Activate
Sheets("feuil16").Range("a2").Select
End Sub
Private Sub suivant_feuil17()
Sheets("feuil31").Activate
Sheets("feuil31").Range("a2").Select
End Sub
Private Sub précédent_feuil31()
Sheets("feuil17").Activate
Sheets("feuil17").Range("a2").Select
End Sub
Private Sub suivant_feuil31()
Sheets("feuil13").Activate
Sheets("feuil13").Range("a2").Select
End Sub
Private Sub précédent_feuil13()
Sheets("feuil31").Activate
Sheets("feuil31").Range("a2").Select
End Sub
Private Sub imprimer_feuil8()
Application.Sheets("feuil8").PrintPreview
End Sub
Private Sub imprimer_feuil10()
Application.Sheets("feuil10").PrintPreview
End Sub
Private Sub imprimer_feuil11()
Application.Sheets("feuil11").PrintPreview
End Sub
Private Sub imprimer_feuil13()
Application.Sheets("feuil13").PrintPreview
End Sub
Private Sub imprimer_feuil14()
Application.Sheets("feuil14").PrintPreview
End Sub
Private Sub imprimer_feuil23()
Application.Sheets("feuil23").PrintPreview
End Sub
Private Sub imprimer_feuil15()
Application.Sheets("feuil15").PrintPreview
End Sub
Private Sub imprimer_feuil16()
Application.Sheets("feuil16").PrintPreview
End Sub
Private Sub imprimer_feuil17()
Application.Sheets("feuil17").PrintPreview
End Sub
Private Sub imprimer_feuil18()
Application.Sheets("feuil18").PrintPreview
End Sub
Private Sub imprimer_feuil20()
Application.Sheets("feuil20").PrintPreview
Application.Sheets("feuil19").PrintPreview
End Sub
Private Sub imprimer_feuil26()
Application.Sheets("feuil26").PrintPreview
End Sub
Private Sub imprimer_feuil27()
Application.Sheets("feuil27").PrintPreview
End Sub
Private Sub imprimer_feuil29()
Application.Sheets("feuil29").PrintPreview
End Sub
Private Sub affiche_tableau_amortissement()
'animationv1
MsgBox "TABLEAU D'AMORTISSEMENT  !" & Chr(10) & Chr(10) & "NB : Assurez vous que les Notes 3A à 3D sont éditées pour que le Tableau d'amortissement soit entièrement renseigné. "
Sheets("feuil30").Activate
End Sub
Private Sub imprimer_feuil30()
Application.Sheets("feuil30").PrintPreview
End Sub
Private Sub édite_justif_des_postes_du_bilan()
'condition de traitement des données de l'état annexé
If Sheets("feuil7").Range("g54") = "" Then
MsgBox "Veuillez éditer vos Etats N pour renseigner le Justificatif des Postes !"
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des Postes du Bilan ?", vbYesNo, "Demande de confirmation") = vbYes Then

'Saisir la référence du poste
Dim resultat As Variant
    resultat = InputBox("Veuillez saisir (en majuscule) la référence du Poste à justifier :" & Chr(10) & Chr(10) & "Exemple : AE, AF ou AG, Etc...", "Justif des Postes") 'La variable reçoit la valeur entrée dans l'InputBox
   
    If resultat = "" Then 'Si la valeur est différente de "" on affiche le résultat
    Else
    
'efface d'abord les données existentes
Sheets("feuil26").Range("a3:h5003").ClearContents
Sheets("feuil26").Range("e5004:h5004").ClearContents
Sheets("feuil26").Range("c1:d1").ClearContents

'affecte le signe (-) pour le filtre
For i = 3 To 5003
Sheets("feuil26").Cells(i, 1) = "-"
Next
    
Dim variable As Variant
    variable = (5000 - WorksheetFunction.CountBlank(Sheets("feuil2").Range("a3:a5000")) + 20)
    
For i = 3 To variable

'If resultat = "AX" Then
'Sheets("feuil26").Range("c1") = resultat
'Sheets("feuil26").Range("d1") = "Frais d'établissement"
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 201 Then
'Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
'Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Else
'End If
'Else
'End If

'If resultat = "AY" Then
'Sheets("feuil26").Range("c1") = resultat
'Sheets("feuil26").Range("d1") = "Charges à répartir"
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 202 Then
'Sheets("feuil26").Cells(I + 2, 1) = Sheets("feuil2").Cells(I, 1) 'n°Compte
'Sheets("feuil26").Cells(I + 2, 2) = Sheets("feuil2").Cells(I, 2) 'libellé
'Sheets("feuil26").Cells(I + 2, 7) = Sheets("feuil2").Cells(I, 7) 'solde débit
'Else
'End If
'Else
'End If

'If resultat = "AC" Then
'Sheets("feuil26").Range("c1") = resultat
'Sheets("feuil26").Range("d1") = "Primes de remboursement des obligations"
'If Left(Sheets("feuil2").Cells(I, 1), 3) = 206 Then
'Sheets("feuil26").Cells(I + 2, 1) = Sheets("feuil2").Cells(I, 1) 'n°Compte
'Sheets("feuil26").Cells(I + 2, 2) = Sheets("feuil2").Cells(I, 2) 'libellé
'Sheets("feuil26").Cells(I + 2, 7) = Sheets("feuil2").Cells(I, 7) 'solde débit
'Else
'End If
'Else
'End If

If resultat = "AE" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Frais de développement et de prospection"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 211 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2181 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2191 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2811 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 28181 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2911 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29191 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29181 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "AF" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Brevets, licences, logiciels et droits similaires"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 212 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 213 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 214 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2193 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2812 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2813 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2814 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2912 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2913 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2914 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29193 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "AG" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Fonds commercial et droit au bail"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 215 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 216 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2815 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2816 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2915 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2916 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "AH" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Autres immobilisations incorporelles"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 217 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 218 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2198 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2817 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2818 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2917 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2918 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29198 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2181 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 28181 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29181 Then
Else
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
End If
Else
End If
Else
End If

If resultat = "AJ" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Terrains"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 22 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 282 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 292 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "AK" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Bâtiments"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 23 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 283 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 293 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 234 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 235 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 238 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2834 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2835 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2838 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2934 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2935 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2938 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2394 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2395 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2398 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29394 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29395 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29398 Then
Else
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
End If
Else
End If
Else
End If

If resultat = "AL" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Aménagements, agencements et installations"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 234 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 235 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 238 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2834 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2835 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2838 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2934 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2935 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2938 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2394 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2395 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2398 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29394 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29395 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29398 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "AM" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Matériel, mobilier et actifs biologiques"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 24 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 284 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 294 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 245 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2845 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2945 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2495 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29495 Then
Else
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
End If
Else
End If
Else
End If

If resultat = "AN" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Matériel de transport"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 245 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2845 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2945 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2495 Or Left(Sheets("feuil2").Cells(i, 1), 5) = 29495 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "AP" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Avances et acomptes versés sur immobilisations"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 25 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 295 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "AR" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Titres de participation"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 26 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 296 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "AS" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Autres immobilisations financières"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 27 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 297 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "BA" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Actif circulant H.A.O"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 48 Then 'solde débiteur
If Sheets("feuil2").Cells(i, 8) > 0 Then
Else
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
End If
Else
End If
Else
End If
If resultat = "BA" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Actif circulant H.A.O"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 498 Then 'provisions
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "BB" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Stocks et encours"
If Left(Sheets("feuil2").Cells(i, 1), 1) = 3 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

'If resultat = "BD" Then
'Sheets("feuil26").Range("c1") = resultat
'Sheets("feuil26").Range("d1") = "Stocks de matières premières et autres approvisionnements"
'If Left(Sheets("feuil2").Cells(I, 1), 2) = 32 Or Left(Sheets("feuil2").Cells(I, 1), 2) = 33 Or Left(Sheets("feuil2").Cells(I, 1), 3) = 382 Or Left(Sheets("feuil2").Cells(I, 1), 3) = 383 Or Left(Sheets("feuil2").Cells(I, 1), 3) = 388 Or Left(Sheets("feuil2").Cells(I, 1), 3) = 392 Or Left(Sheets("feuil2").Cells(I, 1), 3) = 393 Or Left(Sheets("feuil2").Cells(I, 1), 4) = 3982 Or Left(Sheets("feuil2").Cells(I, 1), 4) = 3983 Or Left(Sheets("feuil2").Cells(I, 1), 4) = 3988 Then
'Sheets("feuil26").Cells(I + 2, 1) = Sheets("feuil2").Cells(I, 1) 'n°Compte
'Sheets("feuil26").Cells(I + 2, 2) = Sheets("feuil2").Cells(I, 2) 'libellé
'Sheets("feuil26").Cells(I + 2, 7) = Sheets("feuil2").Cells(I, 7) 'solde débit
'Sheets("feuil26").Cells(I + 2, 8) = Sheets("feuil2").Cells(I, 8) 'solde crédit
'Else
'End If
'Else
'End If

'If resultat = "BE" Then
'Sheets("feuil26").Range("c1") = resultat
'Sheets("feuil26").Range("d1") = "Stocks des en-cours"
'If Left(Sheets("feuil2").Cells(I, 1), 2) = 34 Or Left(Sheets("feuil2").Cells(I, 1), 2) = 35 Or Left(Sheets("feuil2").Cells(I, 1), 3) = 394 Or Left(Sheets("feuil2").Cells(I, 1), 3) = 395 Then
'Sheets("feuil26").Cells(I + 2, 1) = Sheets("feuil2").Cells(I, 1) 'n°Compte
'Sheets("feuil26").Cells(I + 2, 2) = Sheets("feuil2").Cells(I, 2) 'libellé
'Sheets("feuil26").Cells(I + 2, 7) = Sheets("feuil2").Cells(I, 7) 'solde débit
'Sheets("feuil26").Cells(I + 2, 8) = Sheets("feuil2").Cells(I, 8) 'solde crédit
'Else
'End If
'Else
'End If

'If resultat = "BF" Then
'Sheets("feuil26").Range("c1") = resultat
'Sheets("feuil26").Range("d1") = "Stocks de produits fabriqués"
'If Left(Sheets("feuil2").Cells(I, 1), 2) = 36 Or Left(Sheets("feuil2").Cells(I, 1), 2) = 37 Or Left(Sheets("feuil2").Cells(I, 1), 3) = 386 Or Left(Sheets("feuil2").Cells(I, 1), 3) = 396 Or Left(Sheets("feuil2").Cells(I, 1), 3) = 397 Or Left(Sheets("feuil2").Cells(I, 1), 4) = 3986 Then
'Sheets("feuil26").Cells(I + 2, 1) = Sheets("feuil2").Cells(I, 1) 'n°Compte
'Sheets("feuil26").Cells(I + 2, 2) = Sheets("feuil2").Cells(I, 2) 'libellé
'Sheets("feuil26").Cells(I + 2, 7) = Sheets("feuil2").Cells(I, 7) 'solde débit
'Sheets("feuil26").Cells(I + 2, 8) = Sheets("feuil2").Cells(I, 8) 'solde crédit
'Else
'End If
'Else
'End If

If resultat = "BH" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Fournisseurs, avances versées"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 409 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 490 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "BI" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Clients"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 41 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 491 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 419 Then
Else
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
End If
Else
End If
Else
End If


If resultat = "BJ" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Autres créances"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 42 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 43 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 44 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 45 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 46 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 47 Then 'solde débiteur
If Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
Else
If Sheets("feuil2").Cells(i, 8) > 0 Then
Else
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
End If
End If
Else
End If
Else
End If
If resultat = "BJ" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Autres créances"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 492 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 493 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 494 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 495 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 496 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 497 Then 'provisions
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "BQ" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Titres de placement"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 50 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 590 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "BR" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Valeurs à encaisser"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 51 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 591 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "BS" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Banques, chèques postaux, caisse et assimilés"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 52 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 53 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 54 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 55 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 57 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 581 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 582 Then 'solde débiteur
If Sheets("feuil2").Cells(i, 8) > 0 Then
Else
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
End If
Else
End If
Else
End If
If resultat = "BS" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Banques, chèques postaux, caisse et assimilés"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 592 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 593 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 594 Then 'provisions
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "BU" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Ecarts de conversion - Actif"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "CA" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Capital"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 101 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 102 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 103 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 104 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "CB" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Apporteurs, capital non appelé"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 109 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "CD" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Primes liées au capital social"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 105 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "CE" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Ecarts de réévaluation"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 106 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "CF" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Réserves indisponibles"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 111 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 112 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 113 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "CG" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Réserves libres"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 118 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "CH" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Report à nouveau"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 12 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "CL" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Subventions d'investissement"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 14 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "CM" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Provisions réglementées"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 15 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "DA" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Emprunts et dettes financières diverses"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 16 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 18 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "DB" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Dettes de location acquisition"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 17 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

'If resultat = "DC" Then
'Sheets("feuil26").Range("c1") = resultat
'Sheets("feuil26").Range("d1") = "Dettes financières diverses"
'If Left(Sheets("feuil2").Cells(I, 1), 2) = 18 Then
'Sheets("feuil26").Cells(I + 2, 1) = Sheets("feuil2").Cells(I, 1) 'n°Compte
'Sheets("feuil26").Cells(I + 2, 2) = Sheets("feuil2").Cells(I, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(I + 2, 8) = Sheets("feuil2").Cells(I, 8) 'solde crédit
'Else
'End If
'Else
'End If

If resultat = "DC" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Provisions pour risques et charges"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 19 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "DH" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Dettes circulantes H.A.O"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 48 Then
If Sheets("feuil2").Cells(i, 7) > 0 Then
Else
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
End If
Else
End If
Else
End If

If resultat = "DI" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Clients, avances reçues"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 419 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "DJ" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Fournisseurs d'exploitation"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 401 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 402 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 404 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 408 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "DK" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Dettes fiscales et sociales"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 44 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 42 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 43 Then
If Sheets("feuil2").Cells(i, 7) > 0 Then
Else
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
End If
Else
End If
Else
End If

'If resultat = "DL" Then
'Sheets("feuil26").Range("c1") = resultat
'Sheets("feuil26").Range("d1") = "Dettes sociales"
'If Left(Sheets("feuil2").Cells(I, 1), 2) = 42 Or Left(Sheets("feuil2").Cells(I, 1), 2) = 43 Then
'If Sheets("feuil2").Cells(I, 7) > 0 Then
'Else
'Sheets("feuil26").Cells(I + 2, 1) = Sheets("feuil2").Cells(I, 1) 'n°Compte
'Sheets("feuil26").Cells(I + 2, 2) = Sheets("feuil2").Cells(I, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(I + 2, 8) = Sheets("feuil2").Cells(I, 8) 'solde crédit
'End If
'Else
'End If
'Else
'End If

If resultat = "DM" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Autres dettes"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 45 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 46 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 47 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
Else
If Sheets("feuil2").Cells(i, 7) > 0 Then
Else
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
End If
End If
Else
End If
Else
End If

If resultat = "DN" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Provisions pour risque à court terme"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 499 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 599 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "DQ" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Banques, crédits d'escompte"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 564 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 565 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "DR" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Banques, établissements financiers et crédits de trésorerie"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 561 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 566 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If
If resultat = "DR" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Banques, établissements financiers et crédits de trésorerie"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 52 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 53 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 54 Then
If Sheets("feuil2").Cells(i, 7) > 0 Then
Else
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
End If
Else
End If
Else
End If

If resultat = "DV" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Ecarts de conversion - Passif"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If
    
Next


'fait les totaux des colonnes e,f,g et h
Sheets("feuil26").Range("e5004") = WorksheetFunction.Sum(Sheets("feuil26").Range("e3:e5000"))
Sheets("feuil26").Range("f5004") = WorksheetFunction.Sum(Sheets("feuil26").Range("f3:f5000"))
Sheets("feuil26").Range("g5004") = WorksheetFunction.Sum(Sheets("feuil26").Range("g3:g5000"))
Sheets("feuil26").Range("h5004") = WorksheetFunction.Sum(Sheets("feuil26").Range("h3:h5000"))

'message de non validité de la référence du poste saisir
If WorksheetFunction.Sum(Sheets("feuil26").Range("e5004:h5004")) = 0 Then
MsgBox "Désolé !  La référence saisie n'a pas pu être traitée."
Else
MsgBox "    FIN DE L'EDITION !"
End If


    'saisir la référence du poste (si resultat)
    End If


'demande de confirmation
End If

'condition de traitement du justif des postes
End If
End Sub
Private Sub annuler_justif_des_postes()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
Sheets("feuil26").Range("a3:h5003").ClearContents
Sheets("feuil26").Range("e5004:h5004").ClearContents
Sheets("feuil26").Range("c1:d1").ClearContents
End If
End Sub
Private Sub affiche_justif_des_postes()
'animationv1
Sheets("feuil26").Activate
End Sub
Private Sub édite_justif_des_postes_du_résultat()
'condition de traitement des données de l'état annexé
If Sheets("feuil7").Range("g54") = "" Then
MsgBox "Veuillez éditer vos Etats N pour renseigner le Justificatif des Postes !"
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des Postes du Compte de résultat ?", vbYesNo, "Demande de confirmation") = vbYes Then

'Saisir la référence du poste
Dim resultat As Variant
    resultat = InputBox("Veuillez saisir (en majuscule) la référence du Poste à justifier :" & Chr(10) & Chr(10) & "Exemple : TA, RA ou RB, Etc...", "Justif des Postes") 'La variable reçoit la valeur entrée dans l'InputBox
   
    If resultat = "" Then 'Si la valeur est différente de "" on affiche le résultat
    Else
    
'efface d'abord les données existentes
Sheets("feuil26").Range("a3:h5003").ClearContents
Sheets("feuil26").Range("e5004:h5004").ClearContents
Sheets("feuil26").Range("c1:d1").ClearContents

'affecte le signe (-) pour le filtre
For i = 3 To 5003
Sheets("feuil26").Cells(i, 1) = "-"
Next
    
Dim variable As Variant
    variable = (5000 - WorksheetFunction.CountBlank(Sheets("feuil2").Range("a3:a5000")) + 20)
    
For i = 3 To variable

If resultat = "RA" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Achats de marchandises"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 601 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "RB" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Variation de stocks de marchandises"
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6031 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If
   
If resultat = "RC" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Achats de matières premières et fournitures liées"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 602 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If
    
If resultat = "RD" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Variation de stocks de matières premières et fournitures"
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6032 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "RE" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Autres achats"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 604 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 605 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 608 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "RF" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Variation de stocks des autres approvisionnements"
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6033 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "RG" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Transports"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 61 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "RH" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Services extérieurs"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 62 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 63 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "RI" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Impôts et taxes"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 64 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "RJ" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Autres charges"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 65 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "RK" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Charges de personnel"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 66 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "RL" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Dotations aux amortissements, aux provisions et dépréciations"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 681 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 691 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "RM" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Frais financiers et charges assimilées"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 67 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

'If resultat = "SC" Then
'Sheets("feuil26").Range("c1") = resultat
'Sheets("feuil26").Range("d1") = "Pertes de change"
'If Left(Sheets("feuil2").Cells(I, 1), 3) = 676 Then
'Sheets("feuil26").Cells(I + 2, 1) = Sheets("feuil2").Cells(I, 1) 'n°Compte
'Sheets("feuil26").Cells(I + 2, 2) = Sheets("feuil2").Cells(I, 2) 'libellé
'Sheets("feuil26").Cells(I + 2, 7) = Sheets("feuil2").Cells(I, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
'Else
'End If
'Else
'End If

If resultat = "RN" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Dotations aux provisions et dépréciations financières"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 687 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 697 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "RO" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Valeurs comptables des cessions d'immobilisations"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 81 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "RP" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Autres charges H.A.O"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 83 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 85 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

'If resultat = "SM" Then
'Sheets("feuil26").Range("c1") = resultat
'Sheets("feuil26").Range("d1") = "Dotations H.A.O"
'If Left(Sheets("feuil2").Cells(I, 1), 2) = 85 Then
'Sheets("feuil26").Cells(I + 2, 1) = Sheets("feuil2").Cells(I, 1) 'n°Compte
'Sheets("feuil26").Cells(I + 2, 2) = Sheets("feuil2").Cells(I, 2) 'libellé
'Sheets("feuil26").Cells(I + 2, 7) = Sheets("feuil2").Cells(I, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
'Else
'End If
'Else
'End If

If resultat = "RQ" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Participation des travailleurs"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 87 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "RS" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Impôts sur le résultat"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 89 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TA" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Ventes de marchandises"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 701 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TB" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Ventes de produits fabriqués"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 702 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 703 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 704 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TC" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Travaux, services vendus"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 705 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 706 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TE" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Production stockée (ou déstockage)"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 73 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TF" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Production immobilisée"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 72 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TD" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Produits accessoires"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 707 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TG" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Subventions d'exploitation"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 71 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TH" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Autres produits"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 75 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TJ" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Reprises d'amortissements, provisions et dépréciations"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 791 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 798 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TI" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Transferts de charges d'exploitation"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 781 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TK" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Revenus financiers et assimilés"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 77 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

'If resultat = "UC" Then
'Sheets("feuil26").Range("c1") = resultat
'Sheets("feuil26").Range("d1") = "Gains de change"
'If Left(Sheets("feuil2").Cells(I, 1), 3) = 776 Then
'Sheets("feuil26").Cells(I + 2, 1) = Sheets("feuil2").Cells(I, 1) 'n°Compte
'Sheets("feuil26").Cells(I + 2, 2) = Sheets("feuil2").Cells(I, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(I + 2, 8) = Sheets("feuil2").Cells(I, 8) 'solde crédit
'Else
'End If
'Else
'End If

If resultat = "TL" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Reprises de provisions et dépréciations financières"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 797 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TM" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Transferts de charges financières"
If Left(Sheets("feuil2").Cells(i, 1), 3) = 787 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TN" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Produits des cessions d'immobilisations"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 82 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

If resultat = "TO" Then
Sheets("feuil26").Range("c1") = resultat
Sheets("feuil26").Range("d1") = "Autres produits H.A.O"
If Left(Sheets("feuil2").Cells(i, 1), 2) = 84 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 88 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 86 Then
Sheets("feuil26").Cells(i + 2, 1) = Sheets("feuil2").Cells(i, 1) 'n°Compte
Sheets("feuil26").Cells(i + 2, 2) = Sheets("feuil2").Cells(i, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
Sheets("feuil26").Cells(i + 2, 8) = Sheets("feuil2").Cells(i, 8) 'solde crédit
Else
End If
Else
End If

'If resultat = "UM" Then
'Sheets("feuil26").Range("c1") = resultat
'Sheets("feuil26").Range("d1") = "Reprises H.A.O"
'If Left(Sheets("feuil2").Cells(I, 1), 2) = 86 Then
'Sheets("feuil26").Cells(I + 2, 1) = Sheets("feuil2").Cells(I, 1) 'n°Compte
'Sheets("feuil26").Cells(I + 2, 2) = Sheets("feuil2").Cells(I, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(I + 2, 8) = Sheets("feuil2").Cells(I, 8) 'solde crédit
'Else
'End If
'Else
'End If

'If resultat = "UN" Then
'Sheets("feuil26").Range("c1") = resultat
'Sheets("feuil26").Range("d1") = "Transferts de charges H.A.O"
'If Left(Sheets("feuil2").Cells(I, 1), 3) = 848 Then
'Sheets("feuil26").Cells(I + 2, 1) = Sheets("feuil2").Cells(I, 1) 'n°Compte
'Sheets("feuil26").Cells(I + 2, 2) = Sheets("feuil2").Cells(I, 2) 'libellé
'Sheets("feuil26").Cells(i + 2, 7) = Sheets("feuil2").Cells(i, 7) 'solde débit
'Sheets("feuil26").Cells(I + 2, 8) = Sheets("feuil2").Cells(I, 8) 'solde crédit
'Else
'End If
'Else
'End If
    
Next


'fait les totaux des colonnes e,f,g et h
Sheets("feuil26").Range("e5004") = WorksheetFunction.Sum(Sheets("feuil26").Range("e3:e5000"))
Sheets("feuil26").Range("f5004") = WorksheetFunction.Sum(Sheets("feuil26").Range("f3:f5000"))
Sheets("feuil26").Range("g5004") = WorksheetFunction.Sum(Sheets("feuil26").Range("g3:g5000"))
Sheets("feuil26").Range("h5004") = WorksheetFunction.Sum(Sheets("feuil26").Range("h3:h5000"))

'message de non validité de la référence du poste saisir
If WorksheetFunction.Sum(Sheets("feuil26").Range("e5004:h5004")) = 0 Then
MsgBox "Désolé !  La référence saisie n'a pas pu être traitée."
Else
MsgBox "    FIN DE L'EDITION !"
End If


    'saisir la référence du poste (si resultat)
    End If


'demande de confirmation
End If

'condition de traitement du justif des postes
End If
End Sub
Private Sub affiche_analyse_financière()
Sheets("feuil31").Activate
End Sub
Private Sub note_34()
'condition générale de traitement de la NOTE 34
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else


'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 34
'annule les données du tableau
Sheets("feuil31").Range("e12:g66").ClearContents

For i = 3 To 5000
'recup N
'compte 654
If Left(Sheets("feuil2").Cells(i, 1), 3) = 654 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 754
If Left(Sheets("feuil2").Cells(i, 1), 3) = 754 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
Else
End If

'compte 77 sauf 776
If Left(Sheets("feuil2").Cells(i, 1), 2) = 77 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 776 Then
Else
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
End If
Else
End If

'compte 776
If Left(Sheets("feuil2").Cells(i, 1), 3) = 776 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
Else
End If

'compte 787
If Left(Sheets("feuil2").Cells(i, 1), 3) = 787 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
Else
End If

'compte 84 (sauf 848) + 88
If Left(Sheets("feuil2").Cells(i, 1), 2) = 84 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 88 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 848 Then
Else
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 8) 'Y
End If
Else
End If

'compte 848
If Left(Sheets("feuil2").Cells(i, 1), 3) = 848 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 8) 'Z
Else
End If

'compte 67 sauf 676
If Left(Sheets("feuil2").Cells(i, 1), 2) = 67 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 676 Then
Else
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 7) 'AA
End If
Else
End If

'compte 676
If Left(Sheets("feuil2").Cells(i, 1), 3) = 676 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 7) 'AB
Else
End If

'compte 83
If Left(Sheets("feuil2").Cells(i, 1), 2) = 83 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 7) 'AC
Else
End If

'compte 87
If Left(Sheets("feuil2").Cells(i, 1), 2) = 87 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 7) 'AD
Else
End If

'compte 89
If Left(Sheets("feuil2").Cells(i, 1), 2) = 89 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 7) 'AE
Else
End If



'recup N-1
'compte 654
If Left(Sheets("feuil1").Cells(i, 1), 3) = 654 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 754
If Left(Sheets("feuil1").Cells(i, 1), 3) = 754 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'U
Else
End If

'compte 77 sauf 776
If Left(Sheets("feuil1").Cells(i, 1), 2) = 77 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 776 Then
Else
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
End If
Else
End If

'compte 776
If Left(Sheets("feuil1").Cells(i, 1), 3) = 776 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'W
Else
End If

'compte 787
If Left(Sheets("feuil1").Cells(i, 1), 3) = 787 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 8) 'X
Else
End If

'compte 84 (sauf 848) + 88
If Left(Sheets("feuil1").Cells(i, 1), 2) = 84 Or Left(Sheets("feuil1").Cells(i, 1), 2) = 88 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 848 Then
Else
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 8) 'Y
End If
Else
End If

'compte 848
If Left(Sheets("feuil1").Cells(i, 1), 3) = 848 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 8) 'Z
Else
End If

'compte 67 sauf 676
If Left(Sheets("feuil1").Cells(i, 1), 2) = 67 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 676 Then
Else
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 7) 'AA
End If
Else
End If

'compte 676
If Left(Sheets("feuil1").Cells(i, 1), 3) = 676 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 7) 'AB
Else
End If

'compte 83
If Left(Sheets("feuil1").Cells(i, 1), 2) = 83 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 7) 'AC
Else
End If

'compte 87
If Left(Sheets("feuil1").Cells(i, 1), 2) = 87 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 7) 'AD
Else
End If

'compte 89
If Left(Sheets("feuil1").Cells(i, 1), 2) = 89 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 7) 'AE
Else
End If

Next

'______________________________________________________________________________________________

'affectation dans le tableau
'chiffre d'affaires
Sheets("feuil31").Range("e12") = (Sheets("feuil6").Range("i20")) / 1000 'N
Sheets("feuil31").Range("f12") = (Sheets("feuil6").Range("j20")) / 1000 'N-1
'marge commerciale
Sheets("feuil31").Range("e13") = (Sheets("feuil6").Range("i16")) / 1000 'N
Sheets("feuil31").Range("f13") = (Sheets("feuil6").Range("j16")) / 1000 'N-1
'valeur ajoutée
Sheets("feuil31").Range("e14") = (Sheets("feuil6").Range("i34")) / 1000 'N
Sheets("feuil31").Range("f14") = (Sheets("feuil6").Range("j34")) / 1000 'N-1
'E.B.E
Sheets("feuil31").Range("e15") = (Sheets("feuil6").Range("i36")) / 1000 'N
Sheets("feuil31").Range("f15") = (Sheets("feuil6").Range("j36")) / 1000 'N-1
'résultat d'exploitation
Sheets("feuil31").Range("e16") = (Sheets("feuil6").Range("i39")) / 1000 'N
Sheets("feuil31").Range("f16") = (Sheets("feuil6").Range("j39")) / 1000 'N-1
'résultat financier
Sheets("feuil31").Range("e17") = (Sheets("feuil6").Range("i45")) / 1000 'N
Sheets("feuil31").Range("f17") = (Sheets("feuil6").Range("j45")) / 1000 'N-1
'résultat ordinaire
Sheets("feuil31").Range("e18") = (Sheets("feuil6").Range("i46")) / 1000 'N
Sheets("feuil31").Range("f18") = (Sheets("feuil6").Range("j46")) / 1000 'N-1
'résultat H.A.O.
Sheets("feuil31").Range("e19") = (Sheets("feuil6").Range("i51")) / 1000 'N
Sheets("feuil31").Range("f19") = (Sheets("feuil6").Range("j51")) / 1000 'N-1
'résultat net
Sheets("feuil31").Range("e20") = (Sheets("feuil6").Range("i54")) / 1000 'N
Sheets("feuil31").Range("f20") = (Sheets("feuil6").Range("j54")) / 1000 'N-1

'E.B.E
Sheets("feuil31").Range("e22") = (Sheets("feuil6").Range("i36") - Abs(WorksheetFunction.Sum(Sheets("feuil18").Range("g111:g113")))) / 1000 'N
Sheets("feuil31").Range("f22") = (Sheets("feuil6").Range("j36") - Abs(WorksheetFunction.Sum(Sheets("feuil18").Range("h111:h113")))) / 1000 'N-1

'valeurs comptables de cessions courantes 645
Sheets("feuil31").Range("e23") = (WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000"))) / 1000 'N
Sheets("feuil31").Range("f23") = (WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000"))) / 1000 'N-1
'produits de cessions courantes 745
Sheets("feuil31").Range("e24") = (-WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000"))) / 1000 'N
Sheets("feuil31").Range("f24") = (-WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000"))) / 1000 'N-1
'revenus financiers - intérêts courus compte 276 (voir fiche explicative)
Sheets("feuil31").Range("e26") = (WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) + Sheets("feuil18").Range("g15")) / 1000 'N
Sheets("feuil31").Range("f26") = (WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) + Sheets("feuil18").Range("h15")) / 1000 'N-1
'gains de change
Sheets("feuil31").Range("e27") = (WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000"))) / 1000 'N
Sheets("feuil31").Range("f27") = (WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000"))) / 1000 'N-1
'transferts de charges financières
Sheets("feuil31").Range("e28") = (WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000"))) / 1000 'N
Sheets("feuil31").Range("f28") = (WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000"))) / 1000 'N-1
'produits HAO
Sheets("feuil31").Range("e29") = (WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000"))) / 1000 'N
Sheets("feuil31").Range("f29") = (WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000"))) / 1000 'N-1
'transferts de charges HAO
Sheets("feuil31").Range("e30") = (WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000"))) / 1000 'N
Sheets("feuil31").Range("f30") = (WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000"))) / 1000 'N-1
'frais financiers - intérêts cours comptes 166, 183 (voir fiche explicative)
Sheets("feuil31").Range("e31") = (-(WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) - Sheets("feuil18").Range("g16") - Sheets("feuil18").Range("g17"))) / 1000 'N
Sheets("feuil31").Range("f31") = (-(WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) - Sheets("feuil18").Range("h16") - Sheets("feuil18").Range("h17"))) / 1000 'N-1
'pertes de change
Sheets("feuil31").Range("e32") = (-WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000"))) / 1000 'N
Sheets("feuil31").Range("f32") = (-WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000"))) / 1000 'N-1
'charges HAO
Sheets("feuil31").Range("e33") = (-WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000"))) / 1000 'N
Sheets("feuil31").Range("f33") = (-WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000"))) / 1000 'N-1
'participation des travailleurs
Sheets("feuil31").Range("e34") = (-WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000"))) / 1000 'N
Sheets("feuil31").Range("f34") = (-WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000"))) / 1000 'N-1
'impôts sur le résultat
Sheets("feuil31").Range("e35") = (-WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000"))) / 1000 'N
Sheets("feuil31").Range("f35") = (-WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000"))) / 1000 'N-1

'distribution de dividendes
Sheets("feuil31").Range("e37") = (Sheets("feuil7").Range("g38")) / 1000 'N
Sheets("feuil31").Range("f37") = (Sheets("feuil7").Range("h38")) / 1000 'N-1

'capitaux propres
Sheets("feuil31").Range("e43") = (Sheets("feuil5").Range("m28")) / 1000 'N
Sheets("feuil31").Range("f43") = (Sheets("feuil5").Range("n28")) / 1000 'N-1
'dettes financières et assimilés + ECP - ECA (voir fiche explicative)
Sheets("feuil31").Range("e44") = (Sheets("feuil5").Range("m33") + Sheets("feuil18").Range("g92") + Sheets("feuil18").Range("g98") + Sheets("feuil18").Range("g103")) / 1000 'N
Sheets("feuil31").Range("f44") = (Sheets("feuil5").Range("n33") + Sheets("feuil18").Range("h92") + Sheets("feuil18").Range("h98") + Sheets("feuil18").Range("h103")) / 1000 'N-1
'actif immobilisé + ECA - ECP (voir fiche explicative)
Sheets("feuil31").Range("e46") = (-(Sheets("feuil5").Range("g34") - Sheets("feuil18").Range("g60") - Sheets("feuil18").Range("g73"))) / 1000 'N
Sheets("feuil31").Range("f46") = (-(Sheets("feuil5").Range("h34") - Sheets("feuil18").Range("h60") - Sheets("feuil18").Range("h73"))) / 1000 'N-1
'actif circulant d'exploitation + ECA
Sheets("feuil31").Range("e48") = (Sheets("feuil5").Range("g41") + Sheets("feuil5").Range("g46") + Sheets("feuil18").Range("g39") + Sheets("feuil18").Range("g51") + Sheets("feuil18").Range("g58") + Sheets("feuil18").Range("g67") + Sheets("feuil18").Range("g73") + Sheets("feuil18").Range("g92") + Sheets("feuil18").Range("g98") - Sheets("feuil5").Range("g35")) / 1000 'N
Sheets("feuil31").Range("f48") = (Sheets("feuil5").Range("h41") + Sheets("feuil5").Range("h46") + Sheets("feuil18").Range("h39") + Sheets("feuil18").Range("h51") + Sheets("feuil18").Range("h58") + Sheets("feuil18").Range("h67") + Sheets("feuil18").Range("h73") + Sheets("feuil18").Range("h92") + Sheets("feuil18").Range("h98") - Sheets("feuil5").Range("h35")) / 1000 'N-1
'passif circulant d'exploitation + ECP - compte 4726 (voir fiche explicative)
Sheets("feuil31").Range("e49") = (-(Sheets("feuil5").Range("m41") + Sheets("feuil5").Range("m46") - Sheets("feuil18").Range("g41") - Sheets("feuil18").Range("g53") - Sheets("feuil18").Range("g59") - Sheets("feuil18").Range("g60") - Sheets("feuil18").Range("g69") - Sheets("feuil18").Range("g103") - Sheets("feuil5").Range("m35") - Sheets("feuil18").Range("d107"))) / 1000  'N
Sheets("feuil31").Range("f49") = (-(Sheets("feuil5").Range("n41") + Sheets("feuil5").Range("n46") - Sheets("feuil18").Range("h41") - Sheets("feuil18").Range("h53") - Sheets("feuil18").Range("h59") - Sheets("feuil18").Range("h60") - Sheets("feuil18").Range("h69") - Sheets("feuil18").Range("h103") - Sheets("feuil5").Range("n35") - Sheets("feuil18").Range("e107"))) / 1000 'N-1
'actif circulant H.A.O. + ECA - ECP sur compte 485 (voir fiche explicative)
Sheets("feuil31").Range("e51") = (Sheets("feuil5").Range("g35") - Sheets("feuil18").Range("g67") - Sheets("feuil18").Range("g69")) / 1000 'N
Sheets("feuil31").Range("f51") = (Sheets("feuil5").Range("h35") - Sheets("feuil18").Range("h67") - Sheets("feuil18").Range("h69")) / 1000 'N-1
'passif circulant H.A.O. - ECA + ECP sur comptes 4811 et 4812 (voir fiche explicative)
Sheets("feuil31").Range("e52") = (-(Sheets("feuil5").Range("m35") + Sheets("feuil18").Range("g39") + Sheets("feuil18").Range("g51") + Sheets("feuil18").Range("g41") + Sheets("feuil18").Range("g53"))) / 1000 'N
Sheets("feuil31").Range("f52") = (-(Sheets("feuil5").Range("n35") + Sheets("feuil18").Range("h39") + Sheets("feuil18").Range("h51") + Sheets("feuil18").Range("h41") + Sheets("feuil18").Range("h53"))) / 1000 'N-1
'contrôle trésorerie nette - compte 4726 (voir fiche explicative)
Sheets("feuil31").Range("e57") = (Sheets("feuil5").Range("g45") - Sheets("feuil5").Range("m45") - Sheets("feuil18").Range("d107")) / 1000 'N
Sheets("feuil31").Range("f57") = (Sheets("feuil5").Range("h45") - Sheets("feuil5").Range("n45") - Sheets("feuil18").Range("e107")) / 1000 'N-1

'flux de trésorerie opérationnelle
Sheets("feuil31").Range("e59") = (Sheets("feuil7").Range("g23")) / 1000 'N
Sheets("feuil31").Range("f59") = (Sheets("feuil7").Range("h23")) / 1000 'N-1
'flux de trésorerie investissement
Sheets("feuil31").Range("e60") = (Sheets("feuil7").Range("g32")) / 1000 'N
Sheets("feuil31").Range("f60") = (Sheets("feuil7").Range("h32")) / 1000 'N-1
'flux de trésorerie financement
Sheets("feuil31").Range("e61") = (Sheets("feuil7").Range("g49")) / 1000 'N
Sheets("feuil31").Range("f61") = (Sheets("feuil7").Range("h49")) / 1000 'N-1

'dettes financières + trésorerie passif
Sheets("feuil31").Range("e64") = (Sheets("feuil5").Range("m30") + Sheets("feuil5").Range("m31") + Sheets("feuil5").Range("m45")) / 1000 'N
Sheets("feuil31").Range("f64") = (Sheets("feuil5").Range("n30") + Sheets("feuil5").Range("n31") + Sheets("feuil5").Range("n45")) / 1000 'N-1
'trésorerie actif
Sheets("feuil31").Range("e65") = (-Sheets("feuil5").Range("g45")) / 1000 'N
Sheets("feuil31").Range("f65") = (-Sheets("feuil5").Range("h45")) / 1000 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'CAF exploitation
Sheets("feuil31").Range("e25") = WorksheetFunction.Sum(Sheets("feuil31").Range("e22:e24")) 'N
Sheets("feuil31").Range("f25") = WorksheetFunction.Sum(Sheets("feuil31").Range("f22:f24")) 'N-1

'CAFG
Sheets("feuil31").Range("e36") = WorksheetFunction.Sum(Sheets("feuil31").Range("e25:e35")) 'N
Sheets("feuil31").Range("f36") = WorksheetFunction.Sum(Sheets("feuil31").Range("f25:f35")) 'N-1

'autofinancement
Sheets("feuil31").Range("e38") = Sheets("feuil31").Range("e36") + Sheets("feuil31").Range("e37") 'N
Sheets("feuil31").Range("f38") = Sheets("feuil31").Range("f36") + Sheets("feuil31").Range("f37") 'N-1

'rentabilité économique
'Insérer le taux BIC N
 Dim resultat As Variant
    resultat = InputBox("Veuillez saisir le taux de l'impôt sur le bénéfice de l'exercice N :" & Chr(10) & Chr(10) & "Exemple : Saisir 25 pour 25%.", "Taux IBIC") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    
    If (Sheets("feuil5").Range("m28") + Sheets("feuil5").Range("m30") + Sheets("feuil5").Range("m31")) = 0 Then
    Sheets("feuil31").Range("e40") = 0
    Else
    If Sheets("feuil6").Range("i39") > 0 Then
    Sheets("feuil31").Range("e40") = (Sheets("feuil6").Range("i39") * (100 - resultat) / 100) / (Sheets("feuil5").Range("m28") + Sheets("feuil5").Range("m30") + Sheets("feuil5").Range("m31")) 'N
    Else
    Sheets("feuil31").Range("e40") = (Sheets("feuil6").Range("i39") * 1) / (Sheets("feuil5").Range("m28") + Sheets("feuil5").Range("m30") + Sheets("feuil5").Range("m31")) 'N
    End If
    End If
    'Si la valeur est différente de "" on affiche le résultat
    Else
    If (Sheets("feuil5").Range("m28") + Sheets("feuil5").Range("m30") + Sheets("feuil5").Range("m31")) = 0 Then
    Sheets("feuil31").Range("e40") = 0
    Else
    Sheets("feuil31").Range("e40") = (Sheets("feuil6").Range("i39") * 1) / (Sheets("feuil5").Range("m28") + Sheets("feuil5").Range("m30") + Sheets("feuil5").Range("m31")) 'N
    End If
    End If
'Insérer le taux BIC N-1
 Dim resultat1 As Variant
    resultat1 = InputBox("Veuillez saisir le taux de l'impôt sur le bénéfice de l'exercice N-1 :" & Chr(10) & Chr(10) & "Exemple : Saisir 25 pour 25%.", "Taux IBIC") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat1 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    
    If (Sheets("feuil5").Range("n28") + Sheets("feuil5").Range("n30") + Sheets("feuil5").Range("n31")) = 0 Then
    Sheets("feuil31").Range("f40") = 0
    Else
    If Sheets("feuil6").Range("j39") > 0 Then
    Sheets("feuil31").Range("f40") = (Sheets("feuil6").Range("j39") * (100 - resultat1) / 100) / (Sheets("feuil5").Range("n28") + Sheets("feuil5").Range("n30") + Sheets("feuil5").Range("n31")) 'N-1
    Else
    Sheets("feuil31").Range("f40") = (Sheets("feuil6").Range("j39") * 1) / (Sheets("feuil5").Range("n28") + Sheets("feuil5").Range("n30") + Sheets("feuil5").Range("n31")) 'N-1
    End If
    End If
    'Si la valeur est différente de "" on affiche le résultat
    Else
    If (Sheets("feuil5").Range("n28") + Sheets("feuil5").Range("n30") + Sheets("feuil5").Range("n31")) = 0 Then
    Sheets("feuil31").Range("f40") = 0
    Else
    Sheets("feuil31").Range("f40") = (Sheets("feuil6").Range("j39") * 1) / (Sheets("feuil5").Range("n28") + Sheets("feuil5").Range("n30") + Sheets("feuil5").Range("n31")) 'N-1
    End If
    End If
    
'rentabilité financière
If Sheets("feuil5").Range("m28") = 0 Then
Sheets("feuil31").Range("e41") = 0
Else
Sheets("feuil31").Range("e41") = Sheets("feuil6").Range("i54") / Sheets("feuil5").Range("m28") 'N
End If
If Sheets("feuil5").Range("n28") = 0 Then
Sheets("feuil31").Range("f41") = 0
Else
Sheets("feuil31").Range("f41") = Sheets("feuil6").Range("j54") / Sheets("feuil5").Range("n28") 'N-1
End If

'ressources stables
Sheets("feuil31").Range("e45") = WorksheetFunction.Sum(Sheets("feuil31").Range("e43:e44")) 'N
Sheets("feuil31").Range("f45") = WorksheetFunction.Sum(Sheets("feuil31").Range("f43:f44")) 'N-1

'fonds de roulement
Sheets("feuil31").Range("e47") = WorksheetFunction.Sum(Sheets("feuil31").Range("e45:e46")) 'N
Sheets("feuil31").Range("f47") = WorksheetFunction.Sum(Sheets("feuil31").Range("f45:f46")) 'N-1

'BF A.O.
Sheets("feuil31").Range("e50") = WorksheetFunction.Sum(Sheets("feuil31").Range("e48:e49")) 'N
Sheets("feuil31").Range("f50") = WorksheetFunction.Sum(Sheets("feuil31").Range("f48:f49")) 'N-1

'BF H.A.O.
Sheets("feuil31").Range("e53") = WorksheetFunction.Sum(Sheets("feuil31").Range("e51:e52")) 'N
Sheets("feuil31").Range("f53") = WorksheetFunction.Sum(Sheets("feuil31").Range("f51:f52")) 'N-1

'BF GLOBAL
Sheets("feuil31").Range("e54") = Sheets("feuil31").Range("e50") + Sheets("feuil31").Range("e53") 'N
Sheets("feuil31").Range("f54") = Sheets("feuil31").Range("f50") + Sheets("feuil31").Range("f53") 'N-1

'trésorerie nette
Sheets("feuil31").Range("e56") = Sheets("feuil31").Range("e47") - Sheets("feuil31").Range("e54") 'N
Sheets("feuil31").Range("f56") = Sheets("feuil31").Range("f47") - Sheets("feuil31").Range("f54") 'N-1

'variation de la trésorerie nette période
Sheets("feuil31").Range("e62") = WorksheetFunction.Sum(Sheets("feuil31").Range("e59:e61")) 'N
Sheets("feuil31").Range("f62") = WorksheetFunction.Sum(Sheets("feuil31").Range("f59:f61")) 'N-1

'endettement financier net
Sheets("feuil31").Range("e66") = WorksheetFunction.Sum(Sheets("feuil31").Range("e64:e65")) 'N
Sheets("feuil31").Range("f66") = WorksheetFunction.Sum(Sheets("feuil31").Range("f64:f65")) 'N-1


'variation en % stocks
For i = 12 To 66
If Sheets("feuil31").Cells(i, 6) = 0 Then
Else
If Sheets("feuil31").Cells(i, 6) < 0 Then
Sheets("feuil31").Cells(i, 7) = -1 * ((Sheets("feuil31").Cells(i, 5) - Sheets("feuil31").Cells(i, 6)) / Sheets("feuil31").Cells(i, 6))
Else
Sheets("feuil31").Cells(i, 7) = (Sheets("feuil31").Cells(i, 5) - Sheets("feuil31").Cells(i, 6)) / Sheets("feuil31").Cells(i, 6)
End If
End If
Next


'variation en nombre de points
'rentabilité économique
Sheets("feuil31").Range("g40") = (Left((Sheets("feuil31").Range("e40") - Sheets("feuil31").Range("f40")) * 100, 6)) & " points"
'rentabilité financière
Sheets("feuil31").Range("g41") = (Left((Sheets("feuil31").Range("e41") - Sheets("feuil31").Range("f41")) * 100, 6)) & " points"


'_______________________________________________________________________________________


If Abs(Sheets("feuil18").Range("g26")) + Abs(Sheets("feuil18").Range("g27")) + Abs(Sheets("feuil18").Range("h26")) + Abs(Sheets("feuil18").Range("h27")) = 0 Then
MsgBox "    FIN DE L'EDITION  !"
Else
MsgBox "FIN DE L'EDITION  !" & Chr(10) & Chr(10) & "NB : Les Ecarts de conversion ont été éliminés conformément aux données de la FICHE explicative des encaissements et des décaissements validée."
End If

If Abs(Sheets("feuil18").Range("g111")) + Abs(Sheets("feuil18").Range("g112")) + Abs(Sheets("feuil18").Range("g113")) + Abs(Sheets("feuil18").Range("h111")) + Abs(Sheets("feuil18").Range("h112")) + Abs(Sheets("feuil18").Range("h113")) = 0 Then
Else
MsgBox "E.B.E. ET CAFG  !" & Chr(10) & Chr(10) & "NB : L'E.B.E. et la CAFG ont été corrigés des productions immobilisées conformément à la FICHE explicative des encaissements et des décaissements validée."
End If

If Abs(Sheets("feuil18").Range("g15")) + Abs(Sheets("feuil18").Range("g16")) + Abs(Sheets("feuil18").Range("g17")) + Abs(Sheets("feuil18").Range("h15")) + Abs(Sheets("feuil18").Range("h16")) + Abs(Sheets("feuil18").Range("h17")) = 0 Then
Else
MsgBox "CAFG  !" & Chr(10) & Chr(10) & "NB : La CAFG a été corrigée des intérêts courus conformément à la FICHE explicative des encaissements et des décaissements validée."
End If

If Abs(Sheets("feuil18").Range("g25")) + Abs(Sheets("feuil18").Range("h25")) = 0 Then
Else
MsgBox "TRESORERIE  !" & Chr(10) & Chr(10) & "NB : La Trésorerie  a été corrigée du solde du compte 4726 conformément à la FICHE explicative des encaissements et des décaissements validée."
End If


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents

'efface les pourcentages à ne pas calculer
Sheets("feuil31").Range("g22:g24").ClearContents
Sheets("feuil31").Range("g26:g35").ClearContents

'demande de confirmation
End If

'condition générale de traitement
End If
End Sub
Private Sub imprimer_feuil31()
Application.Sheets("feuil31").PrintPreview
End Sub
Private Sub imprimer_toute_la_liasse()
Application.Sheets("feuil3").PrintPreview
Application.Sheets("feuil4").PrintPreview
Application.Sheets("feuil5").PrintPreview
Application.Sheets("feuil8").PrintPreview
Application.Sheets("feuil6").PrintPreview
Application.Sheets("feuil9").PrintPreview
Application.Sheets("feuil10").PrintPreview
Application.Sheets("feuil11").PrintPreview
Application.Sheets("feuil12").PrintPreview
Application.Sheets("feuil13").PrintPreview
Application.Sheets("feuil7").PrintPreview
Application.Sheets("feuil14").PrintPreview
Application.Sheets("feuil23").PrintPreview
Application.Sheets("feuil15").PrintPreview
Application.Sheets("feuil16").PrintPreview
Application.Sheets("feuil17").PrintPreview
Application.Sheets("feuil18").PrintPreview
Application.Sheets("feuil19").PrintPreview
Application.Sheets("feuil20").PrintPreview
Application.Sheets("feuil21").PrintPreview
Application.Sheets("feuil22").PrintPreview

End Sub
Private Sub lire_postulat_1()
Sheets("feuil9").Range("a7") = 1
MsgBox "POSTULAT DE L'ENTITE  !" & Chr(10) & Chr(10) & "L'entité est considérée comme étant une personne morale ou un groupe autonome et distinct de ses propriétaires et de ses partenaires économiques." & Chr(10) & Chr(10) & "La comptabilité financière est fondée sur la séparation entre le patrimoine de l'entité et celui de ses propriétaires."
Sheets("feuil9").Range("a7").ClearContents
End Sub
Private Sub lire_postulat_2()
Sheets("feuil9").Range("a8") = 1
MsgBox "POSTULAT DE LA COMPTABILITE D'ENGAGEMENT  !" & Chr(10) & Chr(10) & "Les effets des transactions et autres évènements sont pris en compte dès que ces transactions ou évènements se produisent et non au moment des encaissements ou paiements." & Chr(10) & Chr(10) & "Ils sont enregistrés dans les livres comptables et présentés dans les états financiers des exercices auxquels ils se rattachent."
Sheets("feuil9").Range("a8").ClearContents
End Sub
Private Sub lire_postulat_3()
Sheets("feuil9").Range("a9") = 1
MsgBox "POSTULAT DE LA SPECIALISATION DES EXERCICES  !" & Chr(10) & Chr(10) & "La vie de l'entité étant découpée en périodes appelées << exercices >> à l'issue desquels sont publiés des états financiers annuels, il faut rattacher à chaque exercice tous les produits et les charges qui le concernent, et ceux-là seulement." & Chr(10) & Chr(10) & "Le respect de ce postulat est assuré par le biais de comptes dits de régularisation qui permettent d'ajuster les produits et les charges dans le temps."
Sheets("feuil9").Range("a9").ClearContents
End Sub
Private Sub lire_postulat_4()
Sheets("feuil9").Range("a10") = 1
MsgBox "POSTULAT DE LA PERMANENCE DES METHODES  !" & Chr(10) & Chr(10) & "Ce postulat exige que les mêmes méthodes comptables et règles d'évaluation et de présentation des comptes soient utilisées par l'entité d'une période à l'autre." & Chr(10) & Chr(10) & "On peut cependant déroger à la fixité des méthodes si un changement exceptionnel intervient, notamment la réglementation comptable, les corrections d'erreurs, les changements d'options fiscales, etc..."
Sheets("feuil9").Range("a10").ClearContents
End Sub
Private Sub lire_postulat_5()
Sheets("feuil9").Range("a11") = 1
MsgBox "POSTULAT DE LA PREEMINENCE DE LA REALITE ECONOMIQUE SUR L'APPARENCE JURIDIQUE  !" & Chr(10) & Chr(10) & "Pour que l'information représente d'une manière pertinente les transactions et autres évènements qu'elle vise à représenter, il est nécessaire qu'ils soient enregistrés et présentés en accord avec leur substance et la réalité économique et non pas seulement selon leur forme juridique." & Chr(10) & Chr(10) & "Le SYSCOHADA limite, cependant, l'application de ce postulat à quatre (4) opérations :" & Chr(10) & " - L'inscription à l'actif du bilan des biens acquis avec réserve de propriété ;" & Chr(10) & " - L'inscription à l'actif du bilan des biens en location acquisition chez le preneur ;" & Chr(10) & " - L'inscription à l'actif du bilan des effets escomptés non encore échus ;" & Chr(10) & " - L'inscription dans les << charges de personnel >> du personnel facturé par d'autres entités (le personnel intérimaire)."
MsgBox "POSTULAT DE LA PREEMINENCE DE LA REALITE ECONOMIQUE SUR L'APPARENCE JURIDIQUE  ! (suite et fin)" & Chr(10) & Chr(10) & "NB : Dans les contrats de concessions de service public, le SYSCOHADA révisé exclut de l'actif du bilan du concessionnaire les apports en immobilisations du concédant car ne répondant pas à la définition d'un actif (ressource économique actuelle contrôlée par l'entité)."
Sheets("feuil9").Range("a11").ClearContents
End Sub
Private Sub lire_chapitre_1()
Sheets("feuil9").Range("a28") = 1
MsgBox "FRAIS DE RECHERCHE ET DE DEVELOPPEMENT  ! (IAS 38)" & Chr(10) & Chr(10) & "Ces frais sont immobilisables si l'entité peut clairement distinguer la phase de recherche de la phase de développement." & Chr(10) & Chr(10) & "Seuls les frais de développement seront immobilisés dans le compte 211 par le crédit du 721, si l'entité peut démontrer simultanément les six (6) critères suivants :" & Chr(10) & " - La faisabilité technique nécessaire à l'achèvement de l'immobilisation incorporelle en vue de sa mise en service ou de sa vente ;" & Chr(10) & " - Son intention d'achever l'immobilisation incorporelle et de l'utiliser ou de la vendre ;" & Chr(10) & " - Sa capacité à utiliser ou à vendre l'immobilisation incorporelle ;" & Chr(10) & " - La façon dont l'immobilisation incorporelle générera des avantages économiques futurs probables ;" & Chr(10) & " - La disponibilité de ressources techniques, financières et autres, pour achever le développement et utiliser ou vendre l'immobilisation incorporelle ; et"
MsgBox "FRAIS DE RECHERCHE ET DE DEVELOPPEMENT  ! (suite et fin)" & Chr(10) & Chr(10) & " - Sa capacité à évaluer de manière fiable les dépenses attribuables à l'immobilisation incorporelle au cours de son développement." & Chr(10) & "A défaut, ces dépenses constituent des charges." & Chr(10) & Chr(10) & "NB : Les frais de recherche appliquée ne sont donc plus immobilisables !"
Sheets("feuil9").Range("a28").ClearContents
End Sub
Private Sub lire_chapitre_2()
Sheets("feuil9").Range("a29") = 1
MsgBox "BREVETS, LICENCES, MARQUES, LOGICIELS, SITES INTERNET ET AUTRES DROITS SIMILAIRES  ! (IAS 38, IFRS 15)" & Chr(10) & Chr(10) & "Les innovations apportées par le SYSCOHADA révisé portent sur :" & Chr(10) & Chr(10) & "1°/ LES SITES INTERNET :" & Chr(10) & " - Les sites acquis << clés en mains >> sont immobilisables dans le compte 2132 s'ils ne sont pas de faible valeur." & Chr(10) & " - Les sites d'e-commerce créés par l'entité sont immobilisables dans le compte 2132 s'ils respectent les six (6) critères d'immobilisation des frais de développement évoqués au chapitre 1." & Chr(10) & " - Les sites publicitaires créés par l'entité sont à comptabiliser en charges d'exploitation." & Chr(10) & Chr(10) & "2°/ LES PAS DE PORTE : C'est la somme versée au propriétaire d'un local commercial, en sus du prix de location et différent du droit au bail. Selon le SYSCOHADA révisé, il s'agit d'un complément de loyer à répartir sur la durée du bail ainsi :" & Chr(10) & " - Lors du versement, le compte 622 sera débité"
MsgBox "BREVETS, LICENCES, MARQUES, LOGICIELS, SITES INTERNET ET AUTRES DROITS SIMILAIRES  ! (suite)" & Chr(10) & Chr(10) & "   par le crédit de la trésorerie." & Chr(10) & " - En fin d'exercice, le compte 622 sera extourné par le débit du 476 pour le montant des exercices suivants. Le compte 476 sera repris au compte de résultat sur la durée restante du bail." & Chr(10) & Chr(10) & "3°/ LES FICHIERS CLIENTS : Les fichiers clients acquis par l'entité sont comptabilisés dans le compte 2183 tandis que les dépenses engagées pour créer en interne des fichiers clients, notices, titres de journaux et magazines sont comptabilisées en charges d'exploitation." & Chr(10) & Chr(10) & "4°/ LES APPELS D'OFFRE :" & Chr(10) & " - Les coûts d'obtention d'un contrat (commissions sur ventes ou au succès) ré facturables au client sont comptabilisés dans le compte 2182." & Chr(10) & " - Par contre les coûts encourus pour répondre à des appels d'offre et les frais marketings ne sont pas à intégrer dans le compte 2182."
MsgBox "BREVETS, LICENCES, MARQUES, LOGICIELS, SITES INTERNET ET AUTRES DROITS SIMILAIRES  ! (suite )" & Chr(10) & Chr(10) & "5°/ LE FONDS COMMERCIAL :" & Chr(10) & " - Le fonds commercial n'est, en principe, pas amortissable. Le SYSCOHADA révisé rend obligatoire l'amortissement du fonds commercial lorsque la durée d'utilité est limitée et déterminable. A défaut cette durée est limitée à 10 ans." & Chr(10) & " - Les comptes à mouvementer sont le 6812 au débit par le crédit du 2815." & Chr(10) & " - Le fonds commercial, créé par l'entité, ne peut jamais constituer une immobilisation incorporelle." & Chr(10) & Chr(10) & "NB : LES AUTRES POSTES de ce chapitre n'ont pas connu de grandes modifications, notamment :" & Chr(10) & Chr(10) & "LES BREVETS" & Chr(10) & " - Les brevets acquis sont enregistrés au débit du compte 2121 à leur coût d'acquisition ;" & Chr(10) & " - Les brevets créés en interne sont enregistrés au débit du compte 2121 par le crédit du compte 211 (frais de développement et dépôt du brevet) ;"
MsgBox "BREVETS, LICENCES, MARQUES, LOGICIELS, SITES INTERNET ET AUTRES DROITS SIMILAIRES  ! (suite)" & Chr(10) & Chr(10) & " - Les brevets sont amortis sur leur durée de protection ou durée effective d'utilisation si elle est différente." & Chr(10) & Chr(10) & "LES LICENCES" & Chr(10) & " - Les licences sont enregistrées au débit du compte 2122 à leur coût d'acquisition ;" & Chr(10) & " - Les licences sont amorties sur leur durée probable d'utilisation qui ne peut excéder la durée d'autorisation." & Chr(10) & " - Les redevances périodiques sont comptabilisées au débit du compte 634." & Chr(10) & Chr(10) & "LES LOGICIELS" & Chr(10) & " - Les logiciels indissociables du matériel entrent dans le coût d'acquisition du matériel ;" & Chr(10) & " - Les logiciels autonomes à usage interne acquis entrent à leur coût d'acquisition au débit du compte 2131 par le crédit du compte 4811 ;" & Chr(10) & " - Les logiciels autonomes à usage interne créés entrent à leur coût de production au débit du compte 2131 ;"
MsgBox "BREVETS, LICENCES, MARQUES, LOGICIELS, SITES INTERNET ET AUTRES DROITS SIMILAIRES  ! (suite et fin)" & Chr(10) & Chr(10) & " - Les logiciels acquis pour être revendus en l'état sont des marchandises à comptabiliser dans le compte 601 ;" & Chr(10) & " - Les logiciels créés pour une commande client sont des produits finis (compte 36). En cours de production, ils sont comptabilisés dans le compte 352 (Prestations de service en cours) ;" & Chr(10) & " - Les logiciels acquis ou créés à usage interne sont amortis sur leur durée probable d'utilisation." & Chr(10) & Chr(10) & "LES MARQUES" & Chr(10) & " - Les marques, droit de propriété industrielle, entrent à leur coût d'enregistrement auprès de l'institut de propriété intellectuel au débit du compte 214 ;" & Chr(10) & " - Les marques ne sont généralement pas amortissables car leur durée d'utilisation est illimitée. Lorsque la durée d'utilité est déterminable par l'entité alors l'amortissement doit être pratiqué."
Sheets("feuil9").Range("a29").ClearContents
End Sub
Private Sub lire_chapitre_3()
Sheets("feuil9").Range("a30") = 1
MsgBox "FRAIS DE PROSPECTION ET D'EXPLOITATION DES RESSOURCES MINERALES  ! (IFRS 6, IFRIC 20)" & Chr(10) & Chr(10) & "1°/ FRAIS DE PROSPECTION ET D'EVALUATION : Ce sont les dépenses encourues par l'entité après obtention du droit de prospecter et avant que la faisabilité technique et la viabilité commerciale de l'extraction soient démontrées." & Chr(10) & " - Ces frais de prospection sont immobilisés dans le compte 2181 pour la partie incorporelle (exemple : acquisition de droit de prospecter ou droit de forage) et/ou en immobilisation corporelle (exemple : véhicule destiné au forage)." & Chr(10) & " - Les frais de prospection et d'évaluation sont amortissables et dépréciables et cessent d'être qualifiés ainsi lorsque la faisabilité technique et la viabilité commerciale de l'extraction sont démontrées. Ils sont de ce fait réaffectés dans d'autres comptes." & Chr(10) & Chr(10) & "2°/ FRAIS DE DECOUVERTURE : La découverture est l'opération qui consiste à enlever des morts-terrains pour avoir"
MsgBox "FRAIS DE PROSPECTION ET D'EXPLOITATION DES RESSOURCES MINERALES  ! (suite et fin)" & Chr(10) & Chr(10) & "accès au gisement dans l'exploitation d'une mine à ciel ouvert." & Chr(10) & " - Si l'opération de découverture prend la forme de stocks que produit la mine, les frais engagés sont comptabilisés conformément au traitement des stocks." & Chr(10) & " - Par contre, si l'opération permet un meilleur accès au minerai à extraire, les frais engagés sont comptabilisés comme un composant de l'actif existant." & Chr(10) & Chr(10) & "3°/ ACQUISITION D'UN GÎTE DE CARRIERE :" & Chr(10) & " -  L'opération est considérée comme l'acquisition d'un stock de matières premières (matériaux à extraire) à inscrire dans le compte 32 et d'un terrain de carrières (tréfonds) à inscrire dans le compte 225." & Chr(10) & " - Les redevances de fortage éventuelles qui rémunèrent cette acquisition sont comptabilisées en charges et constituent un élément du coût de revient des matériaux extraits."
Sheets("feuil9").Range("a30").ClearContents
End Sub
Private Sub lire_chapitre_4()
Sheets("feuil9").Range("a31") = 1
MsgBox "APPROCHE PAR COMPOSANTS  ! (IAS 16)" & Chr(10) & Chr(10) & "Les immobilisations susceptibles d'être décomposées sont celles dont la valeur est significative et qui contiennent des éléments ayant une durée de vie propre. Exemple :" & Chr(10) & " - Les bâtiments et autres ouvrages, les avions, les bateaux, camions, autocars, bus, véhicules blindés de transport de fonds ;" & Chr(10) & " - Certains matériels et outillages des entités industrielles, minières, agricoles, hospitalières et pétrolières." & Chr(10) & Chr(10) & "Sont de ce fait exclues de la décomposition, les immobilisations de faible valeur et de durée de vie courte telles que :" & Chr(10) & " - Les matériels informatiques ;" & Chr(10) & " - Les véhicules de tourisme ;" & Chr(10) & " - Les matériels et mobiliers de bureau." & Chr(10) & Chr(10) & "L'affectation des valeurs entre la structure et ses composants doit se faire sur la base des factures des fournisseurs ou de données techniques. A défaut, la décomposition pourra se faire lors de"
MsgBox "APPROCHE PAR COMPOSANTS  ! (suite et fin)" & Chr(10) & Chr(10) & "la survenance des dépenses de remplacement." & Chr(10) & Chr(10) & "Un plan d'amortissement est établi pour la structure et pour chacun de ses composants, ces derniers étant comptabilisés dans des sous comptes de l'actif-structure." & Chr(10) & "Par ailleurs :" & Chr(10) & " - Un composant ne peut avoir de valeur résiduelle, étant donné qu'il doit être remplacé avant la fin de la durée de vie de la structure." & Chr(10) & " - Les composants ayant une fréquence de remplacement inférieure à douze (12) mois devront être éliminés. Les coûts de ces remplacements constituent une charge de l'exercice."
Sheets("feuil9").Range("a31").ClearContents
End Sub
Private Sub lire_chapitre_5()
Sheets("feuil9").Range("a32") = 1
MsgBox "FRAIS D'INSPECTIONS OU DE REVISIONS MAJEURES, DEPENSES DE SECURITE ET DE MISE EN CONFORMITE  ! (IAS 16)" & Chr(10) & Chr(10) & "1°/ FRAIS D'INSPECTIONS OU DE REVISIONS MAJEURES :" & Chr(10) & "Lorsqu'un actif fait l'objet de visites ou de révisions significatives, effectuées à intervalles réguliers, le coût de ces révisions est comptabilisé comme un composant dans un sous compte de l'immobilisation principale." & Chr(10) & "En conséquence :" & Chr(10) & " - Dès la date de comptabilisation initiale de l'actif, un composant << Révisions majeures >> est comptabilisé séparément des composants physiques et de la structure et est amorti sur la durée restant à courir jusqu'à la prochaine révision ;" & Chr(10) & " - Lorsque la révision est réalisée, la dépense est inscrite en tant qu'actif distinct dès lors que les critères d'immobilisation sont remplis et elle est amortie sur la durée séparant deux (2) révisions ; la valeur nette comptable des coûts de la précédente révision est alors sortie de l'actif."
MsgBox "FRAIS D'INSPECTIONS OU DE REVISIONS MAJEURES, DEPENSES DE SECURITE ET DE MISE EN CONFORMITE  ! (suite et fin)" & Chr(10) & Chr(10) & "NB : Aucune provision pour grosse réparation n'est à constituer au cours d'une telle opération !" & Chr(10) & Chr(10) & "2°/ LES DEPENSES DE SECURITE ET DE MISE EN CONFIRMITE sont immobilisables en tant que composant si les conditions d'immobilisation sont remplies." & Chr(10) & "Notamment, si les dépenses effectuées conditionnent l'obtention d'avantages économiques futurs." & Chr(10) & "NB : Aucune provision n'est à constituer pour ces dépenses également."
Sheets("feuil9").Range("a32").ClearContents
End Sub
Private Sub lire_chapitre_6()
Sheets("feuil9").Range("a34") = 1
MsgBox "COÛT DE DEMANTELEMENT, D'ENLEVEMENT ET DE REMISE EN ETAT DU SITE  !" & Chr(10) & Chr(10) & "Les dépenses de remise en état des sites et de démantèlement en fin d'exploitation doivent généralement faire l'objet d'une provision. Deux (2) situations peuvent se présenter :" & Chr(10) & Chr(10) & "1°/ DEGRADATION IMMEDIATE : L'obligation de démantèlement d'une plate-forme pétrolière existe du fait même de sa construction, alors même qu'elle ne sera jamais mise en service. Dans le cas de la dégradation immédiate :" & Chr(10) & " - Les coûts futurs sont actualisés et comptabilisés en provision au crédit du compte 1984 par le débit d'un sous compte d'immobilisation, composant de l'actif à démanteler." & Chr(10) & " - La désactualisation de la provision chaque année est constatée par le débit du compte 6971 et le crédit du compte 1984." & Chr(10) & Chr(10) & "2°/ DEGRADATION PROGRESSIVE : Dans cette situation, c'est l'exploitation même du site (mines, carrières, gravières) qui occasionne la dégradation ;"
MsgBox "COÛT DE DEMANTELEMENT, D'ENLEVEMENT ET DE REMISE EN ETAT DU SITE  ! (suite et fin)" & Chr(10) & Chr(10) & "cette dégradation naît progressivement, au fur et à mesure de l'exploitation du site. Dans ce cas :" & Chr(10) & " - Une provision doit être constituée, au crédit du compte 1984, à hauteur du montant des travaux correspondant à la dégradation effective du site à la date de clôture de l'exercice." & Chr(10) & " - Cependant, en contrepartie de cette provision il n'y a pas lieu de constater un actif mais une charge au débit du compte 6911." & Chr(10) & Chr(10) & "3°/ EN FIN D'EXPLOITATION :" & Chr(10) & " - Lorsque les dépenses de démantèlement sont engagées, elles sont enregistrées au débit du compte 6244 par le crédit d'un compte de tiers ou de trésorerie ;" & Chr(10) & " - La provision est reprise entièrement en débitant le compte 1984 par le crédit du 7911 et du 7971 pour la partie issue de la désactualisation."
Sheets("feuil9").Range("a34").ClearContents
End Sub
Private Sub lire_chapitre_7()
Sheets("feuil9").Range("a35") = 1
MsgBox "COÛT D'EMPRUNTS  ! (IAS 23)" & Chr(10) & Chr(10) & "Un actif qualifié à la capitalisation des coûts d'emprunt est un actif (immobilisations, stocks) qui exige une longue période de préparation (supérieure ou égale à 12 mois) avant son utilisation ou sa vente." & Chr(10) & "Si l'entité retient une période inférieure à 12 mois, elle doit justifier son choix dans les notes annexes." & Chr(10) & Chr(10) & "L'incorporation des coûts d'emprunt, à l'aide du compte 787, commence lorsque l'entité remplit les conditions suivantes :" & Chr(10) & " - Des dépenses relatives au bien ont été réalisées ;" & Chr(10) & " - Des coûts d'emprunt sont encourus ; et" & Chr(10) & " - Les activités indispensables à la préparation de l'actif préalablement à son utilisation ou à sa vente sont en cours." & Chr(10) & Chr(10) & "NB : Lorsque l'entité se finance globalement, le montant des coûts d'emprunt incorporables au coût de l'actif doit être déterminé en appliquant un taux de capitalisation aux dépenses de l'actif."
Sheets("feuil9").Range("a35").ClearContents
End Sub
Private Sub lire_chapitre_8()
Sheets("feuil9").Range("a36") = 1
MsgBox "CONTRAT DE LOCATION  ! (IFRS 16)" & Chr(10) & Chr(10) & "1°/ CRITERES DE CONTRAT LOCATION ACQUISITION / FINANCEMENT :" & Chr(10) & "Un contrat est qualifié de location acquisition/financement lorsque les critères ci-dessous sont remplis :" & Chr(10) & " - Le preneur choisit la levée d'option d'achat ;" & Chr(10) & " - La durée du contrat est supérieure à 12 mois ;" & Chr(10) & " - La valeur du bien à neuf est significative. Ce critère exclut de facto les biens de faible valeur tels les ordinateurs de bureau et portable ainsi que les mobiliers de bureau." & Chr(10) & Chr(10) & "2°/ ECRITURES CHEZ LE PRENEUR :" & Chr(10) & " - A la signature du contrat, débit d'un compte 2. d'immobilisation par le crédit du compte 17 pour le montant du contrat." & Chr(10) & " - Lors du paiement des loyers, débit du compte 623 par le crédit du compte 52. ou du tiers." & Chr(10) & " - En fin d'année, débit des comptes 672 (intérêts dans les loyers) et 17 (capital remboursé) par le crédit du 623 (loyers payés l'année)."
MsgBox "CONTRAT DE LOCATION  ! (suite)" & Chr(10) & Chr(10) & "Toujours en fin d'année, le bien sera amorti s'il est amortissable et les intérêts courus seront constatés par le débit du 627 et le crédit du 176." & Chr(10) & Chr(10) & "3°/ ECRITURES CHEZ LE BAILLEUR (fabricant ou distributeur) :" & Chr(10) & " - A la signature du contrat, débit du compte 2718 par le crédit du compte 70.Vente pour le montant du contrat." & Chr(10) & " - Lors du paiement des loyers, débit du 52.Trésorerie par le crédit des comptes 2718 (capital restitué) et du compte 775 (intérêts dans les loyers)." & Chr(10) & " - En fin d'année, les intérêts courus éventuels seront constatés au crédit du 775 par le débit du 2761." & Chr(10) & Chr(10) & "4°/ CONTRAT DE LOCATION SIMPLE :" & Chr(10) & " - Les contrats de location simple sont ceux qui ne respectent pas les critères d'un contrat de location acquisition/financement." & Chr(10) & " - Seules les écritures de règlement des loyers seront passées chez le preneur comme chez le bailleur."
MsgBox "CONTRAT DE LOCATION  ! (suite et fin)" & Chr(10) & Chr(10) & "5°/ LA SOUS-LOCATION :" & Chr(10) & " - Dans la sous-location le preneur devient un bailleur, appelé bailleur intermédiaire." & Chr(10) & " - Le traitement comptable entre le bailleur intermédiaire et le nouveau preneur se fait en fonction de la qualification du contrat qui les lie, en contrat de location acquisition/financement ou en contrat de location simple." & Chr(10) & Chr(10) & "NB :" & Chr(10) & "- Les textes recommandent que les biens acquis en location acquisition soient amortis sur la durée d'utilité du bien. Il faudra aussi vérifier la réglementation fiscale à ce sujet." & Chr(10) & "- Des nouveaux comptes ont été créés pour le suivi des biens pris en location acquisition chez le preneur. Ce sont : 2286, 2316, 2326, 2416, 2426, 2446, 2456."
Sheets("feuil9").Range("a36").ClearContents
End Sub
Private Sub lire_chapitre_9()
Sheets("feuil9").Range("a37") = 1
MsgBox "RESERVE DE PROPRIETE  !" & Chr(10) & Chr(10) & "Malgré l'existence de la clause de réserve de propriété et en application du postulat de la prééminence de la réalité économique sur l'apparence juridique :" & Chr(10) & " - L'achat-vente est enregistré comme un achat chez le client et une vente chez le fournisseur." & Chr(10) & " - Des comptes spécifiques ont été créés pour suivre les créances et les dettes avec réserve de propriété, notamment le 4116, 4016 et 4816." & Chr(10) & " - En fin d'année, si le bien est une immobilisation, le client devra l'amortir et le fournisseur pourra constater des charges provisionnées sur client si ce dernier devenait insolvable." & Chr(10) & Chr(10) & "En cas de revendication du bien par le fournisseur pour impayé du client :" & Chr(10) & " - Le fournisseur constate le retour du bien par le débit du compte 60.Achat et le crédit du compte client 4116 ou 416, pour le prix estimé de revente." & Chr(10) & " - Le client constatera une sortie du bien de son patrimoine"
MsgBox "RESERVE DE PROPRIETE  ! (suite et fin)" & Chr(10) & Chr(10) & "par les écritures de sortie d'immobilisations ou de déstockages." & Chr(10) & " - Si le prix de revente estimé est supérieur au solde dû par le client, une restitution au client pourra être faite par le fournisseur, en débitant le 4116 ou 416 (pour solde) par le crédit du 52.Trésorerie. Dans le cas contraire, c'est le compte 651 qui servira à solder le 4116 ou 416 chez le fournisseur."
Sheets("feuil9").Range("a37").ClearContents
End Sub
Private Sub lire_chapitre_10()
Sheets("feuil9").Range("a38") = 1
MsgBox "IMMEUBLES DE PLACEMENT  ! (IAS 40)" & Chr(10) & Chr(10) & "Un immeuble de placement est un bien immobilier (terrain et/ou bâtiment) détenu par le propriétaire ou le preneur (contrat de location acquisition) pour en retirer des loyers, à l'exclusion de l'activité des hôtels et assimilés et des immeubles détenus par une entreprise et loués à ses salariés." & Chr(10) & Chr(10) & "Ces immobilisations doivent être comptabilisées dans leurs comptes appropriés, notamment le 2281, 2315 et 2325 qui changent de libellé (immeubles de rapport) pour (immeubles de placement)." & Chr(10) & Chr(10) & "NB : Les immeubles de placement suivent le même traitement comptable que tous les biens immobiliers de l'entité !"
Sheets("feuil9").Range("a38").ClearContents
End Sub
Private Sub lire_chapitre_11()
Sheets("feuil9").Range("a39") = 1
MsgBox "CONSTRUCTIONS SUR SOL D'AUTRUI ET CONTRAT DE RENTES VIAGERES  !" & Chr(10) & Chr(10) & "1°/ CONSTRUCTIONS SUR SOL D'AUTRUI :" & Chr(10) & "Lorsque des constructions sont édifiées sur un terrain appartenant à autrui, le locataire du terrain est réputé propriétaire des constructions jusqu'à l'expiration du bail et est donc en droit de les enlever, de les vendre ou même de les hypothéquer. Par conséquent :" & Chr(10) & " - C'est le locataire du terrain qui doit inscrire cette construction à l'actif de son bilan en débitant le compte 232 par le crédit du 481 ou 722 (production en interne)." & Chr(10) & " - En fin d'année, la construction doit être amortie par le débit du 6813 et le crédit du 2832 sur la durée du bail." & Chr(10) & " - A la fin du bail, la construction sort du bilan du locataire par le débit du 2832 et le crédit du 232." & Chr(10) & "   Si une indemnité d'éviction est prévue, elle sera constatée par le débit du 485 et le crédit du 822." & Chr(10) & " - A la fin du bail, le propriétaire"
MsgBox "CONSTRUCTIONS SUR SOL D'AUTRUI ET CONTRAT DE RENTES VIAGERES  ! (suite)" & Chr(10) & Chr(10) & "du terrain entre la construction dans son patrimoine en débitant le compte 231 pour le montant de l'indemnité d'éviction. S'il reçoit gratuitement la construction, elle sera comptabilisée à sa valeur actuelle au débit du 231 par le crédit du 841." & Chr(10) & Chr(10) & "NB : - Les locaux construits dans le cadre de la copropriété sont des constructions sur sol propre." & Chr(10) & "        - En usufruit, l'opération est considérée comme une location simple s'il n'est pas prévu un transfert de propriété du terrain au terme du contrat, et est enregistrée au débit du 2188 ou 476 si l'usufruit fait l'objet d'un décaissement. Le compte 2188 sera amorti sur la durée du contrat ou le 476 sera repris chaque année au compte de résultat." & Chr(10) & Chr(10) & "2°/ CONTRAT DE RENTES VIAGERES :" & Chr(10) & "Dans un contrat de rentes viagères, le débirentier effectue des versements périodiques (rentes)"
MsgBox "CONSTRUCTIONS SUR SOL D'AUTRUI ET CONTRAT DE RENTES VIAGERES  ! (suite et fin)" & Chr(10) & Chr(10) & "à un crédirentier jusqu'au décès de ce dernier. Ce type de contrat qui porte généralement sur l'acquisition d'immeuble est enregistré chez le débirentier comme suit :" & Chr(10) & " - A la signature du contrat, le compte 2.d'immobilisation sera débité par le crédit du 1681 pour un montant estimé et indiqué dans le contrat." & Chr(10) & " - A chaque échéance de paiement, le 1681 sera débité par le crédit du 52.Trésorerie." & Chr(10) & " - Lors du décès prématuré du crédirentier, le compte 1681 sera soldé par le crédit du 841." & Chr(10) & " - Lorsque le compte 1681 est soldé et que le crédirentier est encore vivant, les versements périodiques seront constatés au débit du 831 par le crédit du 52.Trésorerie."
Sheets("feuil9").Range("a39").ClearContents
End Sub
Private Sub lire_chapitre_12()
Sheets("feuil9").Range("a40") = 1
MsgBox "DEPRECIATION DES IMMOBILISATIONS  ! (IAS 36)" & Chr(10) & Chr(10) & "A la clôture de chaque exercice une entité doit apprécier s'il existe un quelconque indice qu'un actif (immobilisation incorporelle ou corporelle) a subi une perte de valeur." & Chr(10) & "S'il existe un tel indice, l'entité doit estimer la valeur actuelle et la comparer avec la valeur nette comptable. L'actif doit être déprécié lorsque sa valeur nette comptable est supérieure à sa valeur actuelle et cette dépréciation doit être constatée par une dotation pour dépréciation au débit du compte 6913 ou 6914 par le crédit du compte 29." & Chr(10) & Chr(10) & "1°/ L'indice de perte de valeur peut être, entre autres :" & Chr(10) & " - La baisse de la valeur de marché de l'actif ;" & Chr(10) & " - La valeur comptable de l'actif net de l'entité est supérieure à sa capitalisation boursière ;" & Chr(10) & " - L'obsolescence ou la dégradation physique de l'actif." & Chr(10) & "NB : S'il n'existe pas d'indice de perte de valeur, aucun test"
MsgBox "DEPRECIATION DES IMMOBILISATIONS  ! (suite)" & Chr(10) & Chr(10) & "de dépréciation n'est requis !" & Chr(10) & Chr(10) & "2°/ La valeur actuelle est le prix actuel d'achat de l'immobilisation. Si l'immobilisation est amortissable, il faudra tenir compte de l'âge et donc de son plan d'amortissement pour estimer sa valeur actuelle." & Chr(10) & Chr(10) & "3°/ La constatation de la perte de valeur d'une immobilisation a pour conséquences :" & Chr(10) & " - La révision de son plan d'amortissement de sorte à repartir sa valeur actuelle sur la durée d'amortissement restant." & Chr(10) & " - Lors de la reprise ultérieure d'une perte de valeur, la valeur comptable de l'immobilisation augmentée de la reprise ne doit pas être supérieure à la valeur comptable qui aurait été déterminée si aucune perte de valeur n'avait été comptabilisée antérieurement." & Chr(10) & Chr(10) & "4°/ Lorsqu'une immobilisation corporelle a fait l'objet d'une réévaluation, la perte de valeur s'impute d'abord sur l'écart"
MsgBox "DEPRECIATION DES IMMOBILISATIONS  ! (suite et fin)" & Chr(10) & Chr(10) & "de réévaluation en débitant le compte 1062, le solde éventuel est enregistré en charge au débit du 6914 puis la contrepartie (le crédit) est le compte 29." & Chr(10) & Chr(10) & "NB : Les Frais de développement font également l'objet de test de dépréciation avec la création du nouveau compte 2911 << Dépréciations des frais de développement >>  !"
Sheets("feuil9").Range("a40").ClearContents
End Sub
Private Sub lire_chapitre_13()
Sheets("feuil9").Range("a41") = 1
MsgBox "PORTEFEUILLE TITRES  !" & Chr(10) & Chr(10) & "1°/ LES TITRES DE PARTICIPATION :" & Chr(10) & "Un titre est qualifié de participation lorsque sa détention (à plus de 10% et à long terme) permet d'exercer une certaine influence sur la société qui les a émis." & Chr(10) & " - A l'acquisition, le compte 26 est débité par le crédit du 52.Trésorerie (pour la partie libérée et versée) et le 4813 (pour la partie non libérée). Dès que la partie non libérée est appelée le compte 4813 est remplacé par le compte 484." & Chr(10) & " - Les frais d'acquisition et les coûts d'emprunt sont exclus du coût d'acquisition tandis que les droits de souscription et d'attribution (DPS et DA) entrent dans le coût d'acquisition." & Chr(10) & " - A la perception de dividendes, le compte 4711 ou 52 est débité par le crédit du 7721." & Chr(10) & " - A l'inventaire, la valeur actuelle du titre est comparée à son coût d'acquisition. La dépréciation éventuelle est constatée par le débit du 6972 et le crédit du 296."
MsgBox "PORTEFEUILLE TITRES  ! (suite)" & Chr(10) & Chr(10) & " - A la sortie du titre (cession), le compte 816 sera débité par le crédit du compte 26 (sortie du titre), et le compte 485 ou 52 sera débité par le crédit du 826 (prix de cession)." & Chr(10) & "Si une dépréciation avait été constatée, elle sera reprise par le débit du 296 et le crédit du 7972." & Chr(10) & Chr(10) & "2°/ LES TITRES IMMOBILISES :" & Chr(10) & "Ce sont des titres que l'entité a décidé de conserver durablement, mais qui ne correspondent pas à la définition des titres de participation. D'où leur classement dans les Autres immobilisations financières, dans le compte 274." & Chr(10) & " - Les écritures d'acquisition, de perception de dividendes, d'inventaire et de sortie des titres immobilisés sont identiques à celles des titres de participation." & Chr(10) & " - A la perception de dividendes, c'est le compte 7722 qui sera utilisé au lieu du 7721." & Chr(10) & " - A l'inventaire, le coût d'acquisition sera comparé à la valeur"
MsgBox "PORTEFEUILLE TITRES  ! (suite)" & Chr(10) & Chr(10) & "actuelle ou au cours moyen du dernier mois avant la clôture, pour les titres cotés." & Chr(10) & Chr(10) & "3°/ LES TITRES DE PLACEMENT :" & Chr(10) & "Ils sont définis comme des titres cessibles, acquis en vue d'en tirer un revenu direct ou une plus-value à brève échéance (spéculation)." & Chr(10) & " - A l'acquisition, le compte 50 est débité par le crédit du 52.Trésorerie (pour la partie libérée) et 4726 (pour la partie non libérée). Dès que la partie non libérée est appelée, le compte 4726 est remplacé par le compte 4712." & Chr(10) & " - Les frais d'acquisition sont enregistrés dans un sous compte 50, notamment les nouveaux comptes 5016, 5026, 5036." & Chr(10) & " - A la perception de dividendes, le compte 4711 ou 52 sera débité par le crédit du 7746." & Chr(10) & " - A l'inventaire, le coût d'acquisition sera comparé à la valeur actuelle ou au cours moyen du dernier mois avant la clôture pour les titres cotés. L'éventuelle dépréciation"
MsgBox "PORTEFEUILLE TITRES  ! (suite)" & Chr(10) & Chr(10) & "sera constatée par le débit du 6795 et le crédit du 590." & Chr(10) & " - A la vente du titre, le compte 52 ou 4721 sera débité par le crédit du compte 50 et du compte 777 (gain sur l'opération). En cas de perte le 677 sera débité avec le 4712 ou 52 par le crédit du 50." & Chr(10) & "L'éventuelle dépréciation sera reprise par le débit du 590 et le crédit du 7795." & Chr(10) & Chr(10) & "4°/ CAS SPECIAL DES OBLIGATIONS :" & Chr(10) & "L'obligation est un droit de créance acquis par l'entité sur une société émettrice d'emprunt obligataire." & Chr(10) & " - A l'acquisition (à la souscription), le compte 503 ou 2745 est débité, pour le montant versé majoré éventuellement des frais sur achat, par le crédit du compte 52." & Chr(10) & " - A l'acquisition (en bourse), le coût d'acquisition (cote officielle) est composé du capital et des intérêts courus. Seront donc débités les comptes 503 ou 2745 et 5063 ou 2768 par le crédit du 52.trésorerie."
MsgBox "PORTEFEUILLE TITRES  ! (suite et fin)" & Chr(10) & Chr(10) & " - A l'encaissement des coupons (intérêts), le compte 52 est débité par le crédit du compte 7745." & Chr(10) & Chr(10) & "NB :" & Chr(10) & " - Les titres de placement (compte 50) que la direction n'a pas l'intention ou la possibilité de revendre dans les 12 mois à compter de la date de clôture de l'exercice, doivent être reclassés dans le compte 2748." & Chr(10) & " - Le rachat des propres actions de l'entité en vue de les annuler, autorisé par l'art. 643 du droit des sociétés et du GIE (ohada), s'enregistre comme suit :" & Chr(10) & "A l'achat, débit du 5021 par le crédit du 52. Pour annuler, débit du 1013 par le crédit du 5021 et du 105 (si le prix de rachat est inférieur à la valeur nominale. A l'inverse la différence s'impute sur un compte de réserve disponible.)" & Chr(10) & " - A l'inventaire, aucune dépréciation n'est à constater sur les actions propres (compte 5021) destinées aux salariés et dirigeants de l'entité gratuitement."
Sheets("feuil9").Range("a41").ClearContents
End Sub
Private Sub lire_chapitre_14()
Sheets("feuil9").Range("a42") = 1
MsgBox "STOCKS ET EN-COURS DE PRODUCTION  ! (IAS 2)" & Chr(10) & Chr(10) & "1°/ COÛT D'ENTREE :" & Chr(10) & " - Le coût d'achat des marchandises, matières et autres approvisionnements est égal au prix d'achat majoré des frais directs sur achat (transport, manutention, droits de douane, commissions et courtages, etc...)." & Chr(10) & "Les coûts d'emprunt sont à incorporer si le cycle d'achat est long." & Chr(10) & " - Le coût de production des produits et en-cours comprend les coûts directs et indirects de production (y compris l'amortissement des coûts de démantèlement, d'enlèvement et de restauration du site), les coûts fixes et variables et le coût des emprunts si le cycle de production est long." & Chr(10) & " - Les entrées en stock sont constatées par le débit des comptes de la classe 3 et le crédit des comptes 603 et 73." & Chr(10) & " - Les pièces de rechange (à l'exception du stock de sécurité utilisable sur plus d'un exercice) et le matériel d'entretien sont habituellement inscrits en stocks"
MsgBox "STOCKS ET EN-COURS DE PRODUCTION  ! (suite)" & Chr(10) & Chr(10) & "et comptabilisés dans le résultat lors de leur consommation." & Chr(10) & " - Les matières et matériaux récupérés des immobilisations mises au rebut peuvent être repris dans les stocks par le débit du compte 388." & Chr(10) & Chr(10) & "2°/ COÛT DE SORTIE :" & Chr(10) & " - En inventaire permanent, les sorties de stock sont valorisées selon la méthode du CUMP calculé à chaque entrée ou sur une période et selon la méthode FIFO ou PEPS." & Chr(10) & " - En inventaire intermittent, les sorties de stock sont valorisées selon la méthode du coût moyen pondéré sur la durée de stockage." & Chr(10) & " - Deux (2) méthodes alternatives de valorisation ont été instituées. Ce sont la méthode des coûts standards et la méthode du prix de détail." & Chr(10) & " - Les sorties de stock sont enregistrées au débit des comptes 603 et 73 par le crédit des comptes de la classe 3." & Chr(10) & Chr(10) & "3°/ A L'INVENTAIRE :"
MsgBox "STOCKS ET EN-COURS DE PRODUCTION  ! (suite)" & Chr(10) & Chr(10) & "L'inventaire physique est rendu obligatoire par l'art.17-6 de l'AUDCIF, et l'écart avec l'inventaire comptable doit être comptabilisé." & Chr(10) & "Les stocks font aussi l'objet de test de dépréciation en fin d'exercice. En effet :" & Chr(10) & " - Il y'a dépréciation du stock des matières premières, des en-cours de production et des produits intermédiaires destinés à la transformation que si le coût de revient de leur produit fini est supérieur à son prix de vente probable sur le marché." & Chr(10) & " - Il y'a dépréciation du stock des matières premières et des en-cours de production destinés à être revendus en l'état que si le coût d'achat (pour les matières premières) et le coût de production (pour les en-cours de production) est supérieur à leur prix de vente probable sur le marché." & Chr(10) & " - Il y'a dépréciation du stock des marchandises, des produits finis et des produits résiduels que si leur coût d'entrée"
MsgBox "STOCKS ET EN-COURS DE PRODUCTION  ! (suite et fin)" & Chr(10) & Chr(10) & "en stock est supérieur à leur prix de vente probable sur le marché." & Chr(10) & " - La dépréciation des stocks s'enregistre par le débit du compte 6593 et le crédit du compte 39. La reprise de dépréciation s'enregistre au débit du compte 39 par le crédit du compte 7593." & Chr(10) & " - Le contrat de vente ferme est une exception à la constatation de la dépréciation du stock, dès lors que le prix de vente stipulé couvre la bonne exécution du contrat." & Chr(10) & " - En cas de vol de stock, l'indemnité est comptabilisé au crédit du compte 7582 par le débit du 52.Trésorerie." & Chr(10) & " - En cas de destruction du stock par sinistre (incendie, inondation), l'indemnité est comptabilisé au crédit du 841 et la sortie du stock est constatée par le débit du 831 et le crédit du compte 3 de stock, car il s'agit d'un évènement exceptionnel."
Sheets("feuil9").Range("a42").ClearContents
End Sub
Private Sub lire_chapitre_15()
Sheets("feuil9").Range("a43") = 1
MsgBox "ABANDONS DE CREANCES, OPERATIONS D'AFFACTURAGE ET TITRISATION  !" & Chr(10) & Chr(10) & "1°/ ABANDONS DE CREANCES :" & Chr(10) & "L'abandon de créance est une aide ou un avantage accordé par une entité créancière pour soutenir un partenaire en difficulté." & Chr(10) & " - L'abandon de créance commerciale s'enregistre chez l'entité qui abandonne au débit du compte 836 par le crédit du 411 et chez l'entité qui bénéficie au débit du compte 401 par le crédit du 846." & Chr(10) & " - L'abandon de créance financière (prêt, avance...) s'enregistre chez l'entité qui abandonne au débit du compte 836 par le crédit du 277 et chez l'entité qui bénéficie au débit du compte 181 par le crédit du 846." & Chr(10) & Chr(10) & "2°/ OPERATIONS D'AFFACTURAGE :" & Chr(10) & "L'affacturage ou factoring est une opération où un fournisseur transfère ses créances commerciales à un factor (institution financière) qui se charge d'en opérer le recouvrement et qui en garantit la bonne fin, même en cas de défaillance momentanée"
MsgBox "ABANDONS DE CREANCES, OPERATIONS D'AFFACTURAGE ET TITRISATION  ! (suite)" & Chr(10) & Chr(10) & "du débiteur. La comptabilisation de l'opération chez le fournisseur se fait comme suit :" & Chr(10) & " - Lors du transfert des créances, matérialisé par l'avis d'achat du factor, les comptes 4716 et 4717 sont débités par le crédit du compte 411." & Chr(10) & " - Lors du virement du montant net (avis de crédit), les comptes 52, 6314, 6745 et 4454 sont débités par le crédit du compte 4716." & Chr(10) & " - Après recouvrement des créances par le factor, la retenue de garantie est restituée au fournisseur et est comptabilisée au débit du compte 52 par le crédit du compte 4717." & Chr(10) & Chr(10) & "3°/ TITRISATION :" & Chr(10) & "La titrisation des créances consiste pour un entité de céder ses créances à une entité spécialisée qui finance l'acquisition par l'émission de titres sur les marchés financiers." & Chr(10) & " - La décote entre le prix de cession et la valeur actuelle des créances est"
MsgBox "ABANDONS DE CREANCES, OPERATIONS D'AFFACTURAGE ET TITRISATION  ! (suite et fin)" & Chr(10) & Chr(10) & "comptabilisée dans le compte 6782." & Chr(10) & " - Le boni éventuel issu de la liquidation de l'entité spécialisée et remboursé au cédant est constaté dans le compte 7782."
Sheets("feuil9").Range("a43").ClearContents
End Sub
Private Sub lire_chapitre_16()
Sheets("feuil9").Range("a44") = 1
MsgBox "CAPITAUX PROPRES ET AUTRES FONDS PROPRES  !" & Chr(10) & Chr(10) & "Dans le Système comptable OHADA, les capitaux propres sont regroupés dans les comptes suivants :" & Chr(10) & " - 10. Capital ;" & Chr(10) & " - 11. Réserves ;" & Chr(10) & " - 12. Reports à nouveau ;" & Chr(10) & " - 13. Résultat net de l'exercice ;" & Chr(10) & " - 14. Subventions d'investissement ;" & Chr(10) & " - 15. Provisions réglementées et fonds assimilés." & Chr(10) & Chr(10) & "La notion juridique (droit des sociétés et du GIE Ohada) des capitaux propres reprend celle du Système comptable OHADA, à l'exception du compte 10. Capital où le solde du compte 109 ne doit pas être déduit." & Chr(10) & Chr(10) & "Les Autres fonds propres sont généralement issus du compte 167 et ont la particularité de n'être pratiquement pas remboursable. "
Sheets("feuil9").Range("a44").ClearContents
End Sub
Private Sub lire_chapitre_17()
Sheets("feuil9").Range("a45") = 1
MsgBox "SUBVENTIONS ET AIDES PUBLIQUES  !" & Chr(10) & Chr(10) & "Les subventions sont des aides allouées aux entités par l'autorité publique sans obligation de remboursement." & Chr(10) & Chr(10) & "1°/ LES SUBVENTIONS D'INVESTISSEMENT : Elles servent à créer ou à acquérir des immobilisations." & Chr(10) & " - A la promesse, le compte 4494 est débité par le crédit du compte 14." & Chr(10) & " - A la réalisation, le compte 52 ou 2.immobilisation est débité par le crédit du compte 4494." & Chr(10) & " - En fin d'année, si l'immobilisation financée est amortie, le compte 681 est débité par le crédit du compte 28 et la subvention, amortie proportionnellement à l'immobilisation, sera reprise par le débit du compte 14 contre le crédit du compte 799." & Chr(10) & " - Le test de dépréciation de l'immobilisation tient compte du solde de la subvention en fin d'année, et vient diminuer la valeur nette comptable à comparer avec la valeur actuelle de l'immobilisation." & Chr(10) & " - En cas de cession de"
MsgBox "SUBVENTIONS ET AIDES PUBLIQUES  ! (suite)" & Chr(10) & Chr(10) & "l'immobilisation, le solde de la subvention est entièrement repris par le débit du compte 14 et le crédit du compte 799." & Chr(10) & " - Si la promesse de subvention n'est pas réalisée, le compte 4494 sera crédité par le débit du compte 6515 et le compte 14 sera débité par le crédit du compte 799." & Chr(10) & "NB : Les reprises de subventions d'investissement sont maintenant considérées comme des opérations ordinaires (compte 799)  !" & Chr(10) & Chr(10) & "2°/ LES SUBVENTIONS D'EXPLOITATION : Elles servent à compenser l'insuffisance de certains produits d'exploitation (services publics à prix imposés) ou de certaines charges d'exploitation." & Chr(10) & " - A la promesse, le compte 4495 est débité par le crédit du compte 71." & Chr(10) & "NB : Si la subvention est destinée à rembourser des frais forfaitaires ou des frais réels identifiés, le compte 71 au crédit peut être remplacé par le compte 781 (frais forfaitaires) ou par"
MsgBox "SUBVENTIONS ET AIDES PUBLIQUES  ! (suite)" & Chr(10) & Chr(10) & "les comptes concernés de la classe 6 (frais réels)." & Chr(10) & " - A la réalisation, le compte 52.Trésorerie est débité par le crédit du compte 4495." & Chr(10) & " - Si la promesse de subvention n'est pas réalisée, le compte 6515 est débité par le crédit du compte 4495." & Chr(10) & Chr(10) & "3°/ LES SUBVENTIONS D'EQUILIBRE : Elles servent à compenser en tout ou partie la perte que l'entité aurait constatée si cette subvention ne lui avait pas été accordée." & Chr(10) & " - A la promesse, le compte 4496 est débité par le crédit du compte 88." & Chr(10) & " - A la réalisation, le compte 52.Trésorerie est débité par le crédit du compte 4496." & Chr(10) & Chr(10) & "NB :" & Chr(10) & " - La subvention accordée par en entité privée est comptabilisée en charge chez l'entité qui l'accorde au débit du compte 835 ou, si elle est récurrente, au débit des comptes 6582 et 6283." & Chr(10) & " - Si l'aide publique est accordée à une"
MsgBox "SUBVENTIONS ET AIDES PUBLIQUES  ! (suite et fin)" & Chr(10) & Chr(10) & "entité publique, elle est considérée comme une dotation en capital à comptabiliser dans le compte 102." & Chr(10) & " - Une subvention publique qui dévient remboursable doit être comptabilisée comme un changement d'estimation comptable. Le compte 14 est alors débité pour la subvention d'investissement, et le compte 831 est débité pour les subventions d'exploitation et d'équilibre à rembourser."
Sheets("feuil9").Range("a45").ClearContents
End Sub
Private Sub lire_chapitre_18()
Sheets("feuil9").Range("a46") = 1
MsgBox "PROVISIONS, PASSIFS EVENTUELS ET ACTIFS EVENTUELS  ! (IAS 37)" & Chr(10) & Chr(10) & "1°/ PROVISIONS : Une provision (provision pour risque et charge) est un passif externe dont l'échéance ou le montant est incertain." & Chr(10) & Chr(10) & "Il existe trois (3) conditions nécessaires pour comptabiliser une provision :" & Chr(10) & " - Il existe une obligation actuelle (juridique ou implicite) résultant d'un évènement passé ;" & Chr(10) & " - Il est probable qu'une sortie de ressources représentatives d'avantages économiques futurs sera nécessaire pour régler l'obligation ;" & Chr(10) & " - Le montant de l'obligation peut être estimé de manière fiable." & Chr(10) & "NB : Si ces trois (3) conditions ne sont pas réunies, aucune provision ne peut être constituée." & Chr(10) & Chr(10) & "Les écritures comptables de dotation et de reprise de provisions sont :" & Chr(10) & " - Dotation : Débit des comptes 6911, 6971, 6591, 6791 et 854 par le crédit des comptes 19, 499 et 599."
MsgBox "PROVISIONS, PASSIFS EVENTUELS ET ACTIFS EVENTUELS  ! (suite)" & Chr(10) & Chr(10) & " - Reprise : Débit des comptes 19, 499 et 599 par le crédit des comptes 7911, 7971, 7591, 7791 et 864." & Chr(10) & "NB : Les comptes 6591, 6791, 7591, 7791, 499 et 599 sont utilisés pour les provisions à court terme (- 1 an)  !" & Chr(10) & Chr(10) & "Les nouvelles provisions du compte 19 sont :" & Chr(10) & " - 197 Provisions pour restructuration ;" & Chr(10) & " - 1984 Provisions pour démantèlement et remise en état ;" & Chr(10) & " - 1985 Provisions pour droits à réduction ou avantage en nature (Chèques, cadeaux, cartes de fidélité...)." & Chr(10) & Chr(10) & "Les provisions non admises sont, entre autres :" & Chr(10) & " - Les provisions pour grosses réparations ;" & Chr(10) & " - Les provisions pour chômage technique." & Chr(10) & Chr(10) & "NB : Une provision évaluée par actualisation doit être désactualisée chaque année. L'augmentation (effet temps) doit être comptabilisée au débit du compte 6971."
MsgBox "PROVISIONS, PASSIFS EVENTUELS ET ACTIFS EVENTUELS  ! (suite et fin)" & Chr(10) & Chr(10) & "2°/ PASSIFS EVENTUELS : Un passif éventuel est :" & Chr(10) & " - Une obligation potentielle résultant d'évènements passés et dont l'existence ne sera confirmée que par la survenance ou la non-survenance d'un ou de plusieurs évènements futurs incertains qui ne sont pas totalement sous le contrôle de l'entité ; ou" & Chr(10) & " - Une obligation actuelle résultant d'évènements passés mais dont, il n'est pas probable qu'une sortie de ressources soit nécessaire pour éteindre l'obligation ou, que le montant de l'obligation n'est pas estimable de manière fiable." & Chr(10) & Chr(10) & "3°/ ACTIFS EVENTUELS :" & Chr(10) & " - Un actif éventuel est un actif potentiel résultant d'évènements passés et dont l'existence ne sera confirmée que par la survenance (ou non) d'un ou plusieurs évènements futurs incertains qui ne sont pas sous le contrôle de l'entité. L'actif éventuel ne figure qu'en note annexe."
Sheets("feuil9").Range("a46").ClearContents
End Sub
Private Sub lire_chapitre_19()
Sheets("feuil9").Range("a47") = 1
MsgBox "ATTRIBUTION GATUITE D'ACTIONS AU PERSONNEL SALARIE ET AUX DIRIGEANTS DE LA SOCIETE  !" & Chr(10) & Chr(10) & "Une société peut attribuer des actions gratuites au personnel salarié et aux dirigeants, par rachat de ses propres actions ou par prélèvement sur le résultat ou sur les réserves." & Chr(10) & Chr(10) & "1°/ ATTRIBUTION PAR RACHAT DE SES PROPRES ACTIONS : Le cadre juridique est l'article 640 du Droit des sociétés et du GIE (Ohada)." & Chr(10) & "Les écritures comptables sont :" & Chr(10) & " - Lors du rachat de ses propres actions : Débit du compte 5021 par le crédit du compte 52.Trésorerie." & Chr(10) & " - A l'attribution : Débit du compte 6772 par le crédit du compte 5021." & Chr(10) & "NB : Aucune dépréciation n'est possible sur les titres rachetés  !" & Chr(10) & Chr(10) & "2°/ PRELEVEMENT SUR LE RESULTAT OU SUR LES RESERVES : Le cadre juridique est l'article 640-1 du Droit des sociétés et du GIE (Ohada). Les écritures comptables sont :"
MsgBox "ATTRIBUTION GATUITE D'ACTIONS AU PERSONNEL SALARIE ET AUX DIRIGEANTS DE LA SOCIETE  ! (suite et fin)" & Chr(10) & Chr(10) & " - Lors du prélèvement : Débit du compte 1301, 12 ou 11 (sauf réserve légale) par le crédit du compte 1132." & Chr(10) & " - A l'attribution : Débit du compte 1132 par le crédit du compte 1013." & Chr(10) & Chr(10) & "NB : Les sociétés qui attribuent leurs actions aux personnes éligibles peuvent, à cette fin, souscrire ou acquérir 10% du total de leurs propres actions. Les actions ainsi acquises doivent être attribuées dans le délai d'un an à compter de l'acquisition (article 640)  !"
Sheets("feuil9").Range("a47").ClearContents
End Sub
Private Sub lire_chapitre_20()
Sheets("feuil9").Range("a49") = 1
MsgBox "EMPRUNT OBLIGATAIRE  !" & Chr(10) & Chr(10) & "1°/ LES EMPRUNTS OBLIGATAIRES ORDINAIRES : Les obligations sont des titres qui confèrent à leurs détenteurs un droit de créance. Pour une même émission d'obligations, les droits sont les mêmes pour tous les détenteurs." & Chr(10) & "L'émission d'un emprunt obligataire se déroule en plusieurs phases :" & Chr(10) & " - Ouverture de la souscription : Débit du compte 47131 par le crédit du compte 1611 (pour le prix d'émission de l'emprunt)." & Chr(10) & " - Souscription de l'emprunt : Débit du compte 47132 par le crédit du compte 47131." & Chr(10) & " - Le versement des fonds : Débit des compte 52 et 6316 par le crédit du compte 47132." & Chr(10) & Chr(10) & "La prime de remboursement, différence entre le prix d'émission et le prix de remboursement des obligations, est dorénavant comptabilisée au débit du compte 6714 par le crédit du compte 1661 à l'échéance. La prime de remboursement est étalée sur la durée de l'emprunt au prorata des intérêts courus."
MsgBox "EMPRUNT OBLIGATAIRE  ! (suite)" & Chr(10) & Chr(10) & "La comptabilisation du service de l'emprunt :" & Chr(10) & " - Lors du paiement : Débit des comptes 6711 et 1611 par le crédit du compte 52.Trésorerie." & Chr(10) & " - A la clôture de l'exercice : Débit du compte 6711 par le crédit du compte 1661 (intérêts courus). Cette écriture est contrepassée à l'ouverture de l'exercice suivant." & Chr(10) & Chr(10) & "Lorsque le cours en bourse des obligations en inférieur à la valeur de remboursement, la société émettrice peut racheter les obligations auprès des obligataires qui le souhaitent pour les annuler et dégager ainsi une plus-value. La comptabilisation est la suivante :" & Chr(10) & " - Lors du rachat des obligations : Débit du compte 5031 par le crédit du compte 52.Trésorerie." & Chr(10) & " - Lors de l'annulation des obligations : Débit du compte 1611 par le crédit des comptes 5031 et 841." & Chr(10) & Chr(10) & "2°/ OBLIGATIONS CONVERTIBLES OU REMBOURSABLES EN ACTIONS (OCA ou ORA) :"
MsgBox "EMPRUNT OBLIGATAIRE  ! (suite)" & Chr(10) & Chr(10) & "Désormais, l'Acte uniforme OHADA permet aux sociétés par actions d'émettre des obligations convertibles ou remboursables en actions." & Chr(10) & "Le traitement comptable est le suivant :" & Chr(10) & " - De l'ouverture au versement des fonds : Les écritures sont identiques à celles d'un emprunt obligataire ordinaire. Les comptes utilisées sont le 1612 et 1613." & Chr(10) & " - Lors du remboursement ou de la conversion : Débit du compte 1612 ou 1613 par le crédit des comptes 1013 (valeur nominale) et 1054 (prime de conversion)." & Chr(10) & Chr(10) & "3°/ OBLIGATIONS AVEC BONS DE SOUSCRIPTION D'OBLIGATIONS : La société émet un premier emprunt obligataire avec la promesse d'émettre un second plus attractif pour les détenteurs de bons de souscription." & Chr(10) & "Le traitement comptable est le suivant :" & Chr(10) & " - A l'émission de l'emprunt, les écritures sont celles d'un emprunt obligataire ordinaire."
MsgBox "EMPRUNT OBLIGATAIRE  ! (suite et fin)" & Chr(10) & Chr(10) & " - La vente des bons de souscription : Débit du compte 52 par le crédit du compte 4719." & Chr(10) & " - Lors de l'exercice des bons : Débit du compte 4719 par le crédit du compte 7745." & Chr(10) & Chr(10) & "NB :" & Chr(10) & " - Les obligations à coupon zéro sont les obligations remboursables sans aucun paiement d'intérêt." & Chr(10) & " - Les obligations à fenêtres sont celles qui peuvent être remboursées par anticipation sur demande, soit du souscripteur soit de l'émetteur. Ces remboursements anticipés s'accompagnent de pénalités fixées dans le contrat d'émission."
Sheets("feuil9").Range("a49").ClearContents
End Sub
Private Sub lire_chapitre_21()
Sheets("feuil9").Range("a50") = 1
MsgBox "ENGAGEMENTS DE RETRAITE ET AUTRES AVANTAGES ASSIMILES  ! (IAS 19)" & Chr(10) & Chr(10) & "1°/ CHAMP D'APPLICATION :" & Chr(10) & " - Les présentes dispositions couvrent les seuls engagements de retraite en matière de pensions, de compléments de retraites, d'indemnités ou d'allocations en raison du départ à la retraite, ou avantages similaires des membres du personnel et des mandataires sociaux d'une entité." & Chr(10) & " - Au titre de ces dispositions, les entités doivent évaluer et comptabiliser sous forme de provisions à inscrire au passif du bilan, les engagements de retraite et porter une mention dans les Notes annexes." & Chr(10) & " - Toutefois, les entités faisant appel public à l'épargne ont l'obligation d'évaluer les engagements de retraite selon la méthode actuarielle." & Chr(10) & " - Les autres entités peuvent opter pour l'application, soit de la méthode actuarielle, soit des méthodes simplifiées, qui font abstraction des hypothèses démographiques et/ou financières."
MsgBox "ENGAGEMENTS DE RETRAITE ET AUTRES AVANTAGES ASSIMILES  ! (suite)" & Chr(10) & Chr(10) & "NB : Les présentes dispositions encouragent les entités (sans toutefois le leur imposer) à faire appel à un actuaire qualifié pour évaluer toute obligation significative au titre des engagements de retraite." & Chr(10) & Chr(10) & "2°/ COMPTABILISATION :" & Chr(10) & " - Les dotations de l'exercice s'enregistrent au débit du compte 6911 par le crédit du compte 1961." & Chr(10) & " - Les reprises s'enregistrent au débit du compte 1961 par le crédit du compte 7911." & Chr(10) & " - Pour les entités utilisant la méthode actuarielle d'évaluation, la désactualisation (augmentation) ou l'effet temps s'enregistre au débit du compte 6971 par le crédit du compte 1961. La reprise se fait avec le compte 7971." & Chr(10) & Chr(10) & "3°/ COMPTABILISATION DES REGIMES COUVERTS PAR DES ACTIFS :" & Chr(10) & " - Lorsqu'un contrat d'assurance est souscrit par l'entité et que le paiement des allocations de retraite incombe"
MsgBox "ENGAGEMENTS DE RETRAITE ET AUTRES AVANTAGES ASSIMILES  ! (suite)" & Chr(10) & Chr(10) & "à l'assureur, le paiement des primes d'assurance par l'entité est enregistré au débit du compte 6686 par le crédit du compte 4332." & Chr(10) & "NB : Aucune provision pour retraite n'est à constituer dans ce cas." & Chr(10) & " - Lorsque l'entité souscrit à un contrat d'assurance et que le paiement des indemnités de retraite incombe partiellement à l'assureur, les primes sont enregistrées au débit du compte 6686 et au crédit du compte 4332. L'entité doit, de ce fait, comptabiliser une provision pour retraite pour la partie non couverte, au débit du compte 6911 et au crédit du compte 1961." & Chr(10) & " - Lorsque l'entité souscrit à un contrat et que le paiement des indemnités de fin de carrière incombe entièrement à l'entité, le versement des primes à l'assureur est comptabilisé au débit du compte 1962 par le crédit du compte 52. La provision global des engagements est comptabilisée chaque année,"
MsgBox "ENGAGEMENTS DE RETRAITE ET AUTRES AVANTAGES ASSIMILES  ! (suite et fin)" & Chr(10) & Chr(10) & "au débit des comptes 6911 et 6971 par le crédit du compte 1961." & Chr(10) & "Lors du paiement des indemnités de retraite aux bénéficiaires, les comptes 1961 et 1962 seront contrepassés pour être soldés." & Chr(10) & Chr(10) & "NB :" & Chr(10) & " - Les salariés sous un contrat à durée déterminée (CDD) n'entrent pas dans le calcul de la provision pour retraite." & Chr(10) & " - Le SYSCOHADA recommande aux entités appartenant à un groupe dont les comptes consolidés sont établis selon les normes IFRS, d'opter pour l'évaluation des engagements de retraite selon la méthide actuarielle dans leurs comptes individuels afin de minorer les retraitements de consolidation."
Sheets("feuil9").Range("a50").ClearContents
End Sub
Private Sub lire_chapitre_22()
Sheets("feuil9").Range("a51") = 1
MsgBox "OPERATIONS EN DEVISES ET CONTRATS DE COUVERTURE SUR MARCHES FINANCIERS  !" & Chr(10) & Chr(10) & "1°/ CREANCES ET DETTES EN DEVISES :" & Chr(10) & "Les opérations d'achat et vente de biens et services (produits, immobilisations, titres, etc...) en devises sont à l'origine des dettes et créances commerciales en devises dans le bilan d'une entité." & Chr(10) & "Les opérations de prêts et emprunts en devises sont à l'origine des dettes et créances financières en devises dans le bilan d'une entité." & Chr(10) & Chr(10) & " - Les dettes et les créances en devises entrent dans le patrimoine de l'entité au cours du jour de l'opération, date d'achat ou de vente pour les biens et services (dettes et créances commerciales) et date de mise à disposition des fonds pour les prêts et emprunts (dettes et créances financières)." & Chr(10) & Chr(10) & " - En fin d'année, les dettes et créances en devises au bilan sont réévaluées au cours de change de clôture. Les écarts de conversion-Actif sont comptabilisés au"
MsgBox "OPERATIONS EN DEVISES ET CONTRATS DE COUVERTURE SUR MARCHES FINANCIERS  ! (suite)" & Chr(10) & Chr(10) & "débit du compte 478 par le crédit du compte de dette ou de créance correspondant et les écarts de conversion-Passif sont comptabilisés au débit du compte de dette ou de créance correspondant par le crédit du compte 479. Ces écritures sont contrepassées à l'ouverture de l'exercice suivant." & Chr(10) & "NB : La comptabilisation d'un écart de conversion-Actif à l'inventaire entraine la constitution d'une provision pour perte de change du montant de l'écart (convention de prudence) à enregistrer, au débit du compte 6971 ou 6791 par le crédit du compte 194 ou 4997 (si l'opération à un caractère financier) et au débit du compte 6591 par le crédit du compte 4991 (si l'opération à un caractère commercial). Les reprises se font respectivement par les comptes 7971, 7791 et 7591." & Chr(10) & Chr(10) & " - Lors des règlements, les pertes de change sont comptabilisées au débit du compte 676 par le crédit"
MsgBox "OPERATIONS EN DEVISES ET CONTRATS DE COUVERTURE SUR MARCHES FINANCIERS  ! (suite)" & Chr(10) & Chr(10) & "du compte de dette ou de créance (financière) correspondant et au débit du compte 656 par le crédit du compte de dette ou de créance (commerciale) correspondant." & Chr(10) & " - Lors des règlements, les gains de change sont comptabilisés au débit du compte de créance ou de dette (financière) correspondant par le crédit du compte 776 et au débit du compte de dette ou de créance (commerciale) correspondant par le crédit du compte 756." & Chr(10) & Chr(10) & "NB :" & Chr(10) & " - A l'inventaire, les avances et acomptes sur immobilisation ne font pas l'objet de réévaluation. Aucun écart de conversion n'est donc à constater sur ce poste du bilan." & Chr(10) & " - A l'inventaire, les créances douteuses en devises sont réévaluées et les dépréciations portent sur le montant total de la créance tandis que les écarts de conversion (Actif ou Passif) sont limités à la partie jugée recouvrable."
MsgBox "OPERATIONS EN DEVISES ET CONTRATS DE COUVERTURE SUR MARCHES FINANCIERS  ! (suite)" & Chr(10) & Chr(10) & " - A l'inventaire, lorsqu'il y a une couverture entière de change sur les dettes et créances, aucun écart de conversion (Actif ou Passif) et aucune provision ne sont à constater. Si la couverture est partielle, seule la provision est ajustée pour la partie non couverte." & Chr(10) & " - A l'inventaire, les disponibilités en devises de l'entité sont converties au cours de change à la clôture de l'exercice. Les gains ou pertes de change sont comptabilités au résultat financier avec les comptes 676 et 776." & Chr(10) & Chr(10) & "2°/ CONTRATS DE COUVERTURE SUR MARCHES FINANCIERS :" & Chr(10) & "Une opération est qualifiée de couverture, si elle présente les caractéristiques suivantes :" & Chr(10) & " - Les contrats ou options de taux d'intérêt achetés ou vendus ont pour effet de réduire le risque de variation de valeur affectant l'élément couvert ;" & Chr(10) & " - L'élément couvert peut"
MsgBox "OPERATIONS EN DEVISES ET CONTRATS DE COUVERTURE SUR MARCHES FINANCIERS  ! (suite)" & Chr(10) & Chr(10) & "être un actif, un passif, un engagement existant ou une transaction future ;" & Chr(10) & " - Une corrélation est établie entre les variations de valeur de l'élément couvert et celles du contrat de couverture." & Chr(10) & Chr(10) & "La comptabilisation des contrats qualifiés de couverture se fait selon l'article 57-3 de l'Acte uniforme :" & Chr(10) & " - Les variations de valeur s'enregistrent dans le compte 54 avec pour contrepartie les comptes 4786 et 4797. Ces derniers comptes seront imputés au résultat à l'aide des compte 6784 et 7784." & Chr(10) & " - Les frais de couverture sont comptabilisés en charge au débit du compte 6784." & Chr(10) & Chr(10) & "3°/ CAS SPECIAL DES STOCKS :" & Chr(10) & "Les stocks en devises sont valorisés en fonction de leur détention à l'étranger ou de leur acquisition à l'étranger (avec détention dans l'espace OHADA)."
MsgBox "OPERATIONS EN DEVISES ET CONTRATS DE COUVERTURE SUR MARCHES FINANCIERS  ! (suite et fin)" & Chr(10) & Chr(10) & " - Détention à l'étranger :" & Chr(10) & "La valeur des stocks en devises est convertie, en fin d'exercice, à un cours de change qui est égal à la moyenne pondérée des coûts pratiqués à la date d'achat ou d'entrée en magasin des éléments considérés." & Chr(10) & Chr(10) & " - Acquisition à l'étranger, avec détention dans l'espace OHADA. Il y a plusieurs possibilités d'évaluation :" & Chr(10) & "Valorisation des achats et des stocks au cours d'achat." & Chr(10) & "Valorisation des achats au cours du jour d'achat et valorisation des stocks au cours de clôture." & Chr(10) & "Valorisation selon un cours interne de période fixé par l'entité." & Chr(10) & Chr(10) & "NB : L'application de la permanence des méthodes est de règle et tout changement de procédé d'évaluation d'un exercice à l'autre doit être signalé dans les Notes annexes  !"
Sheets("feuil9").Range("a51").ClearContents
End Sub
Private Sub lire_chapitre_23()
Sheets("feuil9").Range("a53") = 1
MsgBox "CONTRATS PLURI-EXERCICES  ! (IAS 11, IFRS 15)" & Chr(10) & Chr(10) & "1°/ LA METHODE A L'AVANCEMENT :" & Chr(10) & " C'est la principale méthode de comptabilisation des contrats pluri-exercices retenue par le SYSCOHADA. Elle est appliquée lorsque l'entité est en mesure d'évaluer le résultat à terminaison de manière fiable." & Chr(10) & "La méthode consiste à comptabiliser :" & Chr(10) & " - Au cours de l'exercice, les avances reçues (crédit du compte 4191) et les retenues de garantie subies (débit du compte 4117) ainsi que les charges (achats de matières premières, frais de personnel, etc..) dans les comptes appropriés ;" & Chr(10) & " - En fin d'année, une facture partielle (selon le pourcentage d'avancement des travaux) au débit du compte 4181 par le crédit du compte 70.ventes et du compte 4435 éventuellement ;" & Chr(10) & " - A la livraison, le compte 411 au débit (déduction faite des avances et retenues de garantie) par le crédit du compte 70.Ventes. et selon le cas le compte 4432 ou 4433."
MsgBox "CONTRATS PLURI-EXERCICES  ! (suite)" & Chr(10) & Chr(10) & "2°/ LA METHODE A L'ACHEVEMENT :" & Chr(10) & "C'est la méthode, exceptionnelle, à utiliser lorsque l'entité n'est pas en mesure d'évaluer le résultat à terminaison de manière fiable. Elle cesse d'être appliquée lorsque l'entité peut évaluer le résultat à terminaison." & Chr(10) & " - Au cours de l'exercice, les écritures sont identiques à celles de la méthode à l'avancement ;" & Chr(10) & " - En fin d'année, les écritures comptables sont identiques à celles de la méthode à l'avancement, sauf que le montant dans le compte 70.Ventes doit être égal au charges consommées de l'exercice afin de dégager un résultat nul ;" & Chr(10) & " - A la livraison, les écritures comptables sont identiques à celles de la méthode à l'avancement." & Chr(10) & Chr(10) & "3°/ CAS DES CONTRATS A TERMINAISON DEFICITAIRE : Une provision doit être constituée quand un contrat est à terminaison déficitaire." & Chr(10) & " - Méthode à l'avancement : la provision est"
MsgBox "CONTRATS PLURI-EXERCICES  ! (suite et fin)" & Chr(10) & Chr(10) & "évaluée sur la partie du contrat non encore exécutée et comptabilisée au débit du compte 6911 par le crédit du compte 193. La reprise se fait avec le compte 7911." & Chr(10) & " - La méthode à l'achèvement : la provision est égale à la perte totale probable sur le contrat et est comptabilisée en deux (2) partie. Une partie de la provision à court terme, dont le montant est égal au pourcentage d'avancement multiplié par la provision totale, est enregistrée au débit du compte 6591 par le crédit du compte 4991. Et une partie à long terme (le solde) enregistrée au débit du compte 6911 par le crédit du compte 193." & Chr(10) & "Les reprises se font à l'aide des comptes 7911 et 7591." & Chr(10) & Chr(10) & "NB : La réforme a supprimé la méthode du bénéfice partiel à l'inventaire et modifié le mode de comptabilisation de la méthode à l'achèvement !"
Sheets("feuil9").Range("a53").ClearContents
End Sub
Private Sub lire_chapitre_24()
Sheets("feuil9").Range("a54") = 1
MsgBox "ABONNEMENT DES CHARGES ET PRODUITS  !" & Chr(10) & Chr(10) & "Dans le souci d'encadrer les modalités d'enregistrement des opérations nécessaires à l'établissement de compte de résultat périodique (mensuel, trimestriel...) par certaines entités, le SYSCOHADA préconise la possibilité d'enregistrer périodiquement ces charges et produits en utilisant la technique d'abonnement." & Chr(10) & Chr(10) & "1°/ LA TECHNIQUE D'ABONNEMENT :" & Chr(10) & "Elle consiste à enregistrer les charges et les produits, dont le montant peut être connu ou fixé d'avance avec une précision suffisante (loyers, impôts, primes d'assurance, amortissements...), et qu'on décide de repartir par fractions égales entre les périodes comptables de l'exercice (système d'abonnement) afin d'obtenir des situations intermédiaires (mensuelles, trimestrielles...)." & Chr(10) & "Le compte prévu par le SYSCOHADA pour appliquer cette technique est le 474 dont le 4746 pour la répartition des charges et le 4747 pour celle des produits."
MsgBox "ABONNEMENT DES CHARGES ET PRODUITS  ! (suite)" & Chr(10) & Chr(10) & "2°/ REGLES DE COMPTABILISATION" & Chr(10) & "Comptabilisation des opérations en cours d'exercice :" & Chr(10) & " - A la fin de chaque période retenue par l'entité (mois, trimestre...), le compte 4746 est crédité de la fraction des charges abonnées par le débit du compte de charges correspondant." & Chr(10) & " - Lors de la réception par l'entité de la facture correspondant à la charge réelle de la période, le compte 4746 est débité par le crédit du compte de tiers ou de trésorerie concerné." & Chr(10) & " - Le compte 4747 utilisé pour les produits fonctionne de manière symétrique." & Chr(10) & " - La TVA éventuelle sur la facture est enregistrée selon les règles habituelles." & Chr(10) & " - Pour les dotations aux amortissements, le compte 68 est débité par le crédit du compte 4746." & Chr(10) & Chr(10) & "Comptabilisation des opérations à la clôture de l'exercice :" & Chr(10) & " - Les comptes 4746 et 4747"
MsgBox "ABONNEMENT DES CHARGES ET PRODUITS  ! (suite et fin)" & Chr(10) & Chr(10) & "doivent être soldés par la contrepartie du compte de charge et de produit concernés." & Chr(10) & " - Lorsque la période d'étalement court sur plusieurs exercices, le solde des comptes 4746 et 4747 est effectué par le biais des comptes de régularisation 476 et 477." & Chr(10) & " - Pour les dotations aux amortissements, le compte 4746 sera débité par le crédit du compte 28."
Sheets("feuil9").Range("a54").ClearContents
End Sub
Private Sub lire_chapitre_25()
Sheets("feuil9").Range("a55") = 1
MsgBox "CONTRAT DE CONCESSIONS DE SERVICE PUBLIC  ! (IFRIC 12)" & Chr(10) & Chr(10) & "1°/ CHAMP D'APPLICATION :" & Chr(10) & "Les présentes dispositions énoncent les principes de comptabilisation, par un opérateur privé, des contrats de concessions de service conclus entre un organisme public et un opérateur privé, lorsque l'infrastructure objet du contrat est contrôlée par le concédant. En d'autres termes, les contrats qui entrent dans le champ d'application des présentes dispositions du SYSCOHADA, sont ceux dans lesquels l'autorité publique contrôle l'infrastructure." & Chr(10) & Chr(10) & "Les contrats de concessions de service public concernent généralement les routes, ponts, hôpitaux, prisons, aéroports, réseaux de distribution d'eau, fourniture d'énergie et réseaux de télécommunication." & Chr(10) & Chr(10) & "2°/ MODE DE COMPTABILISATION :" & Chr(10) & "Dans un contrat de concessions de service public, les immobilisations apportées par l'autorité publique (le concédant) ne doivent plus entrer dans"
MsgBox "CONTRAT DE CONCESSIONS DE SERVICE PUBLIC  ! (suite)" & Chr(10) & Chr(10) & "le patrimoine de l'opérateur privé (le concessionnaire) sauf si ces immobilisations ne seront plus restituées au concédant. D'où la suppression des comptes 1676, 1982 et la modification du compte 1684 par la réforme." & Chr(10) & Chr(10) & "Les écritures comptables sont identiques à celles des contrats pluri-exercices. Le chiffre d'affaires est comptabilisé dans le compte 70 avec pour contrepartie :" & Chr(10) & " - Le compte 2734 si l'opérateur privé perçoit, dans le cadre du contrat, une rémunération fixe de l'autorité publique." & Chr(10) & " - Le compte 2183 si l'opérateur privé est rémunéré par les usagers du service public." & Chr(10) & " - Les comptes 2734 et 2183 si l'opérateur privé est rémunéré en partie par le concédant et en partie par les usagers du service public." & Chr(10) & Chr(10) & "3°/ CONTRAT DE PARTENARIAT PUBLIC PRIVE (PPP) :" & Chr(10) & "Le contrat PPP fonctionne pratiquement à l'identique du"
MsgBox "CONTRAT DE CONCESSIONS DE SERVICE PUBLIC  ! (suite et fin)" & Chr(10) & Chr(10) & "contrat de concessions de service public à la seule différence que l'opérateur privé n'est pas rémunéré par les usagers du service public mais uniquement par l'autorité publique." & Chr(10) & Chr(10) & "La comptabilisation se fera donc uniquement avec le compte 2734 au débit par le crédit du compte 70." & Chr(10) & Chr(10) & "A la fin de la construction, les factures de redevances sont émises jusqu'au terme du contrat. Elles sont enregistrées au débit du compte 411 par le crédit :" & Chr(10) & " - du compte 2734 pour la fraction des redevances correspondant à la seule prestation de construction, afin de solder ce compte ;" & Chr(10) & " - du compte 77 pour la fraction des redevances correspondant au coût du financement supporté par l'opérateur privé refacturé à la collectivité publique ;" & Chr(10) & " - du compte 706 pour les redevances représentatives des prestations post construction rendues par l'opérateur privé."
Sheets("feuil9").Range("a55").ClearContents
End Sub
Private Sub lire_chapitre_26()
Sheets("feuil9").Range("a56") = 1
MsgBox "GROUPEMENT D'INTERÊT ECONOMIQUE (G.I.E.)  !" & Chr(10) & Chr(10) & "Le G.I.E., société de personnes, est constitué entre deux ou plusieurs personnes physiques ou morales, pour une durée déterminée, en vue de mettre en oeuvre tous les moyens propres à faciliter ou à développer l'activité économique des membres, à améliorer ou à accroître les résultats de cette activité." & Chr(10) & "Le G.I.E. peut être constitué sans capital minimal légal, son financement étant assuré par les membres." & Chr(10) & Chr(10) & "A la constitution, lorsque les membres prennent des parts dans le G.I.E., l'opération est enregistrée :" & Chr(10) & " - Au débit du compte 266 par le crédit du compte 4813 et 52, dans la comptabilité des membres." & Chr(10) & " - Au débit du compte 46 et 52 par le crédit du compte 1013 ou 181 (si le G.I.E est constitué sans capital minimal légal), dans la comptabilité du G.I.E." & Chr(10) & Chr(10) & "Lorsqu'un membre avance des fonds au G.I.E. sur du long terme, l'opération est enregistrée :"
MsgBox "GROUPEMENT D'INTERÊT ECONOMIQUE (G.I.E.)  ! (suite et fin" & Chr(10) & Chr(10) & " - Au débit du compte 2774 par le crédit du compte 52, dans la comptabilité du membre." & Chr(10) & " - Au débit du compte 52 par le crédit du compte 164, dans la comptabilité du G.I.E." & Chr(10) & Chr(10) & "Lorsque le G.I.E. réalise une opération pour un de ses membres (prestation de service, achat à des tiers pour revendre au membre ou achat au membre pour revendre aux tiers), l'opération est enregistrée :" & Chr(10) & " - Au débit du compte 621 par le crédit du compte 463 ou 52, dans la comptabilité du membre." & Chr(10) & " - Au débit du compte 463 ou 52 par le crédit du compte 70, dans la comptabilité du G.I.E." & Chr(10) & Chr(10) & "En fin d'année :" & Chr(10) & " - Lorsqu'il y a distribution de bénéfices, les membres comptabilisent les revenus perçus au crédit du compte 772." & Chr(10) & " - En cas de déficit, il peut être apuré par des apports, avances ou cotisations complémentaires des membres."
Sheets("feuil9").Range("a56").ClearContents
End Sub
Private Sub lire_chapitre_27()
Sheets("feuil9").Range("a57") = 1
MsgBox "PERSONNEL INTERIMAIRE  !" & Chr(10) & Chr(10) & "Le personnel intérimaire est le personnel salarié d'une autre entité (entreprise de travail temporaire, entreprise industrielle ou commerciale appartenant généralement au même groupe), mis à la disposition de l'entité pour une durée déterminée. La prestation est facturée par cette autre entité." & Chr(10) & "NB : Une société de gardiennage n'est pas une entreprise de travail temporaire  !" & Chr(10) & Chr(10) & "L'application partielle du principe de la prééminence de la réalité sur l'apparence conduit le SYSCOHADA à inclure ces prestations de service reçus non dans les services extérieurs, mais dans les charges de personnel, malgré l'absence de contrat de travail entre l'entité et les travailleurs utilisés." & Chr(10) & "Par conséquent :" & Chr(10) & " - En cours d'exercice, l'entité utilisatrice enregistre les factures reçues de l'entreprise de travail temporaire au débit du compte 637."
MsgBox "PERSONNEL INTERIMAIRE  ! (suite et fin)" & Chr(10) & Chr(10) & " - A la clôture de l'exercice, le compte 637 est viré, pour solde, au débit du compte 667." & Chr(10) & Chr(10) & "NB : " & Chr(10) & " - Afin de ne pas fausser l'assiette des taxes, impôts ou cotisations calculés à partir de la masse salariale, des indications doivent être fournies, dans les Notes annexes, sur l'origine des charges ainsi transférées." & Chr(10) & " - La réforme a créé le compte 6327, pouvant être utilisé pour comptabiliser les factures des sociétés de gardiennage."
Sheets("feuil9").Range("a57").ClearContents
End Sub
Private Sub lire_chapitre_28()
Sheets("feuil9").Range("a58") = 1
MsgBox "REEVALUATION DES BILANS  ! (IAS 16, IAS 29)" & Chr(10) & Chr(10) & "Lors d'une réévaluation (légale ou libre), la valeur réévaluée des biens (immobilisations corporelles et financières) ne doit pas être supérieure à la valeur actuelle du bien sinon c'est la valeur actuelle qui est retenue." & Chr(10) & Chr(10) & "La comptabilisation se fait au débit des comptes 2.immobilisations (pour la hausse de valeur) par le crédit du compte 106 et des comptes 28 (hausse de valeur, si les biens sont amortis)." & Chr(10) & Chr(10) & "NB :" & Chr(10) & " - Pour les biens amortis, le plan d'amortissement initial doit être repris avec la valeur brute du bien réévaluée ou, les amortissements annuels ultérieurs doivent être multipliés par le coefficient (k) de réévaluation." & Chr(10) & " - Si l'opération de réévaluation est neutre fiscalement, le compte 154 doit être utilisé en remplacement du compte 106. Par conséquent, une reprise annuelle de provision réglementée est effectuée à concurrence du montant"
MsgBox "REEVALUATION DES BILANS  ! (suite et fin)" & Chr(10) & Chr(10) & "de supplément de la dotation aux amortissements annuelle des biens amortis, par le débit du compte 154 et le crédit du compte 861." & Chr(10) & " - La cession d'un bien réévalué se comptabilise dans les règles habituelles. Cependant, l'écart de réévaluation provenant du bien cédé doit être viré dans un compte de réserve non distribuable." & Chr(10) & " - Dans les économies hyper inflationnistes, les états financiers doivent être convertis chaque fin d'exercice dans l'unité de mesure ayant cours et les écarts, pertes ou gains éventuels, sont comptabilisés dans le bilan et dans le compte de résultat." & Chr(10) & Chr(10) & "REMARQUE : Toute réévaluation libre doit se faire dans le respect des conditions générales des articles 62 à 65 de l'Acte uniforme  !"
Sheets("feuil9").Range("a58").ClearContents
End Sub
Private Sub lire_chapitre_29()
Sheets("feuil9").Range("a59") = 1
MsgBox "INVENTAIRE PERMANENT EN COMPTABILITE FINANCIERE  !" & Chr(10) & Chr(10) & "Il est possible de tenir les comptes d'inventaire permanent en comptabilité générale, à l'instar de la comptabilité analytique de gestion, dans le cadre des comptes ouverts dans le plan des comptes du SYSCOHADA." & Chr(10) & "La tenue et le suivi permanent de comptes de stocks reposent sur les écritures suivantes :" & Chr(10) & Chr(10) & "ENTREE EN STOCKS" & Chr(10) & " - Pour les biens achetés, débit du compte 31, 32 ou 33 par le crédit du compte 603." & Chr(10) & " - Pour les biens produits, débit du compte 36 ou 37 par le crédit du compte 73." & Chr(10) & Chr(10) & "SORTIE DE STOCKS" & Chr(10) & " - Pour les biens achetés, débit du compte 603 par le crédit du compte 31, 32 ou 33." & Chr(10) & " - Pour les biens produits, débit du compte 73 par le crédit du compte 36 ou 37." & Chr(10) & Chr(10) & "EN FIN D'EXERCICE" & Chr(10) & " - Pour les stocks dont l'entité est déjà propriétaire, mais qui ne sont pas"
MsgBox "INVENTAIRE PERMANENT EN COMPTABILITE FINANCIERE  ! (suite et fin)" & Chr(10) & Chr(10) & "encore réceptionnés, car en voie d'acheminement vers l'entité ou vers un dépositaire ou un consignataire, l'entité utilise le compte 38 par le crédit ou le débit des comptes 603 et 73 pour constater les stocks initial et final." & Chr(10) & " - Les comptes d'en-cours 34 et 35 sont valorisés et mis à jour par le débit et le crédit du compte 73 (annulation stock initial ; constatation stock final). Ces corrections peuvent être faites chaque mois si l'entité établit des états financiers annuels." & Chr(10) & " - Toutes les corrections de valorisation apportées aux montants figurant dans les comptes de stocks pour assurer la conformité aux normes de la comptabilité générale, sont effectuées par débit et crédit des comptes 603 et 73 à la clôture de l'exercice."
Sheets("feuil9").Range("a59").ClearContents
End Sub
Private Sub lire_chapitre_30()
Sheets("feuil9").Range("a60") = 1
MsgBox "ENGAGEMENTS FINANCIERS ET PASSIFS EVENTUELS  !" & Chr(10) & Chr(10) & "Le SYSCOHADA n'impose pas la tenue d'une comptabilité des engagements. Toutefois, il prévoit un cadre qui règlemente la comptabilisation des engagements à travers l'utilisation spécifique des comptes de la classe 9." & Chr(10) & "La présente disposition propose les règles de comptabilisation des engagements de garantie." & Chr(10) & Chr(10) & "1°/ ENGAGEMENTS DE GARANTIE ACCORDES :" & Chr(10) & "Ce sont des engagements accordés par l'entité, non associés à des éléments figurant au bilan, pour garantir un créancier contre la défaillance éventuelle de son débiteur. Ces engagements sont comptabilisés :" & Chr(10) & " - Au crédit des comptes 9061 (avals accordés), 9062 (cautions, garanties accordées), 9063 (hypothèques accordées), 9064 (effets endossés par l'entité), 9068 (autres garanties accordées) ;" & Chr(10) & " - Par le débit du compte 916." & Chr(10) & Chr(10) & "2°/ ENGAGEMENTS DE GARANTIE OBTENUS :"
MsgBox "ENGAGEMENTS FINANCIERS ET PASSIFS EVENTUELS  ! (suite et fin)" & Chr(10) & Chr(10) & "Ce sont des engagements obtenus par l'entité pour la garantir en cas d'insolvabilité d'un tiers ou de mise en cause de la responsabilité de ce dernier. Ces engagements sont comptabilisés :" & Chr(10) & " - Au débit des comptes 9021 (avals obtenus), 9022 (cautions, garanties obtenues), 9023 (hypothèques obtenues), 9024 (effets endossés par des tiers), 9028 (autres garanties obtenues) ;" & Chr(10) & " - Par le crédit du compte 912." & Chr(10) & Chr(10) & "NB : Les informations en matière d'engagement sont à fournir dans les Notes annexes, pour les engagements qui ont un caractère significatif en application de la convention d'importance significative  !"
Sheets("feuil9").Range("a60").ClearContents
End Sub
Private Sub lire_chapitre_31()
Sheets("feuil9").Range("a61") = 1
MsgBox "EVENEMENTS POSTERIEURS A LA CLÔTURE DE L'EXERCICE  ! (IAS 10)" & Chr(10) & Chr(10) & "L'Acte uniforme, en son article 7, fixe la date de clôture d'un exercice comptable au 31 Décembre de chaque année, la date d'arrêtée des comptes au plus tard le 30 Avril de l'année suivante (article 23) et la date d'approbation des comptes en assemblée générale au plus tard le 30 Juin." & Chr(10) & "Les évènements postérieurs sont donc ceux qui interviennent entre la date de clôture et la date d'arrêtée des comptes." & Chr(10) & Chr(10) & "1°/ Evènements postérieurs contribuant à confirmer une situation existant à la date de clôture :" & Chr(10) & "L'entité doit ajuster les montants comptabilisés dans ses états financiers pour refléter ces évènements. Exemples :" & Chr(10) & " - Le règlement, après la clôture de l'exercice, d'une action en justice qui confirme que l'entité avait une obligation actuelle à la date de clôture. L'entité ajuste toute provision comptabilisée antérieurement liée à cette action en justice."
 
MsgBox "EVENEMENTS POSTERIEURS A LA CLÔTURE DE L'EXERCICE  ! (suite et fin)" & Chr(10) & Chr(10) & " - La faillite d'un client survenant après la clôture de l'exercice, confirme généralement qu'une perte sur une créance existait à la fin de la clôture de l'exercice et que l'entité doit ajuster la valeur comptable de la créance." & Chr(10) & " - La découverte de fraude ou d'erreurs montrant que les états financiers sont incorrects." & Chr(10) & Chr(10) & "2°/ Evènements postérieurs indiquant une situation nouvelle postérieure à la date de clôture :" & Chr(10) & "Si ces évènements ne remettent pas en cause la continuité de l'exploitation de l'entité, aucun ajustement ne doit être constaté dans les états financiers de l'exercice N mais une mention dans les Notes annexes doit être fournie, si ces évènements sont significatifs. Exemples :" & Chr(10) & " - Un incendie détruisant une partie importante de l'outil de production." & Chr(10) & " - Un regroupement d'entité." & Chr(10) & " - la cession d'une filiale."
Sheets("feuil9").Range("a61").ClearContents
End Sub
Private Sub lire_chapitre_32()
Sheets("feuil9").Range("a62") = 1
MsgBox "OPERATIONS FAITES POUR LE COMPTE DE TIERS  ! (IFRS 15)" & Chr(10) & Chr(10) & "1°/ LE MANDATAIRE :" & Chr(10) & "Le mandat est le contrat par lequel une personne, le mandant, donne à une autre, le mandataire, le pouvoir de faire << quelque chose >> pour son compte et en son nom." & Chr(10) & "Le mandataire est rémunéré par une commission qui doit être prévue dans le contrat et a droit au remboursement intégral de ses débours ainsi que de ses avances et frais." & Chr(10) & " - Les opérations d'achat, pour le compte du mandant, sont enregistrées au débit du compte 4731 par le crédit du compte 4712 (ouvert au nom de chaque fournisseur)." & Chr(10) & " - Les opérations de vente, pour le compte du mandant, sont enregistrées au débit du compte 4711 (ouvert au nom de chaque client) par le crédit du compte 4731." & Chr(10) & " - Les avances et frais engagés peuvent être enregistrés dans le compte 473." & Chr(10) & " - La rémunération du mandataire est comptabilisée dans le compte 706 s'il s'agit de son"
MsgBox "OPERATIONS FAITES POUR LE COMPTE DE TIERS  ! (suite)" & Chr(10) & Chr(10) & "activité principale. Dans le cas d'une activité accessoire c'est le compte 7072 qui sera choisi." & Chr(10) & Chr(10) & "NB : Le mandant enregistre normalement les opérations d'achat et de vente en charges et en produits et la rémunération du mandataire dans le compte 623." & Chr(10) & Chr(10) & "2°/ LE COMMISSIONNAIRE :" & Chr(10) & "Le commissionnaire agit en son nom propre ou sous un nom social pour le compte du commettant. L'intermédiaire doit rendre compte au commettant des opérations qu'il exécute pour son compte." & Chr(10) & "D'une manière générale, le commissionnaire prélève directement sa commission sur les sommes qu'il doit restituer au commettant." & Chr(10) & " - Les opérations traitées pour le compte de tiers, au nom de l'entité, sont comptabilisées selon leur nature dans les charges et les produits de l'entité comme le ferait un acheteur-revendeur." & Chr(10) & " - Sa commission n'apparait pas"
MsgBox "OPERATIONS FAITES POUR LE COMPTE DE TIERS  ! (suite et fin)" & Chr(10) & Chr(10) & "directement. Elle est constituée par la marge qu'il réalise sur les transactions dans lesquelles il s'entremet (ventes - achats)." & Chr(10) & Chr(10) & "NB : Les opérations d'achat et vente sont enregistrées normalement chez le commettant sauf que pour les ventes, la rémunération du commissionnaire vient en déduction du chiffre d'affaires et est comptabilisée dans le compte 6322." & Chr(10) & "En d'autres termes, le montant de la vente doit correspondre au montant d'achat chez l'intermédiaire."
Sheets("feuil9").Range("a62").ClearContents
End Sub
Private Sub lire_chapitre_33()
Sheets("feuil9").Range("a63") = 1
MsgBox "OPERATIONS FAITES EN COMMUN  !" & Chr(10) & Chr(10) & "La Société en Participation (SP) est une entité de communautés d'intérêts sans personnalité juridique (absence d'immatriculation au RCCM)." & Chr(10) & "Les opérations de la SP sont généralement regroupées dans la comptabilité du gérant, l'un des coparticipants, de la manière suivante :" & Chr(10) & " - Soit dans une comptabilité autonome rattachée à la comptabilité du gérant, par le compte de liaison 188 ;" & Chr(10) & " - Soit à l'intérieur de sa propre comptabilité, en subdivisant les comptes de la classe 6 et 7 où seraient récapitulés les charges et produits de la société en participation." & Chr(10) & Chr(10) & "1°/ APPORTS EN JOUISSANCE DE BIEN :" & Chr(10) & " - L'opération est comptabilisée par la SP comme une charge locative facturée par le coparticipant propriétaire du bien au débit du compte 622 par le crédit du compte 463." & Chr(10) & " - Chez le coparticipant propriétaire, au débit le compte 463 par le crédit du compte 7073 ou 706."
 
MsgBox "OPERATIONS FAITES EN COMMUN  ! (suite)" & Chr(10) & Chr(10) & "2°/ MISES DE FONDS : Les mises de fonds sont destinées à financer les besoins de la SP." & Chr(10) & " - Dans la comptabilité de la SP, le compte 52 sera débité par le crédit du compte 463. Si le gérant tient une comptabilité autonome, les fonds transiteront par le compte 188." & Chr(10) & " - Chez les coparticipants, le compte 463 sera débité par le crédit du compte 52." & Chr(10) & Chr(10) & "3°/ ACQUISITIONS DE BIENS :" & Chr(10) & " - Ces biens destinés à la SP doivent figurer dans le bilan du gérant coparticipant (propriétaire apparent) au débit du compte 2.immobilisation par le crédit du compte 481. Ensuite, il doit constater le droit des autres coparticipants sur ces biens en créditant, dans sa propre comptabilité, le compte 182 par le débit du compte 463." & Chr(10) & " - Les autres coparticipants doivent également constater leur droits sur ces biens dans leur comptabilité en débitant le compte 2773 par le crédit du compte 463."
MsgBox "OPERATIONS FAITES EN COMMUN  ! (suite)" & Chr(10) & Chr(10) & "La dotation aux amortissements annuelle sera constatée dans la comptabilité de la SP par le débit du compte 68 et le crédit du compte 28 pour les biens amortissables. Par conséquent :" & Chr(10) & " - L'amortissement annuelle vient diminuer la dette du gérant envers les autres coparticipants. Dans la propre comptabilité du gérant, le compte 182 sera débit par le crédit du compte 463 du montant de l'amortissement ;" & Chr(10) & " - Dans la comptabilité des autres coparticipants, le compte 2773 sera crédité par le débit du compte 463, diminuant ainsi leur droit sur le bien du montant de l'amortissement." & Chr(10) & Chr(10) & "4°/ OPERATIONS AVEC LES TIERS ET ENTRE COPARTICIPANTS :" & Chr(10) & " - Les opérations avec les tiers et entre coparticipants s'enregistrent selon les règles habituelles de comptabilisation." & Chr(10) & " - Par ailleurs si la cession se fait au coût du bien entre coparticipants, chez le cédant le compte de"
MsgBox "OPERATIONS FAITES EN COMMUN  ! (suite)" & Chr(10) & Chr(10) & "charge 6 ou le compte 781 sera crédité par le débit du compte 463. Chez le coparticipant acquéreur, la comptabilisation se fera conformément aux règles habituelles dans le compte 6 de charge concernée." & Chr(10) & Chr(10) & "5°/ REPARTITION DE LA PRODUCTION ET DU RESULTAT DE LA SP :" & Chr(10) & "Les biens produits par la SP et qui font l'objet de répartition entre les coparticipants se comptabilisent comme suit :" & Chr(10) & " - Dans la comptabilité de la SP, le compte 463 sera débité par le crédit du compte 781 du montant du coût de production des biens répartis ;" & Chr(10) & " - Dans la comptabilité de chaque coparticipant, le compte 638 sera débité par le crédit du compte 463." & Chr(10) & Chr(10) & "Le résultat de la SP, en fin d'exercice, est réparti de la manière suivante :" & Chr(10) & " - Dans la comptabilité de la SP, en cas de bénéfice au débit du compte 652 et en cas de perte au crédit du compte 752 par le"
MsgBox "OPERATIONS FAITES EN COMMUN  ! (suite et fin)" & Chr(10) & Chr(10) & "crédit ou le débit du compte 463." & Chr(10) & " - Dans la comptabilité de chaque coparticipant, en cas de bénéfice au crédit du compte 752 et en cas de perte au débit du compte 652 par le débit ou le crédit du compte 463." & Chr(10) & Chr(10) & "NB : Chaque coparticipant doit faire apparaître dans son compte de résultat de fin d'année, la quote-part de résultat partagé en créant à cet effet un poste supplémentaire dans son compte de résultat  !"
Sheets("feuil9").Range("a63").ClearContents
End Sub
Private Sub lire_chapitre_34()
Sheets("feuil9").Range("a64") = 1
MsgBox "COMPTABILITE AUTONOME PAR ETABLISSEMENT  !" & Chr(10) & Chr(10) & "Toutes les opérations enregistrées entre le siège et un établissement, le siège étant aussi un établissement, transitent par un compte de liaison qui fonctionne dans les deux comptabilités de façon réciproque : le compte 185." & Chr(10) & "Illustration" & Chr(10) & "La succursale en rupture de fonds demande au siège de lui faire parvenir une somme de  5 000 000 F pour faire face à certains règlements." & Chr(10) & "Les écritures comptables seront," & Chr(10) & Chr(10) & "Au niveau du siège :" & Chr(10) & "D : 1851 SUCCURSALE A ....... 5000000" & Chr(10) & "         C : 571 CAISSE SIEGE .......... 5000000" & Chr(10) & Chr(10) & "Au niveau de la succursale :" & Chr(10) & "D : 572 CAISSE SUCCURSALE .... 5000000" & Chr(10) & "         C : 1852 COMPTE SIEGE .......... 5000000" & Chr(10) & Chr(10) & "REMARQUE : Globalement, les opérations comptabilisées se neutralisent au niveau de l'entité  !"
MsgBox "COMPTABILITE AUTONOME PAR ETABLISSEMENT  ! (suite et fin)" & Chr(10) & Chr(10) & "Les cessions entre l'établissement et les tiers s'enregistrent conformément aux règles habituelles." & Chr(10) & "Par contre les cessions entre établissement s'enregistrent :" & Chr(10) & " - Pour l'établissement qui fournit, au débit du compte 185 par le crédit du compte 187 (ou au crédit du compte 6 de charge concernée) ;" & Chr(10) & " - Pour l'établissement qui reçoit, au débit du compte 186 (ou au débit du compte 6 de charge concernée) par le crédit du compte 185." & Chr(10) & Chr(10) & "NB :" & Chr(10) & " - Les comptes 186 et 187 peuvent être remplacés respectivement par les comptes 6 de charges et 7 de produits concernés." & Chr(10) & " - Lorsque le siège accorde une autonomie financière à un établissement, le compte 184 sert à comptabiliser le capital de cet établissement." & Chr(10) & " - En fin d'année, les comptes 185, 186, 187 et 184 sont soldés pour avoir les comptes cumulés de l'entité  !"
Sheets("feuil9").Range("a64").ClearContents
End Sub
Private Sub lire_chapitre_35()
Sheets("feuil9").Range("a65") = 1
MsgBox "CONTRAT DE FRANCHISE  !" & Chr(10) & Chr(10) & "Le franchisage est le contrat par lequel une entité (le franchiseur) concède à une entité indépendante (franchisée), en contrepartie d'une redevance, le droit de se présenter sous sa raison sociale et sa marque, pour vendre des produits ou services. Le franchisé exploite la marque commerciale ou l'enseigne concédée par le franchiseur qui apporte, par ailleurs, une assistance permanente au franchisé." & Chr(10) & "En contrepartie des concessions et de cette assistance, le franchisé doit lui régler :" & Chr(10) & " - Un droit d'entrée dès son arrivée dans la chaîne de franchise ;" & Chr(10) & " - Des redevances périodiques calculées habituellement sur la base du chiffre d'affaires réalisés." & Chr(10) & Chr(10) & "1°/ LE DROIT D'ENTREE" & Chr(10) & "Comptabilisation chez le franchiseur :" & Chr(10) & " - S'il correspond à la contrepartie des biens livrés, il est comptabilisé en produit dans le compte 70 ;"
MsgBox "CONTRAT DE FRANCHISE  ! (suite et fin)" & Chr(10) & Chr(10) & " - S'il correspond à des prestations restant à fournir au franchisé, il est enregistré au crédit du compte 477." & Chr(10) & Chr(10) & "Comptabilisation chez le franchisé :" & Chr(10) & " - S'il rémunère le droit d'utilisation de la marque et du savoir-faire du franchiseur, il s'enregistre au débit du compte 2184 et est amorti sur la durée probable de la franchise ;" & Chr(10) & " - S'il rémunère les frais de démarrage et d'installation du local d'exploitation du franchisé, il s'enregistre au débit du compte 2345 ou 235 ;" & Chr(10) & " - S'il rémunère un ensemble de prestations fournies par le franchiseur, il s'enregistre au débit du compte 634 ou 476." & Chr(10) & Chr(10) & "2°/ LES REDEVANCES" & Chr(10) & " - Chez le franchiseur, ils s'enregistrent au crédit du compte 706 ou 7076." & Chr(10) & " - Chez le franchisé, ils s'enregistrent au débit du compte 634."
Sheets("feuil9").Range("a65").ClearContents
End Sub
Private Sub lire_chapitre_36()
Sheets("feuil9").Range("a66") = 1
MsgBox "COMPTABILITE PLURI MONETAIRE  !" & Chr(10) & Chr(10) & "Une comptabilité pluri monétaire fait appel à deux (2) principales méthodes de traitement :" & Chr(10) & Chr(10) & "1°/ METHODE D'INTEGRATION DIRECTE OU MONO MONETAIRE" & Chr(10) & "Elle est utilisée lorsqu'il n'y a qu'un petit nombre d'opérations réalisées dans une seule monnaie étrangère." & Chr(10) & " - Elle consiste à convertir au cours du jour toutes les opérations réalisées en monnaie étrangère." & Chr(10) & " - En fin d'année ou à l'échéance des règlements, le traitement se fait conformément aux règles habituelles des opérations en monnaies étrangères." & Chr(10) & Chr(10) & "2°/ METHODE D'INTEGRATION DIFFEREE OU PLURI MONETAIRE" & Chr(10) & "Elle est conseillée dès que les opérations avec l'étranger prennent une certaine ampleur (plusieurs monnaies étrangères en cause, de nombreuses opérations)." & Chr(10) & "La méthode consiste à mettre en place une comptabilité autonome pour chaque devise, en liaison avec la comptabilité ordinaire de"
 
MsgBox "COMPTABILITE PLURI MONETAIRE  ! (suite et fin)" & Chr(10) & Chr(10) & "l'entité tenue en F CFA par l'utilisation du compte 185." & Chr(10) & " - Les opérations au jour le jour sont enregistrées dans chaque comptabilité autonome de la devise concernée ;" & Chr(10) & " - En fin d'exercice, les comptabilités autonomes en monnaies étrangères sont converties au cours du jour et intégrées à la comptabilité ordinaire de l'entité tenue en F CFA." & Chr(10) & Chr(10) & "NB : Il existe une troisième méthode dite de l'intégration mixte qui fait intervenir une comptabilité des monnaies étrangères en partie simple (hors bilan) et une comptabilité en F CFA en partie double (comptabilité ordinaire)  !"
Sheets("feuil9").Range("a66").ClearContents
End Sub
Private Sub lire_chapitre_37()
Sheets("feuil9").Range("a67") = 1
MsgBox "OPERATIONS SPECIFIQUES DES ENTITES AGRICOLES  !" & Chr(10) & Chr(10) & "La spécificité de l'activité agricole a nécessité la création de nouveaux comptes adaptés à certaines de ses opérations :" & Chr(10) & Chr(10) & " - Le compte 2245 : qui enregistre les dépenses et les charges engagées en vue de l'amélioration durable de la fertilité des terrains d'exploitation (travail du sol, assolements, fumures, apports organiques...). Ces dépenses sont immobilisées et amorties si elles sont ultérieures à l'acquisition du terrain." & Chr(10) & Chr(10) & " - Le compte 6226 : fermages et loyers du foncier débité par le crédit du compte 702, s'ils sont payés en nature." & Chr(10) & Chr(10) & " - Le compte 7222 : enregistre les productions par l'entité (en interne) des actifs biologiques, est crédité par le débit du compte 2496." & Chr(10) & Chr(10) & " - Le compte 724 : enregistre les prélèvements sur la production pour l'autoconsommation, est crédité contre le débit du compte 1047 ou 6617/6627."
MsgBox "OPERATIONS SPECIFIQUES DES ENTITES AGRICOLES  ! (suite et fin)" & Chr(10) & Chr(10) & " - Les comptes 714 ou 844 pour les subventions reçues." & Chr(10) & Chr(10) & " - Les comptes de la classe 3 : intitulés << Stocks d'actifs biologiques >> pour enregistrer les actifs biologiques dont la durabilité dans l'entité agricole est de moins d'un an." & Chr(10) & Chr(10) & " - Les autres opérations sont enregistrées conformément aux règles habituelles, notamment la classification des animaux et des plantes en immobilisations ou en stocks en fonction de leur utilité et de leur durée de vie dans l'entité agricole (à plus ou moins d'un an)." & Chr(10) & Chr(10) & "NB : Les comptes d'immobilisations animales et végétales ont été remplacés par le nouvel intitulé << Actifs biologiques >>  !"
Sheets("feuil9").Range("a67").ClearContents
End Sub
Private Sub lire_chapitre_38()
Sheets("feuil9").Range("a68") = 1
MsgBox "FUSIONS ET OPERATIONS ASSIMILEES  !" & Chr(10) & Chr(10) & "Les opérations de fusion ont pour conséquences la dissolution de la société absorbée et l'augmentation du capital de la société absorbante, et sont régies par les dispositions du Droit des sociétés et du GIE de l'OHADA révisé (en ses articles 190, 191, 192, 674, 675, etc...)." & Chr(10) & Chr(10) & "Les écritures comptables chez la société absorbante sont les suivantes :" & Chr(10) & " - A la promesse : Débit du compte 4614 par le crédit des comptes 101 et 1053 ;" & Chr(10) & " - A la réalisation : Débit des comptes 2.immobilisations par le crédit du compte 4614." & Chr(10) & Chr(10) & "Les écritures comptables chez la société absorbée :" & Chr(10) & " - A la réalisation : Débit du compte 4718 par le crédit des comptes 2.immobilisations et du compte 1318 (résultat de fusion lorsque les apports sont repris à leur valeur réelle) ;" & Chr(10) & " - A la conversion en actions : le compte 4718 est crédité par le débit du compte 502 ;"
MsgBox "FUSIONS ET OPERATIONS ASSIMILEES  ! (suite)" & Chr(10) & Chr(10) & " - Au partage des actions : le compte 4618 est crédité par le débit des comptes 1.de capitaux propres ;" & Chr(10) & " - Enfin, pour solder les comptes de l'entité absorbée : le compte 502 est crédité par le débit du compte 4618." & Chr(10) & Chr(10) & "NB :" & Chr(10) & " - Lorsque les deux (2) entités ont des participations réciproques, l'entité absorbante doit renoncer à ses actions détenues dans l'entité absorbée, et également réduire son capital de celles détenues par l'entité absorbée." & Chr(10) & Chr(10) & " - Le rapport ou parité d'échange =" & Chr(10) & Chr(10) & "[Valeur de l'entité absorbée/Nombre d'actions de l'entité absorbée]" & Chr(10) & "------------------------------------------------------------------------" & Chr(10) & "[Valeur de l'entité absorbante/Nombre d'actions de l'entité absorbante]"
MsgBox "FUSIONS ET OPERATIONS ASSIMILEES  ! (suite et fin)" & Chr(10) & Chr(10) & " - Les écritures de scission sont identiques à celles des fusions." & Chr(10) & Chr(10) & " - Les apports partiels d'actifs, assimilés à une restructuration chez la société apporteuse, sont enregistrés chez cette dernière avec les comptes 833 et 843 pour constater les plus ou moins values des sorties d'actifs à leur valeur réelle. Les autres écritures restent identiques à celles des fusions." & Chr(10) & Chr(10) & " - Les rompus, les nombres à virgule issus de l'application du rapport d'échange d'actions, sont résolus entre autres par la constatation pure et simple d'une perte ou par le versement d'une soulte en compensation  !"
Sheets("feuil9").Range("a68").ClearContents
End Sub
Private Sub lire_chapitre_39()
Sheets("feuil9").Range("a69") = 1
MsgBox "COMPTES INTERMEDIAIRES  ! (IAS 34)" & Chr(10) & Chr(10) & "Le SYSCOHADA révisé recommande des principes de comptabilisation, d'évaluation et de présentation des comptes intermédiaires établis volontairement ou légalement par certaines entités." & Chr(10) & Chr(10) & "1°/ Les comptes intermédiaires comprennent :" & Chr(10) & " - Le bilan intermédiaire qui doit faire apparaître les données du dernier exercice ;" & Chr(10) & " - Le compte de résultat intermédiaire qui doit faire apparaître les données de la même période de l'année précédente, ainsi que les données du dernier exercice ;" & Chr(10) & " - Le tableau des flux de trésorerie intermédiaire qui doit faire apparaître les données du dernier exercice ;" & Chr(10) & " - Et une sélection des Notes annexes." & Chr(10) & Chr(10) & "2°/ Adoption de méthodes comptables identiques à celles utilisées dans les comptes de l'exercice :" & Chr(10) & " - Evaluation de charge d'impôt intermédiaire ;" & Chr(10) & " - Extrapolation des stocks et des provisions."
Sheets("feuil9").Range("a69").ClearContents
End Sub
Private Sub lire_chapitre_40()
Sheets("feuil9").Range("a70") = 1
MsgBox "LIQUIDATION  !" & Chr(10) & Chr(10) & "La société est en liquidation dès l'instant de sa dissolution. Les principales causes de dissolution sont :" & Chr(10) & " - Arrivée au terme, réalisation ou extinction de l'objet ;" & Chr(10) & " - Annulation du contrat de société, dissolution anticipée décidée par les associés ou le tribunal ;" & Chr(10) & " - Jugement ordonnant la liquidation judiciaire ou la cession totale des actifs." & Chr(10) & Chr(10) & "Le liquidateur désigné (en assemblée générale ou en justice) a pour mission essentielle :" & Chr(10) & Chr(10) & "1°/ Réaliser l'actif et le passif et dégager un résultat de liquidation, avec les comptes 837 (perte) et 847 (profit), à inscrire en capitaux propres au crédit du compte 1384 ;" & Chr(10) & Chr(10) & "2°/ Distribuer les capitaux propres et le résultat de liquidation aux associés en les débitant par le crédit du compte 4619 ;" & Chr(10) & Chr(10) & "3°/ Régler éventuellement les associés en débitant le compte 4619 par le crédit du compte 52."
Sheets("feuil9").Range("a70").ClearContents
End Sub
Private Sub définition_actif()
Sheets("feuil9").Range("d107") = 1
MsgBox "ACTIF  ! (Annexe à l'Acte uniforme, page 149)" & Chr(10) & Chr(10) & "Un actif est un élément identifiable du patrimoine représentant une ressource économique actuelle contrôlée par l'entité du fait d'évènements passés."
Sheets("feuil9").Range("d107").ClearContents
End Sub
Private Sub définition_charges()
Sheets("feuil9").Range("d109") = 1
MsgBox "CHARGES  ! (Annexe à l'Acte uniforme, page 159)" & Chr(10) & Chr(10) & "Emplois définitifs ou consommations de valeurs décaissées ou à décaisser par l'entité :" & Chr(10) & " - Soit en contrepartie de marchandises, approvisionnements, travaux et services consommés par l'entité, ainsi que des avantages qui leur ont été consentis ;" & Chr(10) & " - Soit en vertu d'une obligation légale que l'entité doit remplir ;" & Chr(10) & " - Soit exceptionnellement, sans contrepartie directe." & Chr(10) & Chr(10) & "Les charges comprennent également pour la détermination du résultat de l'exercice :" & Chr(10) & " - Les dotations aux amortissements, aux dépréciations et aux provisions ;" & Chr(10) & " - La valeur comptable des éléments d'actif cédés, détruits ou disparus."
Sheets("feuil9").Range("d109").ClearContents
End Sub
Private Sub définition_amortissement()
Sheets("feuil9").Range("d111") = 1
MsgBox "AMORTISSEMENT  ! (Article 45 de l'Acte uniforme)" & Chr(10) & Chr(10) & "L'amortissement consiste pour l'entité à répartir le montant amortissable du bien sur sa durée d'utilité selon un plan prédéfini." & Chr(10) & Chr(10) & "Le plan d'amortissement est la traduction comptable de la répartition systématique du montant amortissable d'un actif selon le rythme de consommation des avantages économiques attendus en fonction de sa durée d'utilité."
Sheets("feuil9").Range("d111").ClearContents
End Sub
Private Sub définition_dépréciation()
Sheets("feuil9").Range("d113") = 1
MsgBox "DEPRECIATION  ! (Article 46 de l'Acte uniforme)" & Chr(10) & Chr(10) & "La dépréciation permet de constater la perte de valeur de l'actif." & Chr(10) & Chr(10) & "A la clôture de chaque exercice, une entité doit apprécier s'il existe un quelconque indice qu'un actif a subi une perte de valeur. S'il existe un tel indice, l'entité doit estimer la valeur actuelle de l'actif concerné et la comparer avec la valeur nette comptable." & Chr(10) & Chr(10) & "L'actif doit être déprécié lorsque la valeur nette comptable est supérieure à la valeur actuelle." & Chr(10) & Chr(10) & "Pour les immobilisations, cette dépréciation est constatée par une dotation et pour les autres éléments de l'actif, par une charge pour dépréciation."
Sheets("feuil9").Range("d113").ClearContents
End Sub
Private Sub définition_passif()
Sheets("feuil9").Range("h107") = 1
MsgBox "PASSIF  ! (Annexe à l'Acte uniforme, page 189)" & Chr(10) & Chr(10) & "LE PASSIF EXTERNE constitue des ressources financières externes, payables ou remboursables selon des échéances déterminées." & Chr(10) & "Le passif externe regroupe toutes les dettes envers les tiers et les provisions pour risques et charges." & Chr(10) & Chr(10) & "LE PASSIF INTERNE constitue des ressources financières internes (capitaux propres dont subventions d'investissement et provisions règlementées) de l'entité."
Sheets("feuil9").Range("h107").ClearContents
End Sub
Private Sub définition_produits()
Sheets("feuil9").Range("h109") = 1
MsgBox "PRODUITS  ! (Annexe à l'Acte uniforme, page 192)" & Chr(10) & Chr(10) & "Sommes ou valeurs reçues ou à recevoir :" & Chr(10) & " - Soit en contrepartie de la fourniture par l'entité de biens, travaux, services, ainsi que des avantages qu'elle a consentis ;" & Chr(10) & " - Soit en vertu d'une obligation légale existant à la charge d'un tiers ;" & Chr(10) & " - Soit exceptionnellement sans contrepartie." & Chr(10) & Chr(10) & "Les produits comprennent également pour la détermination du résultat de l'exercice :" & Chr(10) & " - La production stockée au cours de l'exercice ;" & Chr(10) & " - La production immobilisée ;" & Chr(10) & " - Les reprises sur amortissements et provisions ;" & Chr(10) & " - Le prix de cession d'éléments d'actifs cédés, détruits ou disparus ;" & Chr(10) & " - Le transfert de charges."
Sheets("feuil9").Range("h109").ClearContents
End Sub
Private Sub définition_provision()
Sheets("feuil9").Range("h111") = 1
MsgBox "PROVISION  ! (Article 48 de l'Acte uniforme)" & Chr(10) & Chr(10) & "Une provision est un passif externe ou une dette dont l'échéance ou le montant est incertain." & Chr(10) & "Le terme provision désigne les provisions pour risques et charges." & Chr(10) & Chr(10) & "Par dérogation, les provisions règlementées sont constituées uniquement en application de dispositions légales notamment fiscales." & Chr(10) & Chr(10) & "Un passif externe est une obligation actuelle de l'entité de transférer une ressource économique à la suite d'événements passés."
Sheets("feuil9").Range("h111").ClearContents
End Sub
Private Sub définition_composant()
Sheets("feuil9").Range("h113") = 1
MsgBox "COMPOSANT  ! (Article 38-1 de l'Acte uniforme)" & Chr(10) & Chr(10) & "L'entité ventile le montant d'une immobilisation corporelle en ses parties significatives dès lors que :" & Chr(10) & " - Les éléments d'actif sont identifiables ;" & Chr(10) & " - Les éléments d'actif ont une utilisation différente ;" & Chr(10) & " - La durée d'utilité de chaque élément est différente ;" & Chr(10) & " - Le coût de chaque élément peut être évalué de façon fiable et qu'il est significatif par rapport au coût total de l'immobilisation." & Chr(10) & Chr(10) & "Chaque élément de l'immobilisation visée à l'alinéa précédent doit être comptabilisé séparément dès son acquisition ou son remplacement." & Chr(10) & Chr(10) & "La décomposition de ces immobilisations n'est autorisée que pour les bâtiments et autres ouvrages, les avions, les bateaux, les camions, les autocars, les bus, les véhicules blindés de transport de fonds, certains matériels et outillages des entités industrielles, minières, agricoles, hospitalières et"
MsgBox "COMPOSANT  ! (Article 38-1 de l'Acte uniforme)" & Chr(10) & Chr(10) & "pétrolières, dès lors que l'entité dispose de statistiques et autres informations lui permettant de bien appréhender la durée d'utilité de chaque élément."
Sheets("feuil9").Range("h113").ClearContents
End Sub
Private Sub proforma_point_1()
Sheets("feuil9").Range("i9") = 1
MsgBox "DECLARATION DE CONFORMITE  !" & Chr(10) & Chr(10) & "Sont considérés comme  << premiers états financiers selon le SYSCOHADA révisé >>, ceux qui sont confirmés par une déclaration explicite et sans réserve de conformité  SYSCOHADA révisé."
Sheets("feuil9").Range("i9").ClearContents
End Sub
Private Sub proforma_point_2()
Sheets("feuil9").Range("i10") = 1
MsgBox "LES CHARGES IMMOBILISEES  !" & Chr(10) & Chr(10) & "Les charges immobilisées (sauf les primes de remboursement des obligations et les frais de prospection) doivent être virées au débit du compte 4751." & Chr(10) & Chr(10) & "Ensuite le compte 4751 doit être repris sur l'exercice ou étalé sur la période restant à amortir sans dépasser cinq (5) ans, en le créditant par le débit des comptes de charges par nature concernés."
Sheets("feuil9").Range("i10").ClearContents
End Sub
Private Sub proforma_point_3()
Sheets("feuil9").Range("i11") = 1
MsgBox "LES PRIMES DE REMBOURSEMENT ET FRAIS D'EMISSION  !" & Chr(10) & Chr(10) & "1°/ LES PRIMES DE REMBOURSEMENT :" & Chr(10) & "Le compte 206 doit être crédité par le débit du compte 161." & Chr(10) & "Au fur et à mesure du remboursement des obligations, les primes de remboursement échues sont enregistrées au débit du compte 6714 au prorata des intérêts courus." & Chr(10) & "Les primes de remboursement non échues, sont inscrites dans les Notes annexes en engagements hors bilan." & Chr(10) & Chr(10) & "2°/ LES FRAIS D'EMISSION :" & Chr(10) & "Le compte 2026 doit être crédité par le débit du compte 4751." & Chr(10) & "Ensuite le compte 4751 doit être repris en charge sur l'exercice ou étalé sur la durée restant à amortir sans dépasser cinq (5) ans, en le créditant par le débit du compte 6316."
Sheets("feuil9").Range("i11").ClearContents
End Sub
Private Sub proforma_point_4()
Sheets("feuil9").Range("i12") = 1
MsgBox "LES FRAIS DE PROSPECTION  !" & Chr(10) & Chr(10) & "1°/ Les frais de prospection et d'évaluation des ressources minérales activés selon des critères non conformes au SYSCOHADA révisé doivent être annulés." & Chr(10) & "Le compte 2012 sera crédité par le débit du compte 4751." & Chr(10) & "Ensuite le compte 4751 sera repris sur l'exercice ou étalé sur la période restant à amortir sans dépasser cinq (5) ans, en le créditant par le débit du compte 6261." & Chr(10) & Chr(10) & "2°/ En revanche, les frais de prospection activés selon des critères conformes au SYSCOHADA révisé seront simplement virés dans le nouveau compte approprié, en créditant le compte 2012 par le débit du compte 2181 si l'actif de prospection est une immobilisation incorporelle."
Sheets("feuil9").Range("i12").ClearContents
End Sub
Private Sub proforma_point_5()
Sheets("feuil9").Range("i13") = 1
MsgBox "LES PROVISIONS POUR CHARGES A REPARTIR SUR PLUSIEURS EXERCICES  !" & Chr(10) & Chr(10) & "Les provisions pour charges à répartir doivent être soldées conformément aux schémas de comptabilisation suivants :" & Chr(10) & Chr(10) & " - S'il s'agit d'une provision pour démantèlement et de restauration du site, la provision doit être transférée au crédit du compte 1984 par le débit du compte 197. L'estimation des coûts de démantèlement, enlèvement et restauration du site doit être évaluée et inscrite au bilan au débit d'un compte 2.immobilisation, pour le montant total déduction faite de la provision déjà constituée." & Chr(10) & Chr(10) & " - S'il s'agit d'une révision majeure, la provision doit être reprise par le crédit du compte 4752 et le débit du compte 197. La prochaine inspection sera immobilisée."
MsgBox "LES PROVISIONS POUR CHARGES A REPARTIR SUR PLUSIEURS EXERCICES  !" & Chr(10) & Chr(10) & "- S'il s'agit d'un composant d'immobilisation, la provision doit être reprise par le crédit du compte 4752 et le débit du compte 197. Le bien concerné doit être décomposé et son plan d'amortissement doit être revu." & Chr(10) & Chr(10) & " - S'il s'agit d'autres provisions, elles doivent être virées au crédit du compte 4752 par le débit du compte 197." & Chr(10) & Chr(10) & "NB : Les comptes 4752 seront rapportés au résultat de l'exercice ou étalés sur une durée ne pouvant pas dépasser cinq (5) ans, en les débitant par le crédit du compte 791."
Sheets("feuil9").Range("i13").ClearContents
End Sub
Private Sub proforma_point_6()
Sheets("feuil9").Range("i14") = 1
MsgBox "FRAIS DE RECHERCHE APPLIQUEE  !" & Chr(10) & Chr(10) & "Les frais de recherche appliquée, activés conformément aux dispositions anciennes, doivent faire l'objet d'une annulation." & Chr(10) & Chr(10) & "A cet effet, le compte 4751 sera débité (pour la valeur nette comptable) par le crédit du compte 211 et le débit du compte 2811." & Chr(10) & Chr(10) & "Le compte 4751 sera ensuite rapporté au compte de résultat sur la durée restant à amortir sans dépasser une durée de cinq (5) ans, en le créditant par le débit du compte 6261."
Sheets("feuil9").Range("i14").ClearContents
End Sub
Private Sub proforma_point_7()
Sheets("feuil9").Range("i15") = 1
MsgBox "APPROCHE PAR LES COMPOSANTS  !" & Chr(10) & Chr(10) & "Pour les biens acquis avant l'entrée en vigueur du SYSCOHADA révisé, l'entité a le choix entre :" & Chr(10) & " - Maintenir les immobilisations en l'état ; ou" & Chr(10) & " - Faire un retraitement des immobilisations existantes par la méthode ci-après développée." & Chr(10) & Chr(10) & "La méthode retenue pour le retraitement des immobilisations décomposables existant au bilan d'ouverture, est celle de la réallocation des valeurs nettes comptables." & Chr(10) & "Cette méthode consiste à ne pas modifier la valeur nette comptable globale de chaque immobilisation, mais à la répartir entre les différents composants." & Chr(10) & Chr(10) & "NB : Cette méthode n'a aucun impact sur les capitaux propres  !"
Sheets("feuil9").Range("i15").ClearContents
End Sub
Private Sub proforma_point_8()
Sheets("feuil9").Range("i16") = 1
MsgBox "COÛTS DE DEMANTELEMENT, D'ENLEVEMENT ET DE REMISE EN ETAT DU SITE  !" & Chr(10) & Chr(10) & "Il sera procédé à une évaluation du coût de démantèlement du site, déduction faite de la provision pour charge à répartir, constituée depuis le début de l'exploitation." & Chr(10) & Chr(10) & "Le compte 197, enregistré antérieurement à l'entrée en vigueur du SYSCOHADA révisé, sera viré au compte 1984."
Sheets("feuil9").Range("i16").ClearContents
End Sub
Private Sub proforma_point_9()
Sheets("feuil9").Range("i17") = 1
MsgBox "CONTRAT DE LOCATION  !" & Chr(10) & Chr(10) & "Par dérogation et dans un souci de simplification, les nouvelles dispositions portant sur les contrats de location doivent s'appliquer exclusivement aux nouveaux contrats signés à partir de la date d'application du SYSCOHADA révisé." & Chr(10) & Chr(10) & "En conséquence, aucun retraitement ne sera opéré concernant les contrats de location en cours."
Sheets("feuil9").Range("i17").ClearContents
End Sub
Private Sub proforma_point_10()
Sheets("feuil9").Range("i18") = 1
MsgBox "LES IMMEUBLES DE PLACEMENT  !" & Chr(10) & Chr(10) & "L'application des nouveaux critères de qualification et d'évaluation des immeubles de placement doit se faire de façon prospective." & Chr(10) & Chr(10) & "Par conséquent, les seuls réajustements vont consister à changer l'intitulé des comptes 2281, 2315 et 2325."
Sheets("feuil9").Range("i18").ClearContents
End Sub
Private Sub proforma_point_11()
Sheets("feuil9").Range("i19") = 1
MsgBox "ENGAGEMENTS DE RETRAITE ET AUTRES AVANTAGES ASSIMILES  !" & Chr(10) & Chr(10) & "1°/ Les entités qui n'ont jamais constituées de provision pour retraite ont le choix entre deux (2) méthodes de comptabilisation :" & Chr(10) & " - Comptabilisation de la totalité de la charge à la fin du premier exercice d'application ;" & Chr(10) & " - Etalement de la partie de l'indemnité relative aux engagements antérieurs non comptabilisés de façon linéaire, sur une durée maximum de cinq (5) ans." & Chr(10) & Chr(10) & "2°/ Les entités qui constituaient déjà des provisions pour retraite n'ont aucun retraitement à faire." & Chr(10) & "Cependant, celles qui ont l'obligation de présenter leurs états financiers selon les normes IFRS doivent réévaluer ces provisions selon la méthode actuarielle si ce n'était pas la méthode utilisée."
Sheets("feuil9").Range("i19").ClearContents
End Sub
Private Sub proforma_point_12()
Sheets("feuil9").Range("i20") = 1
MsgBox "CONTRATS PLURI-EXERCICES  !" & Chr(10) & Chr(10) & "Pour les entités qui utilisaient la méthode du bénéfice partiel à l'inventaire ou la méthode à l'achèvement avec constatation d'un stock en cours, les comptes 475 et 34 ou 35 doivent être soldés en les créditant par le débit du compte 4751." & Chr(10) & Chr(10) & "Ensuite le compte 4751 doit être rapporté au compte de résultat soit globalement, soit par fractions égales sur une durée de cinq (5) ans, en le créditant par le débit du compte 651."
Sheets("feuil9").Range("i20").ClearContents
End Sub
Private Sub proforma_point_13()
Sheets("feuil9").Range("i21") = 1
MsgBox "CONTRAT DE CONCESSIONS DE SERVICE PUBLIC  !" & Chr(10) & Chr(10) & "Les comptes d'immobilisations mis en concession par le concédant à titre gratuit, avec condition de retour, doivent être soldés. A cet effet, le compte 4751 sera débité (pour la valeur nette comptable) par le crédit du compte 2.immobilisations et le débit du compte 28 (cumul des amortissements pratiqués)." & Chr(10) & "Ensuite le compte 4751 sera rapporté au compte de résultat soit globalement, soit par fractions égales sur une durée de cinq (5) ans, en le créditant par le débit du compte 831." & Chr(10) & Chr(10) & "Le compte 1676 sera débité par le crédit du compte 4752, pour être soldé." & Chr(10) & "Ensuite le compte 4752 sera rapporté au compte de résultat soit globalement, soit par fractions égales sur une durée de cinq (5) ans, en le débitant par le crédit du compte 841." & Chr(10) & Chr(10) & "Les provisions enregistrées dans le compte 1986 doivent être soldées, en débitant le compte 1986 par le crédit du compte 4752."
MsgBox "CONTRAT DE CONCESSIONS DE SERVICE PUBLIC  !" & Chr(10) & Chr(10) & "Ensuite le compte 4752 doit être rapporté au compte de résultat soit globalement, soit par fractions égales sur une durée de cinq (5) ans, en le débitant par le crédit du compte 79." & Chr(10) & Chr(10) & "Les provisions enregistrées dans le compte 1982 doivent être virées dans le compte 1984, si elles répondent à la définition de Provisions pour démantèlement et remise en état." & Chr(10) & "Dans le cas contraire, elles seront soldées en les débitant par le crédit du compte 4752. Ensuite le compte 4752 sera rapporté au compte de résultat soit globalement, soit par fractions égales sur cinq (5) ans, en le débitant par le crédit du compte 79."
Sheets("feuil9").Range("i21").ClearContents
End Sub
Private Sub proforma_point_14()
Sheets("feuil9").Range("i22") = 1
MsgBox "AMORTISSEMENT DU FONDS COMMERCIAL  !" & Chr(10) & Chr(10) & "Les fonds commerciaux inscrits au bilan, qui ne sont pas en cours d'amortissement et que la durée d'utilité est jugée limitée, sont amortis de façon prospective sur cette durée, à partir du premier exercice d'application du SYSCOHADA révisé." & Chr(10) & Chr(10) & "Les petites entités peuvent, à partir du premier exercice d'application du SYSCOHADA révisé, amortir tous les fonds commerciaux inscrits à l'actif sur une durée de dix (10) ans." & Chr(10) & "Les petites entités qui pratiquaient déjà l'amortissement de leurs fonds commerciaux doivent en conséquence modifier la durée résiduelle d'amortissement, de telle sorte que leurs fonds commerciaux soient amortis sur dix (10) ans."
Sheets("feuil9").Range("i22").ClearContents
End Sub
Private Sub impact_compte_475_proforma()
Sheets("feuil9").Range("i26") = 1
MsgBox "L'utilisation des comptes 475 pour les comptes pro forma va créer des emplois et des ressources qui auront un impact sur le tableau des flux de trésorerie." & Chr(10) & Chr(10) & "Un retraitement extra-comptable est donc nécessaire pour équilibrer le tableau des flux de trésorerie pro forma." & Chr(10) & Chr(10) & "NB : Veuillez, à cet effet, insérer le solde des comptes 4751 et 4752 comme indiqué par la suite  !"
Sheets("feuil9").Range("i26").ClearContents
End Sub
Private Sub insérer_solde_4751_proforma()
Sheets("feuil9").Range("i30") = 1

'condition d'édition
If Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer le Tableau des flux de trésorerie pro forma N-1 !"
Else

 'Insérer le montant du compte 4751 dans le TFT
 Dim resultat As Variant
    resultat = InputBox("Veuillez saisir le solde du compte 4751 - Actif_ajustement SYSCOHADA révisé, issu de la balance pro forma :" & Chr(10) & Chr(10) & "NB : La variation des créances sera diminuée du montant  !" & Chr(10), "TFT Proforma") 'La variable reçoit la valeur entrée dans l'InputBox
   
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil7").Range("h18") = Sheets("feuil7").Range("h18") + resultat 'Variation des créances
    Sheets("feuil7").Range("h23") = Sheets("feuil7").Range("h23") + resultat 'total flux opérationnels
    Sheets("feuil7").Range("e22") = WorksheetFunction.Sum(Sheets("feuil7").Range("h16:h19")) 'bf exploitation
    Sheets("feuil7").Range("h51") = Sheets("feuil7").Range("h51") + resultat 'variation de trésorerie période
    Sheets("feuil7").Range("h53") = Sheets("feuil7").Range("h53") + resultat 'trésorerie au 31 décembre
    'affiche le TAFIRE
    Sheets("feuil7").Activate
    
    'message d'équilibre
    If Sheets("feuil7").Range("h53") - Sheets("feuil7").Range("h54") = 0 Then
    MsgBox "Votre Tableau de trésorerie N-1 est équilibré !" & Chr(10) & Chr(10) & "Avec la valeur de la variation des créances de  " & Sheets("feuil7").Range("h18") & "."
    Sheets("feuil7").Range("j54").ClearContents
    Sheets("feuil7").Range("k54").ClearContents
    Sheets("feuil7").Range("j54") = "T.F.T.  N-1  équilibré  !"
    Else
    MsgBox "Votre tableau de trésorerie N-1 est toujours déséquilibré de  " & Abs(Sheets("feuil7").Range("h53") - Sheets("feuil7").Range("h54")) & "  !" & Chr(10) & Chr(10) & "Avec la valeur de la variation des créances de  " & Sheets("feuil7").Range("h18") & "."
    Sheets("feuil7").Range("j54") = "Ecart  T.F.T.  N-1"
    Sheets("feuil7").Range("k54") = Abs(Sheets("feuil7").Range("h53") - Sheets("feuil7").Range("h54"))
    End If
    
    'Si la valeur est différente de "" on affiche le résultat
    Else
    End If

'condition d'édition
End If

Sheets("feuil9").Range("i30").ClearContents
End Sub
Private Sub insérer_solde_4752_proforma()
Sheets("feuil9").Range("i32") = 1

'condition d'édition
If Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer le Tableau des flux de trésorerie pro forma N-1 !"
Else

'Insérer le montant du compte 4752 dans le TFT
 Dim resultat As Variant
    resultat = InputBox("Veuillez saisir le solde du compte 4752 - Passif_ajustement SYSCOHADA révisé, issu de la balance pro forma :" & Chr(10) & Chr(10) & "NB : La variation du passif circulant sera diminuée du montant  !" & Chr(10), "TFT Proforma") 'La variable reçoit la valeur entrée dans l'InputBox
   
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil7").Range("h19") = Sheets("feuil7").Range("h19") - resultat 'Variation des créances
    Sheets("feuil7").Range("h23") = Sheets("feuil7").Range("h23") - resultat 'total flux opérationnels
    Sheets("feuil7").Range("e22") = WorksheetFunction.Sum(Sheets("feuil7").Range("h16:h19")) 'bf exploitation
    Sheets("feuil7").Range("h51") = Sheets("feuil7").Range("h51") - resultat 'variation de trésorerie période
    Sheets("feuil7").Range("h53") = Sheets("feuil7").Range("h53") - resultat 'trésorerie au 31 décembre
    'affiche le TAFIRE
    Sheets("feuil7").Activate
    
    'message d'équilibre
    If Sheets("feuil7").Range("h53") - Sheets("feuil7").Range("h54") = 0 Then
    MsgBox "Votre Tableau de trésorerie N-1 est équilibré !" & Chr(10) & Chr(10) & "Avec la valeur de la variation du passif circulant de  " & Sheets("feuil7").Range("h19") & "."
    Sheets("feuil7").Range("j54").ClearContents
    Sheets("feuil7").Range("k54").ClearContents
    Sheets("feuil7").Range("j54") = "T.F.T.  N-1  équilibré  !"
    Else
    MsgBox "Votre tableau de trésorerie N-1 est toujours déséquilibré de  " & Abs(Sheets("feuil7").Range("h53") - Sheets("feuil7").Range("h54")) & "  !" & Chr(10) & Chr(10) & "Avec la valeur de la variation du passif circulant de  " & Sheets("feuil7").Range("h19") & "."
    Sheets("feuil7").Range("j54") = "Ecart  T.F.T.  N-1"
    Sheets("feuil7").Range("k54") = Abs(Sheets("feuil7").Range("h53") - Sheets("feuil7").Range("h54"))
    End If
    
    'Si la valeur est différente de "" on affiche le résultat
    Else
    End If

'condition d'édition
End If

Sheets("feuil9").Range("i32").ClearContents
End Sub
Private Sub suppression_charges_immobilisées_tafire()
Sheets("feuil9").Range("i35") = 1
MsgBox "La suppression du poste du TAFIRE : FA (Charges immobilisées), dans la nouvelle monture du Tableau des flux de trésorerie crée un déséquilibre de ce dernier." & Chr(10) & Chr(10) & "Un retraitement extra-comptable sera donc nécessaire pour l'équilibre du Tableau des flux de trésorerie pro forma." & Chr(10) & Chr(10) & "NB : Veuillez, à cette fin, insérer le montant du poste comme indiqué par la suite  !"
Sheets("feuil9").Range("i35").ClearContents
End Sub
Private Sub insérer_montant_charges_immobilisées_tafire()
Sheets("feuil9").Range("i37") = 1

'condition d'édition
If Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer le Tableau des flux de trésorerie pro forma N-1 !"
Else

'Insérer le montant des charges immobilisées dans le TFT
Dim resultat As Variant
    resultat = InputBox("Veuillez saisir le montant du poste FA - Charges immobilisées (augmentation dans l'exercice) comme chiffré dans le TAFIRE :" & Chr(10) & Chr(10) & "NB : La CAFG sera diminuée du montant  !" & Chr(10), "TFT Proforma") 'La variable reçoit la valeur entrée dans l'InputBox
   
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil7").Range("h15") = Sheets("feuil7").Range("h15") - resultat 'CAFG
    Sheets("feuil7").Range("h23") = Sheets("feuil7").Range("h23") - resultat 'total flux opérationnels
    Sheets("feuil7").Range("h51") = Sheets("feuil7").Range("h51") - resultat 'variation de trésorerie période
    Sheets("feuil7").Range("h53") = Sheets("feuil7").Range("h53") - resultat 'trésorerie au 31 décembre
    'affiche le TAFIRE
    Sheets("feuil7").Activate
    
    'message d'équilibre
    If Sheets("feuil7").Range("h53") - Sheets("feuil7").Range("h54") = 0 Then
    MsgBox "Votre Tableau de trésorerie N-1 est équilibré !" & Chr(10) & Chr(10) & "Avec la nouvelle valeur de la CAFG de  " & Sheets("feuil7").Range("h15") & "."
    Sheets("feuil7").Range("j54").ClearContents
    Sheets("feuil7").Range("k54").ClearContents
    Sheets("feuil7").Range("j54") = "T.F.T.  N-1  équilibré  !"
    Else
    MsgBox "Votre tableau de trésorerie N-1 est toujours déséquilibré de  " & Abs(Sheets("feuil7").Range("h53") - Sheets("feuil7").Range("h54")) & "  !" & Chr(10) & Chr(10) & "Avec la nouvelle valeur de la CAFG de  " & Sheets("feuil7").Range("h15") & "."
    Sheets("feuil7").Range("j54") = "Ecart  T.F.T.  N-1"
    Sheets("feuil7").Range("k54") = Abs(Sheets("feuil7").Range("h53") - Sheets("feuil7").Range("h54"))
    End If
    
    'Si la valeur est différente de "" on affiche le résultat
    Else
    End If
    
'condition d'édition
End If

Sheets("feuil9").Range("i37").ClearContents
End Sub
Private Sub impact_compte_475_exercice()
Sheets("feuil9").Range("i43") = 1
MsgBox "Certains des comptes 4751 et 4752 issus des comptes pro forma, rapportés au compte de résultat du premier exercice d'application de la réforme et celui des exercices suivants, contribueront au déséquilibre du Tableau des flux de trésorerie de l'exercice concerné." & Chr(10) & Chr(10) & "Un retraitement extra-comptable sera nécessaire pour neutraliser l'impact de ces comptes." & Chr(10) & Chr(10) & "NB : Veuillez insérer le montant rapporté sur l'exercice de ces comptes, comme indiqué par la suite  !"
Sheets("feuil9").Range("i43").ClearContents
End Sub
Private Sub insérer_montant_4751_exercice()
Sheets("feuil9").Range("i47") = 1

'condition d'édition
If Sheets("feuil7").Range("g54") = "" Then
MsgBox "Veuillez d'abord éditer le Tableau des flux de trésorerie N !"
Else

'Insérer le montant du compte 4751 dans le TFT
 Dim resultat As Variant
    resultat = InputBox("Veuillez saisir le montant du compte 4751 - Actif_ajustement SYSCOHADA révisé, rapporté au compte de résultat de l'exercice :" & Chr(10) & Chr(10) & "NB : La variation des créances sera modifiée du montant  !" & Chr(10), "TFT Exercice") 'La variable reçoit la valeur entrée dans l'InputBox
   
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil7").Range("g18") = Sheets("feuil7").Range("g18") - resultat 'Variation des créances
    Sheets("feuil7").Range("g23") = Sheets("feuil7").Range("g23") - resultat 'total flux opérationnels
    Sheets("feuil7").Range("d22") = WorksheetFunction.Sum(Sheets("feuil7").Range("g16:g19")) 'bf exploitation
    Sheets("feuil7").Range("g51") = Sheets("feuil7").Range("g51") - resultat 'variation de trésorerie période
    Sheets("feuil7").Range("g53") = Sheets("feuil7").Range("g53") - resultat 'trésorerie au 31 décembre
    'affiche le TAFIRE
    Sheets("feuil7").Activate
    
    'message d'équilibre
    If Sheets("feuil7").Range("g53") - Sheets("feuil7").Range("g54") = 0 Then
    MsgBox "Votre Tableau de trésorerie N est équilibré !" & Chr(10) & Chr(10) & "Avec la valeur de la variation des créances de  " & Sheets("feuil7").Range("g18") & "."
    Sheets("feuil7").Range("j53").ClearContents
    Sheets("feuil7").Range("k53").ClearContents
    Sheets("feuil7").Range("j53") = "T.F.T.  N  équilibré  !"
    Else
    MsgBox "Votre tableau de trésorerie N est toujours déséquilibré de  " & Abs(Sheets("feuil7").Range("g53") - Sheets("feuil7").Range("g54")) & "  !" & Chr(10) & Chr(10) & "Avec la valeur de la variation des créances de  " & Sheets("feuil7").Range("g18") & "."
    Sheets("feuil7").Range("j53") = "Ecart  T.F.T.  N"
    Sheets("feuil7").Range("k53") = Abs(Sheets("feuil7").Range("g53") - Sheets("feuil7").Range("g54"))
    End If
    
    'Si la valeur est différente de "" on affiche le résultat
    Else
    End If

'condition d'édition
End If

Sheets("feuil9").Range("i47").ClearContents
End Sub
Private Sub insérer_montant_4752_exercice()
Sheets("feuil9").Range("i49") = 1

'condition d'édition
If Sheets("feuil7").Range("g54") = "" Then
MsgBox "Veuillez d'abord éditer le Tableau des flux de trésorerie N !"
Else

'Insérer le montant du compte 4752 dans le TFT
 Dim resultat As Variant
    resultat = InputBox("Veuillez saisir le montant du compte 4752 - Passif_ajustement SYSCOHADA révisé, rapporté au compte de résultat de l'exercice :" & Chr(10) & Chr(10) & "NB : La variation du passif circulant sera modifiée du montant  !" & Chr(10), "TFT Exercice") 'La variable reçoit la valeur entrée dans l'InputBox
   
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil7").Range("g19") = Sheets("feuil7").Range("g19") + resultat 'Variation des créances
    Sheets("feuil7").Range("g23") = Sheets("feuil7").Range("g23") + resultat 'total flux opérationnels
    Sheets("feuil7").Range("d22") = WorksheetFunction.Sum(Sheets("feuil7").Range("g16:g19")) 'bf exploitation
    Sheets("feuil7").Range("g51") = Sheets("feuil7").Range("g51") + resultat 'variation de trésorerie période
    Sheets("feuil7").Range("g53") = Sheets("feuil7").Range("g53") + resultat 'trésorerie au 31 décembre
    'affiche le TAFIRE
    Sheets("feuil7").Activate
    
    'message d'équilibre
    If Sheets("feuil7").Range("g53") - Sheets("feuil7").Range("g54") = 0 Then
    MsgBox "Votre Tableau de trésorerie N est équilibré !" & Chr(10) & Chr(10) & "Avec la valeur de la variation du passif circulant de  " & Sheets("feuil7").Range("g19") & "."
    Sheets("feuil7").Range("j53").ClearContents
    Sheets("feuil7").Range("k53").ClearContents
    Sheets("feuil7").Range("j53") = "T.F.T.  N  équilibré  !"
    Else
    MsgBox "Votre tableau de trésorerie N est toujours déséquilibré de  " & Abs(Sheets("feuil7").Range("g53") - Sheets("feuil7").Range("g54")) & "  !" & Chr(10) & Chr(10) & "Avec la valeur de la variation du passif circulant de  " & Sheets("feuil7").Range("g19") & "."
    Sheets("feuil7").Range("j53") = "Ecart  T.F.T.  N"
    Sheets("feuil7").Range("k53") = Abs(Sheets("feuil7").Range("g53") - Sheets("feuil7").Range("g54"))
    End If
    
    'Si la valeur est différente de "" on affiche le résultat
    Else
    End If

'condition d'édition
End If

Sheets("feuil9").Range("i49").ClearContents
End Sub
Private Sub affiche_la_réforme()
'animationv1
'délai d'essai
date_test = Now()
If Year(2020) > 2017 Then
MsgBox "Délai d'essai expiré 10!"
Else

'condition d'installation
'If Sheets("feuil12").Range("a100") = Left(Sheets("feuil12").Range("a101"), 10) Then

Sheets("feuil9").Activate
Sheets("feuil9").Range("a1").Select

'condition d'installation
'Else
'MsgBox "Désolé  !  Veuillez d'abord installer votre logiciel."
'End If

'délai d'essai
End If
End Sub
Private Sub edite_compte_résultat_n_smart()
'animationv1
'mise en forme conditionnelle
Sheets("feuil28").Range("za18") = 1

'délai d'essai
date_test = Now()
If Year(2020) > 2017 Then
MsgBox "Délai d'essai expiré 11!"
Else

'condition d'installation
'If Sheets("feuil12").Range("a100") = Left(Sheets("feuil12").Range("a101"), 10) Then

'condition d'édition
If WorksheetFunction.Sum(Sheets("feuil2").Range("g1:h5000")) = 0 Then
MsgBox "Désolé !  Aucune donnée à éditer."
Else

'demande de confirmation
If Sheets("feuil7").Range("h54") = "" Then

If MsgBox("NB : Si ce n'est pas le 1er exercice comptable, veuillez toujours commencer par éditer les Etats financiers de l'exercice N-1  !" & Chr(10) & "D'abord le Compte de résultat, ensuite le Bilan, puis le Tableau de trésorerie." & Chr(10) & Chr(10) & "Confirmez vous l'édition du Compte de résultat N ?", vbYesNo, "Demande de confirmation") = vbYes Then
edite_compte_résultat_n
End If

Else

If MsgBox("Confirmez vous l'édition du Compte de résultat N ?", vbYesNo, "Demande de confirmation") = vbYes Then
edite_compte_résultat_n
End If

'demande de confirmation
End If

'condition d'édition
End If

'condition d'installation
'Else
'MsgBox "Désolé  !  Veuillez d'abord installer votre logiciel."
'End If

'délai d'essai
End If

'mise en forme conditionnelle
Sheets("feuil28").Range("za18").ClearContents
End Sub
Private Sub affiche_note_1_à_2()
'animationv1
Sheets("feuil14").Activate
End Sub
Private Sub affiche_note_3()
'animationv1
Sheets("feuil23").Activate
End Sub
Private Sub affiche_note_4_à_27a()
'animationv1
Sheets("feuil15").Activate
End Sub
Private Sub affiche_note_27b()
'animationv1
Sheets("feuil11").Activate
End Sub
Private Sub affiche_note_28()
'animationv1
Sheets("feuil10").Activate
End Sub
Private Sub affiche_note_29_à_30()
'animationv1
Sheets("feuil8").Activate
End Sub
Private Sub affiche_note_31()
'animationv1
Sheets("feuil16").Activate
End Sub
Private Sub affiche_note_32_à_33()
'animationv1
Sheets("feuil17").Activate
End Sub
Private Sub affiche_note_34_à_35()
'animationv1
Sheets("feuil31").Activate
End Sub
Private Sub affiche_note_36()
'animationv1
Sheets("feuil13").Activate
End Sub
Private Sub note_4()
'condition générale de traitement de la NOTE 4
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 4
If Sheets("feuil5").Range("e32") + Sheets("feuil5").Range("e33") + Sheets("feuil24").Range("i33") + Sheets("feuil24").Range("i34") = 0 Then
MsgBox "Désolé  !  Aucune immobilisation financière comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 4
'annule les données du tableau
Sheets("feuil15").Range("b12:d23").ClearContents

For i = 3 To 5000
'recup N
'compte 26
If Left(Sheets("feuil2").Cells(i, 1), 2) = 26 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 271
If Left(Sheets("feuil2").Cells(i, 1), 3) = 271 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 272
If Left(Sheets("feuil2").Cells(i, 1), 3) = 272 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 273
If Left(Sheets("feuil2").Cells(i, 1), 3) = 273 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 274
If Left(Sheets("feuil2").Cells(i, 1), 3) = 274 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 275
If Left(Sheets("feuil2").Cells(i, 1), 3) = 275 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If

'compte 276
If Left(Sheets("feuil2").Cells(i, 1), 3) = 276 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 7) 'Z
Else
End If

'compte 277 + 278
If Left(Sheets("feuil2").Cells(i, 1), 3) = 277 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 277 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 7) 'AA
Else
End If

'compte 278
'If Left(Sheets("feuil2").Cells(i, 1), 3) = 278 Then
'Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 7) 'AB
'Else
'End If

'compte 296
If Left(Sheets("feuil2").Cells(i, 1), 3) = 296 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 8) 'AC
Else
End If

'compte 297
If Left(Sheets("feuil2").Cells(i, 1), 3) = 297 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
Else
End If



'recup N-1
'compte 26
If Left(Sheets("feuil1").Cells(i, 1), 2) = 26 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 271
If Left(Sheets("feuil1").Cells(i, 1), 3) = 271 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 272
If Left(Sheets("feuil1").Cells(i, 1), 3) = 272 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 273
If Left(Sheets("feuil1").Cells(i, 1), 3) = 273 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 274
If Left(Sheets("feuil1").Cells(i, 1), 3) = 274 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'compte 275
If Left(Sheets("feuil1").Cells(i, 1), 3) = 275 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

'compte 276
If Left(Sheets("feuil1").Cells(i, 1), 3) = 276 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 7) 'Z
Else
End If

'compte 277
If Left(Sheets("feuil1").Cells(i, 1), 3) = 277 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 7) 'AA
Else
End If

'compte 278
If Left(Sheets("feuil1").Cells(i, 1), 3) = 278 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 7) 'AB
Else
End If

'compte 296
If Left(Sheets("feuil1").Cells(i, 1), 3) = 296 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 8) 'AC
Else
End If

'compte 297
If Left(Sheets("feuil1").Cells(i, 1), 3) = 297 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'AD
Else
End If


Next


'affectation dans le tableau
'titres de placement
Sheets("feuil15").Range("b12") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("c12") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'prêts et créances
Sheets("feuil15").Range("b13") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("c13") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'prêts au personnel
Sheets("feuil15").Range("b14") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("c14") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'créances sur l'état
Sheets("feuil15").Range("b15") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("c15") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'titres immobilisés
Sheets("feuil15").Range("b16") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("c16") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'dépôts et cautionnements
Sheets("feuil15").Range("b17") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("c17") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'intérêts courus
Sheets("feuil15").Range("b18") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("c18") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'immobilisations financières diverses
Sheets("feuil15").Range("b19") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("c19") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'annulé
'Sheets("feuil15").Range("b21") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
'Sheets("feuil15").Range("c21") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'dépréciations titres de participation
Sheets("feuil15").Range("b21") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil15").Range("c21") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1
'dépréciations autres immobilisations financières
Sheets("feuil15").Range("b22") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'N
Sheets("feuil15").Range("c22") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'N-1
'______________________________________________________________________________________
'Calculs du tableau

'total brut
Sheets("feuil15").Range("b20") = WorksheetFunction.Sum(Sheets("feuil15").Range("b12:b19")) 'N
Sheets("feuil15").Range("c20") = WorksheetFunction.Sum(Sheets("feuil15").Range("c12:c19")) 'N-1

'total net de dépréciation
Sheets("feuil15").Range("b23") = Sheets("feuil15").Range("b20") - Sheets("feuil15").Range("b21") - Sheets("feuil15").Range("b22") 'N
Sheets("feuil15").Range("c23") = Sheets("feuil15").Range("c20") - Sheets("feuil15").Range("c21") - Sheets("feuil15").Range("c22") 'N-1

'variation en %
For i = 12 To 23
If Sheets("feuil15").Cells(i, 3) = 0 Then
Else
If Sheets("feuil15").Cells(i, 3) < 0 Then
Sheets("feuil15").Cells(i, 4) = -1 * ((Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3))
Else
Sheets("feuil15").Cells(i, 4) = (Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3)
End If
End If
Next
'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"

'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents

'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub note_3D()
'condition générale de traitement de la NOTES 3D
If Sheets("feuil23").Range("g133") = "" Then
MsgBox "Veuillez d'abord éditer la NOTE 3C  !"
Else

'condition spécifique de traitement de la NOTES 3D
If Sheets("feuil23").Range("f35") = 0 Then
MsgBox "Désolé  !  Aucune cession constatée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

For i = 3 To 5000

'compte 274
If Left(Sheets("feuil2").Cells(i, 1), 3) = 274 Then
Sheets("feuil23").Cells(i, 95) = Sheets("feuil2").Cells(i, 6) 'CQ
Else
End If

'compte 821
If Left(Sheets("feuil2").Cells(i, 1), 3) = 821 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7541 Then
Sheets("feuil23").Cells(i, 96) = Sheets("feuil2").Cells(i, 8) 'CR
Else
End If

'compte 822
If Left(Sheets("feuil2").Cells(i, 1), 3) = 822 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7542 Then
Sheets("feuil23").Cells(i, 97) = Sheets("feuil2").Cells(i, 8) 'CS
Else
End If

'compte 826
If Left(Sheets("feuil2").Cells(i, 1), 3) = 826 Then
Sheets("feuil23").Cells(i, 98) = Sheets("feuil2").Cells(i, 8) 'CT
Else
End If

Next


'traitement des données dans le TABLEAU 3 - PLUS VALUE DES CESSIONS
'annule le tableau 3 - plus values
Sheets("feuil23").Range("d153:h169").ClearContents
Sheets("feuil23").Range("i157").ClearContents
Sheets("feuil23").Range("i164").ClearContents
Sheets("feuil23").Range("i168:i169").ClearContents

'affectation des Montant brut et Amortissements pratiqués
'frais de dévelop et prospection
If Sheets("feuil23").Range("f16") > 0 Then
Sheets("feuil23").Range("d153") = Sheets("feuil23").Range("f16") 'mtt brut
Sheets("feuil23").Range("e153") = Sheets("feuil23").Range("e119") 'amortis. pratiqués
Else
End If

'brevets, licences,
If Sheets("feuil23").Range("f17") > 0 Then
Sheets("feuil23").Range("d154") = Sheets("feuil23").Range("f17") 'mtt brut
Sheets("feuil23").Range("e154") = Sheets("feuil23").Range("e120") 'amortis. pratiqués
Else
End If

'fonds commercial
If Sheets("feuil23").Range("f18") > 0 Then
Sheets("feuil23").Range("d155") = Sheets("feuil23").Range("f18") 'mtt brut
Sheets("feuil23").Range("e155") = Sheets("feuil23").Range("e121") 'amortis. pratiqués
Else
End If

'autres immob. fin.
If Sheets("feuil23").Range("f19") > 0 Then
Sheets("feuil23").Range("d156") = Sheets("feuil23").Range("f19") 'mtt brut
Sheets("feuil23").Range("e156") = Sheets("feuil23").Range("e122") 'amortis. pratiqués
Else
End If

'terrain
If Sheets("feuil23").Range("f21") + Sheets("feuil23").Range("f22") > 0 Then
Sheets("feuil23").Range("d159") = Sheets("feuil23").Range("f21") + Sheets("feuil23").Range("f21") 'mtt brut
Sheets("feuil23").Range("e159") = Sheets("feuil23").Range("e125") + Sheets("feuil23").Range("e126") 'amortis. pratiqués
Else
End If

'bâtiments
If Sheets("feuil23").Range("f23") + Sheets("feuil23").Range("f24") > 0 Then
Sheets("feuil23").Range("d160") = Sheets("feuil23").Range("f23") + Sheets("feuil23").Range("f24") 'mtt brut
Sheets("feuil23").Range("e160") = Sheets("feuil23").Range("e127") + Sheets("feuil23").Range("e128") 'amortis. pratiqués
Else
End If

'installations et agencements
If Sheets("feuil23").Range("f25") > 0 Then
Sheets("feuil23").Range("d161") = Sheets("feuil23").Range("f25") 'mtt brut
Sheets("feuil23").Range("e161") = Sheets("feuil23").Range("e129") 'amortis. pratiqués
Else
End If

'matériel
If Sheets("feuil23").Range("f26") > 0 Then
Sheets("feuil23").Range("d162") = Sheets("feuil23").Range("f26") 'mtt brut
Sheets("feuil23").Range("e162") = Sheets("feuil23").Range("e130") 'amortis. pratiqués
Else
End If

'matériel de transport
If Sheets("feuil23").Range("f27") > 0 Then
Sheets("feuil23").Range("d163") = Sheets("feuil23").Range("f27") 'mtt brut
Sheets("feuil23").Range("e163") = Sheets("feuil23").Range("e131") 'amortis. pratiqués
Else
End If

'titres de participation
If Sheets("feuil23").Range("f33") > 0 Then
Sheets("feuil23").Range("d166") = Sheets("feuil23").Range("f33") 'mtt brut
'Sheets("feuil23").Range("e163") = Sheets("feuil23").Range("e131") 'amortis. pratiqués
Else
End If


'affectation du compte 274 (montant brut des Autres immob. financières)
Sheets("feuil23").Range("d167") = WorksheetFunction.Sum(Sheets("feuil23").Range("cq1:cq5000"))


'affectation des prix de cession
Sheets("feuil23").Range("g157") = WorksheetFunction.Sum(Sheets("feuil23").Range("cr1:cr5000")) 'immob incorpor
Sheets("feuil23").Range("g164") = WorksheetFunction.Sum(Sheets("feuil23").Range("cs1:cs5000")) 'immob corpor
Sheets("feuil23").Range("g168") = WorksheetFunction.Sum(Sheets("feuil23").Range("ct1:ct5000")) 'immob financ

'__________________________________________________________________________________________
'Calculs du tableau 3

'sous-total immob. incorp.
Sheets("feuil23").Range("d157") = WorksheetFunction.Sum(Sheets("feuil23").Range("d153:d156")) 'mtt brut
Sheets("feuil23").Range("e157") = WorksheetFunction.Sum(Sheets("feuil23").Range("e153:e156")) 'amorts. pratiqués

'sous-total immob. corp.
Sheets("feuil23").Range("d164") = WorksheetFunction.Sum(Sheets("feuil23").Range("d159:d163")) 'mtt brut
Sheets("feuil23").Range("e164") = WorksheetFunction.Sum(Sheets("feuil23").Range("e159:e163")) 'amorts. pratiqués

'sous-total immob. fin.
Sheets("feuil23").Range("d168") = WorksheetFunction.Sum(Sheets("feuil23").Range("d166:d167")) 'mtt brut
Sheets("feuil23").Range("e168") = WorksheetFunction.Sum(Sheets("feuil23").Range("e166:e167")) 'amorts. pratiqués

'total général
Sheets("feuil23").Range("d169") = Sheets("feuil23").Range("d157") + Sheets("feuil23").Range("d164") + Sheets("feuil23").Range("d168") 'mtt brut
Sheets("feuil23").Range("e169") = Sheets("feuil23").Range("e157") + Sheets("feuil23").Range("e164") + Sheets("feuil23").Range("e168") 'amorts. pratiqués
Sheets("feuil23").Range("g169") = Sheets("feuil23").Range("g157") + Sheets("feuil23").Range("g164") + Sheets("feuil23").Range("g168") 'prix de cession

'Valeurs comptables nettes
For i = 153 To 169
Sheets("feuil23").Cells(i, 6) = Sheets("feuil23").Cells(i, 4) - Sheets("feuil23").Cells(i, 5)
Next

'Plus ou moins values
Sheets("feuil23").Range("i157") = Sheets("feuil23").Range("g157") - Sheets("feuil23").Range("f157") 'immob incorp
Sheets("feuil23").Range("i164") = Sheets("feuil23").Range("g164") - Sheets("feuil23").Range("f164") 'immob corp
Sheets("feuil23").Range("i168") = Sheets("feuil23").Range("g168") - Sheets("feuil23").Range("f168") 'immob fin
Sheets("feuil23").Range("i169") = Sheets("feuil23").Range("g169") - Sheets("feuil23").Range("f169") 'total général

'__________________________________________________________________________________________


'efface les recups de la feuil23
Sheets("feuil23").Range("t1:za5001").ClearContents


MsgBox "    FIN DE L'EDITION  !"

'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub annuler_note_3D()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule le tableau 3 - plus values
Sheets("feuil23").Range("d153:h169").ClearContents
Sheets("feuil23").Range("i157").ClearContents
Sheets("feuil23").Range("i164").ClearContents
Sheets("feuil23").Range("i168:i169").ClearContents
End If
End Sub
Private Sub annuler_note_4()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("b12:d23").ClearContents
End If
End Sub
Private Sub note_5()

'condition générale de traitement de la NOTE 5
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 5
If Sheets("feuil5").Range("e35") + Sheets("feuil5").Range("m35") + Sheets("feuil5").Range("ah35") = 0 Then
MsgBox "Désolé  !  Aucune créance et dette H.A.O. comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 5
'annule les données du tableau
Sheets("feuil15").Range("e85:g89").ClearContents
Sheets("feuil15").Range("e100:g105").ClearContents

For i = 3 To 5000
'recup N
'compte 485
If Left(Sheets("feuil2").Cells(i, 1), 3) = 485 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 488
If Left(Sheets("feuil2").Cells(i, 1), 3) = 488 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 4985+4988
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4985 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4988 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
Else
End If

'compte 481 sauf 4813
If Left(Sheets("feuil2").Cells(i, 1), 3) = 481 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4813 Then
Else
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
End If
Else
End If

'compte 482
If Left(Sheets("feuil2").Cells(i, 1), 3) = 482 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
Else
End If

'compte 4813
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4813 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 8) 'Y
Else
End If

'compte 484
If Left(Sheets("feuil2").Cells(i, 1), 3) = 484 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 8) 'Z
Else
End If


'recup N-1
'compte 485
If Left(Sheets("feuil1").Cells(i, 1), 3) = 485 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 488
If Left(Sheets("feuil1").Cells(i, 1), 3) = 488 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 4985+4988
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4985 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4988 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
Else
End If

'compte 481 sauf 4813
If Left(Sheets("feuil1").Cells(i, 1), 3) = 481 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4813 Then
Else
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'W
End If
Else
End If

'compte 482
If Left(Sheets("feuil1").Cells(i, 1), 3) = 482 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 8) 'X
Else
End If

'compte 4813
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4813 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 8) 'Y
Else
End If

'compte 484
If Left(Sheets("feuil1").Cells(i, 1), 3) = 484 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 8) 'Z
Else
End If






Next


'affectation dans le tableau
'CREANCES HAO
'créances sur cessions d'immobilisation
Sheets("feuil15").Range("e85") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f85") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'autres créances HAO
Sheets("feuil15").Range("e86") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f86") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'dépréciation des créances HAO
Sheets("feuil15").Range("e88") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f88") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1

'DETTES HAO
'fournisseurs d'investissement
Sheets("feuil15").Range("e100") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f100") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'fournisseurs d'invest EAP
Sheets("feuil15").Range("e101") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f101") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'versement restant sur titres de participation
Sheets("feuil15").Range("e103") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("f103") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'autres dettes HAO
Sheets("feuil15").Range("e104") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("f104") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut créances HAO
Sheets("feuil15").Range("e87") = WorksheetFunction.Sum(Sheets("feuil15").Range("e85:e86")) 'N
Sheets("feuil15").Range("f87") = WorksheetFunction.Sum(Sheets("feuil15").Range("f85:f86")) 'N-1

'total net de dépréciation
Sheets("feuil15").Range("e89") = Sheets("feuil15").Range("e87") - Sheets("feuil15").Range("e88") 'N
Sheets("feuil15").Range("f89") = Sheets("feuil15").Range("f87") - Sheets("feuil15").Range("f88") 'N-1

'total DETTES H.A.O.
Sheets("feuil15").Range("e105") = WorksheetFunction.Sum(Sheets("feuil15").Range("e100:e104")) 'N
Sheets("feuil15").Range("f105") = WorksheetFunction.Sum(Sheets("feuil15").Range("f100:f104")) 'N-1


'variation en % créances HAO
For i = 85 To 89
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'variation en % dettes HAO
For i = 100 To 105
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next
'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub annuler_note_5()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e85:g89").ClearContents
Sheets("feuil15").Range("e100:g105").ClearContents
End If
End Sub
Private Sub note_6()

'condition générale de traitement de la NOTE 6
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 6
If Sheets("feuil5").Range("e36") + Sheets("feuil5").Range("ah36") = 0 Then
MsgBox "Désolé  !  Aucun stock et encours comptabilisé."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 6
'annule les données du tableau
Sheets("feuil15").Range("e121:g131").ClearContents

For i = 3 To 5000
'recup N
'compte 31
If Left(Sheets("feuil2").Cells(i, 1), 2) = 31 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 32
If Left(Sheets("feuil2").Cells(i, 1), 2) = 32 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 33
If Left(Sheets("feuil2").Cells(i, 1), 2) = 33 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 34
If Left(Sheets("feuil2").Cells(i, 1), 2) = 34 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 35
If Left(Sheets("feuil2").Cells(i, 1), 2) = 35 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 36
If Left(Sheets("feuil2").Cells(i, 1), 2) = 36 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If

'compte 37
If Left(Sheets("feuil2").Cells(i, 1), 2) = 37 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 7) 'Z
Else
End If

'compte 38
If Left(Sheets("feuil2").Cells(i, 1), 2) = 38 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 7) 'AA
Else
End If

'compte 39
If Left(Sheets("feuil2").Cells(i, 1), 2) = 39 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 8) 'AB
Else
End If


'recup N-1
'compte 31
If Left(Sheets("feuil1").Cells(i, 1), 2) = 31 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 32
If Left(Sheets("feuil1").Cells(i, 1), 2) = 32 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 33
If Left(Sheets("feuil1").Cells(i, 1), 2) = 33 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 34
If Left(Sheets("feuil1").Cells(i, 1), 2) = 34 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 35
If Left(Sheets("feuil1").Cells(i, 1), 2) = 35 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'compte 36
If Left(Sheets("feuil1").Cells(i, 1), 2) = 36 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

'compte 37
If Left(Sheets("feuil1").Cells(i, 1), 2) = 37 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 7) 'Z
Else
End If

'compte 38
If Left(Sheets("feuil1").Cells(i, 1), 2) = 38 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 7) 'AA
Else
End If

'compte 39
If Left(Sheets("feuil1").Cells(i, 1), 2) = 39 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 8) 'AB
Else
End If


Next


'affectation dans le tableau
'stocks marchandises
Sheets("feuil15").Range("e121") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f121") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'stocks matières premières
Sheets("feuil15").Range("e122") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f122") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'stocks autres approvis.
Sheets("feuil15").Range("e123") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f123") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'stocks produits encours
Sheets("feuil15").Range("e124") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f124") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'stocks services encours
Sheets("feuil15").Range("e125") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f125") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'stocks produits finis
Sheets("feuil15").Range("e126") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("f126") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'stocks produits intermédiaires
Sheets("feuil15").Range("e127") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("f127") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'stocks en route, en consignation
Sheets("feuil15").Range("e128") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("f128") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'dépréciation des stocks
Sheets("feuil15").Range("e130") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil15").Range("f130") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1


'______________________________________________________________________________________
'Calculs du tableau

'total brut stocks
Sheets("feuil15").Range("e129") = WorksheetFunction.Sum(Sheets("feuil15").Range("e121:e128")) 'N
Sheets("feuil15").Range("f129") = WorksheetFunction.Sum(Sheets("feuil15").Range("f121:f128")) 'N-1

'total net de dépréciation
Sheets("feuil15").Range("e131") = Sheets("feuil15").Range("e129") - Sheets("feuil15").Range("e130") 'N
Sheets("feuil15").Range("f131") = Sheets("feuil15").Range("f129") - Sheets("feuil15").Range("f130") 'N-1


'variation en % stocks
For i = 121 To 131
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub annuler_note_6()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e121:g131").ClearContents
End If
End Sub
Private Sub note_7()
'condition générale de traitement de la NOTE 7
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 7
If Sheets("feuil5").Range("e39") + Sheets("feuil5").Range("m36") + Sheets("feuil5").Range("ah39") = 0 Then
MsgBox "Désolé  !  Aucune créance client comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 7
'annule les données du tableau
Sheets("feuil15").Range("b158:d174").ClearContents

For i = 3 To 5000
'recup N
'compte 411
If Left(Sheets("feuil2").Cells(i, 1), 3) = 411 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4112 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4116 Then
Else
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
End If
Else
End If

'compte 412
If Left(Sheets("feuil2").Cells(i, 1), 3) = 412 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4122 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4126 Then
Else
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
End If
Else
End If

'compte 4116+4126
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4116 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4126 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 4112+4122
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4112 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4122 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 413
If Left(Sheets("feuil2").Cells(i, 1), 3) = 413 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 414
If Left(Sheets("feuil2").Cells(i, 1), 3) = 414 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If

'compte 415
If Left(Sheets("feuil2").Cells(i, 1), 3) = 415 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 7) 'Z
Else
End If

'compte 416
If Left(Sheets("feuil2").Cells(i, 1), 3) = 416 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 7) 'AA
Else
End If

'compte 418
If Left(Sheets("feuil2").Cells(i, 1), 3) = 418 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 7) 'AB
Else
End If

'compte 491
If Left(Sheets("feuil2").Cells(i, 1), 3) = 491 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 8) 'AC
Else
End If

'CLIENTS CREDITEURS
'compte 4191
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4191 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
Else
End If

'compte 4192
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4192 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 8) 'AE
Else
End If

'compte 4194+4198
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4194 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4198 Then
Sheets("feuil2").Cells(i, 32) = Sheets("feuil2").Cells(i, 8) 'AF
Else
End If


'recup N-1
'compte 411
If Left(Sheets("feuil1").Cells(i, 1), 3) = 411 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4112 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4116 Then
Else
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
End If
Else
End If

'compte 412
If Left(Sheets("feuil1").Cells(i, 1), 3) = 412 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4122 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4126 Then
Else
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
End If
Else
End If

'compte 4116+4126
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4116 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4126 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 4112+4122
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4112 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4122 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 413
If Left(Sheets("feuil1").Cells(i, 1), 3) = 413 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'compte 414
If Left(Sheets("feuil1").Cells(i, 1), 3) = 414 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

'compte 415
If Left(Sheets("feuil1").Cells(i, 1), 3) = 415 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 7) 'Z
Else
End If

'compte 416
If Left(Sheets("feuil1").Cells(i, 1), 3) = 416 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 7) 'AA
Else
End If

'compte 418
If Left(Sheets("feuil1").Cells(i, 1), 3) = 418 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 7) 'AB
Else
End If

'compte 491
If Left(Sheets("feuil1").Cells(i, 1), 3) = 491 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 8) 'AC
Else
End If

'CLIENTS CREDITEURS
'compte 4191
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4191 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'AD
Else
End If

'compte 4192
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4192 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 8) 'AE
Else
End If

'compte 4194+4198
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4194 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4198 Then
Sheets("feuil1").Cells(i, 32) = Sheets("feuil1").Cells(i, 8) 'AF
Else
End If


Next


'affectation dans le tableau
'clients hors réserve de propriété et groupe
Sheets("feuil15").Range("b158") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("c158") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'E.A.R. hors réserve de propriété et groupe
Sheets("feuil15").Range("b160") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("c160") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'clients et E.A.R. avec réserve de propriété
Sheets("feuil15").Range("b161") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("c161") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'clients et E.A.R. groupe
Sheets("feuil15").Range("b162") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("c162") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'clients, valeurs impayées
Sheets("feuil15").Range("b163") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("c163") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'créances sur cessions courante d'immobilisations
Sheets("feuil15").Range("b164") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("c164") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'clients effets non échus
Sheets("feuil15").Range("b165") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("c165") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'clients douteux et litigeux
Sheets("feuil15").Range("b166") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("c166") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'clients, produits à recevoir
Sheets("feuil15").Range("b167") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil15").Range("c167") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'dépréciations des clients
Sheets("feuil15").Range("b169") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil15").Range("c169") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1
'clients, avances hors groupe
Sheets("feuil15").Range("b171") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'N
Sheets("feuil15").Range("c171") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'N-1
'clients, avances groupe
Sheets("feuil15").Range("b172") = WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000")) 'N
Sheets("feuil15").Range("c172") = WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000")) 'N-1
'clients, autres créditeurs
Sheets("feuil15").Range("b173") = WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000")) 'N
Sheets("feuil15").Range("c173") = WorksheetFunction.Sum(Sheets("feuil1").Range("af1:af5000")) 'N-1
'______________________________________________________________________________________
'Calculs du tableau

'total brut
Sheets("feuil15").Range("b168") = WorksheetFunction.Sum(Sheets("feuil15").Range("b158:b167")) 'N
Sheets("feuil15").Range("c168") = WorksheetFunction.Sum(Sheets("feuil15").Range("c158:c167")) 'N-1

'total net de dépréciation
Sheets("feuil15").Range("b170") = Sheets("feuil15").Range("b168") - Sheets("feuil15").Range("b169") 'N
Sheets("feuil15").Range("c170") = Sheets("feuil15").Range("c168") - Sheets("feuil15").Range("c169") 'N-1

'total clients créditeurs
Sheets("feuil15").Range("b174") = WorksheetFunction.Sum(Sheets("feuil15").Range("b171:b173")) 'N
Sheets("feuil15").Range("c174") = WorksheetFunction.Sum(Sheets("feuil15").Range("c171:c173")) 'N-1

'variation en %
For i = 158 To 174
If Sheets("feuil15").Cells(i, 3) = 0 Then
Else
If Sheets("feuil15").Cells(i, 3) < 0 Then
Sheets("feuil15").Cells(i, 4) = -1 * ((Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3))
Else
Sheets("feuil15").Cells(i, 4) = (Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3)
End If
End If
Next
'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"

'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents

'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_7()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("b158:d174").ClearContents
End If
End Sub
Private Sub note_8()
'condition générale de traitement de la NOTE 8
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 8
If Sheets("feuil5").Range("e40") + Sheets("feuil5").Range("ah40") = 0 Then
MsgBox "Désolé  !  Aucune créance diverse comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 8
'annule les données du tableau
Sheets("feuil15").Range("b194:d208").ClearContents

For i = 3 To 5000
'recup N
'compte 42
If Left(Sheets("feuil2").Cells(i, 1), 2) = 42 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 43
If Left(Sheets("feuil2").Cells(i, 1), 2) = 43 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 44
If Left(Sheets("feuil2").Cells(i, 1), 2) = 44 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 45
If Left(Sheets("feuil2").Cells(i, 1), 2) = 45 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 46
If Left(Sheets("feuil2").Cells(i, 1), 2) = 46 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 4751
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4751 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If

'compte 47
If Left(Sheets("feuil2").Cells(i, 1), 2) = 47 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4751 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
Else
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 7) 'Z
End If
Else
End If

'compte 185
If Left(Sheets("feuil2").Cells(i, 1), 3) = 185 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 7) 'AA
Else
End If

'compte 186+187
If Left(Sheets("feuil2").Cells(i, 1), 3) = 186 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 187 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 7) 'AB
Else
End If

'compte 188
If Left(Sheets("feuil2").Cells(i, 1), 3) = 188 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 7) 'AC
Else
End If

'compte 492+493+494+495+496+497
If Left(Sheets("feuil2").Cells(i, 1), 3) = 492 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 493 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 494 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 495 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 496 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 497 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
Else
End If


'recup N-1
'compte 42
If Left(Sheets("feuil1").Cells(i, 1), 2) = 42 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 43
If Left(Sheets("feuil1").Cells(i, 1), 2) = 43 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 44
If Left(Sheets("feuil1").Cells(i, 1), 2) = 44 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 45
If Left(Sheets("feuil1").Cells(i, 1), 2) = 45 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 46
If Left(Sheets("feuil1").Cells(i, 1), 2) = 46 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'compte 4751
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4751 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

'compte 47
If Left(Sheets("feuil1").Cells(i, 1), 2) = 47 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4751 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 478 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 479 Then
Else
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 7) 'Z
End If
Else
End If

'compte 185
If Left(Sheets("feuil1").Cells(i, 1), 3) = 185 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 7) 'AA
Else
End If

'compte 186+187
If Left(Sheets("feuil1").Cells(i, 1), 3) = 186 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 187 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 7) 'AB
Else
End If

'compte 188
If Left(Sheets("feuil1").Cells(i, 1), 3) = 188 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 7) 'AC
Else
End If

'compte 492+493+494+495+496+497
If Left(Sheets("feuil1").Cells(i, 1), 3) = 492 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 493 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 494 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 495 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 496 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 497 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'AD
Else
End If


Next


'affectation dans le tableau
'personnel
Sheets("feuil15").Range("b194") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("c194") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'organismes sociaux
Sheets("feuil15").Range("b195") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("c195") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'état et collectivités publiques
Sheets("feuil15").Range("b196") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("c196") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'organismes internationaux
Sheets("feuil15").Range("b197") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("c197") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'apporteurs, capital
Sheets("feuil15").Range("b198") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("c198") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'compte de liaison - SYSCOHADA révisé
Sheets("feuil15").Range("b200") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("c200") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'autres débiteurs divers
Sheets("feuil15").Range("b201") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("c201") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'comptes permanents non bloqués des établissements
Sheets("feuil15").Range("b203") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("c203") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'comptes de liaison charge et produit
Sheets("feuil15").Range("b204") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil15").Range("c204") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'comptes de liaison, société en participation
Sheets("feuil15").Range("b205") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil15").Range("c205") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1
'dépréciations des autres créances
Sheets("feuil15").Range("b207") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'N
Sheets("feuil15").Range("c207") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'N-1
'______________________________________________________________________________________
'Calculs du tableau

'total brut
Sheets("feuil15").Range("b206") = WorksheetFunction.Sum(Sheets("feuil15").Range("b194:b205")) 'N
Sheets("feuil15").Range("c206") = WorksheetFunction.Sum(Sheets("feuil15").Range("c194:c205")) 'N-1

'total net de dépréciation
Sheets("feuil15").Range("b208") = Sheets("feuil15").Range("b206") - Sheets("feuil15").Range("b207") 'N
Sheets("feuil15").Range("c208") = Sheets("feuil15").Range("c206") - Sheets("feuil15").Range("c207") 'N-1


'variation en %
For i = 194 To 208
If Sheets("feuil15").Cells(i, 3) = 0 Then
Else
If Sheets("feuil15").Cells(i, 3) < 0 Then
Sheets("feuil15").Cells(i, 4) = -1 * ((Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3))
Else
Sheets("feuil15").Cells(i, 4) = (Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3)
End If
End If
Next
'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"

'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents

'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_8()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("b194:d208").ClearContents
End If
End Sub
Private Sub note_9()

'condition générale de traitement de la NOTE 9
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 9
If Sheets("feuil5").Range("e42") + Sheets("feuil5").Range("ah42") = 0 Then
MsgBox "Désolé  !  Aucun titre de placement comptabilisé."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 9
'annule les données du tableau
Sheets("feuil15").Range("e265:g274").ClearContents

For i = 3 To 5000
'recup N
'compte 501
If Left(Sheets("feuil2").Cells(i, 1), 3) = 501 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 502
If Left(Sheets("feuil2").Cells(i, 1), 3) = 502 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 503
If Left(Sheets("feuil2").Cells(i, 1), 3) = 503 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 504
If Left(Sheets("feuil2").Cells(i, 1), 3) = 504 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 505
If Left(Sheets("feuil2").Cells(i, 1), 3) = 505 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 506
If Left(Sheets("feuil2").Cells(i, 1), 3) = 506 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If

'compte 508
If Left(Sheets("feuil2").Cells(i, 1), 3) = 508 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 7) 'Z
Else
End If

'compte 590
If Left(Sheets("feuil2").Cells(i, 1), 3) = 590 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 8) 'AA
Else
End If



'recup N-1
'compte 501
If Left(Sheets("feuil1").Cells(i, 1), 3) = 501 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 502
If Left(Sheets("feuil1").Cells(i, 1), 3) = 502 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 503
If Left(Sheets("feuil1").Cells(i, 1), 3) = 503 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 504
If Left(Sheets("feuil1").Cells(i, 1), 3) = 504 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 505
If Left(Sheets("feuil1").Cells(i, 1), 3) = 505 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'compte 506
If Left(Sheets("feuil1").Cells(i, 1), 3) = 506 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

'compte 508
If Left(Sheets("feuil1").Cells(i, 1), 3) = 508 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 7) 'Z
Else
End If

'compte 590
If Left(Sheets("feuil1").Cells(i, 1), 3) = 590 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 8) 'AA
Else
End If


Next


'affectation dans le tableau
'titres du trésor et bons de caisse
Sheets("feuil15").Range("e265") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f265") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'actions
Sheets("feuil15").Range("e266") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f266") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'obligations
Sheets("feuil15").Range("e267") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f267") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'bons de souscription
Sheets("feuil15").Range("e268") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f268") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'titres hors région
Sheets("feuil15").Range("e269") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f269") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'intérêts courus
Sheets("feuil15").Range("e270") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("f270") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'autres valeurs assimilées
Sheets("feuil15").Range("e271") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("f271") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'dépréciations des titres de placement
Sheets("feuil15").Range("e273") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("f273") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1


'______________________________________________________________________________________
'Calculs du tableau

'total brut des titres
Sheets("feuil15").Range("e272") = WorksheetFunction.Sum(Sheets("feuil15").Range("e265:e271")) 'N
Sheets("feuil15").Range("f272") = WorksheetFunction.Sum(Sheets("feuil15").Range("f265:f271")) 'N-1

'total net de dépréciation
Sheets("feuil15").Range("e274") = Sheets("feuil15").Range("e272") - Sheets("feuil15").Range("e273") 'N
Sheets("feuil15").Range("f274") = Sheets("feuil15").Range("f272") - Sheets("feuil15").Range("f273") 'N-1


'variation en % stocks
For i = 265 To 274
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub annuler_note_9()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e265:g274").ClearContents
End If
End Sub
Private Sub note_10()

'condition générale de traitement de la NOTE 10
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 10
If Sheets("feuil5").Range("e43") + Sheets("feuil5").Range("ah43") = 0 Then
MsgBox "Désolé  !  Aucune valeur à encaisser comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 10
'annule les données du tableau
Sheets("feuil15").Range("e301:g309").ClearContents

For i = 3 To 5000
'recup N
'compte 511
If Left(Sheets("feuil2").Cells(i, 1), 3) = 511 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 512
If Left(Sheets("feuil2").Cells(i, 1), 3) = 512 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 513
If Left(Sheets("feuil2").Cells(i, 1), 3) = 513 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 514
If Left(Sheets("feuil2").Cells(i, 1), 3) = 514 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 515
If Left(Sheets("feuil2").Cells(i, 1), 3) = 515 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 518
If Left(Sheets("feuil2").Cells(i, 1), 3) = 518 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If

'compte 591
If Left(Sheets("feuil2").Cells(i, 1), 3) = 591 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 8) 'Z
Else
End If


'recup N-1
'compte 511
If Left(Sheets("feuil1").Cells(i, 1), 3) = 511 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 512
If Left(Sheets("feuil1").Cells(i, 1), 3) = 512 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 513
If Left(Sheets("feuil1").Cells(i, 1), 3) = 513 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 514
If Left(Sheets("feuil1").Cells(i, 1), 3) = 514 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 515
If Left(Sheets("feuil1").Cells(i, 1), 3) = 515 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'compte 518
If Left(Sheets("feuil1").Cells(i, 1), 3) = 518 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

'compte 591
If Left(Sheets("feuil1").Cells(i, 1), 3) = 591 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 8) 'Z
Else
End If


Next


'affectation dans le tableau
'effets à encaisser
Sheets("feuil15").Range("e301") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f301") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'effets à l'encaissement
Sheets("feuil15").Range("e302") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f302") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'chèques à encaisser
Sheets("feuil15").Range("e303") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f303") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'chèques à l'encaissement
Sheets("feuil15").Range("e304") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f304") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'cartes de crédit à encaisser
Sheets("feuil15").Range("e305") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f305") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'autres valeurs à encaisser
Sheets("feuil15").Range("e306") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("f306") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'dépréciations des valeurs à encaisser
Sheets("feuil15").Range("e308") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("f308") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1


'______________________________________________________________________________________
'Calculs du tableau

'total brut des valeurs à encaisser
Sheets("feuil15").Range("e307") = WorksheetFunction.Sum(Sheets("feuil15").Range("e301:e306")) 'N
Sheets("feuil15").Range("f307") = WorksheetFunction.Sum(Sheets("feuil15").Range("f301:f306")) 'N-1

'total net de dépréciation
Sheets("feuil15").Range("e309") = Sheets("feuil15").Range("e307") - Sheets("feuil15").Range("e308") 'N
Sheets("feuil15").Range("f309") = Sheets("feuil15").Range("f307") - Sheets("feuil15").Range("f308") 'N-1


'variation en % stocks
For i = 301 To 309
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_10()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e301:g309").ClearContents
End If
End Sub
Private Sub note_11()

'condition générale de traitement de la NOTE 11
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 11
If Sheets("feuil5").Range("e44") + Sheets("feuil5").Range("ah44") = 0 Then
MsgBox "Désolé  !  Aucune disponibilité comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 11
'annule les données du tableau
Sheets("feuil15").Range("e337:g351").ClearContents

For i = 3 To 5000
'recup N
'compte 521
If Left(Sheets("feuil2").Cells(i, 1), 3) = 521 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 522
If Left(Sheets("feuil2").Cells(i, 1), 3) = 522 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 525
If Left(Sheets("feuil2").Cells(i, 1), 3) = 525 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 523+524
If Left(Sheets("feuil2").Cells(i, 1), 3) = 523 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 524 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 526
If Left(Sheets("feuil2").Cells(i, 1), 3) = 526 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 531
If Left(Sheets("feuil2").Cells(i, 1), 3) = 531 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If

'compte 532+533+538
If Left(Sheets("feuil2").Cells(i, 1), 3) = 532 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 533 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 538 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 7) 'Z
Else
End If

'compte 536
If Left(Sheets("feuil2").Cells(i, 1), 3) = 536 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 7) 'AA
Else
End If

'compte 54
If Left(Sheets("feuil2").Cells(i, 1), 2) = 54 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 7) 'AB
Else
End If

'compte 57
If Left(Sheets("feuil2").Cells(i, 1), 2) = 57 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 7) 'AC
Else
End If

'compte 55
If Left(Sheets("feuil2").Cells(i, 1), 2) = 55 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 7) 'AD
Else
End If

'compte 581+582
If Left(Sheets("feuil2").Cells(i, 1), 3) = 581 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 582 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 7) 'AE
Else
End If

'compte 592+593+594
If Left(Sheets("feuil2").Cells(i, 1), 3) = 592 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 593 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 594 Then
Sheets("feuil2").Cells(i, 32) = Sheets("feuil2").Cells(i, 8) 'AF
Else
End If


'recup N-1
'compte 521
If Left(Sheets("feuil1").Cells(i, 1), 3) = 521 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 522
If Left(Sheets("feuil1").Cells(i, 1), 3) = 522 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 525
If Left(Sheets("feuil1").Cells(i, 1), 3) = 525 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 523+524
If Left(Sheets("feuil1").Cells(i, 1), 3) = 523 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 524 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 526
If Left(Sheets("feuil1").Cells(i, 1), 3) = 526 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'compte 531
If Left(Sheets("feuil1").Cells(i, 1), 3) = 531 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

'compte 532+533+538
If Left(Sheets("feuil1").Cells(i, 1), 3) = 532 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 533 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 538 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 7) 'Z
Else
End If

'compte 536
If Left(Sheets("feuil1").Cells(i, 1), 3) = 536 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 7) 'AA
Else
End If

'compte 54
If Left(Sheets("feuil1").Cells(i, 1), 2) = 54 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 7) 'AB
Else
End If

'compte 57
If Left(Sheets("feuil1").Cells(i, 1), 2) = 57 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 7) 'AC
Else
End If

'compte 55
If Left(Sheets("feuil1").Cells(i, 1), 2) = 55 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 7) 'AD
Else
End If

'compte 581+582
If Left(Sheets("feuil1").Cells(i, 1), 3) = 581 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 582 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 7) 'AE
Else
End If

'compte 592+593+594
If Left(Sheets("feuil1").Cells(i, 1), 3) = 592 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 593 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 594 Then
Sheets("feuil1").Cells(i, 32) = Sheets("feuil1").Cells(i, 8) 'AF
Else
End If

Next


'affectation dans le tableau
'banques locales
Sheets("feuil15").Range("e337") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f337") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'banques autres états région
Sheets("feuil15").Range("e338") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f338") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'banques DAT
Sheets("feuil15").Range("e339") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f339") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'autres banques
Sheets("feuil15").Range("e340") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f340") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'banques intérêts courus
Sheets("feuil15").Range("e341") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f341") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'chèques postaux
Sheets("feuil15").Range("e342") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("f342") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'autres établissements financiers
Sheets("feuil15").Range("e343") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("f343") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'établissements financiers intérêts courus
Sheets("feuil15").Range("e344") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("f344") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'instruments de trésorerie
Sheets("feuil15").Range("e345") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil15").Range("f345") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'caisse
Sheets("feuil15").Range("e346") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil15").Range("f346") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1
'caisse électronique mobile
Sheets("feuil15").Range("e347") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'N
Sheets("feuil15").Range("f347") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'N-1
'régies d'avances et accréditifs
Sheets("feuil15").Range("e348") = WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000")) 'N
Sheets("feuil15").Range("f348") = WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000")) 'N-1
'dépréciations
Sheets("feuil15").Range("e350") = WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000")) 'N
Sheets("feuil15").Range("f350") = WorksheetFunction.Sum(Sheets("feuil1").Range("af1:af5000")) 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut des disponibiliés
Sheets("feuil15").Range("e349") = WorksheetFunction.Sum(Sheets("feuil15").Range("e337:e348")) 'N
Sheets("feuil15").Range("f349") = WorksheetFunction.Sum(Sheets("feuil15").Range("f337:f348")) 'N-1

'total net de dépréciation
Sheets("feuil15").Range("e351") = Sheets("feuil15").Range("e349") - Sheets("feuil15").Range("e350") 'N
Sheets("feuil15").Range("f351") = Sheets("feuil15").Range("f349") - Sheets("feuil15").Range("f350") 'N-1


'variation en % stocks
For i = 337 To 351
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub annuler_note_11()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e337:g351").ClearContents
End If
End Sub
Private Sub note_12()
'condition générale de traitement de la NOTE 12
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 12
If Sheets("feuil5").Range("e46") + Sheets("feuil5").Range("h46") + Sheets("feuil5").Range("m46") + Sheets("feuil5").Range("n46") + Sheets("feuil6").Range("i25") + Sheets("feuil6").Range("j25") + Sheets("feuil6").Range("i42") + Sheets("feuil6").Range("j42") = 0 Then
MsgBox "Désolé  !  Aucun écart de conversion et tranfert de charge comptabilisé."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 12
'annule les données du tableau
Sheets("feuil15").Range("b374").ClearContents
Sheets("feuil15").Range("b381").ClearContents
Sheets("feuil15").Range("e409:g409").ClearContents
Sheets("feuil15").Range("e416:g416").ClearContents

For i = 3 To 5000
'recup N
'compte 478
If Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 479
If Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
Else
End If

'compte 781
If Left(Sheets("feuil2").Cells(i, 1), 3) = 781 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
Else
End If

'compte 787
If Left(Sheets("feuil2").Cells(i, 1), 3) = 787 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
Else
End If


'recup N-1
'compte 781
If Left(Sheets("feuil1").Cells(i, 1), 3) = 781 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
Else
End If

'compte 787
If Left(Sheets("feuil1").Cells(i, 1), 3) = 787 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'W
Else
End If



Next


'affectation dans le tableau
'écarts de conversion actif
Sheets("feuil15").Range("b374") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
'Sheets("feuil15").Range("f337") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'écarts de conversion passif
Sheets("feuil15").Range("b381") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
'Sheets("feuil15").Range("f338") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1

'transferts de charges d'exploitation
Sheets("feuil15").Range("e409") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f409") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'transferts de charges financières
Sheets("feuil15").Range("e416") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f416") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut des disponibiliés
'Sheets("feuil15").Range("e349") = WorksheetFunction.Sum(Sheets("feuil15").Range("e337:e348")) 'N
'Sheets("feuil15").Range("f349") = WorksheetFunction.Sum(Sheets("feuil15").Range("f337:f348")) 'N-1

'total net de dépréciation
'Sheets("feuil15").Range("e351") = Sheets("feuil15").Range("e349") - Sheets("feuil15").Range("e350") 'N
'Sheets("feuil15").Range("f351") = Sheets("feuil15").Range("f349") - Sheets("feuil15").Range("f350") 'N-1


'variation en % transferts charges d'exploitation
For i = 409 To 409
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'variation en % transferts charges financières
For i = 416 To 416
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "                                                 FIN DE L'EDITION  !" & Chr(10) & Chr(10) & "NB : Veuillez détailler les éventuels écarts de conversion, et éventuels transferts de charges (suite NOTE 12)  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub annuler_note_12()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("b374").ClearContents
Sheets("feuil15").Range("b381").ClearContents
Sheets("feuil15").Range("e409:g409").ClearContents
Sheets("feuil15").Range("e416:g416").ClearContents
End If
End Sub
Private Sub note_14()
'condition générale de traitement de la NOTE 14
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 14
If Sheets("feuil5").Range("m15") + Sheets("feuil5").Range("m17") + Sheets("feuil5").Range("m18") + Sheets("feuil5").Range("m19") + Sheets("feuil5").Range("n15") + Sheets("feuil5").Range("n17") + Sheets("feuil5").Range("n18") + Sheets("feuil5").Range("n19") = 0 Then
MsgBox "Désolé  !  Aucune prime et réserve comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 14
'annule les données du tableau
Sheets("feuil15").Range("e481:g494").ClearContents

For i = 3 To 5000
'recup N
'compte 1051
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1051 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 8) 'T
Else
End If

'compte 1052
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1052 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
Else
End If

'compte 1053
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1053 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
Else
End If

'compte 1054
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1054 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
Else
End If

'compte 1058
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1058 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
Else
End If

'compte 111
If Left(Sheets("feuil2").Cells(i, 1), 3) = 111 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 8) 'Y
Else
End If

'compte 112
If Left(Sheets("feuil2").Cells(i, 1), 3) = 112 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 8) 'Z
Else
End If

'compte 1131
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1131 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 8) 'AA
Else
End If

'compte 1132
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1132 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 8) 'AB
Else
End If

'compte 113 sauf 1131 et 1132
If Left(Sheets("feuil2").Cells(i, 1), 3) = 113 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1131 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 1132 Then
Else
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 8) 'AC
End If
Else
End If


'recup N-1
'compte 1051
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1051 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 8) 'T
Else
End If

'compte 1052
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1052 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'U
Else
End If

'compte 1053
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1053 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
Else
End If

'compte 1054
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1054 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'W
Else
End If

'compte 1058
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1058 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 8) 'X
Else
End If

'compte 111
If Left(Sheets("feuil1").Cells(i, 1), 3) = 111 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 8) 'Y
Else
End If

'compte 112
If Left(Sheets("feuil1").Cells(i, 1), 3) = 112 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 8) 'Z
Else
End If

'compte 1131
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1131 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 8) 'AA
Else
End If

'compte 1132
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1132 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 8) 'AB
Else
End If

'compte 113 sauf 1131 et 1132
If Left(Sheets("feuil1").Cells(i, 1), 3) = 113 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1131 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 1132 Then
Else
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 8) 'AC
End If
Else
End If


Next


'affectation dans le tableau
'primes d'émission
Sheets("feuil15").Range("e481") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f481") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'primes d'apport
Sheets("feuil15").Range("e482") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f482") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'primes de fusion
Sheets("feuil15").Range("e483") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f483") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'primes de conversion
Sheets("feuil15").Range("e484") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f484") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'autres primes
Sheets("feuil15").Range("e485") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f485") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'réserves légales
Sheets("feuil15").Range("e487") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("f487") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'réserves statutaires
Sheets("feuil15").Range("e488") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("f488") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'réserves de plus values nettes
Sheets("feuil15").Range("e489") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("f489") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'réserves d'attribution gratuite d'actions
Sheets("feuil15").Range("e490") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil15").Range("f490") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'autres réserves réglementées
Sheets("feuil15").Range("e491") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil15").Range("f491") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1
'réserves libres
Sheets("feuil15").Range("e493") = Sheets("feuil5").Range("m18") 'N
Sheets("feuil15").Range("f493") = Sheets("feuil5").Range("n18") 'N-1
'report à nouveau
Sheets("feuil15").Range("e494") = Sheets("feuil5").Range("m19") 'N
Sheets("feuil15").Range("f494") = Sheets("feuil5").Range("n19") 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut des primes
Sheets("feuil15").Range("e486") = WorksheetFunction.Sum(Sheets("feuil15").Range("e481:e485")) 'N
Sheets("feuil15").Range("f486") = WorksheetFunction.Sum(Sheets("feuil15").Range("f481:f485")) 'N-1

'total brut des réserves
Sheets("feuil15").Range("e492") = WorksheetFunction.Sum(Sheets("feuil15").Range("e487:e491")) 'N
Sheets("feuil15").Range("f492") = WorksheetFunction.Sum(Sheets("feuil15").Range("f487:f491")) 'N-1


'variation en % des primes et réserves
'For i = 337 To 351
'If Sheets("feuil15").Cells(i, 6) = 0 Then
'Else
'If Sheets("feuil15").Cells(i, 6) < 0 Then
'Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
'Else
'Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
'End If
'End If
'Next

'variation en abs() des primes et réserves
For i = 481 To 494
Sheets("feuil15").Cells(i, 7) = Abs(Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6))
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub annuler_note_14()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e481:g494").ClearContents
End If
End Sub
Private Sub note_15A()
'condition générale de traitement de la NOTE 15A
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 15A
If Sheets("feuil5").Range("m24") + Sheets("feuil5").Range("m25") + Sheets("feuil5").Range("n24") + Sheets("feuil5").Range("n25") = 0 Then
MsgBox "Désolé  !  Aucune subvention et provision réglementée comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 15A
'annule les données du tableau
Sheets("feuil15").Range("c518:f535").ClearContents

For i = 3 To 5000
'recup N
'compte 1411
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1411 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 8) 'T
Else
End If

'compte 1412
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1412 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
Else
End If

'compte 1413
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1413 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
Else
End If

'compte 1414
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1414 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
Else
End If

'compte 1415
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1415 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
Else
End If

'compte 1416
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1416 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 8) 'Y
Else
End If

'compte 1417
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1417 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 8) 'Z
Else
End If

'compte 1418 + 148
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1418 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 148 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 8) 'AA
Else
End If

'compte 151
If Left(Sheets("feuil2").Cells(i, 1), 3) = 151 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 8) 'AB
Else
End If

'compte 152
If Left(Sheets("feuil2").Cells(i, 1), 3) = 152 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 8) 'AC
Else
End If

'compte 154
If Left(Sheets("feuil2").Cells(i, 1), 3) = 154 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
Else
End If

'compte 155
If Left(Sheets("feuil2").Cells(i, 1), 3) = 155 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 8) 'AE
Else
End If

'compte 156
If Left(Sheets("feuil2").Cells(i, 1), 3) = 156 Then
Sheets("feuil2").Cells(i, 32) = Sheets("feuil2").Cells(i, 8) 'AF
Else
End If

'compte 157
If Left(Sheets("feuil2").Cells(i, 1), 3) = 157 Then
Sheets("feuil2").Cells(i, 33) = Sheets("feuil2").Cells(i, 8) 'AG
Else
End If

'compte 158 + 153
If Left(Sheets("feuil2").Cells(i, 1), 3) = 158 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 153 Then
Sheets("feuil2").Cells(i, 34) = Sheets("feuil2").Cells(i, 8) 'AH
Else
End If



'recup N-1
'compte 1411
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1411 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 8) 'T
Else
End If

'compte 1412
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1412 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'U
Else
End If

'compte 1413
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1413 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
Else
End If

'compte 1414
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1414 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'W
Else
End If

'compte 1415
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1415 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 8) 'X
Else
End If

'compte 1416
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1416 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 8) 'Y
Else
End If

'compte 1417
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1417 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 8) 'Z
Else
End If

'compte 1418 + 148
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1418 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 148 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 8) 'AA
Else
End If

'compte 151
If Left(Sheets("feuil1").Cells(i, 1), 3) = 151 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 8) 'AB
Else
End If

'compte 152
If Left(Sheets("feuil1").Cells(i, 1), 3) = 152 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 8) 'AC
Else
End If

'compte 154
If Left(Sheets("feuil1").Cells(i, 1), 3) = 154 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'AD
Else
End If

'compte 155
If Left(Sheets("feuil1").Cells(i, 1), 3) = 155 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 8) 'AE
Else
End If

'compte 156
If Left(Sheets("feuil1").Cells(i, 1), 3) = 156 Then
Sheets("feuil1").Cells(i, 32) = Sheets("feuil1").Cells(i, 8) 'AF
Else
End If

'compte 157
If Left(Sheets("feuil1").Cells(i, 1), 3) = 157 Then
Sheets("feuil1").Cells(i, 33) = Sheets("feuil1").Cells(i, 8) 'AG
Else
End If

'compte 158 + 153
If Left(Sheets("feuil1").Cells(i, 1), 3) = 158 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 153 Then
Sheets("feuil1").Cells(i, 34) = Sheets("feuil1").Cells(i, 8) 'AH
Else
End If

Next


'affectation dans le tableau
'état
Sheets("feuil15").Range("c518") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("d518") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'régions
Sheets("feuil15").Range("c519") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("d519") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'départements
Sheets("feuil15").Range("c520") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("d520") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'communes et collectivités
Sheets("feuil15").Range("c521") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("d521") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'entités publiques ou mixtes
Sheets("feuil15").Range("c522") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("d522") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'entités et organismes privés
Sheets("feuil15").Range("c523") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("d523") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'organismes internationaux
Sheets("feuil15").Range("c524") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("d524") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'autres
Sheets("feuil15").Range("c525") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("d525") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'amortissements dérogatoires
Sheets("feuil15").Range("c527") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil15").Range("d527") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'plus values à réinvestir
Sheets("feuil15").Range("c528") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil15").Range("d528") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1
'provision spéciale de réévaluation
Sheets("feuil15").Range("c529") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'N
Sheets("feuil15").Range("d529") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'N-1
'provisions réglementées relatives aux immob.
Sheets("feuil15").Range("c530") = WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000")) 'N
Sheets("feuil15").Range("d530") = WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000")) 'N-1
'provisions réglementées relatives aux stocks
Sheets("feuil15").Range("c531") = WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000")) 'N
Sheets("feuil15").Range("d531") = WorksheetFunction.Sum(Sheets("feuil1").Range("af1:af5000")) 'N-1
'provisions pour investissement
Sheets("feuil15").Range("c532") = WorksheetFunction.Sum(Sheets("feuil2").Range("ag1:ag5000")) 'N
Sheets("feuil15").Range("d532") = WorksheetFunction.Sum(Sheets("feuil1").Range("ag1:ag5000")) 'N-1
'autres provisions et fonds réglementés
Sheets("feuil15").Range("c533") = WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000")) 'N
Sheets("feuil15").Range("d533") = WorksheetFunction.Sum(Sheets("feuil1").Range("ah1:ah5000")) 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut des subventions
Sheets("feuil15").Range("c526") = WorksheetFunction.Sum(Sheets("feuil15").Range("c518:c525")) 'N
Sheets("feuil15").Range("d526") = WorksheetFunction.Sum(Sheets("feuil15").Range("d518:d525")) 'N-1

'total brut des provisions réglementées
Sheets("feuil15").Range("c534") = WorksheetFunction.Sum(Sheets("feuil15").Range("c527:c533")) 'N
Sheets("feuil15").Range("d534") = WorksheetFunction.Sum(Sheets("feuil15").Range("d527:d533")) 'N-1

'total général
Sheets("feuil15").Range("c535") = Sheets("feuil15").Range("c526") + Sheets("feuil15").Range("c534") 'N
Sheets("feuil15").Range("d535") = Sheets("feuil15").Range("d526") + Sheets("feuil15").Range("d534") 'N-1


'variation en %
For i = 518 To 535
If Sheets("feuil15").Cells(i, 4) = 0 Then
Else
If Sheets("feuil15").Cells(i, 4) < 0 Then
Sheets("feuil15").Cells(i, 6) = -1 * ((Sheets("feuil15").Cells(i, 3) - Sheets("feuil15").Cells(i, 4)) / Sheets("feuil15").Cells(i, 4))
Else
Sheets("feuil15").Cells(i, 6) = (Sheets("feuil15").Cells(i, 3) - Sheets("feuil15").Cells(i, 4)) / Sheets("feuil15").Cells(i, 4)
End If
End If
Next

'variation en valeur abs()
For i = 518 To 535
Sheets("feuil15").Cells(i, 5) = Abs(Sheets("feuil15").Cells(i, 3) - Sheets("feuil15").Cells(i, 4))
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub annuler_note_15A()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("c518:f535").ClearContents
End If
End Sub
Private Sub note_16A()
'condition générale de traitement de la NOTE 16A
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 16A
If Sheets("feuil5").Range("m33") + Sheets("feuil5").Range("n33") = 0 Then
MsgBox "Désolé  !  Aucune dette financière et ressource assimilée comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 16A
'annule les données du tableau
Sheets("feuil15").Range("b590:e606").ClearContents
Sheets("feuil15").Range("b626:e639").ClearContents

For i = 3 To 5000
'recup N
'compte 161
If Left(Sheets("feuil2").Cells(i, 1), 3) = 161 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 8) 'T
Else
End If

'compte 162
If Left(Sheets("feuil2").Cells(i, 1), 3) = 162 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
Else
End If

'compte 163
If Left(Sheets("feuil2").Cells(i, 1), 3) = 163 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
Else
End If

'compte 164
If Left(Sheets("feuil2").Cells(i, 1), 3) = 164 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
Else
End If

'compte 165
If Left(Sheets("feuil2").Cells(i, 1), 3) = 165 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
Else
End If

'compte 166
If Left(Sheets("feuil2").Cells(i, 1), 3) = 166 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 8) 'Y
Else
End If

'compte 167
If Left(Sheets("feuil2").Cells(i, 1), 3) = 167 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 8) 'Z
Else
End If

'compte 168
If Left(Sheets("feuil2").Cells(i, 1), 3) = 168 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 8) 'AA
Else
End If

'compte 181 + 182 + 183
If Left(Sheets("feuil2").Cells(i, 1), 3) = 181 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 182 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 183 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 8) 'AB
Else
End If

'compte 184
If Left(Sheets("feuil2").Cells(i, 1), 3) = 184 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 8) 'AC
Else
End If

'compte 172
If Left(Sheets("feuil2").Cells(i, 1), 3) = 172 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
Else
End If

'compte 173
If Left(Sheets("feuil2").Cells(i, 1), 3) = 173 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 8) 'AE
Else
End If

'compte 174
If Left(Sheets("feuil2").Cells(i, 1), 3) = 174 Then
Sheets("feuil2").Cells(i, 32) = Sheets("feuil2").Cells(i, 8) 'AF
Else
End If

'compte 176
If Left(Sheets("feuil2").Cells(i, 1), 3) = 176 Then
Sheets("feuil2").Cells(i, 33) = Sheets("feuil2").Cells(i, 8) 'AG
Else
End If

'compte 178
If Left(Sheets("feuil2").Cells(i, 1), 3) = 178 Then
Sheets("feuil2").Cells(i, 34) = Sheets("feuil2").Cells(i, 8) 'AH
Else
End If


'compte 191
If Left(Sheets("feuil2").Cells(i, 1), 3) = 191 Then
Sheets("feuil2").Cells(i, 35) = Sheets("feuil2").Cells(i, 8) 'AI
Else
End If

'compte 192
If Left(Sheets("feuil2").Cells(i, 1), 3) = 192 Then
Sheets("feuil2").Cells(i, 36) = Sheets("feuil2").Cells(i, 8) 'AJ
Else
End If

'compte 193
If Left(Sheets("feuil2").Cells(i, 1), 3) = 193 Then
Sheets("feuil2").Cells(i, 37) = Sheets("feuil2").Cells(i, 8) 'AK
Else
End If

'compte 194
If Left(Sheets("feuil2").Cells(i, 1), 3) = 194 Then
Sheets("feuil2").Cells(i, 38) = Sheets("feuil2").Cells(i, 8) 'AL
Else
End If

'compte 195
If Left(Sheets("feuil2").Cells(i, 1), 3) = 195 Then
Sheets("feuil2").Cells(i, 39) = Sheets("feuil2").Cells(i, 8) 'AM
Else
End If

'compte 1961
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1961 Then
Sheets("feuil2").Cells(i, 40) = Sheets("feuil2").Cells(i, 8) 'AN
Else
End If

'compte 1962
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1962 Then
Sheets("feuil2").Cells(i, 41) = Sheets("feuil2").Cells(i, 8) 'AO
Else
End If

'compte 197
If Left(Sheets("feuil2").Cells(i, 1), 3) = 197 Then
Sheets("feuil2").Cells(i, 42) = Sheets("feuil2").Cells(i, 8) 'AP
Else
End If

'compte 1981
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1981 Then
Sheets("feuil2").Cells(i, 43) = Sheets("feuil2").Cells(i, 8) 'AQ
Else
End If

'compte 1983
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1983 Then
Sheets("feuil2").Cells(i, 44) = Sheets("feuil2").Cells(i, 8) 'AR
Else
End If

'compte 1984
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1984 Then
Sheets("feuil2").Cells(i, 45) = Sheets("feuil2").Cells(i, 8) 'AS
Else
End If

'compte 1985
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1985 Then
Sheets("feuil2").Cells(i, 46) = Sheets("feuil2").Cells(i, 8) 'AT
Else
End If

'compte 1988
If Left(Sheets("feuil2").Cells(i, 1), 4) = 1988 Then
Sheets("feuil2").Cells(i, 47) = Sheets("feuil2").Cells(i, 8) 'AU
Else
End If





'recup N-1
'compte 161
If Left(Sheets("feuil1").Cells(i, 1), 3) = 161 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 8) 'T
Else
End If

'compte 162
If Left(Sheets("feuil1").Cells(i, 1), 3) = 162 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'U
Else
End If

'compte 163
If Left(Sheets("feuil1").Cells(i, 1), 3) = 163 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
Else
End If

'compte 164
If Left(Sheets("feuil1").Cells(i, 1), 3) = 164 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'W
Else
End If

'compte 165
If Left(Sheets("feuil1").Cells(i, 1), 3) = 165 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 8) 'X
Else
End If

'compte 166
If Left(Sheets("feuil1").Cells(i, 1), 3) = 166 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 8) 'Y
Else
End If

'compte 167
If Left(Sheets("feuil1").Cells(i, 1), 3) = 167 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 8) 'Z
Else
End If

'compte 168
If Left(Sheets("feuil1").Cells(i, 1), 3) = 168 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 8) 'AA
Else
End If

'compte 181 + 182 + 183
If Left(Sheets("feuil1").Cells(i, 1), 3) = 181 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 182 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 183 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 8) 'AB
Else
End If

'compte 184
If Left(Sheets("feuil1").Cells(i, 1), 3) = 184 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 8) 'AC
Else
End If

'compte 172
If Left(Sheets("feuil1").Cells(i, 1), 3) = 172 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'AD
Else
End If

'compte 173
If Left(Sheets("feuil1").Cells(i, 1), 3) = 173 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 8) 'AE
Else
End If

'compte 174
If Left(Sheets("feuil1").Cells(i, 1), 3) = 174 Then
Sheets("feuil1").Cells(i, 32) = Sheets("feuil1").Cells(i, 8) 'AF
Else
End If

'compte 176
If Left(Sheets("feuil1").Cells(i, 1), 3) = 176 Then
Sheets("feuil1").Cells(i, 33) = Sheets("feuil1").Cells(i, 8) 'AG
Else
End If

'compte 178
If Left(Sheets("feuil1").Cells(i, 1), 3) = 178 Then
Sheets("feuil1").Cells(i, 34) = Sheets("feuil1").Cells(i, 8) 'AH
Else
End If


'compte 191
If Left(Sheets("feuil1").Cells(i, 1), 3) = 191 Then
Sheets("feuil1").Cells(i, 35) = Sheets("feuil1").Cells(i, 8) 'AI
Else
End If

'compte 192
If Left(Sheets("feuil1").Cells(i, 1), 3) = 192 Then
Sheets("feuil1").Cells(i, 36) = Sheets("feuil1").Cells(i, 8) 'AJ
Else
End If

'compte 193
If Left(Sheets("feuil1").Cells(i, 1), 3) = 193 Then
Sheets("feuil1").Cells(i, 37) = Sheets("feuil1").Cells(i, 8) 'AK
Else
End If

'compte 194
If Left(Sheets("feuil1").Cells(i, 1), 3) = 194 Then
Sheets("feuil1").Cells(i, 38) = Sheets("feuil1").Cells(i, 8) 'AL
Else
End If

'compte 195
If Left(Sheets("feuil1").Cells(i, 1), 3) = 195 Then
Sheets("feuil1").Cells(i, 39) = Sheets("feuil1").Cells(i, 8) 'AM
Else
End If

'compte 1961
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1961 Then
Sheets("feuil1").Cells(i, 40) = Sheets("feuil1").Cells(i, 8) 'AN
Else
End If

'compte 1962
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1962 Then
Sheets("feuil1").Cells(i, 41) = Sheets("feuil1").Cells(i, 8) 'AO
Else
End If

'compte 197
If Left(Sheets("feuil1").Cells(i, 1), 3) = 197 Then
Sheets("feuil1").Cells(i, 42) = Sheets("feuil1").Cells(i, 8) 'AP
Else
End If

'compte 1981
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1981 Then
Sheets("feuil1").Cells(i, 43) = Sheets("feuil1").Cells(i, 8) 'AQ
Else
End If

'compte 1983
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1983 Then
Sheets("feuil1").Cells(i, 44) = Sheets("feuil1").Cells(i, 8) 'AR
Else
End If

'compte 1984
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1984 Then
Sheets("feuil1").Cells(i, 45) = Sheets("feuil1").Cells(i, 8) 'AS
Else
End If

'compte 1985
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1985 Then
Sheets("feuil1").Cells(i, 46) = Sheets("feuil1").Cells(i, 8) 'AT
Else
End If

'compte 1988
If Left(Sheets("feuil1").Cells(i, 1), 4) = 1988 Then
Sheets("feuil1").Cells(i, 47) = Sheets("feuil1").Cells(i, 8) 'AU
Else
End If

Next


'affectation dans le tableau
'emprunt obligataire
Sheets("feuil15").Range("b590") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("c590") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'emprunts auprès des établissements de crédit
Sheets("feuil15").Range("b591") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("c591") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'avances reçues de l'état
Sheets("feuil15").Range("b592") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("c592") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'avances reçues et comptes courants bloqués
Sheets("feuil15").Range("b593") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("c593") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'dépôts et cautionnements reçus
Sheets("feuil15").Range("b594") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("c594") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'intérêts courus
Sheets("feuil15").Range("b595") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("c595") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'avances assorties de conditions particulières
Sheets("feuil15").Range("b596") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("c596") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'autres emprunts et dettes
Sheets("feuil15").Range("b597") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("c597") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'dettes liées à des participations
Sheets("feuil15").Range("b598") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil15").Range("c598") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'comptes bloqués des établissements et succursales
Sheets("feuil15").Range("b599") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil15").Range("c599") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1
'crédit bail immobilier
Sheets("feuil15").Range("b601") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'N
Sheets("feuil15").Range("c601") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'N-1
'crédit bail mobilier
Sheets("feuil15").Range("b602") = WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000")) 'N
Sheets("feuil15").Range("c602") = WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000")) 'N-1
'location vente
Sheets("feuil15").Range("b603") = WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000")) 'N
Sheets("feuil15").Range("c603") = WorksheetFunction.Sum(Sheets("feuil1").Range("af1:af5000")) 'N-1
'intérêts courus
Sheets("feuil15").Range("b604") = WorksheetFunction.Sum(Sheets("feuil2").Range("ag1:ag5000")) 'N
Sheets("feuil15").Range("c604") = WorksheetFunction.Sum(Sheets("feuil1").Range("ag1:ag5000")) 'N-1
'autres dettes de location acquisition
Sheets("feuil15").Range("b605") = WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000")) 'N
Sheets("feuil15").Range("c605") = WorksheetFunction.Sum(Sheets("feuil1").Range("ah1:ah5000")) 'N-1

'SUITE NOTE 16A
'provisions pour litiges
Sheets("feuil15").Range("b626") = WorksheetFunction.Sum(Sheets("feuil2").Range("ai1:ai5000")) 'N
Sheets("feuil15").Range("c626") = WorksheetFunction.Sum(Sheets("feuil1").Range("ai1:ai5000")) 'N-1
'provisions pour garantie donnée aux clients
Sheets("feuil15").Range("b627") = WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) 'N
Sheets("feuil15").Range("c627") = WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) 'N-1
'provisions pour pertes sur marché
Sheets("feuil15").Range("b628") = WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) 'N
Sheets("feuil15").Range("c628") = WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) 'N-1
'provisions pour pertes de change
Sheets("feuil15").Range("b629") = WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) 'N
Sheets("feuil15").Range("c629") = WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) 'N-1
'provisions pour impôts
Sheets("feuil15").Range("b630") = WorksheetFunction.Sum(Sheets("feuil2").Range("am1:am5000")) 'N
Sheets("feuil15").Range("c630") = WorksheetFunction.Sum(Sheets("feuil1").Range("am1:am5000")) 'N-1
'provisions pour pensions et obligations similaires
Sheets("feuil15").Range("b631") = WorksheetFunction.Sum(Sheets("feuil2").Range("an1:an5000")) 'N
Sheets("feuil15").Range("c631") = WorksheetFunction.Sum(Sheets("feuil1").Range("an1:an5000")) 'N-1
'provisions pour actif du régime de retraite
Sheets("feuil15").Range("b632") = WorksheetFunction.Sum(Sheets("feuil2").Range("ao1:ao5000")) 'N
Sheets("feuil15").Range("c632") = WorksheetFunction.Sum(Sheets("feuil1").Range("ao1:ao5000")) 'N-1
'provisions pour restructuration
Sheets("feuil15").Range("b633") = WorksheetFunction.Sum(Sheets("feuil2").Range("ap1:ap5000")) 'N
Sheets("feuil15").Range("c633") = WorksheetFunction.Sum(Sheets("feuil1").Range("ap1:ap5000")) 'N-1
'provisions pour amendes et penalités
Sheets("feuil15").Range("b634") = WorksheetFunction.Sum(Sheets("feuil2").Range("aq1:aq5000")) 'N
Sheets("feuil15").Range("c634") = WorksheetFunction.Sum(Sheets("feuil1").Range("aq1:aq5000")) 'N-1
'provisions de propre assureur
Sheets("feuil15").Range("b635") = WorksheetFunction.Sum(Sheets("feuil2").Range("ar1:ar5000")) 'N
Sheets("feuil15").Range("c635") = WorksheetFunction.Sum(Sheets("feuil1").Range("ar1:ar5000")) 'N-1
'provisions pour démantèlement
Sheets("feuil15").Range("b636") = WorksheetFunction.Sum(Sheets("feuil2").Range("as1:as5000")) 'N
Sheets("feuil15").Range("c636") = WorksheetFunction.Sum(Sheets("feuil1").Range("as1:as5000")) 'N-1
'provisions de droits à déductions
Sheets("feuil15").Range("b637") = WorksheetFunction.Sum(Sheets("feuil2").Range("at1:at5000")) 'N
Sheets("feuil15").Range("c637") = WorksheetFunction.Sum(Sheets("feuil1").Range("at1:at5000")) 'N-1
'autres provisions
Sheets("feuil15").Range("b638") = WorksheetFunction.Sum(Sheets("feuil2").Range("au1:au5000")) 'N
Sheets("feuil15").Range("c638") = WorksheetFunction.Sum(Sheets("feuil1").Range("au1:au5000")) 'N-1
'______________________________________________________________________________________
'Calculs du tableau

'total brut des emprunts et dettes financières
Sheets("feuil15").Range("b600") = WorksheetFunction.Sum(Sheets("feuil15").Range("b590:b599")) 'N
Sheets("feuil15").Range("c600") = WorksheetFunction.Sum(Sheets("feuil15").Range("c590:c599")) 'N-1

'total brut des dettes de location acquisition
Sheets("feuil15").Range("b606") = WorksheetFunction.Sum(Sheets("feuil15").Range("b601:b605")) 'N
Sheets("feuil15").Range("c606") = WorksheetFunction.Sum(Sheets("feuil15").Range("c601:c605")) 'N-1

'total brut des provisions pour risques et charges
Sheets("feuil15").Range("b639") = WorksheetFunction.Sum(Sheets("feuil15").Range("b626:b638")) 'N
Sheets("feuil15").Range("c639") = WorksheetFunction.Sum(Sheets("feuil15").Range("c626:c638")) 'N-1


'variation en %
For i = 590 To 606
If Sheets("feuil15").Cells(i, 3) = 0 Then
Else
If Sheets("feuil15").Cells(i, 3) < 0 Then
Sheets("feuil15").Cells(i, 5) = -1 * ((Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3))
Else
Sheets("feuil15").Cells(i, 5) = (Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3)
End If
End If
Next

'SUITE NOTE 16A
For i = 626 To 639
If Sheets("feuil15").Cells(i, 3) = 0 Then
Else
If Sheets("feuil15").Cells(i, 3) < 0 Then
Sheets("feuil15").Cells(i, 5) = -1 * ((Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3))
Else
Sheets("feuil15").Cells(i, 5) = (Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3)
End If
End If
Next


'variation en valeur abs()
For i = 590 To 606
Sheets("feuil15").Cells(i, 4) = Abs(Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3))
Next

'SUITE NOTE 16A
'variation en valeur abs()
For i = 626 To 639
Sheets("feuil15").Cells(i, 4) = Abs(Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3))
Next


'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub annuler_note_16A()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("b590:e606").ClearContents
Sheets("feuil15").Range("b626:e639").ClearContents
End If
End Sub
Private Sub note_17()
'condition générale de traitement de la NOTE 17
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 17
If Sheets("feuil5").Range("m37") + Sheets("feuil5").Range("n37") + Sheets("feuil5").Range("e38") + Sheets("feuil5").Range("ah38") = 0 Then
MsgBox "Désolé  !  Aucune dette fournisseur comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 17
'annule les données du tableau
Sheets("feuil15").Range("b806:d815").ClearContents

For i = 3 To 5000
'recup N
'compte 401 (sauf 4012) + 4041 + 4042
If Left(Sheets("feuil2").Cells(i, 1), 3) = 401 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4041 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4042 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4012 Then
Else
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 8) 'T
End If
Else
End If

'compte 402 (sauf 4022) + 4046 + 4047
If Left(Sheets("feuil2").Cells(i, 1), 3) = 402 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4046 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4047 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4022 Then
Else
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
End If
Else
End If

'compte 4012 + 4022
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4012 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4022 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
Else
End If

'compte 408 (sauf 4082)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 408 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4082 Then
Else
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
End If
Else
End If

'compte 4082
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4082 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
Else
End If

'compte 4091
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4091 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If

'compte 4092
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4092 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 7) 'Z
Else
End If

'compte 4093 + 4094 + 4098
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4093 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4094 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4098 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 7) 'AA
Else
End If



'recup N-1
'compte 401 (sauf 4012) + 4041 + 4042
If Left(Sheets("feuil1").Cells(i, 1), 3) = 401 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4041 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4042 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4012 Then
Else
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 8) 'T
End If
Else
End If

'compte 402 (sauf 4022) + 4046 + 4047
If Left(Sheets("feuil1").Cells(i, 1), 3) = 402 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4046 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4047 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4022 Then
Else
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'U
End If
Else
End If

'compte 4012 + 4022
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4012 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4022 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
Else
End If

'compte 408 (sauf 4082)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 408 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4082 Then
Else
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'W
End If
Else
End If

'compte 4082
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4082 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 8) 'X
Else
End If

'compte 4091
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4091 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

'compte 4092
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4092 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 7) 'Z
Else
End If

'compte 4093 + 4094 + 4098
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4093 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4094 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4098 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 7) 'AA
Else
End If

Next


'affectation dans le tableau
'fournisseurs dettes en compte hors groupe
Sheets("feuil15").Range("b806") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("c806") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'fournisseurs effets à payer hors groupe
Sheets("feuil15").Range("b807") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("c807") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'fournisseurs dettes et effets à payer groupe
Sheets("feuil15").Range("b808") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("c808") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'fournisseurs factures non parvenues hors groupe
Sheets("feuil15").Range("b809") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("c809") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'fournisseurs factures non parvenues groupe
Sheets("feuil15").Range("b810") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("c810") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'fournisseurs avances et acomptes hors groupe
Sheets("feuil15").Range("b812") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("c812") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'fournisseurs avances et acomptes groupe
Sheets("feuil15").Range("b813") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("c813") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'autres fournisseurs débiteurs
Sheets("feuil15").Range("b814") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("c814") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut fournisseurs
Sheets("feuil15").Range("b811") = WorksheetFunction.Sum(Sheets("feuil15").Range("b806:b810")) 'N
Sheets("feuil15").Range("c811") = WorksheetFunction.Sum(Sheets("feuil15").Range("c806:c810")) 'N-1

'total brut fournisseurs débiteurs
Sheets("feuil15").Range("b815") = WorksheetFunction.Sum(Sheets("feuil15").Range("b812:b814")) 'N
Sheets("feuil15").Range("c815") = WorksheetFunction.Sum(Sheets("feuil15").Range("c812:c814")) 'N-1

'variation en %
For i = 806 To 815
If Sheets("feuil15").Cells(i, 3) = 0 Then
Else
If Sheets("feuil15").Cells(i, 3) < 0 Then
Sheets("feuil15").Cells(i, 4) = -1 * ((Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3))
Else
Sheets("feuil15").Cells(i, 4) = (Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3)
End If
End If
Next
'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"

'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents

'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub annuler_note_17()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("b806:d815").ClearContents
End If
End Sub
Private Sub note_18()
'condition générale de traitement de la NOTE 18
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 18
If Sheets("feuil5").Range("m38") + Sheets("feuil5").Range("n38") = 0 Then
MsgBox "Désolé  !  Aucune dette fiscale et sociale comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 18
'annule les données du tableau
Sheets("feuil15").Range("b842:e855").ClearContents

For i = 3 To 5000
'recup N
'compte 421
If Left(Sheets("feuil2").Cells(i, 1), 3) = 421 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 8) 'T
Else
End If

'compte 422
If Left(Sheets("feuil2").Cells(i, 1), 3) = 422 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
Else
End If

'compte 42 (sauf 421 et 422)
If Left(Sheets("feuil2").Cells(i, 1), 2) = 42 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 421 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 422 Then
Else
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
End If
Else
End If

'compte 431
If Left(Sheets("feuil2").Cells(i, 1), 3) = 431 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
Else
End If

'compte 432
If Left(Sheets("feuil2").Cells(i, 1), 3) = 432 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
Else
End If

'compte 433 + 438
If Left(Sheets("feuil2").Cells(i, 1), 3) = 433 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 438 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 8) 'Y
Else
End If

'compte 441
If Left(Sheets("feuil2").Cells(i, 1), 3) = 441 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 8) 'Z
Else
End If

'compte 442
If Left(Sheets("feuil2").Cells(i, 1), 3) = 442 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 8) 'AA
Else
End If

'compte 443 + 444 + 445 + 446
If Left(Sheets("feuil2").Cells(i, 1), 3) = 443 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 444 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 445 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 446 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 8) 'AB
Else
End If

'compte 447
If Left(Sheets("feuil2").Cells(i, 1), 3) = 447 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 8) 'AC
Else
End If

'compte 448 + 449
If Left(Sheets("feuil2").Cells(i, 1), 3) = 448 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 449 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
Else
End If



'recup N-1
'compte 421
If Left(Sheets("feuil1").Cells(i, 1), 3) = 421 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 8) 'T
Else
End If

'compte 422
If Left(Sheets("feuil1").Cells(i, 1), 3) = 422 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'U
Else
End If

'compte 42 (sauf 421 et 422)
If Left(Sheets("feuil1").Cells(i, 1), 2) = 42 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 421 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 422 Then
Else
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
End If
Else
End If

'compte 431
If Left(Sheets("feuil1").Cells(i, 1), 3) = 431 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'W
Else
End If

'compte 432
If Left(Sheets("feuil1").Cells(i, 1), 3) = 432 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 8) 'X
Else
End If

'compte 433 + 438
If Left(Sheets("feuil1").Cells(i, 1), 3) = 433 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 438 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 8) 'Y
Else
End If

'compte 441
If Left(Sheets("feuil1").Cells(i, 1), 3) = 441 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 8) 'Z
Else
End If

'compte 442
If Left(Sheets("feuil1").Cells(i, 1), 3) = 442 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 8) 'AA
Else
End If

'compte 443 + 444 + 445 + 446
If Left(Sheets("feuil1").Cells(i, 1), 3) = 443 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 444 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 445 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 446 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 8) 'AB
Else
End If

'compte 447
If Left(Sheets("feuil1").Cells(i, 1), 3) = 447 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 8) 'AC
Else
End If

'compte 448 + 449
If Left(Sheets("feuil1").Cells(i, 1), 3) = 448 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 449 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'AD
Else
End If

Next


'affectation dans le tableau
'personnel avances et acomptes
Sheets("feuil15").Range("b842") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("c842") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'personnel rémunérations dues
Sheets("feuil15").Range("b843") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("c843") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'autres personnel
Sheets("feuil15").Range("b844") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("c844") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'sécurité sociale
Sheets("feuil15").Range("b845") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("c845") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'caisse de retraite
Sheets("feuil15").Range("b846") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("c846") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'autres organismes sociaux
Sheets("feuil15").Range("b847") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("c847") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'état impôt sur les bénéfices
Sheets("feuil15").Range("b849") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("c849") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'état impôts et taxes
Sheets("feuil15").Range("b850") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("c850") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'état TVA
Sheets("feuil15").Range("b851") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil15").Range("c851") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'état impôts retenus à la source
Sheets("feuil15").Range("b852") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil15").Range("c852") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1
'autres dettes état
Sheets("feuil15").Range("b853") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'N
Sheets("feuil15").Range("c853") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut des dettes sociales
Sheets("feuil15").Range("b848") = WorksheetFunction.Sum(Sheets("feuil15").Range("b842:b847")) 'N
Sheets("feuil15").Range("c848") = WorksheetFunction.Sum(Sheets("feuil15").Range("c842:c847")) 'N-1

'total brut des dettes fiscales
Sheets("feuil15").Range("b854") = WorksheetFunction.Sum(Sheets("feuil15").Range("b849:b853")) 'N
Sheets("feuil15").Range("c854") = WorksheetFunction.Sum(Sheets("feuil15").Range("c849:c853")) 'N-1

'total général
Sheets("feuil15").Range("b855") = Sheets("feuil15").Range("b848") + Sheets("feuil15").Range("b854") 'N
Sheets("feuil15").Range("c855") = Sheets("feuil15").Range("c848") + Sheets("feuil15").Range("c854") 'N-1


'variation en %
For i = 842 To 855
If Sheets("feuil15").Cells(i, 3) = 0 Then
Else
If Sheets("feuil15").Cells(i, 3) < 0 Then
Sheets("feuil15").Cells(i, 5) = -1 * ((Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3))
Else
Sheets("feuil15").Cells(i, 5) = (Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3)
End If
End If
Next


'variation en valeur abs()
For i = 842 To 855
Sheets("feuil15").Cells(i, 4) = Abs(Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3))
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_18()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("b842:e855").ClearContents
End If
End Sub
Private Sub note_19()
'condition générale de traitement de la NOTE 19
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 19
If Sheets("feuil5").Range("m39") + Sheets("feuil5").Range("n39") + Sheets("feuil5").Range("m40") + Sheets("feuil5").Range("n40") = 0 Then
MsgBox "Désolé  !  Aucune dette et provision pour risque à court terme comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 19
'annule les données du tableau
Sheets("feuil15").Range("b878:e901").ClearContents

For i = 3 To 5000
'recup N
'compte 45
If Left(Sheets("feuil2").Cells(i, 1), 2) = 45 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 8) 'T
Else
End If

'compte 461
If Left(Sheets("feuil2").Cells(i, 1), 3) = 461 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
Else
End If

'compte 462
If Left(Sheets("feuil2").Cells(i, 1), 3) = 462 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
Else
End If

'compte 465
If Left(Sheets("feuil2").Cells(i, 1), 3) = 465 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
Else
End If

'compte 466
If Left(Sheets("feuil2").Cells(i, 1), 3) = 466 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
Else
End If

'compte 463 + 467
If Left(Sheets("feuil2").Cells(i, 1), 3) = 463 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 467 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 8) 'Y
Else
End If

'compte 4712
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4712 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 8) 'Z
Else
End If

'compte 4713
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4713 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 8) 'AA
Else
End If

'compte 4715
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4715 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 8) 'AB
Else
End If

'compte 4716
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4716 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 8) 'AC
Else
End If

'compte 4726
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4726 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
Else
End If

'compte 4752
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4752 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 8) 'AE
Else
End If

'compte 47
If Left(Sheets("feuil2").Cells(i, 1), 2) = 47 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
Else
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4712 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4713 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4715 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4716 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4726 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4752 Then
Else
Sheets("feuil2").Cells(i, 32) = Sheets("feuil2").Cells(i, 8) 'AF
End If
End If
Else
End If

'compte 185
If Left(Sheets("feuil2").Cells(i, 1), 3) = 185 Then
Sheets("feuil2").Cells(i, 33) = Sheets("feuil2").Cells(i, 8) 'AG
Else
End If

'compte 186 + 187
If Left(Sheets("feuil2").Cells(i, 1), 3) = 186 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 187 Then
Sheets("feuil2").Cells(i, 34) = Sheets("feuil2").Cells(i, 8) 'AH
Else
End If


'compte 188
If Left(Sheets("feuil2").Cells(i, 1), 3) = 188 Then
Sheets("feuil2").Cells(i, 35) = Sheets("feuil2").Cells(i, 8) 'AI
Else
End If

'compte 499 + 599
If Left(Sheets("feuil2").Cells(i, 1), 3) = 499 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 599 Then
Sheets("feuil2").Cells(i, 36) = Sheets("feuil2").Cells(i, 8) 'AJ
Else
End If


'recup N-1
'compte 45
If Left(Sheets("feuil1").Cells(i, 1), 2) = 45 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 8) 'T
Else
End If

'compte 461
If Left(Sheets("feuil1").Cells(i, 1), 3) = 461 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'U
Else
End If

'compte 462
If Left(Sheets("feuil1").Cells(i, 1), 3) = 462 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
Else
End If

'compte 465
If Left(Sheets("feuil1").Cells(i, 1), 3) = 465 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'W
Else
End If

'compte 466
If Left(Sheets("feuil1").Cells(i, 1), 3) = 466 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 8) 'X
Else
End If

'compte 463 + 467
If Left(Sheets("feuil1").Cells(i, 1), 3) = 463 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 467 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 8) 'Y
Else
End If

'compte 4712
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4712 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 8) 'Z
Else
End If

'compte 4713
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4713 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 8) 'AA
Else
End If

'compte 4715
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4715 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 8) 'AB
Else
End If

'compte 4716
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4716 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 8) 'AC
Else
End If

'compte 4726
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4726 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'AD
Else
End If

'compte 4752
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4752 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 8) 'AE
Else
End If

'compte 47
If Left(Sheets("feuil1").Cells(i, 1), 2) = 47 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 478 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 479 Then
Else
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4712 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4713 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4715 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4716 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4726 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4752 Then
Else
Sheets("feuil1").Cells(i, 32) = Sheets("feuil1").Cells(i, 8) 'AF
End If
End If
Else
End If

'compte 185
If Left(Sheets("feuil1").Cells(i, 1), 3) = 185 Then
Sheets("feuil1").Cells(i, 33) = Sheets("feuil1").Cells(i, 8) 'AG
Else
End If

'compte 186 + 187
If Left(Sheets("feuil1").Cells(i, 1), 3) = 186 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 187 Then
Sheets("feuil1").Cells(i, 34) = Sheets("feuil1").Cells(i, 8) 'AH
Else
End If


'compte 188
If Left(Sheets("feuil1").Cells(i, 1), 3) = 188 Then
Sheets("feuil1").Cells(i, 35) = Sheets("feuil1").Cells(i, 8) 'AI
Else
End If

'compte 499 + 599
If Left(Sheets("feuil1").Cells(i, 1), 3) = 499 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 599 Then
Sheets("feuil1").Cells(i, 36) = Sheets("feuil1").Cells(i, 8) 'AJ
Else
End If

Next


'affectation dans le tableau
'organismes internationaux
Sheets("feuil15").Range("b878") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("c878") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'apporteurs opérations sur le capital
Sheets("feuil15").Range("b879") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("c879") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'associés compte courant
Sheets("feuil15").Range("b880") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("c880") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'associés dividendes à payer
Sheets("feuil15").Range("b881") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("c881") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'groupe compte courant
Sheets("feuil15").Range("b882") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("c882") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'autres dettes associés
Sheets("feuil15").Range("b883") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("c883") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'crèditeurs divers
Sheets("feuil15").Range("b885") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("c885") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'obligataires
Sheets("feuil15").Range("b886") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("c886") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'rémunérations d'administrateurs
Sheets("feuil15").Range("b887") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil15").Range("c887") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'compte du factor
Sheets("feuil15").Range("b888") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil15").Range("c888") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1
'versement restant sur titres de placement
Sheets("feuil15").Range("b890") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'N
Sheets("feuil15").Range("c890") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'N-1
'compte transitoire SYSCOHADA
Sheets("feuil15").Range("b892") = WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000")) 'N
Sheets("feuil15").Range("c892") = WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000")) 'N-1
'autres créditeurs divers
Sheets("feuil15").Range("b893") = WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000")) 'N
Sheets("feuil15").Range("c893") = WorksheetFunction.Sum(Sheets("feuil1").Range("af1:af5000")) 'N-1
'compte permanent non bloqué des établissements et succursales
Sheets("feuil15").Range("b896") = WorksheetFunction.Sum(Sheets("feuil2").Range("ag1:ag5000")) 'N
Sheets("feuil15").Range("c896") = WorksheetFunction.Sum(Sheets("feuil1").Range("ag1:ag5000")) 'N-1
'comptes de liaison charges et produits
Sheets("feuil15").Range("b897") = WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000")) 'N
Sheets("feuil15").Range("c897") = WorksheetFunction.Sum(Sheets("feuil1").Range("ah1:ah5000")) 'N-1
'comptes de liaison des sociétés en participation
Sheets("feuil15").Range("b898") = WorksheetFunction.Sum(Sheets("feuil2").Range("ai1:ai5000")) 'N
Sheets("feuil15").Range("c898") = WorksheetFunction.Sum(Sheets("feuil1").Range("ai1:ai5000")) 'N-1
'provisions pour risques à court terme
Sheets("feuil15").Range("b901") = WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) 'N
Sheets("feuil15").Range("c901") = WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut dettes associés
Sheets("feuil15").Range("b884") = WorksheetFunction.Sum(Sheets("feuil15").Range("b878:b883")) 'N
Sheets("feuil15").Range("c884") = WorksheetFunction.Sum(Sheets("feuil15").Range("c878:c883")) 'N-1

'total brut des créditeurs divers
Sheets("feuil15").Range("b894") = WorksheetFunction.Sum(Sheets("feuil15").Range("b885:b893")) 'N
Sheets("feuil15").Range("c894") = WorksheetFunction.Sum(Sheets("feuil15").Range("c885:c893")) 'N-1

'total brut des comptes de liaison
Sheets("feuil15").Range("b899") = WorksheetFunction.Sum(Sheets("feuil15").Range("b895:b898")) 'N
Sheets("feuil15").Range("c899") = WorksheetFunction.Sum(Sheets("feuil15").Range("c898:c898")) 'N-1

'total général autres dettes
Sheets("feuil15").Range("b900") = Sheets("feuil15").Range("b884") + Sheets("feuil15").Range("b894") + Sheets("feuil15").Range("b899") 'N
Sheets("feuil15").Range("c900") = Sheets("feuil15").Range("c884") + Sheets("feuil15").Range("c894") + Sheets("feuil15").Range("c899") 'N-1


'variation en %
For i = 878 To 901
If Sheets("feuil15").Cells(i, 3) = 0 Then
Else
If Sheets("feuil15").Cells(i, 3) < 0 Then
Sheets("feuil15").Cells(i, 5) = -1 * ((Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3))
Else
Sheets("feuil15").Cells(i, 5) = (Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3)) / Sheets("feuil15").Cells(i, 3)
End If
End If
Next

'variation en valeur abs()
For i = 878 To 901
Sheets("feuil15").Cells(i, 4) = Abs(Sheets("feuil15").Cells(i, 2) - Sheets("feuil15").Cells(i, 3))
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub annuler_note_19()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("b878:e901").ClearContents
End If
End Sub
Private Sub note_20()
'condition générale de traitement de la NOTE 20
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 20
If Sheets("feuil5").Range("m43") + Sheets("feuil5").Range("n43") + Sheets("feuil5").Range("m44") + Sheets("feuil5").Range("n44") = 0 Then
MsgBox "Désolé  !  Aucune banque au crédit comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 20
'annule les données du tableau
Sheets("feuil15").Range("e913:g922").ClearContents

For i = 3 To 5000
'recup N
'compte 564
If Left(Sheets("feuil2").Cells(i, 1), 3) = 564 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 8) 'T
Else
End If

'compte 565
If Left(Sheets("feuil2").Cells(i, 1), 3) = 565 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
Else
End If

'compte 521
If Left(Sheets("feuil2").Cells(i, 1), 3) = 521 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
Else
End If

'compte 522
If Left(Sheets("feuil2").Cells(i, 1), 3) = 522 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
Else
End If

'compte 52 (sauf 521 + 522 + 526) + 53 + 54
If Left(Sheets("feuil2").Cells(i, 1), 2) = 52 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 53 Or Left(Sheets("feuil2").Cells(i, 1), 2) = 54 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 521 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 522 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 526 Then
Else
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
End If
Else
End If

'compte 526
If Left(Sheets("feuil2").Cells(i, 1), 3) = 526 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 8) 'Y
Else
End If

'compte 561
If Left(Sheets("feuil2").Cells(i, 1), 3) = 561 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 8) 'Z
Else
End If


'recup N-1
'compte 564
If Left(Sheets("feuil1").Cells(i, 1), 3) = 564 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 8) 'T
Else
End If

'compte 565
If Left(Sheets("feuil1").Cells(i, 1), 3) = 565 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'U
Else
End If

'compte 521
If Left(Sheets("feuil1").Cells(i, 1), 3) = 521 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
Else
End If

'compte 522
If Left(Sheets("feuil1").Cells(i, 1), 3) = 522 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'W
Else
End If

'compte 52 (sauf 521 + 522 + 526) + 53 + 54
If Left(Sheets("feuil1").Cells(i, 1), 2) = 52 Or Left(Sheets("feuil1").Cells(i, 1), 2) = 53 Or Left(Sheets("feuil1").Cells(i, 1), 2) = 54 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 521 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 522 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 526 Then
Else
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 8) 'X
End If
Else
End If

'compte 526
If Left(Sheets("feuil1").Cells(i, 1), 3) = 526 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 8) 'Y
Else
End If

'compte 561
If Left(Sheets("feuil1").Cells(i, 1), 3) = 561 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 8) 'Z
Else
End If



Next


'affectation dans le tableau
'escomptes de crédit de campagne
Sheets("feuil15").Range("e913") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f913") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'escomptes de crédit ordinaire
Sheets("feuil15").Range("e914") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f914") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'banques locales
Sheets("feuil15").Range("e916") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f916") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'banques autres régions
Sheets("feuil15").Range("e917") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f917") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'autres banques
Sheets("feuil15").Range("e918") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f918") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'banques intérêts courus
Sheets("feuil15").Range("e919") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("f919") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'crédits de trésorerie
Sheets("feuil15").Range("e920") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("f920") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut des crédits d'escomptes
Sheets("feuil15").Range("e915") = WorksheetFunction.Sum(Sheets("feuil15").Range("e913:e914")) 'N
Sheets("feuil15").Range("f915") = WorksheetFunction.Sum(Sheets("feuil15").Range("f913:f914")) 'N-1

'total brut des crédits de trésorerie
Sheets("feuil15").Range("e921") = WorksheetFunction.Sum(Sheets("feuil15").Range("e916:e920")) 'N
Sheets("feuil15").Range("f921") = WorksheetFunction.Sum(Sheets("feuil15").Range("f916:f920")) 'N-1

'total général
Sheets("feuil15").Range("e922") = Sheets("feuil15").Range("e915") + Sheets("feuil15").Range("e921") 'N
Sheets("feuil15").Range("f922") = Sheets("feuil15").Range("f915") + Sheets("feuil15").Range("f921") 'N-1


'variation en % stocks
For i = 913 To 922
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_20()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e913:g922").ClearContents
End If
End Sub
Private Sub note_21()
'condition générale de traitement de la NOTE 21
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 21
If Sheets("feuil6").Range("i20") + Sheets("feuil6").Range("i22") + Sheets("feuil6").Range("i23") + Sheets("feuil6").Range("i24") + Sheets("feuil6").Range("j20") + Sheets("feuil6").Range("j22") + Sheets("feuil6").Range("j23") + Sheets("feuil6").Range("j24") = 0 Then
MsgBox "Désolé  !  Aucun chiffre d'affaires et autre produit comptabilisé."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 21
'annule les données du tableau
Sheets("feuil15").Range("e949:g970").ClearContents

For i = 3 To 5000
'recup N
'compte 7011
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7011 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 8) 'T
Else
End If

'compte 7012
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7012 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
Else
End If

'compte 7013 + 7014
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7013 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7014 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
Else
End If

'compte 7015
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7015 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
Else
End If

'compte 7021 + 7031 + 7041
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7021 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7031 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7041 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
Else
End If

'compte 7022 + 7032 + 7042
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7022 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7032 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7042 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 8) 'Y
Else
End If

'compte 7023 + 7024 + 7033 + 7034 + 7043 + 7044
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7023 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7024 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7033 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7034 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7043 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7044 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 8) 'Z
Else
End If

'compte 7025 + 7035 + 7045
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7025 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7035 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7045 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 8) 'AA
Else
End If

'compte 7051 + 7061
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7051 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7061 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 8) 'AB
Else
End If

'compte 7052 + 7062
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7052 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7062 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 8) 'AC
Else
End If

'compte 7053 + 7054 + 7063 + 7064
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7053 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7054 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7063 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7064 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
Else
End If

'compte 7055 + 7065
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7055 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7065 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 8) 'AE
Else
End If

'compte 707
If Left(Sheets("feuil2").Cells(i, 1), 3) = 707 Then
Sheets("feuil2").Cells(i, 32) = Sheets("feuil2").Cells(i, 8) 'AF
Else
End If

'compte 72
If Left(Sheets("feuil2").Cells(i, 1), 2) = 72 Then
Sheets("feuil2").Cells(i, 33) = Sheets("feuil2").Cells(i, 8) 'AG
Else
End If

'compte 71
If Left(Sheets("feuil2").Cells(i, 1), 2) = 71 Then
Sheets("feuil2").Cells(i, 34) = Sheets("feuil2").Cells(i, 8) 'AH
Else
End If

'compte 75
If Left(Sheets("feuil2").Cells(i, 1), 2) = 75 Then
Sheets("feuil2").Cells(i, 35) = Sheets("feuil2").Cells(i, 8) 'AI
Else
End If

'compte 7019
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7019 Then
Sheets("feuil2").Cells(i, 36) = Sheets("feuil2").Cells(i, 7) 'AJ
Else
End If

'compte 7029 + 7039 + 7049
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7029 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7039 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7049 Then
Sheets("feuil2").Cells(i, 37) = Sheets("feuil2").Cells(i, 7) 'AK
Else
End If

'compte 7059 + 7069
If Left(Sheets("feuil2").Cells(i, 1), 4) = 7059 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 7069 Then
Sheets("feuil2").Cells(i, 38) = Sheets("feuil2").Cells(i, 7) 'AL
Else
End If


'recup N-1
'compte 7011
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7011 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 8) 'T
Else
End If

'compte 7012
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7012 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'U
Else
End If

'compte 7013 + 7014
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7013 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7014 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
Else
End If

'compte 7015
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7015 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'W
Else
End If

'compte 7021 + 7031 + 7041
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7021 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7031 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7041 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 8) 'X
Else
End If

'compte 7022 + 7032 + 7042
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7022 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7032 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7042 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 8) 'Y
Else
End If

'compte 7023 + 7024 + 7033 + 7034 + 7043 + 7044
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7023 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7024 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7033 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7034 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7043 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7044 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 8) 'Z
Else
End If

'compte 7025 + 7035 + 7045
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7025 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7035 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7045 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 8) 'AA
Else
End If

'compte 7051 + 7061
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7051 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7061 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 8) 'AB
Else
End If

'compte 7052 + 7062
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7052 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7062 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 8) 'AC
Else
End If

'compte 7053 + 7054 + 7063 + 7064
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7053 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7054 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7063 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7064 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'AD
Else
End If

'compte 7055 + 7065
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7055 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7065 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 8) 'AE
Else
End If

'compte 707
If Left(Sheets("feuil1").Cells(i, 1), 3) = 707 Then
Sheets("feuil1").Cells(i, 32) = Sheets("feuil1").Cells(i, 8) 'AF
Else
End If

'compte 72
If Left(Sheets("feuil1").Cells(i, 1), 2) = 72 Then
Sheets("feuil1").Cells(i, 33) = Sheets("feuil1").Cells(i, 8) 'AG
Else
End If

'compte 71
If Left(Sheets("feuil1").Cells(i, 1), 2) = 71 Then
Sheets("feuil1").Cells(i, 34) = Sheets("feuil1").Cells(i, 8) 'AH
Else
End If

'compte 75
If Left(Sheets("feuil1").Cells(i, 1), 2) = 75 Then
Sheets("feuil1").Cells(i, 35) = Sheets("feuil1").Cells(i, 8) 'AI
Else
End If

'compte 7019
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7019 Then
Sheets("feuil1").Cells(i, 36) = Sheets("feuil1").Cells(i, 7) 'AJ
Else
End If

'compte 7029 + 7039 + 7049
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7029 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7039 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7049 Then
Sheets("feuil1").Cells(i, 37) = Sheets("feuil1").Cells(i, 7) 'AK
Else
End If

'compte 7059 + 7069
If Left(Sheets("feuil1").Cells(i, 1), 4) = 7059 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 7069 Then
Sheets("feuil1").Cells(i, 38) = Sheets("feuil1").Cells(i, 7) 'AL
Else
End If


Next


'affectation dans le tableau
'ventes de marchandises dans la région
Sheets("feuil15").Range("e949") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f949") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'ventes de marchandises hors région
Sheets("feuil15").Range("e950") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f950") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'ventes de marchandises groupe
Sheets("feuil15").Range("e951") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f951") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'ventes de marchandises sur internet
Sheets("feuil15").Range("e952") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f952") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'ventes de produits fabriqués dans la région
Sheets("feuil15").Range("e954") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f954") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'ventes de produits fabriqués hors région
Sheets("feuil15").Range("e955") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("f955") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'ventes de produits fabriqués groupe
Sheets("feuil15").Range("e956") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("f956") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'ventes de produits fabriqués sur internet
Sheets("feuil15").Range("e957") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("f957") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'ventes de travaux et services dans la région
Sheets("feuil15").Range("e959") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil15").Range("f959") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'ventes de travaux et services hors région
Sheets("feuil15").Range("e960") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil15").Range("f960") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1
'ventes de travaux et services groupe
Sheets("feuil15").Range("e961") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'N
Sheets("feuil15").Range("f961") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'N-1
'ventes de travaux et services sur internet
Sheets("feuil15").Range("e962") = WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000")) 'N
Sheets("feuil15").Range("f962") = WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000")) 'N-1
'produits accessoires
Sheets("feuil15").Range("e964") = WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000")) 'N
Sheets("feuil15").Range("f964") = WorksheetFunction.Sum(Sheets("feuil1").Range("af1:af5000")) 'N-1
'production immobilisée
Sheets("feuil15").Range("e966") = WorksheetFunction.Sum(Sheets("feuil2").Range("ag1:ag5000")) 'N
Sheets("feuil15").Range("f966") = WorksheetFunction.Sum(Sheets("feuil1").Range("ag1:ag5000")) 'N-1
'subvention d'exploitation
Sheets("feuil15").Range("e967") = WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000")) 'N
Sheets("feuil15").Range("f967") = WorksheetFunction.Sum(Sheets("feuil1").Range("ah1:ah5000")) 'N-1
'autres produits
Sheets("feuil15").Range("e968") = WorksheetFunction.Sum(Sheets("feuil2").Range("ai1:ai5000")) 'N
Sheets("feuil15").Range("f968") = WorksheetFunction.Sum(Sheets("feuil1").Range("ai1:ai5000")) 'N-1

'________________________________________________________________________________________________________

'affetation des rabais, remises, ristournes sur les ventes de marchandises N
If WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) > 0 Then
'Insérer le montant des R,R,R sur les ventes de marchandises dans la région N
    Dim resultat1 As Variant
    resultat1 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes dans la région :", "RRR accordés")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat1 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e949") = Sheets("feuil15").Range("e949") - resultat1 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat1 = 0
    End If
'Insérer le montant des R,R,R sur les ventes de marchandises hors région N
If WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) - resultat1 > 0 Then
    Dim resultat2 As Variant
    resultat2 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes hors région :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat2 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e950") = Sheets("feuil15").Range("e950") - resultat2 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat2 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les ventes de marchandises groupe N
If WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) - resultat1 - resultat2 > 0 Then
    Dim resultat3 As Variant
    resultat3 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes groupe :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat3 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e951") = Sheets("feuil15").Range("e951") - resultat3 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat3 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les ventes de marchandises sur internet N
If WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) - resultat1 - resultat2 - resultat3 > 0 Then
    Dim resultat4 As Variant
    resultat4 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes sur internet :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat4 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e952") = Sheets("feuil15").Range("e952") - resultat4 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat4 = 0
    End If
Else
End If
'message de contrôle du montant total des R,R,R sur les ventes de marchandises N reparti
If WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) - resultat1 - resultat2 - resultat3 - resultat4 = 0 Then
Else
MsgBox "Exercice N" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) - resultat1 - resultat2 - resultat3 - resultat4) & "  entre le montant des rabais, remises et ristournes sur les ventes de marchandises accordés comptabilisé et le total des quotes-parts affectées."
End If
'affetation des rabais, remises, ristournes sur marchandises N
Else
End If

'affetation des rabais, remises, ristournes sur les ventes de marchandises N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) > 0 Then
'Insérer le montant des R,R,R sur les ventes de marchandises dans la région N-1
    Dim resultat11 As Variant
    resultat11 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes dans la région :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat11 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f949") = Sheets("feuil15").Range("f949") - resultat11 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat11 = 0
    End If
'Insérer le montant des R,R,R sur les ventes de marchandises hors région N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) - resultat11 > 0 Then
    Dim resultat12 As Variant
    resultat12 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes hors région :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat12 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f950") = Sheets("feuil15").Range("f950") - resultat12 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat12 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les ventes de marchandises groupe N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) - resultat11 - resultat12 > 0 Then
    Dim resultat13 As Variant
    resultat13 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes groupe :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat13 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f951") = Sheets("feuil15").Range("f951") - resultat13 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat13 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les ventes de marchandises sur internet N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) - resultat11 - resultat12 - resultat13 > 0 Then
    Dim resultat14 As Variant
    resultat14 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes sur internet :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat14 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f952") = Sheets("feuil15").Range("f952") - resultat14 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat14 = 0
    End If
Else
End If
'message de contrôle du montant total des R,R,R sur les ventes de marchandises N-1 reparti
If WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) - resultat11 - resultat12 - resultat13 - resultat14 = 0 Then
Else
MsgBox "Exercice N-1" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) - resultat11 - resultat12 - resultat13 - resultat14) & "  entre le montant des rabais, remises et ristournes sur les ventes de marchandises accordés comptabilisé et le total des quotes-parts affectées."
End If
'affetation des rabais, remises, ristournes sur marchandises N-1
Else
End If





'affetation des rabais, remises, ristournes sur les ventes de prodduits fabriqués N
If WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) > 0 Then
'Insérer le montant des R,R,R sur les ventes de produits fabriqués dans la région N
    Dim resultat21 As Variant
    resultat21 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de produits fabriqués s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes dans la région :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat21 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e954") = Sheets("feuil15").Range("e954") - resultat21 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat21 = 0
    End If
'Insérer le montant des R,R,R sur les ventes de produits fabriqués hors région N
If WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) - resultat21 > 0 Then
    Dim resultat22 As Variant
    resultat22 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de produits fabriqués s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes hors région :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat22 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e955") = Sheets("feuil15").Range("e955") - resultat22 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat22 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les ventes de produits fabriqués groupe N
If WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) - resultat21 - resultat22 > 0 Then
    Dim resultat23 As Variant
    resultat23 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de produits fabriqués s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes groupe :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat23 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e956") = Sheets("feuil15").Range("e956") - resultat23 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat23 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les ventes de produits fabriqués sur internet N
If WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) - resultat21 - resultat22 - resultat23 > 0 Then
    Dim resultat24 As Variant
    resultat24 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de produits fabriqués s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes sur internet :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat24 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e957") = Sheets("feuil15").Range("e957") - resultat24 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat24 = 0
    End If
Else
End If
'message de contrôle du montant total des R,R,R sur les ventes de produits fabriqués N reparti
If WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) - resultat21 - resultat22 - resultat23 - resultat24 = 0 Then
Else
MsgBox "Exercice N" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) - resultat21 - resultat22 - resultat23 - resultat24) & "  entre le montant des rabais, remises et ristournes sur les ventes de produits fabriqués accordés comptabilisé et le total des quotes-parts affectées."
End If
'affetation des rabais, remises, ristournes sur produits fabriqués N
Else
End If

'affetation des rabais, remises, ristournes sur les ventes de produits fabriqués N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) > 0 Then
'Insérer le montant des R,R,R sur les ventes de produits fabriqués dans la région N-1
    Dim resultat31 As Variant
    resultat31 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de produits fabriqués s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes dans la région :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat31 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f954") = Sheets("feuil15").Range("f954") - resultat31 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat31 = 0
    End If
'Insérer le montant des R,R,R sur les ventes de produits fabriqués hors région N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) - resultat31 > 0 Then
    Dim resultat32 As Variant
    resultat32 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de produits fabriqués s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes hors région :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat32 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f955") = Sheets("feuil15").Range("f955") - resultat32 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat32 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les ventes de produits fabriqués groupe N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) - resultat31 - resultat32 > 0 Then
    Dim resultat33 As Variant
    resultat33 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de produits fabriqués s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes groupe :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat33 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f956") = Sheets("feuil15").Range("f956") - resultat33 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat33 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les ventes de produits fabriqués sur internet N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) - resultat31 - resultat32 - resultat33 > 0 Then
    Dim resultat34 As Variant
    resultat34 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de produits fabriqués s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes sur internet :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat34 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f957") = Sheets("feuil15").Range("f957") - resultat34 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat34 = 0
    End If
Else
End If
'message de contrôle du montant total des R,R,R sur les ventes de produits fabriqués N-1 reparti
If WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) - resultat31 - resultat32 - resultat33 - resultat34 = 0 Then
Else
MsgBox "Exercice N-1" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) - resultat31 - resultat32 - resultat33 - resultat34) & "  entre le montant des rabais, remises et ristournes sur les ventes de produits fabriqués accordés comptabilisé et le total des quotes-parts affectées."
End If
'affetation des rabais, remises, ristournes sur produits fabriqués N-1
Else
End If




'affetation des rabais, remises, ristournes sur les ventes de travaux et services N
If WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) > 0 Then
'Insérer le montant des R,R,R sur les ventes de travaux et services dans la région N
    Dim resultat41 As Variant
    resultat41 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de travaux et services s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes dans la région :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat41 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e959") = Sheets("feuil15").Range("e959") - resultat41 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat41 = 0
    End If
'Insérer le montant des R,R,R sur les ventes de travaux et services hors région N
If WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) - resultat41 > 0 Then
    Dim resultat42 As Variant
    resultat42 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de travaux et services s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes hors région :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat42 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e960") = Sheets("feuil15").Range("e960") - resultat42 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat42 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les ventes de travaux et services groupe N
If WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) - resultat41 - resultat42 > 0 Then
    Dim resultat43 As Variant
    resultat43 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de travaux et services s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes groupe :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat43 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e961") = Sheets("feuil15").Range("e961") - resultat43 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat43 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les ventes de travaux et services sur internet N
If WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) - resultat41 - resultat42 - resultat43 > 0 Then
    Dim resultat44 As Variant
    resultat44 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de travaux et services s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes sur internet :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat44 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e962") = Sheets("feuil15").Range("e962") - resultat44 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat44 = 0
    End If
Else
End If
'message de contrôle du montant total des R,R,R sur les ventes de travaux et services N reparti
If WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) - resultat41 - resultat42 - resultat43 - resultat44 = 0 Then
Else
MsgBox "Exercice N" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) - resultat41 - resultat42 - resultat43 - resultat44) & "  entre le montant des rabais, remises et ristournes sur les ventes de travaux et services accordés comptabilisé et le total des quotes-parts affectées."
End If
'affetation des rabais, remises, ristournes sur produits fabriqués N
Else
End If

'affetation des rabais, remises, ristournes sur les ventes de travaux et services N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) > 0 Then
'Insérer le montant des R,R,R sur les ventes de travaux et services dans la région N-1
    Dim resultat51 As Variant
    resultat51 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de travaux et services s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes dans la région :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat51 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f959") = Sheets("feuil15").Range("f959") - resultat51 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat51 = 0
    End If
'Insérer le montant des R,R,R sur les ventes de travaux et services hors région N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) - resultat51 > 0 Then
    Dim resultat52 As Variant
    resultat52 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de travaux et services s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes hors région :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat52 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f960") = Sheets("feuil15").Range("f960") - resultat52 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat52 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les ventes de travaux et services groupe N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) - resultat51 - resultat52 > 0 Then
    Dim resultat53 As Variant
    resultat53 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de travaux et services s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes groupe :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat53 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f961") = Sheets("feuil15").Range("f961") - resultat53 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat53 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les ventes de travaux et services sur internet N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) - resultat51 - resultat52 - resultat53 > 0 Then
    Dim resultat54 As Variant
    resultat54 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes accordés sur les ventes de travaux et services s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes accordés sur les ventes sur internet :", "RRR accordés") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat54 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f962") = Sheets("feuil15").Range("f962") - resultat54 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat54 = 0
    End If
Else
End If
'message de contrôle du montant total des R,R,R sur les ventes de travaux et services N-1 reparti
If WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) - resultat51 - resultat52 - resultat53 - resultat54 = 0 Then
Else
MsgBox "Exercice N-1" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) - resultat51 - resultat52 - resultat53 - resultat54) & "  entre le montant des rabais, remises et ristournes sur les ventes de travaux et services accordés comptabilisé et le total des quotes-parts affectées."
End If
'affetation des rabais, remises, ristournes sur travaux et services N-1
Else
End If

'______________________________________________________________________________________

'Calculs du tableau

'total brut des ventes de marchandises
Sheets("feuil15").Range("e953") = WorksheetFunction.Sum(Sheets("feuil15").Range("e949:e952")) 'N
Sheets("feuil15").Range("f953") = WorksheetFunction.Sum(Sheets("feuil15").Range("f949:f952")) 'N-1

'total brut des ventes de produits fabriqués
Sheets("feuil15").Range("e958") = WorksheetFunction.Sum(Sheets("feuil15").Range("e954:e957")) 'N
Sheets("feuil15").Range("f958") = WorksheetFunction.Sum(Sheets("feuil15").Range("f954:f957")) 'N-1

'total brut des travaux et services
Sheets("feuil15").Range("e963") = WorksheetFunction.Sum(Sheets("feuil15").Range("e959:e962")) 'N
Sheets("feuil15").Range("f963") = WorksheetFunction.Sum(Sheets("feuil15").Range("f959:f962")) 'N-1

'total chiffre d'affaires
Sheets("feuil15").Range("e965") = Sheets("feuil15").Range("e953") + Sheets("feuil15").Range("e958") + Sheets("feuil15").Range("e963") + Sheets("feuil15").Range("e964") 'N
Sheets("feuil15").Range("f965") = Sheets("feuil15").Range("f953") + Sheets("feuil15").Range("f958") + Sheets("feuil15").Range("f963") + Sheets("feuil15").Range("f964") 'N-1

'total brut des autres produits
Sheets("feuil15").Range("e969") = WorksheetFunction.Sum(Sheets("feuil15").Range("e966:e968")) 'N
Sheets("feuil15").Range("f969") = WorksheetFunction.Sum(Sheets("feuil15").Range("f966:f968")) 'N-1

'total général
Sheets("feuil15").Range("e970") = Sheets("feuil15").Range("e965") + Sheets("feuil15").Range("e969") 'N
Sheets("feuil15").Range("f970") = Sheets("feuil15").Range("f965") + Sheets("feuil15").Range("f969") 'N-1


'variation en % stocks
For i = 949 To 970
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_21()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e949:g970").ClearContents
End If
End Sub
Private Sub note_22()
'condition générale de traitement de la NOTE 22
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 22
If Sheets("feuil6").Range("i14") + Sheets("feuil6").Range("i26") + Sheets("feuil6").Range("i28") + Sheets("feuil6").Range("j14") + Sheets("feuil6").Range("j26") + Sheets("feuil6").Range("j28") = 0 Then
MsgBox "Désolé  !  Aucun achat comptabilisé."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 22
'annule les données du tableau
Sheets("feuil15").Range("e985:g1007").ClearContents

For i = 3 To 5000
'recup N
'compte 6011
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6011 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 6012
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6012 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 6013 + 6014
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6013 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6014 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 6021
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6021 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 6022
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6022 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 6023 + 6024
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6023 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6024 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If

'compte 6041
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6041 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 7) 'Z
Else
End If

'compte 6042
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6042 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 7) 'AA
Else
End If

'compte 6043
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6043 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 7) 'AB
Else
End If

'compte 6044 + 6046
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6044 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6046 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 7) 'AC
Else
End If

'compte 6051
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6051 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 7) 'AD
Else
End If

'compte 6052
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6052 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 7) 'AE
Else
End If

'compte 6053
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6053 Then
Sheets("feuil2").Cells(i, 32) = Sheets("feuil2").Cells(i, 7) 'AF
Else
End If

'compte 6054
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6054 Then
Sheets("feuil2").Cells(i, 33) = Sheets("feuil2").Cells(i, 7) 'AG
Else
End If

'compte 6047 + 6055
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6047 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6055 Then
Sheets("feuil2").Cells(i, 34) = Sheets("feuil2").Cells(i, 7) 'AH
Else
End If

'compte 6056
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6056 Then
Sheets("feuil2").Cells(i, 35) = Sheets("feuil2").Cells(i, 7) 'AI
Else
End If

'compte 6057 + 6058
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6057 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6058 Then
Sheets("feuil2").Cells(i, 36) = Sheets("feuil2").Cells(i, 7) 'AJ
Else
End If

'compte 608 (sauf 6085 et 6089)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 608 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6085 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6089 Then
Else
Sheets("feuil2").Cells(i, 37) = Sheets("feuil2").Cells(i, 7) 'AK
End If
Else
End If

'compte 6045 + 6085
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6045 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6085 Then
Sheets("feuil2").Cells(i, 38) = Sheets("feuil2").Cells(i, 7) 'AL
Else
End If

'compte 6049 + 6059 + 6089
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6049 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6059 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6089 Then
Sheets("feuil2").Cells(i, 39) = Sheets("feuil2").Cells(i, 8) 'AM
Else
End If

'compte 6019
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6019 Then
Sheets("feuil2").Cells(i, 40) = Sheets("feuil2").Cells(i, 8) 'AN
Else
End If

'compte 6029
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6029 Then
Sheets("feuil2").Cells(i, 41) = Sheets("feuil2").Cells(i, 8) 'AO
Else
End If

'compte 6015
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6015 Then
Sheets("feuil2").Cells(i, 42) = Sheets("feuil2").Cells(i, 7) 'AP
Else
End If

'compte 6025
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6025 Then
Sheets("feuil2").Cells(i, 43) = Sheets("feuil2").Cells(i, 7) 'AQ
Else
End If


'recup N-1
'compte 6011
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6011 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 6012
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6012 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 6013 + 6014
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6013 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 6014 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 6021
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6021 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 6022
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6022 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'compte 6023 + 6024
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6023 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 6024 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

'compte 6041
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6041 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 7) 'Z
Else
End If

'compte 6042
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6042 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 7) 'AA
Else
End If

'compte 6043
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6043 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 7) 'AB
Else
End If

'compte 6044 + 6046
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6044 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 6046 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 7) 'AC
Else
End If

'compte 6051
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6051 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 7) 'AD
Else
End If

'compte 6052
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6052 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 7) 'AE
Else
End If

'compte 6053
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6053 Then
Sheets("feuil1").Cells(i, 32) = Sheets("feuil1").Cells(i, 7) 'AF
Else
End If

'compte 6054
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6054 Then
Sheets("feuil1").Cells(i, 33) = Sheets("feuil1").Cells(i, 7) 'AG
Else
End If

'compte 6047 + 6055
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6047 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 6055 Then
Sheets("feuil1").Cells(i, 34) = Sheets("feuil1").Cells(i, 7) 'AH
Else
End If

'compte 6056
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6056 Then
Sheets("feuil1").Cells(i, 35) = Sheets("feuil1").Cells(i, 7) 'AI
Else
End If

'compte 6057 + 6058
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6057 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 6058 Then
Sheets("feuil1").Cells(i, 36) = Sheets("feuil1").Cells(i, 7) 'AJ
Else
End If

'compte 608 (sauf 6085 et 6089)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 608 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6085 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 6089 Then
Else
Sheets("feuil1").Cells(i, 37) = Sheets("feuil1").Cells(i, 7) 'AK
End If
Else
End If

'compte 6045 + 6085
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6045 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 6085 Then
Sheets("feuil1").Cells(i, 38) = Sheets("feuil1").Cells(i, 7) 'AL
Else
End If

'compte 6049 + 6059 + 6089
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6049 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 6059 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 6089 Then
Sheets("feuil1").Cells(i, 39) = Sheets("feuil1").Cells(i, 8) 'AM
Else
End If

'compte 6019
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6019 Then
Sheets("feuil1").Cells(i, 40) = Sheets("feuil1").Cells(i, 8) 'AN
Else
End If

'compte 6029
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6029 Then
Sheets("feuil1").Cells(i, 41) = Sheets("feuil1").Cells(i, 8) 'AO
Else
End If

'compte 6015
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6015 Then
Sheets("feuil1").Cells(i, 42) = Sheets("feuil1").Cells(i, 7) 'AP
Else
End If

'compte 6025
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6025 Then
Sheets("feuil1").Cells(i, 43) = Sheets("feuil1").Cells(i, 7) 'AQ
Else
End If

Next


'affectation dans le tableau
'achats de marchandises dans la région
Sheets("feuil15").Range("e985") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f985") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'achats de marchandises hors région
Sheets("feuil15").Range("e986") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f986") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'achats de marchandises groupe
Sheets("feuil15").Range("e987") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f987") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'achats de matières premières dans la région
Sheets("feuil15").Range("e989") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f989") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'achats de matières premières hors région
Sheets("feuil15").Range("e990") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f990") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'achats de matières premières groupe
Sheets("feuil15").Range("e991") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("f991") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'matières consommables
Sheets("feuil15").Range("e993") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("f993") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'matières combustibles
Sheets("feuil15").Range("e994") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("f994") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'produits d'entretien
Sheets("feuil15").Range("e995") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil15").Range("f995") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'fournitures d'atélier, d'usine et de magasin
Sheets("feuil15").Range("e996") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil15").Range("f996") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1
'eau
Sheets("feuil15").Range("e997") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'N
Sheets("feuil15").Range("f997") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'N-1
'électricité
Sheets("feuil15").Range("e998") = WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000")) 'N
Sheets("feuil15").Range("f998") = WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000")) 'N-1
'autres energies
Sheets("feuil15").Range("e999") = WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000")) 'N
Sheets("feuil15").Range("f999") = WorksheetFunction.Sum(Sheets("feuil1").Range("af1:af5000")) 'N-1
'fournitures d'entretien
Sheets("feuil15").Range("e1000") = WorksheetFunction.Sum(Sheets("feuil2").Range("ag1:ag5000")) 'N
Sheets("feuil15").Range("f1000") = WorksheetFunction.Sum(Sheets("feuil1").Range("ag1:ag5000")) 'N-1
'fourniture de bureau
Sheets("feuil15").Range("e1001") = WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000")) 'N
Sheets("feuil15").Range("f1001") = WorksheetFunction.Sum(Sheets("feuil1").Range("ah1:ah5000")) 'N-1
'petits matériels et outillages
Sheets("feuil15").Range("e1002") = WorksheetFunction.Sum(Sheets("feuil2").Range("ai1:ai5000")) 'N
Sheets("feuil15").Range("f1002") = WorksheetFunction.Sum(Sheets("feuil1").Range("ai1:ai5000")) 'N-1
'achats études et prestations de service
Sheets("feuil15").Range("e1003") = WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) 'N
Sheets("feuil15").Range("f1003") = WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) 'N-1
'achats d'emballages
Sheets("feuil15").Range("e1004") = WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) 'N
Sheets("feuil15").Range("f1004") = WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) 'N-1
'frais sur achats
Sheets("feuil15").Range("e1005") = WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) 'N
Sheets("feuil15").Range("f1005") = WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) 'N-1
'R,R,R, sur autres achats
Sheets("feuil15").Range("e1006") = -WorksheetFunction.Sum(Sheets("feuil2").Range("am1:am5000")) 'N
Sheets("feuil15").Range("f1006") = -WorksheetFunction.Sum(Sheets("feuil1").Range("am1:am5000")) 'N-1

'____________________________________________________________________________________________________

'MARCHANDISES
'affetation des rabais, remises, ristournes sur les achats de marchandises N
If WorksheetFunction.Sum(Sheets("feuil2").Range("an1:an5000")) > 0 Then
'Insérer le montant des R,R,R sur les achats de marchandises dans la région N
    Dim resultat1 As Variant
    resultat1 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes obtenus sur les achats de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("an1:an5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes obtenus sur les achats dans la région :", "RRR obtenus")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat1 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e985") = Sheets("feuil15").Range("e985") - resultat1 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat1 = 0
    End If
'Insérer le montant des R,R,R sur les achats de marchandises hors région N
If WorksheetFunction.Sum(Sheets("feuil2").Range("an1:an5000")) - resultat1 > 0 Then
    Dim resultat2 As Variant
    resultat2 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes obtenus sur les achats de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("an1:an5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes obtenus sur les achats hors région :", "RRR obtenus")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat2 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e986") = Sheets("feuil15").Range("e986") - resultat2 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat2 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les achats de marchandises groupe N
If WorksheetFunction.Sum(Sheets("feuil2").Range("an1:an5000")) - resultat1 - resultat2 > 0 Then
    Dim resultat3 As Variant
    resultat3 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes obtenus sur les achats de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("an1:an5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes obtenus sur les achats groupe :", "RRR obtenus")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat3 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e987") = Sheets("feuil15").Range("e987") - resultat3 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat3 = 0
    End If
Else
End If
'message de contrôle du montant total des R,R,R sur les achats de marchandises N reparti
If WorksheetFunction.Sum(Sheets("feuil2").Range("an1:an5000")) - resultat1 - resultat2 - resultat3 = 0 Then
Else
MsgBox "Exercice N" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil2").Range("an1:an5000")) - resultat1 - resultat2 - resultat3) & "  entre le montant des rabais, remises et ristournes sur les achats de marchandises obtenus comptabilisé et le total des quotes-parts affectées."
End If
'affetation des rabais, remises, ristournes sur marchandises N
Else
End If

'affetation des frais sur achats de marchandises N
If WorksheetFunction.Sum(Sheets("feuil2").Range("ap1:ap5000")) > 0 Then
'Insérer le montant des frais sur achats de marchandises dans la région N
    Dim resultat4 As Variant
    resultat4 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des frais sur achats de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("ap1:ap5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des frais sur achats dans la région :", "Frais sur achats")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat4 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e985") = Sheets("feuil15").Range("e985") + resultat4 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat4 = 0
    End If
'Insérer le montant des frais sur achats de marchandises hors région N
If WorksheetFunction.Sum(Sheets("feuil2").Range("ap1:ap5000")) - resultat4 > 0 Then
    Dim resultat5 As Variant
    resultat5 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des frais sur achats de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("ap1:ap5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des frais sur achats hors région :", "Frais sur achats")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat5 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e986") = Sheets("feuil15").Range("e986") + resultat5 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat5 = 0
    End If
Else
End If
'Insérer le montant des frais sur achats de marchandises groupe N
If WorksheetFunction.Sum(Sheets("feuil2").Range("ap1:ap5000")) - resultat4 - resultat5 > 0 Then
    Dim resultat6 As Variant
    resultat6 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des frais sur achats de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("ap1:ap5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des frais sur achats groupe :", "Frais sur achats")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat6 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e987") = Sheets("feuil15").Range("e987") + resultat6 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat6 = 0
    End If
Else
End If
'message de contrôle du montant total des frais sur achats de marchandises N reparti
If WorksheetFunction.Sum(Sheets("feuil2").Range("ap1:ap5000")) - resultat4 - resultat5 - resultat6 = 0 Then
Else
MsgBox "Exercice N" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil2").Range("ap1:ap5000")) - resultat4 - resultat5 - resultat6) & "  entre le montant des frais sur achats de marchandises comptabilisé et le total des quotes-parts affectées."
End If
'affetation des frais sur achats de marchandises N
Else
End If


'affetation des rabais, remises, ristournes sur les achats de marchandises N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("an1:an5000")) > 0 Then
'Insérer le montant des R,R,R sur les achats de marchandises dans la région N-1
    Dim resultat11 As Variant
    resultat11 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes obtenus sur les achats de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("an1:an5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes obtenus sur les achats dans la région :", "RRR obtenus")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat11 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f985") = Sheets("feuil15").Range("f985") - resultat11 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat11 = 0
    End If
'Insérer le montant des R,R,R sur les achats de marchandises hors région N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("an1:an5000")) - resultat11 > 0 Then
    Dim resultat12 As Variant
    resultat12 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes obtenus sur les achats de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("an1:an5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes obtenus sur les achats hors région :", "RRR obtenus")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat12 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f986") = Sheets("feuil15").Range("f986") - resultat12 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat12 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les achats de marchandises groupe N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("an1:an5000")) - resultat11 - resultat12 > 0 Then
    Dim resultat13 As Variant
    resultat13 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes obtenus sur les achats de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("an1:an5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes obtenus sur les achats groupe :", "RRR obtenus")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat13 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f987") = Sheets("feuil15").Range("f987") - resultat13 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat13 = 0
    End If
Else
End If
'message de contrôle du montant total des R,R,R sur les achats de marchandises N-1 reparti
If WorksheetFunction.Sum(Sheets("feuil1").Range("an1:an5000")) - resultat11 - resultat12 - resultat13 = 0 Then
Else
MsgBox "Exercice N-1" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil1").Range("an1:an5000")) - resultat11 - resultat12 - resultat13) & "  entre le montant des rabais, remises et ristournes sur les achats de marchandises obtenus comptabilisé et le total des quotes-parts affectées."
End If
'affetation des rabais, remises, ristournes sur marchandises N-1
Else
End If

'affetation des frais sur achats de marchandises N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("ap1:ap5000")) > 0 Then
'Insérer le montant des frais sur achats de marchandises dans la région N-1
    Dim resultat14 As Variant
    resultat14 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des frais sur achats de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("ap1:ap5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des frais sur achats dans la région :", "Frais sur achats")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat14 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f985") = Sheets("feuil15").Range("f985") + resultat14 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat14 = 0
    End If
'Insérer le montant des frais sur achats de marchandises hors région N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("ap1:ap5000")) - resultat14 > 0 Then
    Dim resultat15 As Variant
    resultat15 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des frais sur achats de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("ap1:ap5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des frais sur achats hors région :", "Frais sur achats")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat15 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f986") = Sheets("feuil15").Range("f986") + resultat15 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat15 = 0
    End If
Else
End If
'Insérer le montant des frais sur achats de marchandises groupe N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("ap1:ap5000")) - resultat14 - resultat15 > 0 Then
    Dim resultat16 As Variant
    resultat16 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des frais sur achats de marchandises s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("ap1:ap5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des frais sur achats groupe :", "Frais sur achats")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat16 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f987") = Sheets("feuil15").Range("f987") + resultat16 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat16 = 0
    End If
Else
End If
'message de contrôle du montant total des frais sur achats de marchandises N-1 reparti
If WorksheetFunction.Sum(Sheets("feuil1").Range("ap1:ap5000")) - resultat14 - resultat15 - resultat16 = 0 Then
Else
MsgBox "Exercice N-1" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil1").Range("ap1:ap5000")) - resultat14 - resultat15 - resultat16) & "  entre le montant des frais sur achats de marchandises comptabilisé et le total des quotes-parts affectées."
End If
'affetation des frais sur achats de marchandises N-1
Else
End If



'MATIERES PREMIERES
'affetation des rabais, remises, ristournes sur les achats de matières N
If WorksheetFunction.Sum(Sheets("feuil2").Range("ao1:ao5000")) > 0 Then
'Insérer le montant des R,R,R sur les achats de matières dans la région N
    Dim resultat21 As Variant
    resultat21 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes obtenus sur les achats de matières premières s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("ao1:ao5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes obtenus sur les achats dans la région :", "RRR obtenus")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat21 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e989") = Sheets("feuil15").Range("e989") - resultat21 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat21 = 0
    End If
'Insérer le montant des R,R,R sur les achats de matières hors région N
If WorksheetFunction.Sum(Sheets("feuil2").Range("ao1:ao5000")) - resultat21 > 0 Then
    Dim resultat22 As Variant
    resultat22 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes obtenus sur les achats de matières premières s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("ao1:ao5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes obtenus sur les achats hors région :", "RRR obtenus")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat22 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e990") = Sheets("feuil15").Range("e990") - resultat22 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat22 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les achats de matières groupe N
If WorksheetFunction.Sum(Sheets("feuil2").Range("ao1:ao5000")) - resultat21 - resultat22 > 0 Then
    Dim resultat23 As Variant
    resultat23 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes obtenus sur les achats de matières premières s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("ao1:ao5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes obtenus sur les achats groupe :", "RRR obtenus")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat23 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e991") = Sheets("feuil15").Range("e991") - resultat23 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat23 = 0
    End If
Else
End If
'message de contrôle du montant total des R,R,R sur les achats de matières N reparti
If WorksheetFunction.Sum(Sheets("feuil2").Range("ao1:ao5000")) - resultat21 - resultat22 - resultat23 = 0 Then
Else
MsgBox "Exercice N" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil2").Range("ao1:ao5000")) - resultat21 - resultat22 - resultat23) & "  entre le montant des rabais, remises et ristournes sur les achats de matières premières obtenus comptabilisé et le total des quotes-parts affectées."
End If
'affetation des rabais, remises, ristournes sur matières N
Else
End If

'affetation des frais sur achats de matières N
If WorksheetFunction.Sum(Sheets("feuil2").Range("aq1:aq5000")) > 0 Then
'Insérer le montant des frais sur achats de matières dans la région N
    Dim resultat24 As Variant
    resultat24 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des frais sur achats de matières premières s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("aq1:aq5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des frais sur achats dans la région :", "Frais sur achats")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat24 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e989") = Sheets("feuil15").Range("e989") + resultat24 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat24 = 0
    End If
'Insérer le montant des frais sur achats de matières hors région N
If WorksheetFunction.Sum(Sheets("feuil2").Range("aq1:aq5000")) - resultat24 > 0 Then
    Dim resultat25 As Variant
    resultat25 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des frais sur achats de matières premières s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("aq1:aq5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des frais sur achats hors région :", "Frais sur achats")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat25 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e990") = Sheets("feuil15").Range("e990") + resultat25 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat25 = 0
    End If
Else
End If
'Insérer le montant des frais sur achats de matières groupe N
If WorksheetFunction.Sum(Sheets("feuil2").Range("aq1:aq5000")) - resultat24 - resultat25 > 0 Then
    Dim resultat26 As Variant
    resultat26 = InputBox("Exercice N" & Chr(10) & Chr(10) & "Le montant des frais sur achats de matières premières s'élève à  " & WorksheetFunction.Sum(Sheets("feuil2").Range("aq1:aq5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des frais sur achats groupe :", "Frais sur achats")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat26 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("e991") = Sheets("feuil15").Range("e991") + resultat26 'N
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat26 = 0
    End If
Else
End If
'message de contrôle du montant total des frais sur achats de matières N reparti
If WorksheetFunction.Sum(Sheets("feuil2").Range("aq1:aq5000")) - resultat24 - resultat25 - resultat26 = 0 Then
Else
MsgBox "Exercice N" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil2").Range("aq1:aq5000")) - resultat24 - resultat25 - resultat26) & "  entre le montant des frais sur achats de matières premières comptabilisé et le total des quotes-parts affectées."
End If
'affetation des frais sur achats de matières N
Else
End If


'affetation des rabais, remises, ristournes sur les achats de matières N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("ao1:ao5000")) > 0 Then
'Insérer le montant des R,R,R sur les achats de matières dans la région N-1
    Dim resultat31 As Variant
    resultat31 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes obtenus sur les achats de matières premières s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("ao1:ao5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes obtenus sur les achats dans la région :", "RRR obtenus")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat31 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f989") = Sheets("feuil15").Range("f989") - resultat31 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat31 = 0
    End If
'Insérer le montant des R,R,R sur les achats de matières hors région N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("ao1:ao5000")) - resultat31 > 0 Then
    Dim resultat32 As Variant
    resultat32 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes obtenus sur les achats de matières premières s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("ao1:ao5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes obtenus sur les achats hors région :", "RRR obtenus")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat32 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f990") = Sheets("feuil15").Range("f990") - resultat32 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat32 = 0
    End If
Else
End If
'Insérer le montant des R,R,R sur les achats de matières groupe N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("ao1:ao5000")) - resultat31 - resultat32 > 0 Then
    Dim resultat33 As Variant
    resultat33 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des rabais, remises et ristournes obtenus sur les achats de matières premières s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("ao1:ao5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des rabais, remises et ristournes obtenus sur les achats groupe :", "RRR obtenus")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat33 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f991") = Sheets("feuil15").Range("f991") - resultat33 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat33 = 0
    End If
Else
End If
'message de contrôle du montant total des R,R,R sur les achats de matières N-1 reparti
If WorksheetFunction.Sum(Sheets("feuil1").Range("ao1:ao5000")) - resultat31 - resultat32 - resultat33 = 0 Then
Else
MsgBox "Exercice N-1" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil1").Range("ao1:ao5000")) - resultat31 - resultat32 - resultat33) & "  entre le montant des rabais, remises et ristournes sur les achats de matières premières obtenus comptabilisé et le total des quotes-parts affectées."
End If
'affetation des rabais, remises, ristournes sur matières N-1
Else
End If

'affetation des frais sur achats de matières N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("aq1:aq5000")) > 0 Then
'Insérer le montant des frais sur achats de matières dans la région N-1
    Dim resultat34 As Variant
    resultat34 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des frais sur achats de matières premières s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("aq1:aq5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des frais sur achats dans la région :", "Frais sur achats")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat34 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f989") = Sheets("feuil15").Range("f989") + resultat34 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat34 = 0
    End If
'Insérer le montant des frais sur achats de matières hors région N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("aq1:aq5000")) - resultat34 > 0 Then
    Dim resultat35 As Variant
    resultat35 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des frais sur achats de matières premières s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("aq1:aq5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des frais sur achats hors région :", "Frais sur achats")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat35 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f990") = Sheets("feuil15").Range("f990") + resultat35 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat35 = 0
    End If
Else
End If
'Insérer le montant des frais sur achats de matières groupe N-1
If WorksheetFunction.Sum(Sheets("feuil1").Range("aq1:aq5000")) - resultat34 - resultat35 > 0 Then
    Dim resultat36 As Variant
    resultat36 = InputBox("Exercice N-1" & Chr(10) & Chr(10) & "Le montant des frais sur achats de matières premières s'élève à  " & WorksheetFunction.Sum(Sheets("feuil1").Range("aq1:aq5000")) & Chr(10) & Chr(10) & "Veuillez saisir la quote-part des frais sur achats groupe :", "Frais sur achats")  'La variable reçoit la valeur entrée dans l'InputBox
    If resultat36 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil15").Range("f991") = Sheets("feuil15").Range("f991") + resultat36 'N-1
    'Si la valeur est différente de "" on affiche le résultat
    Else
    resultat36 = 0
    End If
Else
End If
'message de contrôle du montant total des frais sur achats de matières N-1 reparti
If WorksheetFunction.Sum(Sheets("feuil1").Range("aq1:aq5000")) - resultat34 - resultat35 - resultat36 = 0 Then
Else
MsgBox "Exercice N-1" & Chr(10) & Chr(10) & "Attention  ! Il y a une différence de  " & (WorksheetFunction.Sum(Sheets("feuil1").Range("aq1:aq5000")) - resultat34 - resultat35 - resultat36) & "  entre le montant des frais sur achats de matières premières comptabilisé et le total des quotes-parts affectées."
End If
'affetation des frais sur achats de matières N-1
Else
End If


'______________________________________________________________________________________
'Calculs du tableau

'total brut des achats de marchandises
Sheets("feuil15").Range("e988") = WorksheetFunction.Sum(Sheets("feuil15").Range("e985:e987")) 'N
Sheets("feuil15").Range("f988") = WorksheetFunction.Sum(Sheets("feuil15").Range("f985:f987")) 'N-1

'total brut des achats de matières premières
Sheets("feuil15").Range("e992") = WorksheetFunction.Sum(Sheets("feuil15").Range("e989:e991")) 'N
Sheets("feuil15").Range("f992") = WorksheetFunction.Sum(Sheets("feuil15").Range("f989:f991")) 'N-1

'total brut des autres achats
Sheets("feuil15").Range("e1007") = WorksheetFunction.Sum(Sheets("feuil15").Range("e993:e1006")) 'N
Sheets("feuil15").Range("f1007") = WorksheetFunction.Sum(Sheets("feuil15").Range("f993:f1006")) 'N-1

'variation en % stocks
For i = 985 To 1007
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_22()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e985:g1007").ClearContents
End If
End Sub
Private Sub note_23()
'condition générale de traitement de la NOTE 23
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 23
If Sheets("feuil6").Range("i30") + Sheets("feuil6").Range("j30") = 0 Then
MsgBox "Désolé  !  Aucune charge de transport comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 23
'annule les données du tableau
Sheets("feuil15").Range("e1021:g1026").ClearContents

For i = 3 To 5000
'recup N
'compte 612
If Left(Sheets("feuil2").Cells(i, 1), 3) = 612 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 613
If Left(Sheets("feuil2").Cells(i, 1), 3) = 613 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 614
If Left(Sheets("feuil2").Cells(i, 1), 3) = 614 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 616
If Left(Sheets("feuil2").Cells(i, 1), 3) = 616 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 618
If Left(Sheets("feuil2").Cells(i, 1), 3) = 618 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If



'recup N-1
'compte 612
If Left(Sheets("feuil1").Cells(i, 1), 3) = 612 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 613
If Left(Sheets("feuil1").Cells(i, 1), 3) = 613 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 614
If Left(Sheets("feuil1").Cells(i, 1), 3) = 614 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 616
If Left(Sheets("feuil1").Cells(i, 1), 3) = 616 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 618
If Left(Sheets("feuil1").Cells(i, 1), 3) = 618 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If


Next


'affectation dans le tableau
'transport sur ventes
Sheets("feuil15").Range("e1021") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f1021") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'transport pour le compte de tiers
Sheets("feuil15").Range("e1022") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f1022") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'transport du personnel
Sheets("feuil15").Range("e1023") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f1023") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'transport de plis
Sheets("feuil15").Range("e1024") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f1024") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'autres frais de transport
Sheets("feuil15").Range("e1025") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f1025") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1


'______________________________________________________________________________________
'Calculs du tableau

'total brut des transports
Sheets("feuil15").Range("e1026") = WorksheetFunction.Sum(Sheets("feuil15").Range("e1021:e1025")) 'N
Sheets("feuil15").Range("f1026") = WorksheetFunction.Sum(Sheets("feuil15").Range("f1021:f1025")) 'N-1

'variation en % stocks
For i = 1021 To 1026
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_23()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e1021:g1026").ClearContents
End If
End Sub
Private Sub note_24()
'condition générale de traitement de la NOTE 24
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 24
If Sheets("feuil6").Range("i31") + Sheets("feuil6").Range("j31") = 0 Then
MsgBox "Désolé  !  Aucun service extérieur comptabilisé."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 24
'annule les données du tableau
Sheets("feuil15").Range("e1057:g1071").ClearContents

For i = 3 To 5000
'recup N
'compte 621
If Left(Sheets("feuil2").Cells(i, 1), 3) = 621 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 622
If Left(Sheets("feuil2").Cells(i, 1), 3) = 622 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 623
If Left(Sheets("feuil2").Cells(i, 1), 3) = 623 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 624
If Left(Sheets("feuil2").Cells(i, 1), 3) = 624 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 625
If Left(Sheets("feuil2").Cells(i, 1), 3) = 625 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 626
If Left(Sheets("feuil2").Cells(i, 1), 3) = 626 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If

'compte 627
If Left(Sheets("feuil2").Cells(i, 1), 3) = 627 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 7) 'Z
Else
End If

'compte 628
If Left(Sheets("feuil2").Cells(i, 1), 3) = 628 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 7) 'AA
Else
End If

'compte 631
If Left(Sheets("feuil2").Cells(i, 1), 3) = 631 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 7) 'AB
Else
End If

'compte 632
If Left(Sheets("feuil2").Cells(i, 1), 3) = 632 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 7) 'AC
Else
End If

'compte 633
If Left(Sheets("feuil2").Cells(i, 1), 3) = 633 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 7) 'AD
Else
End If

'compte 634
If Left(Sheets("feuil2").Cells(i, 1), 3) = 634 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 7) 'AE
Else
End If

'compte 635
If Left(Sheets("feuil2").Cells(i, 1), 3) = 635 Then
Sheets("feuil2").Cells(i, 32) = Sheets("feuil2").Cells(i, 7) 'AF
Else
End If

'compte 637 + 638
If Left(Sheets("feuil2").Cells(i, 1), 3) = 637 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 638 Then
Sheets("feuil2").Cells(i, 33) = Sheets("feuil2").Cells(i, 7) 'AG
Else
End If



'recup N-1
'compte 621
If Left(Sheets("feuil1").Cells(i, 1), 3) = 621 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 622
If Left(Sheets("feuil1").Cells(i, 1), 3) = 622 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 623
If Left(Sheets("feuil1").Cells(i, 1), 3) = 623 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 624
If Left(Sheets("feuil1").Cells(i, 1), 3) = 624 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 625
If Left(Sheets("feuil1").Cells(i, 1), 3) = 625 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'compte 626
If Left(Sheets("feuil1").Cells(i, 1), 3) = 626 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

'compte 627
If Left(Sheets("feuil1").Cells(i, 1), 3) = 627 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 7) 'Z
Else
End If

'compte 628
If Left(Sheets("feuil1").Cells(i, 1), 3) = 628 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 7) 'AA
Else
End If

'compte 631
If Left(Sheets("feuil1").Cells(i, 1), 3) = 631 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 7) 'AB
Else
End If

'compte 632
If Left(Sheets("feuil1").Cells(i, 1), 3) = 632 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 7) 'AC
Else
End If

'compte 633
If Left(Sheets("feuil1").Cells(i, 1), 3) = 633 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 7) 'AD
Else
End If

'compte 634
If Left(Sheets("feuil1").Cells(i, 1), 3) = 634 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 7) 'AE
Else
End If

'compte 635
If Left(Sheets("feuil1").Cells(i, 1), 3) = 635 Then
Sheets("feuil1").Cells(i, 32) = Sheets("feuil1").Cells(i, 7) 'AF
Else
End If

'compte 637 + 638
If Left(Sheets("feuil1").Cells(i, 1), 3) = 637 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 638 Then
Sheets("feuil1").Cells(i, 33) = Sheets("feuil1").Cells(i, 7) 'AG
Else
End If



Next


'affectation dans le tableau
'sous traitance générale
Sheets("feuil15").Range("e1057") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f1057") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'location et charges locatives
Sheets("feuil15").Range("e1058") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f1058") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'redevances de location acquisition
Sheets("feuil15").Range("e1059") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f1059") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'entretien, reparations et maintenance
Sheets("feuil15").Range("e1060") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f1060") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'primes d'assurance
Sheets("feuil15").Range("e1061") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f1061") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'études, recherche et documentation
Sheets("feuil15").Range("e1062") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("f1062") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'publicité, publications, relations publiques
Sheets("feuil15").Range("e1063") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("f1063") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'frais de télécommunication
Sheets("feuil15").Range("e1064") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("f1064") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'frais bancaires
Sheets("feuil15").Range("e1065") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil15").Range("f1065") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'rémunérations d'intermédiaires et de conseil
Sheets("feuil15").Range("e1066") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil15").Range("f1066") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1
'frais de formation du personnel
Sheets("feuil15").Range("e1067") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'N
Sheets("feuil15").Range("f1067") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'N-1
'redevances pour brevets, licences et assimilés
Sheets("feuil15").Range("e1068") = WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000")) 'N
Sheets("feuil15").Range("f1068") = WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000")) 'N-1
'cotisations
Sheets("feuil15").Range("e1069") = WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000")) 'N
Sheets("feuil15").Range("f1069") = WorksheetFunction.Sum(Sheets("feuil1").Range("af1:af5000")) 'N-1
'autres charges externes
Sheets("feuil15").Range("e1070") = WorksheetFunction.Sum(Sheets("feuil2").Range("ag1:ag5000")) 'N
Sheets("feuil15").Range("f1070") = WorksheetFunction.Sum(Sheets("feuil1").Range("ag1:ag5000")) 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut des services extérieurs
Sheets("feuil15").Range("e1071") = WorksheetFunction.Sum(Sheets("feuil15").Range("e1057:e1071")) 'N
Sheets("feuil15").Range("f1071") = WorksheetFunction.Sum(Sheets("feuil15").Range("f1057:f1071")) 'N-1

'variation en % stocks
For i = 1057 To 1071
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_24()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e1057:g1071").ClearContents
End If
End Sub
Private Sub note_25()
'condition générale de traitement de la NOTE 25
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 25
If Sheets("feuil6").Range("i32") + Sheets("feuil6").Range("j32") = 0 Then
MsgBox "Désolé  !  Aucun impôt et taxe comptabilisé."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 25
'annule les données du tableau
Sheets("feuil15").Range("e1093:g1098").ClearContents

For i = 3 To 5000
'recup N
'compte 641
If Left(Sheets("feuil2").Cells(i, 1), 3) = 641 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 645
If Left(Sheets("feuil2").Cells(i, 1), 3) = 645 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 646
If Left(Sheets("feuil2").Cells(i, 1), 3) = 646 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 647
If Left(Sheets("feuil2").Cells(i, 1), 3) = 647 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 648
If Left(Sheets("feuil2").Cells(i, 1), 3) = 648 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If



'recup N-1
'compte 641
If Left(Sheets("feuil1").Cells(i, 1), 3) = 641 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 645
If Left(Sheets("feuil1").Cells(i, 1), 3) = 645 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 646
If Left(Sheets("feuil1").Cells(i, 1), 3) = 646 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 647
If Left(Sheets("feuil1").Cells(i, 1), 3) = 647 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 648
If Left(Sheets("feuil1").Cells(i, 1), 3) = 648 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

Next


'affectation dans le tableau
'impôts et taxes directs
Sheets("feuil15").Range("e1093") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f1093") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'impôts et taxes indirects
Sheets("feuil15").Range("e1094") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f1094") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'droits d'enregistrement
Sheets("feuil15").Range("e1095") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f1095") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'pénalités et amendes fiscales
Sheets("feuil15").Range("e1096") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f1096") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'autres impôts et taxes
Sheets("feuil15").Range("e1097") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f1097") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut des impôts et taxes
Sheets("feuil15").Range("e1098") = WorksheetFunction.Sum(Sheets("feuil15").Range("e1093:e1097")) 'N
Sheets("feuil15").Range("f1098") = WorksheetFunction.Sum(Sheets("feuil15").Range("f1093:f1097")) 'N-1

'variation en % stocks
For i = 1093 To 1098
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_25()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e1093:g1098").ClearContents
End If
End Sub
Private Sub note_26()
'condition générale de traitement de la NOTE 26
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 26
If Sheets("feuil6").Range("i33") + Sheets("feuil6").Range("j33") = 0 Then
MsgBox "Désolé  !  Aucune autre charge comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 26
'annule les données du tableau
Sheets("feuil15").Range("e1129:g1138").ClearContents

For i = 3 To 5000
'recup N
'compte 6511
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6511 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 6515
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6515 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 652
If Left(Sheets("feuil2").Cells(i, 1), 3) = 652 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 654
If Left(Sheets("feuil2").Cells(i, 1), 3) = 654 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 6581
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6581 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 6582 + 6583
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6582 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6583 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If

'compte 656 + 657 + 6588
If Left(Sheets("feuil2").Cells(i, 1), 3) = 656 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 657 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6588 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 7) 'Z
Else
End If

'compte 659
If Left(Sheets("feuil2").Cells(i, 1), 3) = 659 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 7) 'AA
Else
End If



'recup N-1
'compte 6511
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6511 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 6515
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6515 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 652
If Left(Sheets("feuil1").Cells(i, 1), 3) = 652 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 654
If Left(Sheets("feuil1").Cells(i, 1), 3) = 654 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 6581
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6581 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'compte 6582 + 6583
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6582 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 6583 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

'compte 656 + 657 + 6588
If Left(Sheets("feuil1").Cells(i, 1), 3) = 656 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 657 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 6588 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 7) 'Z
Else
End If

'compte 659
If Left(Sheets("feuil1").Cells(i, 1), 3) = 659 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 7) 'AA
Else
End If

Next


'affectation dans le tableau
'perte sur créances clients
Sheets("feuil15").Range("e1129") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f1129") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'perte sur débiteurs divers
Sheets("feuil15").Range("e1130") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f1130") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'qoute part de résultat sur opérations faites en commun
Sheets("feuil15").Range("e1131") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f1131") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'valeur comptable de cessions courantes d'immobilisation
Sheets("feuil15").Range("e1132") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f1132") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'indemnités de fonction et autres rémunérations d'administrateurs
Sheets("feuil15").Range("e1133") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f1133") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'dons et mécénat
Sheets("feuil15").Range("e1134") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("f1134") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'autres charges diverses
Sheets("feuil15").Range("e1135") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil15").Range("f1135") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'charges pour dépréciations et provisions pour risques à court terme
Sheets("feuil15").Range("e1137") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil15").Range("f1137") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut des autres charges
Sheets("feuil15").Range("e1138") = WorksheetFunction.Sum(Sheets("feuil15").Range("e1129:e1137")) 'N
Sheets("feuil15").Range("f1138") = WorksheetFunction.Sum(Sheets("feuil15").Range("f1129:f1137")) 'N-1

'variation en % stocks
For i = 1129 To 1138
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_26()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e1129:g1138").ClearContents
End If
End Sub
Private Sub note_27A()
'condition générale de traitement de la NOTE 27A
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 27A
If Sheets("feuil6").Range("i35") + Sheets("feuil6").Range("j35") = 0 Then
MsgBox "Désolé  !  Aucune charge de personnel comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 27A
'annule les données du tableau
Sheets("feuil15").Range("e1165:g1171").ClearContents

For i = 3 To 5000
'recup N
'compte 661 + 662
If Left(Sheets("feuil2").Cells(i, 1), 3) = 661 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 662 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 663
If Left(Sheets("feuil2").Cells(i, 1), 3) = 663 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 664
If Left(Sheets("feuil2").Cells(i, 1), 3) = 664 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 666
If Left(Sheets("feuil2").Cells(i, 1), 3) = 666 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 667
If Left(Sheets("feuil2").Cells(i, 1), 3) = 667 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 668
If Left(Sheets("feuil2").Cells(i, 1), 3) = 668 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If


'recup N-1
'compte 661 + 662
If Left(Sheets("feuil1").Cells(i, 1), 3) = 661 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 662 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 663
If Left(Sheets("feuil1").Cells(i, 1), 3) = 663 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 664
If Left(Sheets("feuil1").Cells(i, 1), 3) = 664 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 666
If Left(Sheets("feuil1").Cells(i, 1), 3) = 666 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 667
If Left(Sheets("feuil1").Cells(i, 1), 3) = 667 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'compte 668
If Left(Sheets("feuil1").Cells(i, 1), 3) = 668 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

Next


'affectation dans le tableau
'rémunérations directes versées au personnel
Sheets("feuil15").Range("e1165") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil15").Range("f1165") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'indemnités forfaitaires versées au personnel
Sheets("feuil15").Range("e1166") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil15").Range("f1166") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'charges sociales
Sheets("feuil15").Range("e1167") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil15").Range("f1167") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'rémunérations et charges sociales de l'exploitant
Sheets("feuil15").Range("e1168") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil15").Range("f1168") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'rémunération transférée du personnel extérieur
Sheets("feuil15").Range("e1169") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil15").Range("f1169") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'autres charges sociales
Sheets("feuil15").Range("e1170") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil15").Range("f1170") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut des charges de personnel
Sheets("feuil15").Range("e1171") = WorksheetFunction.Sum(Sheets("feuil15").Range("e1165:e1170")) 'N
Sheets("feuil15").Range("f1171") = WorksheetFunction.Sum(Sheets("feuil15").Range("f1165:f1170")) 'N-1

'variation en % stocks
For i = 1165 To 1171
If Sheets("feuil15").Cells(i, 6) = 0 Then
Else
If Sheets("feuil15").Cells(i, 6) < 0 Then
Sheets("feuil15").Cells(i, 7) = -1 * ((Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6))
Else
Sheets("feuil15").Cells(i, 7) = (Sheets("feuil15").Cells(i, 5) - Sheets("feuil15").Cells(i, 6)) / Sheets("feuil15").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_27A()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil15").Range("e1165:g1171").ClearContents
End If
End Sub
Private Sub note_29()
'condition générale de traitement de la NOTE 29
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 29
If Sheets("feuil6").Range("i40") + Sheets("feuil6").Range("j40") + Sheets("feuil6").Range("i43") + Sheets("feuil6").Range("j43") = 0 Then
MsgBox "Désolé  !  Aucune charge et produit financiers comptabilisé."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 29
'annule les données du tableau
Sheets("feuil8").Range("e11:g34").ClearContents

For i = 3 To 5000
'recup N
'compte 671
If Left(Sheets("feuil2").Cells(i, 1), 3) = 671 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 672
If Left(Sheets("feuil2").Cells(i, 1), 3) = 672 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 673
If Left(Sheets("feuil2").Cells(i, 1), 3) = 673 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 674
If Left(Sheets("feuil2").Cells(i, 1), 3) = 674 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 675
If Left(Sheets("feuil2").Cells(i, 1), 3) = 675 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 676
If Left(Sheets("feuil2").Cells(i, 1), 3) = 676 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If

'compte 6771
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6771 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 7) 'Z
Else
End If

'compte 6772
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6772 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 7) 'AA
Else
End If

'compte 678
If Left(Sheets("feuil2").Cells(i, 1), 3) = 678 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 7) 'AB
Else
End If

'compte 679
If Left(Sheets("feuil2").Cells(i, 1), 3) = 679 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 7) 'AC
Else
End If

'compte 771
If Left(Sheets("feuil2").Cells(i, 1), 3) = 771 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
Else
End If

'compte 772
If Left(Sheets("feuil2").Cells(i, 1), 3) = 772 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 8) 'AE
Else
End If

'compte 773
If Left(Sheets("feuil2").Cells(i, 1), 3) = 773 Then
Sheets("feuil2").Cells(i, 32) = Sheets("feuil2").Cells(i, 8) 'AF
Else
End If

'compte 774
If Left(Sheets("feuil2").Cells(i, 1), 3) = 774 Then
Sheets("feuil2").Cells(i, 33) = Sheets("feuil2").Cells(i, 8) 'AG
Else
End If

'compte 775
If Left(Sheets("feuil2").Cells(i, 1), 3) = 775 Then
Sheets("feuil2").Cells(i, 34) = Sheets("feuil2").Cells(i, 8) 'AH
Else
End If

'compte 776
If Left(Sheets("feuil2").Cells(i, 1), 3) = 776 Then
Sheets("feuil2").Cells(i, 35) = Sheets("feuil2").Cells(i, 8) 'AI
Else
End If

'compte 777
If Left(Sheets("feuil2").Cells(i, 1), 3) = 777 Then
Sheets("feuil2").Cells(i, 36) = Sheets("feuil2").Cells(i, 8) 'AJ
Else
End If

'compte 778
If Left(Sheets("feuil2").Cells(i, 1), 3) = 778 Then
Sheets("feuil2").Cells(i, 37) = Sheets("feuil2").Cells(i, 8) 'AK
Else
End If

'compte 779
If Left(Sheets("feuil2").Cells(i, 1), 3) = 779 Then
Sheets("feuil2").Cells(i, 38) = Sheets("feuil2").Cells(i, 8) 'AL
Else
End If



'recup N-1
'compte 671
If Left(Sheets("feuil1").Cells(i, 1), 3) = 671 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 672
If Left(Sheets("feuil1").Cells(i, 1), 3) = 672 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 673
If Left(Sheets("feuil1").Cells(i, 1), 3) = 673 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 674
If Left(Sheets("feuil1").Cells(i, 1), 3) = 674 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 675
If Left(Sheets("feuil1").Cells(i, 1), 3) = 675 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'compte 676
If Left(Sheets("feuil1").Cells(i, 1), 3) = 676 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

'compte 6771
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6771 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 7) 'Z
Else
End If

'compte 6772
If Left(Sheets("feuil1").Cells(i, 1), 4) = 6772 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 7) 'AA
Else
End If

'compte 678
If Left(Sheets("feuil1").Cells(i, 1), 3) = 678 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 7) 'AB
Else
End If

'compte 679
If Left(Sheets("feuil1").Cells(i, 1), 3) = 679 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 7) 'AC
Else
End If

'compte 771
If Left(Sheets("feuil1").Cells(i, 1), 3) = 771 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'AD
Else
End If

'compte 772
If Left(Sheets("feuil1").Cells(i, 1), 3) = 772 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 8) 'AE
Else
End If

'compte 773
If Left(Sheets("feuil1").Cells(i, 1), 3) = 773 Then
Sheets("feuil1").Cells(i, 32) = Sheets("feuil1").Cells(i, 8) 'AF
Else
End If

'compte 774
If Left(Sheets("feuil1").Cells(i, 1), 3) = 774 Then
Sheets("feuil1").Cells(i, 33) = Sheets("feuil1").Cells(i, 8) 'AG
Else
End If

'compte 775
If Left(Sheets("feuil1").Cells(i, 1), 3) = 775 Then
Sheets("feuil1").Cells(i, 34) = Sheets("feuil1").Cells(i, 8) 'AH
Else
End If

'compte 776
If Left(Sheets("feuil1").Cells(i, 1), 3) = 776 Then
Sheets("feuil1").Cells(i, 35) = Sheets("feuil1").Cells(i, 8) 'AI
Else
End If

'compte 777
If Left(Sheets("feuil1").Cells(i, 1), 3) = 777 Then
Sheets("feuil1").Cells(i, 36) = Sheets("feuil1").Cells(i, 8) 'AJ
Else
End If

'compte 778
If Left(Sheets("feuil1").Cells(i, 1), 3) = 778 Then
Sheets("feuil1").Cells(i, 37) = Sheets("feuil1").Cells(i, 8) 'AK
Else
End If

'compte 779
If Left(Sheets("feuil1").Cells(i, 1), 3) = 779 Then
Sheets("feuil1").Cells(i, 38) = Sheets("feuil1").Cells(i, 8) 'AL
Else
End If


Next


'affectation dans le tableau
'intérêts des emprunts
Sheets("feuil8").Range("e11") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil8").Range("f11") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'intérêts dans loyers de location acquisition
Sheets("feuil8").Range("e12") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil8").Range("f12") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'escomptes accordés
Sheets("feuil8").Range("e13") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil8").Range("f13") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'autres intérêts
Sheets("feuil8").Range("e14") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil8").Range("f14") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'escomptes des effets de commerce
Sheets("feuil8").Range("e15") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil8").Range("f15") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'pertes de change
Sheets("feuil8").Range("e16") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil8").Range("f16") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1
'pertes sur cessions de titres de placement
Sheets("feuil8").Range("e17") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil8").Range("f17") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'malis sur titres gratuits au personnel salarié
Sheets("feuil8").Range("e19") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil8").Range("f19") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'pertes sur risques financiers
Sheets("feuil8").Range("e20") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil8").Range("f20") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'charges pour dépréciations et provisions à court terme
Sheets("feuil8").Range("e21") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil8").Range("f21") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1

'intérêts de prêts et de créances diverses
Sheets("feuil8").Range("e23") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'N
Sheets("feuil8").Range("f23") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'N-1
'revenus de participation
Sheets("feuil8").Range("e24") = WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000")) 'N
Sheets("feuil8").Range("f24") = WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000")) 'N-1
'escomptes obtenus
Sheets("feuil8").Range("e25") = WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000")) 'N
Sheets("feuil8").Range("f25") = WorksheetFunction.Sum(Sheets("feuil1").Range("af1:af5000")) 'N-1
'revenus de placement
Sheets("feuil8").Range("e26") = WorksheetFunction.Sum(Sheets("feuil2").Range("ag1:ag5000")) 'N
Sheets("feuil8").Range("f26") = WorksheetFunction.Sum(Sheets("feuil1").Range("ag1:ag5000")) 'N-1
'intérêts dans loyers de location acquisition
Sheets("feuil8").Range("e27") = WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000")) 'N
Sheets("feuil8").Range("f27") = WorksheetFunction.Sum(Sheets("feuil1").Range("ah1:ah5000")) 'N-1
'gains de changes
Sheets("feuil8").Range("e28") = WorksheetFunction.Sum(Sheets("feuil2").Range("ai1:ai5000")) 'N
Sheets("feuil8").Range("f28") = WorksheetFunction.Sum(Sheets("feuil1").Range("ai1:ai5000")) 'N-1
'gains sur cessions de titres de placement
Sheets("feuil8").Range("e29") = WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) 'N
Sheets("feuil8").Range("f29") = WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) 'N-1
'gains sur risques financiers
Sheets("feuil8").Range("e30") = WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) 'N
Sheets("feuil8").Range("f30") = WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) 'N-1
'reprises de charges pour dépréciation
Sheets("feuil8").Range("e32") = WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) 'N
Sheets("feuil8").Range("f32") = WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) 'N-1



'______________________________________________________________________________________
'Calculs du tableau

'total brut des frais financiers
Sheets("feuil8").Range("e22") = WorksheetFunction.Sum(Sheets("feuil8").Range("e11:e21")) 'N
Sheets("feuil8").Range("f22") = WorksheetFunction.Sum(Sheets("feuil8").Range("f11:f21")) 'N-1

'total brut des revenus financiers
Sheets("feuil8").Range("e33") = WorksheetFunction.Sum(Sheets("feuil8").Range("e23:e32")) 'N
Sheets("feuil8").Range("f33") = WorksheetFunction.Sum(Sheets("feuil8").Range("f23:f32")) 'N-1

'total général
Sheets("feuil8").Range("e34") = Sheets("feuil8").Range("e22") + Sheets("feuil8").Range("e33") 'N
Sheets("feuil8").Range("f34") = Sheets("feuil8").Range("f22") + Sheets("feuil8").Range("f33") 'N-1



'variation en % stocks
For i = 11 To 34
If Sheets("feuil8").Cells(i, 6) = 0 Then
Else
If Sheets("feuil8").Cells(i, 6) < 0 Then
Sheets("feuil8").Cells(i, 7) = -1 * ((Sheets("feuil8").Cells(i, 5) - Sheets("feuil8").Cells(i, 6)) / Sheets("feuil8").Cells(i, 6))
Else
Sheets("feuil8").Cells(i, 7) = (Sheets("feuil8").Cells(i, 5) - Sheets("feuil8").Cells(i, 6)) / Sheets("feuil8").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_29()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil8").Range("e11:g34").ClearContents
End If
End Sub
Private Sub note_30()
'condition générale de traitement de la NOTE 30
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 30
If Sheets("feuil6").Range("i48") + Sheets("feuil6").Range("j48") + Sheets("feuil6").Range("i50") + Sheets("feuil6").Range("j50") + Sheets("feuil6").Range("i52") + Sheets("feuil6").Range("j52") + Sheets("feuil6").Range("i53") + Sheets("feuil6").Range("j53") = 0 Then
MsgBox "Désolé  !  Aucune charge et produit H.A.O. comptabilisé."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données de la NOTE 30
'annule les données du tableau
Sheets("feuil8").Range("e47:g70").ClearContents

For i = 3 To 5000
'recup N
'compte 831 + 833 + 837
If Left(Sheets("feuil2").Cells(i, 1), 3) = 831 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 833 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 837 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 834
If Left(Sheets("feuil2").Cells(i, 1), 3) = 834 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 835
If Left(Sheets("feuil2").Cells(i, 1), 3) = 835 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 836
If Left(Sheets("feuil2").Cells(i, 1), 3) = 836 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If

'compte 839
If Left(Sheets("feuil2").Cells(i, 1), 3) = 839 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 85
If Left(Sheets("feuil2").Cells(i, 1), 2) = 85 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 7) 'Y
Else
End If

'compte 841 + 843 + 844 + 847
If Left(Sheets("feuil2").Cells(i, 1), 3) = 841 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 843 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 844 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 847 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 8) 'Z
Else
End If

'compte 845
If Left(Sheets("feuil2").Cells(i, 1), 3) = 845 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 8) 'AA
Else
End If

'compte 846
If Left(Sheets("feuil2").Cells(i, 1), 3) = 846 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 8) 'AB
Else
End If

'compte 848
If Left(Sheets("feuil2").Cells(i, 1), 3) = 848 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 8) 'AC
Else
End If

'compte 849
If Left(Sheets("feuil2").Cells(i, 1), 3) = 849 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
Else
End If

'compte 86
If Left(Sheets("feuil2").Cells(i, 1), 2) = 86 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 8) 'AE
Else
End If

'compte 88
If Left(Sheets("feuil2").Cells(i, 1), 2) = 88 Then
Sheets("feuil2").Cells(i, 32) = Sheets("feuil2").Cells(i, 8) 'AF
Else
End If

'compte 87
If Left(Sheets("feuil2").Cells(i, 1), 2) = 87 Then
Sheets("feuil2").Cells(i, 33) = Sheets("feuil2").Cells(i, 7) 'AG
Else
End If

'compte 89
If Left(Sheets("feuil2").Cells(i, 1), 2) = 89 Then
Sheets("feuil2").Cells(i, 34) = Sheets("feuil2").Cells(i, 7) 'AH
Else
End If




'recup N-1
'compte 831 + 833 + 837
If Left(Sheets("feuil1").Cells(i, 1), 3) = 831 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 833 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 837 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 834
If Left(Sheets("feuil1").Cells(i, 1), 3) = 834 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 7) 'U
Else
End If

'compte 835
If Left(Sheets("feuil1").Cells(i, 1), 3) = 835 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 7) 'V
Else
End If

'compte 836
If Left(Sheets("feuil1").Cells(i, 1), 3) = 836 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 7) 'W
Else
End If

'compte 839
If Left(Sheets("feuil1").Cells(i, 1), 3) = 839 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 7) 'X
Else
End If

'compte 85
If Left(Sheets("feuil1").Cells(i, 1), 2) = 85 Then
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 7) 'Y
Else
End If

'compte 841 + 843 + 844 + 847
If Left(Sheets("feuil1").Cells(i, 1), 3) = 841 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 843 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 844 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 847 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 8) 'Z
Else
End If

'compte 845
If Left(Sheets("feuil1").Cells(i, 1), 3) = 845 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 8) 'AA
Else
End If

'compte 846
If Left(Sheets("feuil1").Cells(i, 1), 3) = 846 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 8) 'AB
Else
End If

'compte 848
If Left(Sheets("feuil1").Cells(i, 1), 3) = 848 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 8) 'AC
Else
End If

'compte 849
If Left(Sheets("feuil1").Cells(i, 1), 3) = 849 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'AD
Else
End If

'compte 86
If Left(Sheets("feuil1").Cells(i, 1), 2) = 86 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 8) 'AE
Else
End If

'compte 88
If Left(Sheets("feuil1").Cells(i, 1), 2) = 88 Then
Sheets("feuil1").Cells(i, 32) = Sheets("feuil1").Cells(i, 8) 'AF
Else
End If

'compte 87
If Left(Sheets("feuil1").Cells(i, 1), 2) = 87 Then
Sheets("feuil1").Cells(i, 33) = Sheets("feuil1").Cells(i, 7) 'AG
Else
End If

'compte 89
If Left(Sheets("feuil1").Cells(i, 1), 2) = 89 Then
Sheets("feuil1").Cells(i, 34) = Sheets("feuil1").Cells(i, 7) 'AH
Else
End If


Next


'affectation dans le tableau
'charges H.A.O. constatées
Sheets("feuil8").Range("e47") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) 'N
Sheets("feuil8").Range("f47") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) 'N-1
'pertes sur créances H.A.O.
Sheets("feuil8").Range("e51") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) 'N
Sheets("feuil8").Range("f51") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) 'N-1
'dons et libéralités accordés
Sheets("feuil8").Range("e52") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) 'N
Sheets("feuil8").Range("f52") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) 'N-1
'abandons de créances consenties
Sheets("feuil8").Range("e53") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) 'N
Sheets("feuil8").Range("f53") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) 'N-1
'charges provisionnées H.A.O.
Sheets("feuil8").Range("e54") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) 'N
Sheets("feuil8").Range("f54") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) 'N-1
'dotations H.A.O.
Sheets("feuil8").Range("e55") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) 'N
Sheets("feuil8").Range("f55") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) 'N-1

'produits H.A.O. constatés
Sheets("feuil8").Range("e57") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) 'N
Sheets("feuil8").Range("f57") = WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) 'N-1
'dons et libéralités obtenus
Sheets("feuil8").Range("e61") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) 'N
Sheets("feuil8").Range("f61") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) 'N-1
'abandons de créances obtenues
Sheets("feuil8").Range("e62") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) 'N
Sheets("feuil8").Range("f62") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) 'N-1
'transferts de charges H.A.O.
Sheets("feuil8").Range("e63") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) 'N
Sheets("feuil8").Range("f63") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) 'N-1
'reprises de charges provisionnées H.A.O.
Sheets("feuil8").Range("e64") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) 'N
Sheets("feuil8").Range("f64") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) 'N-1
'reprises H.A.O.
Sheets("feuil8").Range("e65") = WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000")) 'N
Sheets("feuil8").Range("f65") = WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000")) 'N-1
'subventions d'équilibre
Sheets("feuil8").Range("e66") = WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000")) 'N
Sheets("feuil8").Range("f66") = WorksheetFunction.Sum(Sheets("feuil1").Range("af1:af5000")) 'N-1

'participation des travailleurs
Sheets("feuil8").Range("e68") = WorksheetFunction.Sum(Sheets("feuil2").Range("ag1:ag5000")) 'N
Sheets("feuil8").Range("f68") = WorksheetFunction.Sum(Sheets("feuil1").Range("ag1:ag5000")) 'N-1
'impôts sur le résultat
Sheets("feuil8").Range("e69") = WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000")) 'N
Sheets("feuil8").Range("f69") = WorksheetFunction.Sum(Sheets("feuil1").Range("ah1:ah5000")) 'N-1

'______________________________________________________________________________________
'Calculs du tableau

'total brut des autres charges H.A.O.
Sheets("feuil8").Range("e56") = WorksheetFunction.Sum(Sheets("feuil8").Range("e47:e55")) 'N
Sheets("feuil8").Range("f56") = WorksheetFunction.Sum(Sheets("feuil8").Range("f47:f55")) 'N-1

'total brut des autres produits H.A.O.
Sheets("feuil8").Range("e67") = WorksheetFunction.Sum(Sheets("feuil8").Range("e57:e66")) 'N
Sheets("feuil8").Range("f67") = WorksheetFunction.Sum(Sheets("feuil8").Range("f57:f66")) 'N-1

'total brut des participations et impôts sur le résultat
Sheets("feuil8").Range("e70") = WorksheetFunction.Sum(Sheets("feuil8").Range("e68:e69")) 'N
Sheets("feuil8").Range("f70") = WorksheetFunction.Sum(Sheets("feuil8").Range("f68:f69")) 'N-1


'variation en % stocks
For i = 47 To 70
If Sheets("feuil8").Cells(i, 6) = 0 Then
Else
If Sheets("feuil8").Cells(i, 6) < 0 Then
Sheets("feuil8").Cells(i, 7) = -1 * ((Sheets("feuil8").Cells(i, 5) - Sheets("feuil8").Cells(i, 6)) / Sheets("feuil8").Cells(i, 6))
Else
Sheets("feuil8").Cells(i, 7) = (Sheets("feuil8").Cells(i, 5) - Sheets("feuil8").Cells(i, 6)) / Sheets("feuil8").Cells(i, 6)
End If
End If
Next

'_______________________________________________________________________________________



MsgBox "    FIN DE L'EDITION  !"


'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents
Sheets("feuil1").Range("t1:za5001").ClearContents


'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_30()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil8").Range("e47:g70").ClearContents
End If
End Sub
Private Sub annuler_note_34()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil31").Range("e12:g66").ClearContents
End If
End Sub
Private Sub note_35()
'condition générale de traitement de la NOTE 35
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'Insérer le lettre A et N/A
Dim resultat As Variant
    resultat = InputBox("NB : La note 35 est obligatoire pour les entités ayant un effectif de plus de 250 salariés." & Chr(10) & Chr(10) & " - Si vous comptez renseigner la note, veuillez saisir en majuscule la lettre  A." & Chr(10) & Chr(10) & " - Dans le cas contraire, veuillez saisir en majuscule les lettres  N/A  pour annuler la note à l'impression." & Chr(10), "Note 35") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    
    Sheets("feuil31").Range("a79") = resultat
    
    'Si la valeur est différente de "" on affiche le résultat
    Else
    End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_note_35()
If MsgBox("      Confirmez vous l'annulation ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du tableau
Sheets("feuil31").Range("a79").ClearContents
End If
End Sub
Private Sub paginer_liasse()
'animationv1
'délai d'essai
date_test = Now()
If Year(2020) > 2017 Then
MsgBox "Délai d'essai expiré 12!"
Else

'condition d'installation
'If Sheets("feuil12").Range("a100") = Left(Sheets("feuil12").Range("a101"), 10) Then


If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'Insérer 1 ou 0
Dim resultat As Variant
    resultat = InputBox("PAGINATION automatisée de la liasse :" & Chr(10) & Chr(10) & " - Veuillez saisir le chiffre  1  pour paginer toute la liasse." & Chr(10) & Chr(10) & " - Veuillez saisir le chiffre  0  pour annuler la pagination de la liasse." & Chr(10), "Paginer") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    
    'PAGINATION DE LA LIASSE
    If resultat = 1 Then
    'note 1
    If WorksheetFunction.Sum(Sheets("feuil14").Range("e13:k35")) + WorksheetFunction.Sum(Sheets("feuil14").Range("h39:k46")) = 0 Then
    Sheets("feuil14").Range("a1") = 1 'pour effacer la note
    Sheets("feuil14").Range("f1") = 9 'pour paginer en -
    Sheets("feuil4").Range("q164") = "X" 'pour cocher N/A
    Else
    Sheets("feuil14").Range("a1") = 0 'pour afficher la note
    Sheets("feuil14").Range("f1") = 10 'pour paginer en +
    Sheets("feuil4").Range("o164") = "X" 'pour cocher A
    End If
    'note 2
    'obligatoire !
    Sheets("feuil14").Range("f53") = Sheets("feuil14").Range("f1") + 1 'pour paginer en +
    'Sheets("feuil4").Range("q165") = "X" 'pour cocher N/A
    Sheets("feuil4").Range("o165") = "X" 'pour cocher A
    
    'note 3A
    If WorksheetFunction.Sum(Sheets("feuil23").Range("b16:i35")) = 0 Then
    Sheets("feuil23").Range("a1") = 1 'pour effacer la note
    Sheets("feuil23").Range("d1") = Sheets("feuil14").Range("f53") 'pour paginer en -
    Sheets("feuil23").Range("d36") = Sheets("feuil23").Range("d1") 'pour paginer en - (suite note 3A)
    Sheets("feuil4").Range("q166") = "X" 'pour cocher N/A
    Else
    Sheets("feuil23").Range("a1") = 0 'pour effacer la note
    Sheets("feuil23").Range("d1") = Sheets("feuil14").Range("f53") + 1 'pour paginer en +
    Sheets("feuil23").Range("d36") = Sheets("feuil23").Range("d1") + 1 'pour paginer en + (suite note 3A)
    Sheets("feuil4").Range("o166") = "X" 'pour cocher A
    End If
    'note 3B
    If WorksheetFunction.Sum(Sheets("feuil23").Range("b84:i94")) = 0 Then
    Sheets("feuil23").Range("a70") = 1 'pour effacer la note
    Sheets("feuil23").Range("d70") = Sheets("feuil23").Range("d36") 'pour paginer en -
    Sheets("feuil4").Range("q167") = "X" 'pour cocher N/A
    Else
    Sheets("feuil23").Range("a70") = 0 'pour effacer la note
    Sheets("feuil23").Range("d70") = Sheets("feuil23").Range("d36") + 1 'pour paginer en +
    Sheets("feuil4").Range("o167") = "X" 'pour cocher A
    End If
    'note 3C
    If WorksheetFunction.Sum(Sheets("feuil23").Range("b119:i133")) = 0 Then
    Sheets("feuil23").Range("a104") = 1 'pour effacer la note
    Sheets("feuil23").Range("d104") = Sheets("feuil23").Range("d70") 'pour paginer en -
    Sheets("feuil4").Range("q168") = "X" 'pour cocher N/A
    Else
    Sheets("feuil23").Range("a104") = 0 'pour effacer la note
    Sheets("feuil23").Range("d104") = Sheets("feuil23").Range("d70") + 1 'pour paginer en +
    Sheets("feuil4").Range("o168") = "X" 'pour cocher A
    End If
    'note 3D
    If WorksheetFunction.Sum(Sheets("feuil23").Range("d153:i169")) = 0 Then
    Sheets("feuil23").Range("a140") = 1 'pour effacer la note
    Sheets("feuil23").Range("d140") = Sheets("feuil23").Range("d104") 'pour paginer en -
    Sheets("feuil4").Range("q169") = "X" 'pour cocher N/A
    Else
    Sheets("feuil23").Range("a140") = 0 'pour effacer la note
    Sheets("feuil23").Range("d140") = Sheets("feuil23").Range("d104") + 1 'pour paginer en +
    Sheets("feuil4").Range("o169") = "X" 'pour cocher A
    End If
    'note 3E
    If WorksheetFunction.Sum(Sheets("feuil23").Range("d189:g194")) + Sheets("feuil23").Range("f207") + Sheets("feuil23").Range("g207") = 0 Then
    Sheets("feuil23").Range("a175") = 1 'pour effacer la note
    Sheets("feuil23").Range("d175") = Sheets("feuil23").Range("d140") 'pour paginer en -
    Sheets("feuil4").Range("q170") = "X" 'pour cocher N/A
    Else
    Sheets("feuil23").Range("a175") = 0 'pour effacer la note
    Sheets("feuil23").Range("d175") = Sheets("feuil23").Range("d140") + 1 'pour paginer en +
    Sheets("feuil4").Range("o170") = "X" 'pour cocher A
    End If
    
    'note 4
    If WorksheetFunction.Sum(Sheets("feuil15").Range("b12:d23")) = 0 Then
    Sheets("feuil15").Range("a1") = 1 'pour effacer la note
    Sheets("feuil15").Range("d1") = Sheets("feuil23").Range("d175") 'pour paginer en -
    Sheets("feuil4").Range("q171") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a1") = 0 'pour effacer la note
    Sheets("feuil15").Range("d1") = Sheets("feuil23").Range("d175") + 1 'pour paginer en +
    Sheets("feuil4").Range("o171") = "X" 'pour cocher A
    End If
    'note 4 suite
    If WorksheetFunction.Sum(Sheets("feuil15").Range("d50:g69")) = 0 Then
    Sheets("feuil15").Range("a39") = 1 'pour effacer la note
    Sheets("feuil15").Range("d39") = Sheets("feuil15").Range("d1") 'pour paginer en -
    'Sheets("feuil4").Range("q171") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a39") = 0 'pour effacer la note
    Sheets("feuil15").Range("d39") = Sheets("feuil15").Range("d1") + 1 'pour paginer en +
    'Sheets("feuil4").Range("o171") = "X" 'pour cocher A
    End If
    'note 5
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e85:g89")) + WorksheetFunction.Sum(Sheets("feuil15").Range("e100:g105")) = 0 Then
    Sheets("feuil15").Range("a75") = 1 'pour effacer la note
    Sheets("feuil15").Range("d75") = Sheets("feuil15").Range("d39") 'pour paginer en -
    Sheets("feuil4").Range("q172") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a75") = 0 'pour effacer la note
    Sheets("feuil15").Range("d75") = Sheets("feuil15").Range("d39") + 1 'pour paginer en +
    Sheets("feuil4").Range("o172") = "X" 'pour cocher A
    End If
    'note 6
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e121:g131")) = 0 Then
    Sheets("feuil15").Range("a111") = 1 'pour effacer la note
    Sheets("feuil15").Range("d111") = Sheets("feuil15").Range("d75") 'pour paginer en -
    Sheets("feuil4").Range("q173") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a111") = 0 'pour effacer la note
    Sheets("feuil15").Range("d111") = Sheets("feuil15").Range("d75") + 1 'pour paginer en +
    Sheets("feuil4").Range("o173") = "X" 'pour cocher A
    End If
    'note 7
    If WorksheetFunction.Sum(Sheets("feuil15").Range("b158:d174")) = 0 Then
    Sheets("feuil15").Range("a147") = 1 'pour effacer la note
    Sheets("feuil15").Range("d147") = Sheets("feuil15").Range("d111") 'pour paginer en -
    Sheets("feuil4").Range("q174") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a147") = 0 'pour effacer la note
    Sheets("feuil15").Range("d147") = Sheets("feuil15").Range("d111") + 1 'pour paginer en +
    Sheets("feuil4").Range("o174") = "X" 'pour cocher A
    End If
    'note 8
    If WorksheetFunction.Sum(Sheets("feuil15").Range("b194:d208")) = 0 Then
    Sheets("feuil15").Range("a183") = 1 'pour effacer la note
    Sheets("feuil15").Range("d183") = Sheets("feuil15").Range("d147") 'pour paginer en -
    Sheets("feuil4").Range("q175") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a183") = 0 'pour effacer la note
    Sheets("feuil15").Range("d183") = Sheets("feuil15").Range("d147") + 1 'pour paginer en +
    Sheets("feuil4").Range("o175") = "X" 'pour cocher A
    End If
    'note 8A
    If WorksheetFunction.Sum(Sheets("feuil15").Range("b245:g250")) = 0 Then
    Sheets("feuil15").Range("a219") = 1 'pour effacer la note
    Sheets("feuil15").Range("d219") = Sheets("feuil15").Range("d183") 'pour paginer en -
    Sheets("feuil4").Range("q176") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a219") = 0 'pour effacer la note
    Sheets("feuil15").Range("d219") = Sheets("feuil15").Range("d183") + 1 'pour paginer en +
    Sheets("feuil4").Range("o176") = "X" 'pour cocher A
    End If
    'note 9
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e265:g274")) = 0 Then
    Sheets("feuil15").Range("a255") = 1 'pour effacer la note
    Sheets("feuil15").Range("d255") = Sheets("feuil15").Range("d219") 'pour paginer en -
    Sheets("feuil4").Range("q177") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a255") = 0 'pour effacer la note
    Sheets("feuil15").Range("d255") = Sheets("feuil15").Range("d219") + 1 'pour paginer en +
    Sheets("feuil4").Range("o177") = "X" 'pour cocher A
    End If
    'note 10
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e301:g309")) = 0 Then
    Sheets("feuil15").Range("a291") = 1 'pour effacer la note
    Sheets("feuil15").Range("d291") = Sheets("feuil15").Range("d255") 'pour paginer en -
    Sheets("feuil4").Range("q178") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a291") = 0 'pour effacer la note
    Sheets("feuil15").Range("d291") = Sheets("feuil15").Range("d255") + 1 'pour paginer en +
    Sheets("feuil4").Range("o178") = "X" 'pour cocher A
    End If
    'note 11
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e337:g351")) = 0 Then
    Sheets("feuil15").Range("a327") = 1 'pour effacer la note
    Sheets("feuil15").Range("d327") = Sheets("feuil15").Range("d291") 'pour paginer en -
    Sheets("feuil4").Range("q179") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a327") = 0 'pour effacer la note
    Sheets("feuil15").Range("d327") = Sheets("feuil15").Range("d291") + 1 'pour paginer en +
    Sheets("feuil4").Range("o179") = "X" 'pour cocher A
    End If
    'note 12
    If WorksheetFunction.Sum(Sheets("feuil15").Range("d375:g387")) = 0 Then
    Sheets("feuil15").Range("a363") = 1 'pour effacer la note
    Sheets("feuil15").Range("d363") = Sheets("feuil15").Range("d327") 'pour paginer en -
    Sheets("feuil4").Range("q180") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a363") = 0 'pour effacer la note
    Sheets("feuil15").Range("d363") = Sheets("feuil15").Range("d327") + 1 'pour paginer en +
    Sheets("feuil4").Range("o180") = "X" 'pour cocher A
    End If
    'note 12 suite
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e410:g422")) = 0 Then
    Sheets("feuil15").Range("a399") = 1 'pour effacer la note
    Sheets("feuil15").Range("d399") = Sheets("feuil15").Range("d363") 'pour paginer en -
    'Sheets("feuil4").Range("q180") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a399") = 0 'pour effacer la note
    Sheets("feuil15").Range("d399") = Sheets("feuil15").Range("d363") + 1 'pour paginer en +
    If Sheets("feuil4").Range("q180") = "X" Then 'pour cocher N/A
    Sheets("feuil4").Range("q180").ClearContents
    Sheets("feuil4").Range("o180") = "X" 'pour cocher A
    Else
    End If
    End If
    'note 13
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e446:g462")) = 0 Then
    Sheets("feuil15").Range("a435") = 1 'pour effacer la note
    Sheets("feuil15").Range("d435") = Sheets("feuil15").Range("d399") 'pour paginer en -
    Sheets("feuil4").Range("q181") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a435") = 0 'pour effacer la note
    Sheets("feuil15").Range("d435") = Sheets("feuil15").Range("d399") + 1 'pour paginer en +
    Sheets("feuil4").Range("o181") = "X" 'pour cocher A
    End If
    'note 14
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e481:g494")) = 0 Then
    Sheets("feuil15").Range("a471") = 1 'pour effacer la note
    Sheets("feuil15").Range("d471") = Sheets("feuil15").Range("d435") 'pour paginer en -
    Sheets("feuil4").Range("q182") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a471") = 0 'pour effacer la note
    Sheets("feuil15").Range("d471") = Sheets("feuil15").Range("d435") + 1 'pour paginer en +
    Sheets("feuil4").Range("o182") = "X" 'pour cocher A
    End If
    'note 15A
    If WorksheetFunction.Sum(Sheets("feuil15").Range("c518:f535")) = 0 Then
    Sheets("feuil15").Range("a507") = 1 'pour effacer la note
    Sheets("feuil15").Range("d507") = Sheets("feuil15").Range("d471") 'pour paginer en -
    Sheets("feuil4").Range("q183") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a507") = 0 'pour effacer la note
    Sheets("feuil15").Range("d507") = Sheets("feuil15").Range("d471") + 1 'pour paginer en +
    Sheets("feuil4").Range("o183") = "X" 'pour cocher A
    End If
    'note 15B
    If WorksheetFunction.Sum(Sheets("feuil15").Range("c554:f559")) = 0 Then
    Sheets("feuil15").Range("a543") = 1 'pour effacer la note
    Sheets("feuil15").Range("d543") = Sheets("feuil15").Range("d507") 'pour paginer en -
    Sheets("feuil4").Range("q184") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a543") = 0 'pour effacer la note
    Sheets("feuil15").Range("d543") = Sheets("feuil15").Range("d507") + 1 'pour paginer en +
    Sheets("feuil4").Range("o184") = "X" 'pour cocher A
    End If
    'note 16A
    If WorksheetFunction.Sum(Sheets("feuil15").Range("b590:e606")) = 0 Then
    Sheets("feuil15").Range("a579") = 1 'pour effacer la note
    Sheets("feuil15").Range("d579") = Sheets("feuil15").Range("d543") 'pour paginer en -
    Sheets("feuil4").Range("q185") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a579") = 0 'pour effacer la note
    Sheets("feuil15").Range("d579") = Sheets("feuil15").Range("d543") + 1 'pour paginer en +
    Sheets("feuil4").Range("o185") = "X" 'pour cocher A
    End If
    'note 16A suite
    If WorksheetFunction.Sum(Sheets("feuil15").Range("b626:e639")) = 0 Then
    Sheets("feuil15").Range("a615") = 1 'pour effacer la note
    Sheets("feuil15").Range("d615") = Sheets("feuil15").Range("d579") 'pour paginer en -
    'Sheets("feuil4").Range("q185") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a615") = 0 'pour effacer la note
    Sheets("feuil15").Range("d615") = Sheets("feuil15").Range("d579") + 1 'pour paginer en +
    If Sheets("feuil4").Range("q185") = "X" Then 'pour cocher N/A
    Sheets("feuil4").Range("q185").ClearContents
    Sheets("feuil4").Range("o185") = "X" 'pour cocher A
    Else
    End If
    End If
    'note 16B
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e661:f667")) + WorksheetFunction.Sum(Sheets("feuil15").Range("e676:f682")) = 0 Then
    Sheets("feuil15").Range("a651") = 1 'pour effacer la note
    Sheets("feuil15").Range("d651") = Sheets("feuil15").Range("d615") 'pour paginer en -
    Sheets("feuil15").Range("d687") = Sheets("feuil15").Range("d651") 'pour paginer en - (suite note 16B)
    Sheets("feuil4").Range("q186") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a651") = 0 'pour effacer la note
    Sheets("feuil15").Range("d651") = Sheets("feuil15").Range("d615") + 1 'pour paginer en +
    Sheets("feuil15").Range("d687") = Sheets("feuil15").Range("d651") + 1 'pour paginer en + (suite note 16B)
    Sheets("feuil4").Range("o186") = "X" 'pour cocher A
    End If
    'note 16B bis
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e733:f735")) + WorksheetFunction.Sum(Sheets("feuil15").Range("c744:f747")) = 0 Then
    Sheets("feuil15").Range("a723") = 1 'pour effacer la note
    Sheets("feuil15").Range("d723") = Sheets("feuil15").Range("d687") 'pour paginer en -
    Sheets("feuil4").Range("q187") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a723") = 0 'pour effacer la note
    Sheets("feuil15").Range("d723") = Sheets("feuil15").Range("d687") + 1 'pour paginer en +
    Sheets("feuil4").Range("o187") = "X" 'pour cocher A
    End If
    'note 16C
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e769:f783")) = 0 Then
    Sheets("feuil15").Range("a759") = 1 'pour effacer la note
    Sheets("feuil15").Range("d759") = Sheets("feuil15").Range("d723") 'pour paginer en -
    Sheets("feuil4").Range("q188") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a759") = 0 'pour effacer la note
    Sheets("feuil15").Range("d759") = Sheets("feuil15").Range("d723") + 1 'pour paginer en +
    Sheets("feuil4").Range("o188") = "X" 'pour cocher A
    End If
    'note 17
    If WorksheetFunction.Sum(Sheets("feuil15").Range("b806:d815")) = 0 Then
    Sheets("feuil15").Range("a795") = 1 'pour effacer la note
    Sheets("feuil15").Range("d795") = Sheets("feuil15").Range("d759") 'pour paginer en -
    Sheets("feuil4").Range("q189") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a795") = 0 'pour effacer la note
    Sheets("feuil15").Range("d795") = Sheets("feuil15").Range("d759") + 1 'pour paginer en +
    Sheets("feuil4").Range("o189") = "X" 'pour cocher A
    End If
    'note 18
    If WorksheetFunction.Sum(Sheets("feuil15").Range("b842:e855")) = 0 Then
    Sheets("feuil15").Range("a831") = 1 'pour effacer la note
    Sheets("feuil15").Range("d831") = Sheets("feuil15").Range("d795") 'pour paginer en -
    Sheets("feuil4").Range("q190") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a831") = 0 'pour effacer la note
    Sheets("feuil15").Range("d831") = Sheets("feuil15").Range("d795") + 1 'pour paginer en +
    Sheets("feuil4").Range("o190") = "X" 'pour cocher A
    End If
    'note 19
    If WorksheetFunction.Sum(Sheets("feuil15").Range("b878:e901")) = 0 Then
    Sheets("feuil15").Range("a867") = 1 'pour effacer la note
    Sheets("feuil15").Range("d867") = Sheets("feuil15").Range("d831") 'pour paginer en -
    Sheets("feuil4").Range("q191") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a867") = 0 'pour effacer la note
    Sheets("feuil15").Range("d867") = Sheets("feuil15").Range("d831") + 1 'pour paginer en +
    Sheets("feuil4").Range("o191") = "X" 'pour cocher A
    End If
    'note 20
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e913:g922")) = 0 Then
    Sheets("feuil15").Range("a903") = 1 'pour effacer la note
    Sheets("feuil15").Range("d903") = Sheets("feuil15").Range("d867") 'pour paginer en -
    Sheets("feuil4").Range("q192") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a903") = 0 'pour effacer la note
    Sheets("feuil15").Range("d903") = Sheets("feuil15").Range("d867") + 1 'pour paginer en +
    Sheets("feuil4").Range("o192") = "X" 'pour cocher A
    End If
    'note 21
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e949:g970")) = 0 Then
    Sheets("feuil15").Range("a939") = 1 'pour effacer la note
    Sheets("feuil15").Range("d939") = Sheets("feuil15").Range("d903") 'pour paginer en -
    Sheets("feuil4").Range("q193") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a939") = 0 'pour effacer la note
    Sheets("feuil15").Range("d939") = Sheets("feuil15").Range("d903") + 1 'pour paginer en +
    Sheets("feuil4").Range("o193") = "X" 'pour cocher A
    End If
    'note 22
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e985:g1007")) = 0 Then
    Sheets("feuil15").Range("a975") = 1 'pour effacer la note
    Sheets("feuil15").Range("d975") = Sheets("feuil15").Range("d939") 'pour paginer en -
    Sheets("feuil4").Range("q194") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a975") = 0 'pour effacer la note
    Sheets("feuil15").Range("d975") = Sheets("feuil15").Range("d939") + 1 'pour paginer en +
    Sheets("feuil4").Range("o194") = "X" 'pour cocher A
    End If
    'note 23
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e1021:g1026")) = 0 Then
    Sheets("feuil15").Range("a1011") = 1 'pour effacer la note
    Sheets("feuil15").Range("d1011") = Sheets("feuil15").Range("d975") 'pour paginer en -
    Sheets("feuil4").Range("q195") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a1011") = 0 'pour effacer la note
    Sheets("feuil15").Range("d1011") = Sheets("feuil15").Range("d975") + 1 'pour paginer en +
    Sheets("feuil4").Range("o195") = "X" 'pour cocher A
    End If
    'note 24
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e1057:g1071")) = 0 Then
    Sheets("feuil15").Range("a1047") = 1 'pour effacer la note
    Sheets("feuil15").Range("d1047") = Sheets("feuil15").Range("d1011") 'pour paginer en -
    Sheets("feuil4").Range("q196") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a1047") = 0 'pour effacer la note
    Sheets("feuil15").Range("d1047") = Sheets("feuil15").Range("d1011") + 1 'pour paginer en +
    Sheets("feuil4").Range("o196") = "X" 'pour cocher A
    End If
    'note 25
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e1093:g1098")) = 0 Then
    Sheets("feuil15").Range("a1083") = 1 'pour effacer la note
    Sheets("feuil15").Range("d1083") = Sheets("feuil15").Range("d1047") 'pour paginer en -
    Sheets("feuil4").Range("q197") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a1083") = 0 'pour effacer la note
    Sheets("feuil15").Range("d1083") = Sheets("feuil15").Range("d1047") + 1 'pour paginer en +
    Sheets("feuil4").Range("o197") = "X" 'pour cocher A
    End If
    'note 26
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e1129:g1138")) = 0 Then
    Sheets("feuil15").Range("a1119") = 1 'pour effacer la note
    Sheets("feuil15").Range("d1119") = Sheets("feuil15").Range("d1083") 'pour paginer en -
    Sheets("feuil4").Range("q198") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a1119") = 0 'pour effacer la note
    Sheets("feuil15").Range("d1119") = Sheets("feuil15").Range("d1083") + 1 'pour paginer en +
    Sheets("feuil4").Range("o198") = "X" 'pour cocher A
    End If
    'note 27A
    If WorksheetFunction.Sum(Sheets("feuil15").Range("e1165:g1171")) = 0 Then
    Sheets("feuil15").Range("a1155") = 1 'pour effacer la note
    Sheets("feuil15").Range("d1155") = Sheets("feuil15").Range("d1119") 'pour paginer en -
    Sheets("feuil4").Range("q199") = "X" 'pour cocher N/A
    Else
    Sheets("feuil15").Range("a1155") = 0 'pour effacer la note
    Sheets("feuil15").Range("d1155") = Sheets("feuil15").Range("d1119") + 1 'pour paginer en +
    Sheets("feuil4").Range("o199") = "X" 'pour cocher A
    End If
    
    'note 27B
    If WorksheetFunction.Sum(Sheets("feuil11").Range("b14:o23")) + WorksheetFunction.Sum(Sheets("feuil11").Range("b27:j37")) = 0 Then
    Sheets("feuil11").Range("a1") = 1 'pour effacer la note
    Sheets("feuil11").Range("i1") = Sheets("feuil15").Range("d1155") 'pour paginer en -
    Sheets("feuil4").Range("q200") = "X" 'pour cocher N/A
    Else
    Sheets("feuil11").Range("a1") = 0 'pour effacer la note
    Sheets("feuil11").Range("i1") = Sheets("feuil15").Range("d1155") + 1 'pour paginer en +
    Sheets("feuil4").Range("o200") = "X" 'pour cocher A
    End If
    
    'note 28
    If WorksheetFunction.Sum(Sheets("feuil10").Range("b15:j35")) = 0 Then
    Sheets("feuil10").Range("a1") = 1 'pour effacer la note
    Sheets("feuil10").Range("d1") = Sheets("feuil11").Range("i1") 'pour paginer en -
    Sheets("feuil4").Range("q201") = "X" 'pour cocher N/A
    Else
    Sheets("feuil10").Range("a1") = 0 'pour effacer la note
    Sheets("feuil10").Range("d1") = Sheets("feuil11").Range("i1") + 1 'pour paginer en +
    Sheets("feuil4").Range("o201") = "X" 'pour cocher A
    End If
    
    'note 29
    If WorksheetFunction.Sum(Sheets("feuil8").Range("e11:g34")) = 0 Then
    Sheets("feuil8").Range("a1") = 1 'pour effacer la note
    Sheets("feuil8").Range("d1") = Sheets("feuil10").Range("d1") 'pour paginer en -
    Sheets("feuil4").Range("q202") = "X" 'pour cocher N/A
    Else
    Sheets("feuil8").Range("a1") = 0 'pour effacer la note
    Sheets("feuil8").Range("d1") = Sheets("feuil10").Range("d1") + 1 'pour paginer en +
    Sheets("feuil4").Range("o202") = "X" 'pour cocher A
    End If
    'note 30
    If WorksheetFunction.Sum(Sheets("feuil8").Range("e47:g70")) = 0 Then
    Sheets("feuil8").Range("a37") = 1 'pour effacer la note
    Sheets("feuil8").Range("d37") = Sheets("feuil8").Range("d1") 'pour paginer en -
    Sheets("feuil4").Range("q203") = "X" 'pour cocher N/A
    Else
    Sheets("feuil8").Range("a37") = 0 'pour effacer la note
    Sheets("feuil8").Range("d37") = Sheets("feuil8").Range("d1") + 1 'pour paginer en +
    Sheets("feuil4").Range("o203") = "X" 'pour cocher A
    End If
    
    'note 31
    If WorksheetFunction.Sum(Sheets("feuil16").Range("f13:j34")) = 0 Then
    Sheets("feuil16").Range("a1") = 1 'pour effacer la note
    Sheets("feuil16").Range("f1") = Sheets("feuil8").Range("d37") 'pour paginer en -
    Sheets("feuil4").Range("q204") = "X" 'pour cocher N/A
    Else
    Sheets("feuil16").Range("a1") = 0 'pour effacer la note
    Sheets("feuil16").Range("f1") = Sheets("feuil8").Range("d37") + 1 'pour paginer en +
    Sheets("feuil4").Range("o204") = "X" 'pour cocher A
    End If
    
    'note 32
    If WorksheetFunction.Sum(Sheets("feuil17").Range("c16:n34")) = 0 Then
    Sheets("feuil17").Range("a1") = 1 'pour effacer la note
    Sheets("feuil17").Range("h1") = Sheets("feuil16").Range("f1") 'pour paginer en -
    Sheets("feuil4").Range("q205") = "X" 'pour cocher N/A
    Else
    Sheets("feuil17").Range("a1") = 0 'pour effacer la note
    Sheets("feuil17").Range("h1") = Sheets("feuil16").Range("f1") + 1 'pour paginer en +
    Sheets("feuil4").Range("o205") = "X" 'pour cocher A
    End If
    'note 33
    If WorksheetFunction.Sum(Sheets("feuil17").Range("c52:i70")) = 0 Then
    Sheets("feuil17").Range("a38") = 1 'pour effacer la note
    Sheets("feuil17").Range("h38") = Sheets("feuil17").Range("h1") 'pour paginer en -
    Sheets("feuil4").Range("q206") = "X" 'pour cocher N/A
    Else
    Sheets("feuil17").Range("a38") = 0 'pour effacer la note
    Sheets("feuil17").Range("h38") = Sheets("feuil17").Range("h1") + 1 'pour paginer en +
    Sheets("feuil4").Range("o206") = "X" 'pour cocher A
    End If
    
    'note 34
    If WorksheetFunction.Sum(Sheets("feuil31").Range("e12:g66")) = 0 Then
    Sheets("feuil31").Range("a1") = 1 'pour effacer la note
    Sheets("feuil31").Range("d1") = Sheets("feuil17").Range("h38") 'pour paginer en -
    Sheets("feuil4").Range("q207") = "X" 'pour cocher N/A
    Else
    Sheets("feuil31").Range("a1") = 0 'pour effacer la note
    Sheets("feuil31").Range("d1") = Sheets("feuil17").Range("h38") + 1 'pour paginer en +
    Sheets("feuil4").Range("o207") = "X" 'pour cocher A
    End If
    'note 35
    If Left(Sheets("feuil31").Range("a79"), 1) = "N" Then
    Sheets("feuil31").Range("a71") = 1 'pour effacer la note
    Sheets("feuil31").Range("d71") = Sheets("feuil31").Range("d1") 'pour paginer en -
    Sheets("feuil4").Range("q208") = "X" 'pour cocher N/A
    Else
    Sheets("feuil31").Range("a71") = 0 'pour effacer la note
    Sheets("feuil31").Range("d71") = Sheets("feuil31").Range("d1") + 1 'pour paginer en +
    Sheets("feuil4").Range("o208") = "X" 'pour cocher A
    End If
    
    'note 36
    'obligatoire
    Sheets("feuil13").Range("f1") = Sheets("feuil31").Range("d71") + 1 'pour paginer en +
    Sheets("feuil13").Range("f53") = Sheets("feuil13").Range("f1") + 1 'pour paginer en + (suite note 36)
    'Sheets("feuil4").Range("q209") = "X" 'pour cocher N/A
    Sheets("feuil4").Range("o209") = "X" 'pour cocher A
    
    
    
    
    'POUR version démo uniquement
    MsgBox "    FIN DE LA PAGINATION  !"
   
   'POUR version à vendre
   'Insérer la durée (mois) de l'exercice N
    'Dim resultat0 As Variant
    'resultat0 = InputBox("                  FIN DE LA PAGINATION  !" & Chr(10) & Chr(10) & "Veuillez saisir la durée (en mois) de l'exercice en cours :" & Chr(10) & Chr(10) & "Exemple : Saisir 12 pour 12 mois.", "Durée (mois)") 'La variable reçoit la valeur entrée dans l'InputBox
    'If resultat0 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    'Sheets("feuil12").Range("j10") = resultat0 'durée en mois
    'Sheets("feuil12").Range("h10") = Sheets("feuil4").Range("p11") 'exercice clos le :
    'Si la valeur est différente de "" on affiche le résultat
    'Else
    'End If
    
   
   'aperçu avant impression
   If MsgBox("Souhaitez vous voir l'aperçu avant impression ?", vbYesNo, "Demande de confirmation") = vbYes Then
   Application.Sheets("feuil3").PrintPreview 'couverture
   Application.Sheets("feuil4").PrintPreview 'fiche identification
   Application.Sheets("feuil5").PrintPreview 'bilan
   Application.Sheets("feuil6").PrintPreview 'compte de résultat
   Application.Sheets("feuil7").PrintPreview 'T.F.T.
   Application.Sheets("feuil14").PrintPreview 'note 1 et note 2
   Application.Sheets("feuil23").PrintPreview 'note 3A à note 3E
   Application.Sheets("feuil15").PrintPreview 'note 4 à note 27A
   Application.Sheets("feuil11").PrintPreview 'note 27B
   Application.Sheets("feuil10").PrintPreview 'note 28
   Application.Sheets("feuil8").PrintPreview 'note 29 à note 30
   Application.Sheets("feuil16").PrintPreview 'note 31
   Application.Sheets("feuil17").PrintPreview 'note 32 à note 33
   Application.Sheets("feuil31").PrintPreview 'note 34 à note 35
   Application.Sheets("feuil13").PrintPreview 'note 36
   End If
   
    'fin pagination de la liasse
    Else
    End If
    
    
    
    
    'ANNULATION DE LA PAGINATION
    If resultat = 0 Then
    'note 1
    Sheets("feuil14").Range("a1").ClearContents 'pour effacer le 1
    Sheets("feuil14").Range("f1") = 10 'pour paginer en +
    Sheets("feuil4").Range("q164").ClearContents 'pour effacer N/A
    Sheets("feuil4").Range("o164").ClearContents 'pour effacer A
    'note 2
    'obligatoire !
    Sheets("feuil14").Range("f53") = Sheets("feuil14").Range("f1") + 1 'pour paginer en +
    Sheets("feuil4").Range("q165").ClearContents 'pour effacer N/A
    Sheets("feuil4").Range("o165").ClearContents 'pour effacer A
    
    'note 3A
    Sheets("feuil23").Range("a1").ClearContents 'pour effacer le 1
    Sheets("feuil23").Range("d1") = Sheets("feuil14").Range("f53") + 1 'pour paginer en +
    Sheets("feuil23").Range("d36") = Sheets("feuil23").Range("d1") + 1 'pour paginer en + (suite note 3A)
    Sheets("feuil4").Range("o166").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q166").ClearContents 'pour effacer N/A
    'note 3B
    Sheets("feuil23").Range("a70").ClearContents 'pour effacer le 1
    Sheets("feuil23").Range("d70") = Sheets("feuil23").Range("d36") + 1 'pour paginer en +
    Sheets("feuil4").Range("o167").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q167").ClearContents 'pour effacer N/A
    'note 3C
    Sheets("feuil23").Range("a104").ClearContents 'pour effacer le 1
    Sheets("feuil23").Range("d104") = Sheets("feuil23").Range("d70") + 1 'pour paginer en +
    Sheets("feuil4").Range("o168").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q168").ClearContents 'pour effacer N/A
    'note 3D
    Sheets("feuil23").Range("a140").ClearContents 'pour effacer le 1
    Sheets("feuil23").Range("d140") = Sheets("feuil23").Range("d104") + 1 'pour paginer en +
    Sheets("feuil4").Range("o169").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q169").ClearContents 'pour effacer N/A
    'note 3E
    Sheets("feuil23").Range("a175").ClearContents 'pour effacer le 1
    Sheets("feuil23").Range("d175") = Sheets("feuil23").Range("d140") + 1 'pour paginer en +
    Sheets("feuil4").Range("o170").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q170").ClearContents 'pour effacer N/A
    
    'note 4
    Sheets("feuil15").Range("a1").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("a39").ClearContents 'pour effacer le 1 (suite note 4)
    Sheets("feuil15").Range("d1") = Sheets("feuil23").Range("d175") + 1 'pour paginer en +
    Sheets("feuil15").Range("d39") = Sheets("feuil15").Range("d1") + 1 'pour paginer en + (suite note 4)
    Sheets("feuil4").Range("o171").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q171").ClearContents 'pour effacer N/A
    'note 5
    Sheets("feuil15").Range("a75").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d75") = Sheets("feuil15").Range("d39") + 1 'pour paginer en +
    Sheets("feuil4").Range("o172").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q172").ClearContents 'pour effacer N/A
    'note 6
    Sheets("feuil15").Range("a111").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d111") = Sheets("feuil15").Range("d75") + 1 'pour paginer en +
    Sheets("feuil4").Range("o173").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q173").ClearContents 'pour effacer N/A
    'note 7
    Sheets("feuil15").Range("a147").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d147") = Sheets("feuil15").Range("d111") + 1 'pour paginer en +
    Sheets("feuil4").Range("o174").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q174").ClearContents 'pour effacer N/A
    'note 8
    Sheets("feuil15").Range("a183").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d183") = Sheets("feuil15").Range("d147") + 1 'pour paginer en +
    Sheets("feuil4").Range("o175").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q175").ClearContents 'pour effacer N/A
    'note 8A
    Sheets("feuil15").Range("a219").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d219") = Sheets("feuil15").Range("d183") + 1 'pour paginer en +
    Sheets("feuil4").Range("o176").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q176").ClearContents 'pour effacer N/A
    'note 9
    Sheets("feuil15").Range("a255").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d255") = Sheets("feuil15").Range("d219") + 1 'pour paginer en +
    Sheets("feuil4").Range("o177").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q177").ClearContents 'pour effacer N/A
    'note 10
    Sheets("feuil15").Range("a291").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d291") = Sheets("feuil15").Range("d255") + 1 'pour paginer en +
    Sheets("feuil4").Range("o178").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q178").ClearContents 'pour effacer N/A
    'note 11
    Sheets("feuil15").Range("a327").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d327") = Sheets("feuil15").Range("d291") + 1 'pour paginer en +
    Sheets("feuil4").Range("o179").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q179").ClearContents 'pour effacer N/A
    'note 12
    Sheets("feuil15").Range("a363").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("a399").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d363") = Sheets("feuil15").Range("d327") + 1 'pour paginer en +
    Sheets("feuil15").Range("d399") = Sheets("feuil15").Range("d363") + 1 'pour paginer en + (suite note 12)
    Sheets("feuil4").Range("o180").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q180").ClearContents 'pour effacer N/A
    'note 13
    Sheets("feuil15").Range("a435").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d435") = Sheets("feuil15").Range("d399") + 1 'pour paginer en +
    Sheets("feuil4").Range("o181").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q181").ClearContents 'pour effacer N/A
    'note 14
    Sheets("feuil15").Range("a471").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d471") = Sheets("feuil15").Range("d435") + 1 'pour paginer en +
    Sheets("feuil4").Range("o182").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q182").ClearContents 'pour effacer N/A
    'note 15A
    Sheets("feuil15").Range("a507").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d507") = Sheets("feuil15").Range("d471") + 1 'pour paginer en +
    Sheets("feuil4").Range("o183").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q183").ClearContents 'pour effacer N/A
    'note 15B
    Sheets("feuil15").Range("a543").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d543") = Sheets("feuil15").Range("d507") + 1 'pour paginer en +
    Sheets("feuil4").Range("o184").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q184").ClearContents 'pour effacer N/A
    'note 16A
    Sheets("feuil15").Range("a579").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("a615").ClearContents 'pour effacer le 1 (suite note 16A)
    Sheets("feuil15").Range("d579") = Sheets("feuil15").Range("d543") + 1 'pour paginer en +
    Sheets("feuil15").Range("d615") = Sheets("feuil15").Range("d579") + 1 'pour paginer en + (suite note 16A)
    Sheets("feuil4").Range("o185").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q185").ClearContents 'pour effacer N/A
    'note 16B
    Sheets("feuil15").Range("a651").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d651") = Sheets("feuil15").Range("d615") + 1 'pour paginer en +
    Sheets("feuil15").Range("d687") = Sheets("feuil15").Range("d651") + 1 'pour paginer en + (suite note 16B)
    Sheets("feuil4").Range("o186").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q186").ClearContents 'pour effacer N/A
    'note 16B bis
    Sheets("feuil15").Range("a723").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d723") = Sheets("feuil15").Range("d687") + 1 'pour paginer en +
    Sheets("feuil4").Range("o187").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q187").ClearContents 'pour effacer N/A
    'note 16C
    Sheets("feuil15").Range("a759").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d759") = Sheets("feuil15").Range("d723") + 1 'pour paginer en +
    Sheets("feuil4").Range("o188").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q188").ClearContents 'pour effacer N/A
    'note 17
    Sheets("feuil15").Range("a795").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d795") = Sheets("feuil15").Range("d759") + 1 'pour paginer en +
    Sheets("feuil4").Range("o189").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q189").ClearContents 'pour effacer N/A
    'note 18
    Sheets("feuil15").Range("a831").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d831") = Sheets("feuil15").Range("d795") + 1 'pour paginer en +
    Sheets("feuil4").Range("o190").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q190").ClearContents 'pour effacer N/A
    'note 19
    Sheets("feuil15").Range("a867").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d867") = Sheets("feuil15").Range("d831") + 1 'pour paginer en +
    Sheets("feuil4").Range("o191").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q191").ClearContents 'pour effacer N/A
    'note 20
    Sheets("feuil15").Range("a903").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d903") = Sheets("feuil15").Range("d867") + 1 'pour paginer en +
    Sheets("feuil4").Range("o192").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q192").ClearContents 'pour effacer N/A
    'note 21
    Sheets("feuil15").Range("a939").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d939") = Sheets("feuil15").Range("d903") + 1 'pour paginer en +
    Sheets("feuil4").Range("o193").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q193").ClearContents 'pour effacer N/A
    'note 22
    Sheets("feuil15").Range("a975").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d975") = Sheets("feuil15").Range("d939") + 1 'pour paginer en +
    Sheets("feuil4").Range("o194").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q194").ClearContents 'pour effacer N/A
    'note 23
    Sheets("feuil15").Range("a1011").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d1011") = Sheets("feuil15").Range("d975") + 1 'pour paginer en +
    Sheets("feuil4").Range("o195").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q195").ClearContents 'pour effacer N/A
    'note 24
    Sheets("feuil15").Range("a1047").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d1047") = Sheets("feuil15").Range("d1011") + 1 'pour paginer en +
    Sheets("feuil4").Range("o196").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q196").ClearContents 'pour effacer N/A
    'note 25
    Sheets("feuil15").Range("a1083").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d1083") = Sheets("feuil15").Range("d1047") + 1 'pour paginer en +
    Sheets("feuil4").Range("o197").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q197").ClearContents 'pour effacer N/A
    'note 26
    Sheets("feuil15").Range("a1119").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d1119") = Sheets("feuil15").Range("d1083") + 1 'pour paginer en +
    Sheets("feuil4").Range("o198").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q198").ClearContents 'pour effacer N/A
    'note 27A
    Sheets("feuil15").Range("a1155").ClearContents 'pour effacer le 1
    Sheets("feuil15").Range("d1155") = Sheets("feuil15").Range("d1119") + 1 'pour paginer en +
    Sheets("feuil4").Range("o199").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q199").ClearContents 'pour effacer N/A
    
    'note 27B
    Sheets("feuil11").Range("a1").ClearContents 'pour effacer le 1
    Sheets("feuil11").Range("i1") = Sheets("feuil15").Range("d1155") + 1 'pour paginer en +
    Sheets("feuil4").Range("o200").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q200").ClearContents 'pour effacer N/A
    
    'note 28
    Sheets("feuil10").Range("a1").ClearContents 'pour effacer le 1
    Sheets("feuil10").Range("d1") = Sheets("feuil11").Range("i1") + 1 'pour paginer en +
    Sheets("feuil4").Range("o201").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q201").ClearContents 'pour effacer N/A
    
    'note 29
    Sheets("feuil8").Range("a1").ClearContents 'pour effacer le 1
    Sheets("feuil8").Range("d1") = Sheets("feuil10").Range("d1") + 1 'pour paginer en +
    Sheets("feuil4").Range("o202").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q202").ClearContents 'pour effacer N/A
    'note 30
    Sheets("feuil8").Range("a37").ClearContents 'pour effacer le 1
    Sheets("feuil8").Range("d37") = Sheets("feuil8").Range("d1") + 1 'pour paginer en +
    Sheets("feuil4").Range("o203").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q203").ClearContents 'pour effacer N/A
    
    'note 31
    Sheets("feuil16").Range("a1").ClearContents 'pour effacer le 1
    Sheets("feuil16").Range("f1") = Sheets("feuil8").Range("d37") + 1 'pour paginer en +
    Sheets("feuil4").Range("o204").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q204").ClearContents 'pour effacer N/A
    
    'note 32
    Sheets("feuil17").Range("a1").ClearContents 'pour effacer le 1
    Sheets("feuil17").Range("h1") = Sheets("feuil16").Range("f1") + 1 'pour paginer en +
    Sheets("feuil4").Range("o205").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q205").ClearContents 'pour effacer N/A
    'note 33
    Sheets("feuil17").Range("a38").ClearContents 'pour effacer le 1
    Sheets("feuil17").Range("h38") = Sheets("feuil17").Range("h1") + 1 'pour paginer en +
    Sheets("feuil4").Range("o206").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q206").ClearContents 'pour effacer N/A
    
    'note 34
    Sheets("feuil31").Range("a1").ClearContents 'pour effacer le 1
    Sheets("feuil31").Range("d1") = Sheets("feuil17").Range("h38") + 1 'pour paginer en +
    Sheets("feuil4").Range("o207").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q207").ClearContents 'pour effacer N/A
    'note 35
    Sheets("feuil31").Range("a71").ClearContents 'pour effacer le 1
    Sheets("feuil31").Range("d71") = Sheets("feuil31").Range("d1") + 1 'pour paginer en +
    Sheets("feuil4").Range("o208").ClearContents 'pour effacer A
    Sheets("feuil4").Range("q208").ClearContents 'pour effacer N/A
    
    'note 36
    'obligatoire
    Sheets("feuil13").Range("f1") = Sheets("feuil31").Range("d71") + 1 'pour paginer en +
    Sheets("feuil13").Range("f53") = Sheets("feuil13").Range("f1") + 1 'pour paginer en + (suite note 36)
    Sheets("feuil4").Range("q209").ClearContents 'pour effacer N/A
    Sheets("feuil4").Range("o209").ClearContents 'pour effacer A
    
    'annulation de la durée (en mois) de l'exercice N
    Sheets("feuil12").Range("j10").ClearContents
    Sheets("feuil12").Range("h10") = "-"
    
    
    MsgBox "  FIN D'ANNULATION DE LA PAGINATION  !"
    'fin annulation pagination
    Else
    End If
    
    
    
    
    'DESINSTALLATION LOGICIEL
    'If resultat = 2 Then
    'demande de confirmation
    'If MsgBox("Confirmez vous cette opération qui consiste à désinstaller votre logiciel ?", vbYesNo, "Demande de confirmation") = vbYes Then
    
    'If Sheets("feuil12").Range("e7") <> "" And Sheets("feuil12").Range("e8") <> "" And Sheets("feuil12").Range("e10") <> "" Then
    'Sheets("feuil12").Range("a100").ClearContents
    'MsgBox "DESINSTALLATION  !" & Chr(10) & Chr(10) & "Votre logiciel vient d'être désinstallé."
    'Else
    'MsgBox "Désolé  !  Votre logiciel ne peut pas se désinstaller."
    'End If
    
    'demande de confirmation
    'End If
    'fin DEINSTALLATION LOGICIEL
    'Else
    'End If
    
     
    'Si la valeur est différente de "" on affiche le résultat
    Else
    End If

'condition générale
End If

'condition d'installation
'Else
'MsgBox "Désolé  !  Veuillez d'abord installer votre logiciel."
'End If

'délai d'essai
End If
End Sub
Private Sub retour_au_TFT()
Sheets("feuil7").Activate
Sheets("feuil18").Range("a1").ClearContents
End Sub
Private Sub correction_des_flux_n()
'condition générale d'édition
If Sheets("feuil7").Range("g54") = "" Then
MsgBox "Désolé  !  Aucune donnée à corriger."
Else


'condition d'équilibre du TFT N
If Sheets("feuil7").Range("g54") - Sheets("feuil7").Range("g53") <> 0 Then
MsgBox "Veuillez d'abord équilibrer votre Tableau des flux de trésorerie N  !"
Else

'pour activer le bouton VALIDER de la Fiche explicative
Sheets("feuil18").Range("a1") = 2

'efface d'abord les données de N de la fiche
Sheets("feuil18").Range("g11:g107").ClearContents
Sheets("feuil18").Range("g110:g113").ClearContents
Sheets("feuil18").Range("d12").ClearContents
Sheets("feuil18").Range("d107").ClearContents

For i = 3 To 5000
'recup N
'compte 4726 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4726 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 8) 'T
Else
End If

'compte 4041 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4041 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
Else
End If

'compte 4046 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4046 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 8) 'V
Else
End If

'compte 4811 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4811 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
Else
End If

'compte 4821 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4821 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 8) 'X
Else
End If

'compte 17 sauf 176 (mvt crédit)
If Left(Sheets("feuil2").Cells(i, 1), 2) = 17 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 176 Then
Else
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 6) 'Y
End If
Else
End If

'compte 4451 (mvt débit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4451 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 5) 'Z
Else
End If

'compte 4042 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4042 Then
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 8) 'AA
Else
End If

'compte 4047 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4047 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 8) 'AB
Else
End If

'compte 4812 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4812 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 8) 'AC
Else
End If

'compte 4822 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4822 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 8) 'AD
Else
End If

'compte 4813 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4813 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 8) 'AE
Else
End If

'compte 276 (mvt débit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 276 Then
Sheets("feuil2").Cells(i, 32) = Sheets("feuil2").Cells(i, 5) 'AF
Else
End If

'compte 414 (solde débit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 414 Then
Sheets("feuil2").Cells(i, 33) = Sheets("feuil2").Cells(i, 7) 'AG
Else
End If

'compte 485 (solde débit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 485 Then
Sheets("feuil2").Cells(i, 34) = Sheets("feuil2").Cells(i, 7) 'AH
Else
End If

'compte 276 (mvt crédit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 276 Then
Sheets("feuil2").Cells(i, 35) = Sheets("feuil2").Cells(i, 6) 'AI
Else
End If

'compte 4581 (solde débit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4581 Then
Sheets("feuil2").Cells(i, 36) = Sheets("feuil2").Cells(i, 7) 'AJ
Else
End If

'compte 4494 (solde débit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4494 Then
Sheets("feuil2").Cells(i, 37) = Sheets("feuil2").Cells(i, 7) 'AK
Else
End If

'compte 4582 (solde débit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4582 Then
Sheets("feuil2").Cells(i, 38) = Sheets("feuil2").Cells(i, 7) 'AL
Else
End If

'compte 166 (mvt crédit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 166 Then
Sheets("feuil2").Cells(i, 39) = Sheets("feuil2").Cells(i, 6) 'AM
Else
End If

'compte 17 sauf 176 (mvt crédit)
If Left(Sheets("feuil2").Cells(i, 1), 2) = 17 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 176 Then
Else
Sheets("feuil2").Cells(i, 40) = Sheets("feuil2").Cells(i, 6) 'AN
End If
Else
End If

'compte 176 (mvt crédit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 176 Then
Sheets("feuil2").Cells(i, 41) = Sheets("feuil2").Cells(i, 6) 'AO
Else
End If

'compte 183 (mvt crédit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 183 Then
Sheets("feuil2").Cells(i, 42) = Sheets("feuil2").Cells(i, 6) 'AP
Else
End If

'compte 166 + 176 + 183 (mvt débit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 166 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 176 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 183 Then
Sheets("feuil2").Cells(i, 43) = Sheets("feuil2").Cells(i, 5) 'AQ
Else
End If

'compte 276 (solde débit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 276 Then
Sheets("feuil2").Cells(i, 44) = Sheets("feuil2").Cells(i, 7) 'AR
Else
End If

'compte 166 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 166 Then
Sheets("feuil2").Cells(i, 45) = Sheets("feuil2").Cells(i, 8) 'AS
Else
End If

'compte 176 + 183 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 176 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 183 Then
Sheets("feuil2").Cells(i, 46) = Sheets("feuil2").Cells(i, 8) 'AT
Else
End If

'compte 467 (solde débit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 467 Then
Sheets("feuil2").Cells(i, 47) = Sheets("feuil2").Cells(i, 7) 'AU
Else
End If

'compte 478 (solde débit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Then
Sheets("feuil2").Cells(i, 48) = Sheets("feuil2").Cells(i, 7) 'AV
Else
End If

'compte 479 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
Sheets("feuil2").Cells(i, 49) = Sheets("feuil2").Cells(i, 8) 'AW
Else
End If

'compte 72 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 2) = 72 Then
Sheets("feuil2").Cells(i, 50) = Sheets("feuil2").Cells(i, 8) 'AX
Else
End If

'comptes 481 sauf 4811, 4812 et 4813 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 481 Then
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4811 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4812 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4813 Then
Else
Sheets("feuil2").Cells(i, 51) = Sheets("feuil2").Cells(i, 8) 'AY
End If
Else
End If






'recup N-1
'compte 4726 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4726 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 8) 'T
Else
End If


'compte 4041 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4041 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'U
Else
End If

'compte 4046 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4046 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
Else
End If

'compte 4811 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4811 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'Y
Else
End If

'compte 4821 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4821 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 8) 'X
Else
End If

'compte 4042 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4042 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 8) 'AA
Else
End If

'compte 4047 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4047 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 8) 'AB
Else
End If

'compte 4812 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4812 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 8) 'AC
Else
End If

'compte 4822 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4822 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'AD
Else
End If

'compte 4813 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4813 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 8) 'AE
Else
End If

'compte 414 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 414 Then
Sheets("feuil1").Cells(i, 33) = Sheets("feuil1").Cells(i, 7) 'AG
Else
End If

'compte 485 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 485 Then
Sheets("feuil1").Cells(i, 34) = Sheets("feuil1").Cells(i, 7) 'AH
Else
End If

'compte 4581 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4581 Then
Sheets("feuil1").Cells(i, 36) = Sheets("feuil1").Cells(i, 7) 'AJ
Else
End If

'compte 4494 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4494 Then
Sheets("feuil1").Cells(i, 37) = Sheets("feuil1").Cells(i, 7) 'AK
Else
End If

'compte 4582 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4582 Then
Sheets("feuil1").Cells(i, 38) = Sheets("feuil1").Cells(i, 7) 'AL
Else
End If

'compte 276 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 276 Then
Sheets("feuil1").Cells(i, 44) = Sheets("feuil1").Cells(i, 7) 'AR
Else
End If

'compte 166 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 166 Then
Sheets("feuil1").Cells(i, 45) = Sheets("feuil1").Cells(i, 8) 'AS
Else
End If

'compte 176 + 183 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 176 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 183 Then
Sheets("feuil1").Cells(i, 46) = Sheets("feuil1").Cells(i, 8) 'AT
Else
End If

'compte 467 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 467 Then
Sheets("feuil1").Cells(i, 47) = Sheets("feuil1").Cells(i, 7) 'AU
Else
End If

'comptes 481 sauf 4811, 4812 et 4813 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 481 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4811 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4812 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4813 Then
Else
Sheets("feuil1").Cells(i, 51) = Sheets("feuil1").Cells(i, 8) 'AY
End If
Else
End If


Next



'affectation dans le tableau
'TRESORERIE
'solde au 1er janvier - compte 4726
Sheets("feuil18").Range("g11") = Sheets("feuil7").Range("g12") - WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000"))
'dont solde au 1er janvier - compte 4726
Sheets("feuil18").Range("d12") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000"))
'solde au 31 décembre - compte 4726
Sheets("feuil18").Range("g106") = Sheets("feuil7").Range("g53") - WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000"))
'dont solde au 31 décembre - compte 4726
Sheets("feuil18").Range("d107") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000"))


'INVESTISSEMENTS
'Décaissements des immob incorporelles
Sheets("feuil18").Range("g31") = Sheets("feuil7").Range("g26")
'variation du compte 4041
Sheets("feuil18").Range("g34") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000"))
'variation du compte 4046
Sheets("feuil18").Range("g35") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000"))
'variation du compte 4811
Sheets("feuil18").Range("g36") = WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000"))
'variation du compte 4821
Sheets("feuil18").Range("g37") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000"))

'Décaissements des immob corporelles
Sheets("feuil18").Range("g43") = Sheets("feuil7").Range("g27")
'biens corporelles pris en location acquisition (mvt crédit du compte 17 sauf 176)
Sheets("feuil18").Range("g44") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000"))
'tva récupréeé sur immobilisations (mvt crédit du compte 4451)
Sheets("feuil18").Range("g45") = -WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000"))
'variation du compte 4042
Sheets("feuil18").Range("g46") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000"))
'variation du compte 4047
Sheets("feuil18").Range("g47") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000"))
'variation du compte 4812
Sheets("feuil18").Range("g48") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000"))
'variation du compte 4822
Sheets("feuil18").Range("g49") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000"))

'Décaissements des immob financières
Sheets("feuil18").Range("g55") = Sheets("feuil7").Range("g28")
'variation du compte 4813
Sheets("feuil18").Range("g56") = WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000"))
'intérêts courus du compte 276 (mvt débit)
Sheets("feuil18").Range("g57") = WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000"))

'Ecaissements des immob incorporelles et corporelles
Sheets("feuil18").Range("g62") = Sheets("feuil7").Range("g29")
'variation du compte 414
Sheets("feuil18").Range("g64") = -(WorksheetFunction.Sum(Sheets("feuil2").Range("ag1:ag5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("ag1:ag5000")))
'variation du compte 485
Sheets("feuil18").Range("g65") = -(WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("ah1:ah5000")))

'Ecaissements des immob financières
Sheets("feuil18").Range("g71") = Sheets("feuil7").Range("g30")
'intérêts courus du compte 276 (mvt crédit)
Sheets("feuil18").Range("g72") = -WorksheetFunction.Sum(Sheets("feuil2").Range("ai1:ai5000"))

'FINANCEMENTS
'Augmentations de capital par apports nouveaux
Sheets("feuil18").Range("g77") = Sheets("feuil7").Range("g35")
'variation du compte 4581
Sheets("feuil18").Range("g79") = -(WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")))
'variation du compte 467
Sheets("feuil18").Range("g80") = -(WorksheetFunction.Sum(Sheets("feuil2").Range("au1:au5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("au1:au5000")))

'Prélèvements sur le capital
Sheets("feuil18").Range("g82") = Sheets("feuil7").Range("g37")

'Subventions d'investissement reçues
Sheets("feuil18").Range("g84") = Sheets("feuil7").Range("g36")
'variation du compte 4494
Sheets("feuil18").Range("g85") = -(WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")))
'variation du compte 4582
Sheets("feuil18").Range("g86") = -(WorksheetFunction.Sum(Sheets("feuil2").Range("al1:al5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")))

'Dividendes versés
Sheets("feuil18").Range("g88") = Sheets("feuil7").Range("g38")

'Emprunts
Sheets("feuil18").Range("g90") = Sheets("feuil7").Range("g43")
'intérêts courus du compte 166 (mvt crédit)
Sheets("feuil18").Range("g91") = -WorksheetFunction.Sum(Sheets("feuil2").Range("am1:am5000"))

'Autres dettes financières
Sheets("feuil18").Range("g94") = Sheets("feuil7").Range("g44")
'emprunts de location acquisition
Sheets("feuil18").Range("g95") = -WorksheetFunction.Sum(Sheets("feuil2").Range("an1:an5000"))
'intérêts courus du compte 176 (mvt crédit)
Sheets("feuil18").Range("g96") = -WorksheetFunction.Sum(Sheets("feuil2").Range("ao1:ao5000"))
'intérêts courus du compte 183 (mvt crédit)
Sheets("feuil18").Range("g97") = -WorksheetFunction.Sum(Sheets("feuil2").Range("ap1:ap5000"))

'Remboursements des emprunts et autres dettes financières
Sheets("feuil18").Range("g100") = Sheets("feuil7").Range("g45")
'intérêts courus des comptes 166, 176, 183 (mvt débit)
Sheets("feuil18").Range("g102") = WorksheetFunction.Sum(Sheets("feuil2").Range("aq1:aq5000"))

'CAFG
Sheets("feuil18").Range("g14") = Sheets("feuil7").Range("g15")
'intérêts courus du compte 276
Sheets("feuil18").Range("g15") = -(WorksheetFunction.Sum(Sheets("feuil2").Range("ar1:ar5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("ar1:ar5000")))
'intérêts courus du compte 166
Sheets("feuil18").Range("g16") = (WorksheetFunction.Sum(Sheets("feuil2").Range("as1:as5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("as1:as5000")))
'intérêts courus des comptes 176 + 183
Sheets("feuil18").Range("g17") = (WorksheetFunction.Sum(Sheets("feuil2").Range("at1:at5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("at1:at5000")))

'Variation du BFE
Sheets("feuil18").Range("g19") = Sheets("feuil7").Range("d22")
'tva récupérable sur immobiisation
Sheets("feuil18").Range("g20") = -(Sheets("feuil18").Range("g45") + Sheets("feuil18").Range("g33"))
'variation actif circulant H.A.O.
Sheets("feuil18").Range("g22") = -Sheets("feuil18").Range("g65")
'variation actif circulant
Sheets("feuil18").Range("g23") = -(Sheets("feuil18").Range("g64") + Sheets("feuil18").Range("g79") + Sheets("feuil18").Range("g80") + Sheets("feuil18").Range("g85") + Sheets("feuil18").Range("g86"))
'variation passif circulant
Sheets("feuil18").Range("g24") = -(WorksheetFunction.Sum(Sheets("feuil18").Range("g34:g37")) + WorksheetFunction.Sum(Sheets("feuil18").Range("g46:g49")) + Sheets("feuil18").Range("g56"))
'variation du compte 4726
Sheets("feuil18").Range("g25") = -(WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")))
'écarts de conversion ACTIF
Sheets("feuil18").Range("g26") = -(Sheets("feuil18").Range("g38") + Sheets("feuil18").Range("g39") + Sheets("feuil18").Range("g50") + Sheets("feuil18").Range("g51") + Sheets("feuil18").Range("g58") + Sheets("feuil18").Range("g66") + Sheets("feuil18").Range("g67") + Sheets("feuil18").Range("g73") + Sheets("feuil18").Range("g92") + Sheets("feuil18").Range("g98"))
'écarts de conversion PASSIF
Sheets("feuil18").Range("g27") = -(Sheets("feuil18").Range("g40") + Sheets("feuil18").Range("g41") + Sheets("feuil18").Range("g52") + Sheets("feuil18").Range("g53") + Sheets("feuil18").Range("g60") + Sheets("feuil18").Range("g68") + Sheets("feuil18").Range("g69") + Sheets("feuil18").Range("g103"))

'Production immobilisée
Sheets("feuil18").Range("g110") = WorksheetFunction.Sum(Sheets("feuil2").Range("ax1:ax5000"))

'_________________________________________________________________________________

'Calculs du tableau

'FLUX opérationnels
'Sous total CAFG
Sheets("feuil18").Range("g18") = WorksheetFunction.Sum(Sheets("feuil18").Range("g14:g17"))
'Sous total BFE
Sheets("feuil18").Range("g28") = WorksheetFunction.Sum(Sheets("feuil18").Range("g19:g27"))
'Total flux opérationnels
Sheets("feuil18").Range("g29") = Sheets("feuil18").Range("g18") + Sheets("feuil18").Range("g28")

'FLUX investissements
'Sous total décaissements immob incorporelles
Sheets("feuil18").Range("g42") = WorksheetFunction.Sum(Sheets("feuil18").Range("g31:g41"))
'Sous total décaissements immob corporelles
Sheets("feuil18").Range("g54") = WorksheetFunction.Sum(Sheets("feuil18").Range("g43:g53"))
'Sous total décaissements immob financières
Sheets("feuil18").Range("g61") = WorksheetFunction.Sum(Sheets("feuil18").Range("g55:g60"))
'Sous total encaissements immob incorporelles et corporelles
Sheets("feuil18").Range("g70") = WorksheetFunction.Sum(Sheets("feuil18").Range("g62:g69"))
'Sous total encaissements immob financières
Sheets("feuil18").Range("g74") = WorksheetFunction.Sum(Sheets("feuil18").Range("g71:g73"))
'Total flux investissements
Sheets("feuil18").Range("g75") = Sheets("feuil18").Range("g42") + Sheets("feuil18").Range("g54") + Sheets("feuil18").Range("g61") + Sheets("feuil18").Range("g70") + Sheets("feuil18").Range("g74")

'FLUX financements
'Sous total Augmentations de capital
Sheets("feuil18").Range("g81") = WorksheetFunction.Sum(Sheets("feuil18").Range("g77:g80"))
'Sous total prélèvement sur le capital
Sheets("feuil18").Range("g83") = Sheets("feuil18").Range("g82")
'Sous total subventions d'investissements
Sheets("feuil18").Range("g87") = WorksheetFunction.Sum(Sheets("feuil18").Range("g84:g86"))
'Sous total dividendes versés
Sheets("feuil18").Range("g89") = Sheets("feuil18").Range("g88")
'Sous total emprunts
Sheets("feuil18").Range("g93") = WorksheetFunction.Sum(Sheets("feuil18").Range("g90:g92"))
'Sous total autres dettes financières
Sheets("feuil18").Range("g99") = WorksheetFunction.Sum(Sheets("feuil18").Range("g94:g98"))
'Sous total remboursements emprunts et dettes
Sheets("feuil18").Range("g104") = WorksheetFunction.Sum(Sheets("feuil18").Range("g100:g103"))
'Total flux financements
Sheets("feuil18").Range("g105") = Sheets("feuil18").Range("g81") + Sheets("feuil18").Range("g83") + Sheets("feuil18").Range("g87") + Sheets("feuil18").Range("g89") + Sheets("feuil18").Range("g93") + Sheets("feuil18").Range("g99") + Sheets("feuil18").Range("g104")

'_______________________________________________________________________________________________________


'affiche la fiche explicative
Sheets("feuil18").Activate

'___________________________________________________________________________________
'message d'équilibre de la fiche explicative et des corrections à effectuer
If Sheets("feuil18").Range("g11") + Sheets("feuil18").Range("g29") + Sheets("feuil18").Range("g75") + Sheets("feuil18").Range("g105") - Sheets("feuil18").Range("g106") = 0 Then
MsgBox "FICHE EXPLICATIVE  N  équilibrée  !" & Chr(10) & Chr(10) & "Veuillez procéder aux éventuelles corrections manuelles."

'message de corrections manuelles obligatoires
'ecarts de conversion actif
If WorksheetFunction.Sum(Sheets("feuil2").Range("av1:av5000")) > 0 Then
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "L'écart de conversion - Actif a un solde en N de  " & WorksheetFunction.Sum(Sheets("feuil2").Range("av1:av5000")) & "." & Chr(10) & "Veuillez affecter la quote-part relative aux dettes et créances financières ainsi qu'aux fournisseurs et créances d'investissement."
Else
End If
'ecarts de conversion passif
If WorksheetFunction.Sum(Sheets("feuil2").Range("aw1:aw5000")) > 0 Then
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "L'écart de conversion - Passif a un solde en N de  " & WorksheetFunction.Sum(Sheets("feuil2").Range("aw1:aw5000")) & "." & Chr(10) & "Veuillez affecter la quote-part relative aux dettes et créances financières ainsi qu'aux fournisseurs et créances d'investissement."
Else
End If
'Autres fournisseurs d'investissement (comptes 481 sauf 4811, 4812 et 4813)
If (WorksheetFunction.Sum(Sheets("feuil2").Range("ay1:ay5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("ay1:ay5000"))) <> 0 Then
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "Les Autres fournisseurs d'investissement (comptes 481 sauf 4811, 4812 et 4813) ont une variation en  N  de  " & (WorksheetFunction.Sum(Sheets("feuil2").Range("ay1:ay5000")) - WorksheetFunction.Sum(Sheets("feuil1").Range("ay1:ay5000"))) & "." & Chr(10) & "Veuillez éventuellement répartir le montant entre immobilisations incorporelle et corporelle."
Else
End If
'opérations de location acquisition (crédit bail)
If WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) > 0 Then
Sheets("feuil18").Range("g44").Select
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "Le mouvement au crédit du compte 17, représentant le coût des biens pris en location acquisition en N, est de  " & WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000")) & "." & Chr(10) & "Veuillez vérifier l'exactitude du montant récupéré et le répartir entre immobilisations corporelle et incorporelle éventuellement."
Else
End If
'tva récupérable sur acquisitions d'immobilisations
If WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) > 0 Then
Sheets("feuil18").Range("g45").Select
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "Le mouvement au débit du compte 4451, représentant la TVA récupérée sur les acquisitions d'immobilisations en N, est de  " & WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000")) & "." & Chr(10) & "Veuillez vérifier l'exactitude du montant récupéré et le répartir entre immobilisations corporelle et incorporelle éventuellement."
Else
End If
'tva facturée sur cessions d'immobilisations
If Sheets("feuil18").Range("g62") > 0 Then
Sheets("feuil18").Range("g62").Select
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "Il y a eu cession d'immobilisation en N de " & Sheets("feuil18").Range("g62") & "." & Chr(10) & "Veuillez indiquer la TVA éventuelle facturée."
Else
End If
'production immobilisée
If Sheets("feuil18").Range("g110") > 0 Then
Sheets("feuil18").Range("g110").Select
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "Il y a eu production immobilisée en N de " & Sheets("feuil18").Range("g110") & "." & Chr(10) & "Veuillez indiquer la quote-part éventuelle non réglée sur les immobilisations incorporelles, corporelles ou financières."
Else
End If

'message d'équilibre de la fiche explicative et des corrections
Else
MsgBox "ATTENTION  !  FICHE EXPLICATIVE  N  déséquilibrée de  " & Abs(Sheets("feuil18").Range("g11") + Sheets("feuil18").Range("g29") + Sheets("feuil18").Range("g75") + Sheets("feuil18").Range("g105") - Sheets("feuil18").Range("g106")) & "."
End If
'______________________________________________________________________________________



'efface les données des feuil1 et feuil2
Sheets("feuil1").Range("t1:za5000").ClearContents
Sheets("feuil2").Range("t1:za5000").ClearContents



'condition d'équilibre du TFT N
End If

'condition générale d'édition
End If
End Sub
Private Sub valider_fiche_explicative_n()
'demande de validation
If MsgBox("Confirmez vous la validation des corrections de N ?", vbYesNo, "Demande de confirmation") = vbYes Then

For i = 3 To 5000
'recup N
'compte 478 (solde débit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 478 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 479 (solde crédit)
If Left(Sheets("feuil2").Cells(i, 1), 3) = 479 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 8) 'U
Else
End If

Next



'_______________________________________________________________________
'Déduction des ECA / ECP du BF opérationnel et la TVA facturée sur cession d'immob
'écarts de conversion ACTIF
Sheets("feuil18").Range("g26") = -(Sheets("feuil18").Range("g38") + Sheets("feuil18").Range("g39") + Sheets("feuil18").Range("g50") + Sheets("feuil18").Range("g51") + Sheets("feuil18").Range("g58") + Sheets("feuil18").Range("g66") + Sheets("feuil18").Range("g67") + Sheets("feuil18").Range("g73") + Sheets("feuil18").Range("g92") + Sheets("feuil18").Range("g98"))
'écarts de conversion PASSIF
Sheets("feuil18").Range("g27") = -(Sheets("feuil18").Range("g40") + Sheets("feuil18").Range("g41") + Sheets("feuil18").Range("g52") + Sheets("feuil18").Range("g53") + Sheets("feuil18").Range("g60") + Sheets("feuil18").Range("g68") + Sheets("feuil18").Range("g69") + Sheets("feuil18").Range("g103"))
'TVA facturée sur cessions d'immobilisation
Sheets("feuil18").Range("g21") = -Sheets("feuil18").Range("g63")

'_______________________________________________________________________

'Calculs dans la fiche

'FLUX opérationnels
'Sous total CAFG - production immobilisée
Sheets("feuil18").Range("g14") = Sheets("feuil18").Range("g14") - Abs(WorksheetFunction.Sum(Sheets("feuil18").Range("g111:g113"))) 'CAFG - production immobilisée
Sheets("feuil18").Range("g18") = WorksheetFunction.Sum(Sheets("feuil18").Range("g14:g17"))
'Sous total BFE
Sheets("feuil18").Range("g28") = WorksheetFunction.Sum(Sheets("feuil18").Range("g19:g27"))
'Total flux opérationnels
Sheets("feuil18").Range("g29") = Sheets("feuil18").Range("g18") + Sheets("feuil18").Range("g28")

'FLUX investissements
'Sous total décaissements immob incorporelles - production immobilisée
Sheets("feuil18").Range("g31") = Sheets("feuil18").Range("g31") + Abs(Sheets("feuil18").Range("g111"))
Sheets("feuil18").Range("g42") = WorksheetFunction.Sum(Sheets("feuil18").Range("g31:g41"))
'Sous total décaissements immob corporelles - production immobilisée
Sheets("feuil18").Range("g43") = Sheets("feuil18").Range("g43") + Abs(Sheets("feuil18").Range("g112"))
Sheets("feuil18").Range("g54") = WorksheetFunction.Sum(Sheets("feuil18").Range("g43:g53"))
'Sous total décaissements immob financières - production immobilisée
Sheets("feuil18").Range("g55") = Sheets("feuil18").Range("g55") + Abs(Sheets("feuil18").Range("g113"))
Sheets("feuil18").Range("g61") = WorksheetFunction.Sum(Sheets("feuil18").Range("g55:g60"))
'Sous total encaissements immob incorporelles et corporelles
Sheets("feuil18").Range("g70") = WorksheetFunction.Sum(Sheets("feuil18").Range("g62:g69"))
'Sous total encaissements immob financières
Sheets("feuil18").Range("g74") = WorksheetFunction.Sum(Sheets("feuil18").Range("g71:g73"))
'Total flux investissements
Sheets("feuil18").Range("g75") = Sheets("feuil18").Range("g42") + Sheets("feuil18").Range("g54") + Sheets("feuil18").Range("g61") + Sheets("feuil18").Range("g70") + Sheets("feuil18").Range("g74")

'FLUX financements
'Sous total Augmentations de capital
Sheets("feuil18").Range("g81") = WorksheetFunction.Sum(Sheets("feuil18").Range("g77:g80"))
'Sous total prélèvement sur le capital
Sheets("feuil18").Range("g83") = Sheets("feuil18").Range("g82")
'Sous total subventions d'investissements
Sheets("feuil18").Range("g87") = WorksheetFunction.Sum(Sheets("feuil18").Range("g84:g86"))
'Sous total dividendes versés
Sheets("feuil18").Range("g89") = Sheets("feuil18").Range("g88")
'Sous total emprunts
Sheets("feuil18").Range("g93") = WorksheetFunction.Sum(Sheets("feuil18").Range("g90:g92"))
'Sous total autres dettes financières
Sheets("feuil18").Range("g99") = WorksheetFunction.Sum(Sheets("feuil18").Range("g94:g98"))
'Sous total remboursements emprunts et dettes
Sheets("feuil18").Range("g104") = WorksheetFunction.Sum(Sheets("feuil18").Range("g100:g103"))
'Total flux financements
Sheets("feuil18").Range("g105") = Sheets("feuil18").Range("g81") + Sheets("feuil18").Range("g83") + Sheets("feuil18").Range("g87") + Sheets("feuil18").Range("g89") + Sheets("feuil18").Range("g93") + Sheets("feuil18").Range("g99") + Sheets("feuil18").Range("g104")

'_____________________________________________________________________________________________________________________________

'CONTRÔLE DE CONCORDANCE DANS LA FICHE
'efface d'abord la colonne z (z1 à z3) / condition d'affectation de la fiche au T.F.T. N
Sheets("feuil18").Range("z1:z3").ClearContents

'Ecarts de conversion Actif
If Sheets("feuil18").Range("g26") > WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) Then
MsgBox "Attention  !  Le montant des Ecarts de conversion - Actif reparti  " & Sheets("feuil18").Range("g26") & "  est supérieur au montant comptabilisé  " & WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) & "." & Chr(10) & Chr(10) & "NB : Veuillez revoir les affectations  !"
Sheets("feuil18").Range("z1") = 1
Else
End If
'Ecart de conversion passif
If -Sheets("feuil18").Range("g27") > WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) Then
MsgBox "Attention  !  Le montant des Ecarts de conversion - Passif reparti  " & -Sheets("feuil18").Range("g27") & "  est supérieur au montant comptabilisé  " & WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) & "." & Chr(10) & Chr(10) & "NB : Veuillez revoir les affectations  !"
Sheets("feuil18").Range("z2") = 1
Else
End If
'Opération d'acquisition location (crédit bail)
If -Sheets("feuil18").Range("g95") <> Sheets("feuil18").Range("g32") + Sheets("feuil18").Range("g44") Then
MsgBox "Attention  !  Le montant des Emprunts de location acquisition  " & -Sheets("feuil18").Range("g95") & "  est différent du montant inscrit en Biens pris en location acquisition (incorporelle ou corporelle)  " & Sheets("feuil18").Range("g32") + Sheets("feuil18").Range("g44") & "." & Chr(10) & Chr(10) & "NB : Veuillez revoir les affectations  !"
Sheets("feuil18").Range("z3") = 1
Else
End If

'_________________________________________________________________________________________________________________________________

'AFFECTATION DE LA FICHE AU T.F.T. N
'condition générale d'affectation de la fiche au T.F.T. N
If WorksheetFunction.Sum(Sheets("feuil18").Range("z1:z3")) <> 0 Then
Else

'condition spécifique d'affectation de la fiche au T.F.T. N
If Sheets("feuil18").Range("g11") + Sheets("feuil18").Range("g29") + Sheets("feuil18").Range("g75") + Sheets("feuil18").Range("g105") - Sheets("feuil18").Range("g106") = 0 Then

'Affectation des flux corrigés dans le T.F.T. N
'tresorerie au 1er janvier
Sheets("feuil7").Range("g12") = Sheets("feuil18").Range("g11")
'CAFG
Sheets("feuil7").Range("g15") = Sheets("feuil18").Range("g18")
'variaition actif circulant H.A.O.
Sheets("feuil7").Range("g16") = Sheets("feuil7").Range("g16") + Sheets("feuil18").Range("g22")
'variaition actif circulant
Sheets("feuil7").Range("g18") = Sheets("feuil7").Range("g18") + Sheets("feuil18").Range("g20") + Sheets("feuil18").Range("g23") + Sheets("feuil18").Range("g26")
'variaition passif circulant
Sheets("feuil7").Range("g19") = Sheets("feuil7").Range("g19") + Sheets("feuil18").Range("g21") + Sheets("feuil18").Range("g24") + Sheets("feuil18").Range("g25") + Sheets("feuil18").Range("g27")
'décaissements immob incorporels
Sheets("feuil7").Range("g26") = Sheets("feuil18").Range("g42")
'décaissements immob corporels
Sheets("feuil7").Range("g27") = Sheets("feuil18").Range("g54")
'décaissements immob financières
Sheets("feuil7").Range("g28") = Sheets("feuil18").Range("g61")
'encaissements immob incorporelles et corporelles
Sheets("feuil7").Range("g29") = Sheets("feuil18").Range("g70")
'encaissements immob financières
Sheets("feuil7").Range("g30") = Sheets("feuil18").Range("g74")
'augmentation de capital
Sheets("feuil7").Range("g35") = Sheets("feuil18").Range("g81")
'subventions d'investissement
Sheets("feuil7").Range("g36") = Sheets("feuil18").Range("g87")
'prélèvements sur le capital
Sheets("feuil7").Range("g37") = Sheets("feuil18").Range("g83")
'dividendes
Sheets("feuil7").Range("g38") = Sheets("feuil18").Range("g89")
'emprunts
Sheets("feuil7").Range("g43") = Sheets("feuil18").Range("g93")
'autres dettes financières
Sheets("feuil7").Range("g44") = Sheets("feuil18").Range("g99")
'remboursements des emprunts et dettes
Sheets("feuil7").Range("g45") = Sheets("feuil18").Range("g104")
'trésorerie au 31 décembre
Sheets("feuil7").Range("g53") = Sheets("feuil18").Range("g106")

'Calcul des flux de trésorerie dans le tableau du TAFIRE
'total flux de trésorerie opérationnelle
Sheets("feuil7").Range("g23") = WorksheetFunction.Sum(Sheets("feuil7").Range("g15:g19"))
'variation BF opérationelle
Sheets("feuil7").Range("d22") = WorksheetFunction.Sum(Sheets("feuil7").Range("g16:g19"))

'total flux de trésorerie investissements
Sheets("feuil7").Range("g32") = WorksheetFunction.Sum(Sheets("feuil7").Range("g26:g30"))

'total flux de trésorerie financements propres
Sheets("feuil7").Range("g40") = WorksheetFunction.Sum(Sheets("feuil7").Range("g35:g38"))

'total flux de trésorerie financements étrangers
Sheets("feuil7").Range("g47") = WorksheetFunction.Sum(Sheets("feuil7").Range("g43:g45"))

'total flux de trésorerie financements total
Sheets("feuil7").Range("g49") = Sheets("feuil7").Range("g40") + Sheets("feuil7").Range("g47")

'variation de la trésorerie de la période
Sheets("feuil7").Range("g51") = Sheets("feuil7").Range("g23") + Sheets("feuil7").Range("g32") + Sheets("feuil7").Range("g49")

'trésorerie nette au 31 décemnre
Sheets("feuil7").Range("g53") = Sheets("feuil7").Range("g12") + Sheets("feuil7").Range("g51")

MsgBox "T.F.T.  N  corrigé équilibré  !" & Chr(10) & Chr(10) & "NB : Veuillez obligatoirement imprimer la FICHE explicative pour justifier le retraitement des flux de trésorerie."
Application.Sheets("feuil18").PrintPreview

'condition spécifique d'affectation de la fiche au T.F.T. N
Else
MsgBox "T.F.T.  N  corrigé déséquilibré de  " & Abs(Sheets("feuil18").Range("g11") + Sheets("feuil18").Range("g29") + Sheets("feuil18").Range("g75") + Sheets("feuil18").Range("g105") - Sheets("feuil18").Range("g106")) & "." & Chr(10) & Chr(10) & "Veuillez reprendre les corrections  !"
End If

'condition générale d'affectation de la fiche au T.F.T. N
End If
'______________________________________________________________________________________________________________



'efface les données de la feuil2
Sheets("feuil2").Range("t1:za5000").ClearContents

'demande de validation
End If
End Sub
Private Sub correction_des_flux_n_1()
'condition générale d'édition
If Sheets("feuil7").Range("h54") = "" Then
MsgBox "Désolé  !  Aucune donnée à corriger."
Else

'condition d'équilibre du TFT N-1
If Sheets("feuil7").Range("h54") - Sheets("feuil7").Range("h53") <> 0 Then
MsgBox "Veuillez d'abord équilibrer votre Tableau des flux de trésorerie N-1  !"
Else

'pour activer le bouton VALIDER de la Fiche explicative
Sheets("feuil18").Range("a1") = 1

'efface d'abord les données de N -1 de la fiche
Sheets("feuil18").Range("h11:h107").ClearContents
Sheets("feuil18").Range("h110:h113").ClearContents
Sheets("feuil18").Range("e12").ClearContents
Sheets("feuil18").Range("e107").ClearContents

For i = 3 To 5000
'recup N-1
'compte 4726 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4726 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 8) 'T
Else
End If

'compte 4041 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4041 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'U
Else
End If

'compte 4046 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4046 Then
Sheets("feuil1").Cells(i, 22) = Sheets("feuil1").Cells(i, 8) 'V
Else
End If

'compte 4811 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4811 Then
Sheets("feuil1").Cells(i, 23) = Sheets("feuil1").Cells(i, 8) 'W
Else
End If

'compte 4821 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4821 Then
Sheets("feuil1").Cells(i, 24) = Sheets("feuil1").Cells(i, 8) 'X
Else
End If

'compte 17 sauf 176 (mvt crédit)
If Left(Sheets("feuil1").Cells(i, 1), 2) = 17 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 176 Then
Else
Sheets("feuil1").Cells(i, 25) = Sheets("feuil1").Cells(i, 6) 'Y
End If
Else
End If

'compte 4451 (mvt débit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4451 Then
Sheets("feuil1").Cells(i, 26) = Sheets("feuil1").Cells(i, 5) 'Z
Else
End If

'compte 4042 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4042 Then
Sheets("feuil1").Cells(i, 27) = Sheets("feuil1").Cells(i, 8) 'AA
Else
End If

'compte 4047 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4047 Then
Sheets("feuil1").Cells(i, 28) = Sheets("feuil1").Cells(i, 8) 'AB
Else
End If

'compte 4812 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4812 Then
Sheets("feuil1").Cells(i, 29) = Sheets("feuil1").Cells(i, 8) 'AC
Else
End If

'compte 4822 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4822 Then
Sheets("feuil1").Cells(i, 30) = Sheets("feuil1").Cells(i, 8) 'AD
Else
End If

'compte 4813 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4813 Then
Sheets("feuil1").Cells(i, 31) = Sheets("feuil1").Cells(i, 8) 'AE
Else
End If

'compte 276 (mvt débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 276 Then
Sheets("feuil1").Cells(i, 32) = Sheets("feuil1").Cells(i, 5) 'AF
Else
End If

'compte 414 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 414 Then
Sheets("feuil1").Cells(i, 33) = Sheets("feuil1").Cells(i, 7) 'AG
Else
End If

'compte 485 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 485 Then
Sheets("feuil1").Cells(i, 34) = Sheets("feuil1").Cells(i, 7) 'AH
Else
End If

'compte 276 (mvt crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 276 Then
Sheets("feuil1").Cells(i, 35) = Sheets("feuil1").Cells(i, 6) 'AI
Else
End If

'compte 4581 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4581 Then
Sheets("feuil1").Cells(i, 36) = Sheets("feuil1").Cells(i, 7) 'AJ
Else
End If

'compte 4494 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4494 Then
Sheets("feuil1").Cells(i, 37) = Sheets("feuil1").Cells(i, 7) 'AK
Else
End If

'compte 4582 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4582 Then
Sheets("feuil1").Cells(i, 38) = Sheets("feuil1").Cells(i, 7) 'AL
Else
End If

'compte 166 (mvt crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 166 Then
Sheets("feuil1").Cells(i, 39) = Sheets("feuil1").Cells(i, 6) 'AM
Else
End If

'compte 17 sauf 176 (mvt crédit)
If Left(Sheets("feuil1").Cells(i, 1), 2) = 17 Then
If Left(Sheets("feuil1").Cells(i, 1), 3) = 176 Then
Else
Sheets("feuil1").Cells(i, 40) = Sheets("feuil1").Cells(i, 6) 'AN
End If
Else
End If

'compte 176 (mvt crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 176 Then
Sheets("feuil1").Cells(i, 41) = Sheets("feuil1").Cells(i, 6) 'AO
Else
End If

'compte 183 (mvt crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 183 Then
Sheets("feuil1").Cells(i, 42) = Sheets("feuil1").Cells(i, 6) 'AP
Else
End If

'compte 166 + 176 + 183 (mvt débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 166 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 176 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 183 Then
Sheets("feuil1").Cells(i, 43) = Sheets("feuil1").Cells(i, 5) 'AQ
Else
End If

'compte 276 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 276 Then
Sheets("feuil1").Cells(i, 44) = Sheets("feuil1").Cells(i, 7) 'AR
Else
End If

'compte 166 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 166 Then
Sheets("feuil1").Cells(i, 45) = Sheets("feuil1").Cells(i, 8) 'AS
Else
End If

'compte 176 + 183 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 176 Or Left(Sheets("feuil1").Cells(i, 1), 3) = 183 Then
Sheets("feuil1").Cells(i, 46) = Sheets("feuil1").Cells(i, 8) 'AT
Else
End If

'compte 467 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 467 Then
Sheets("feuil1").Cells(i, 47) = Sheets("feuil1").Cells(i, 7) 'AU
Else
End If

'compte 478 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 478 Then
Sheets("feuil1").Cells(i, 48) = Sheets("feuil1").Cells(i, 7) 'AV
Else
End If

'compte 479 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 479 Then
Sheets("feuil1").Cells(i, 49) = Sheets("feuil1").Cells(i, 8) 'AW
Else
End If

'compte 72 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 2) = 72 Then
Sheets("feuil1").Cells(i, 50) = Sheets("feuil1").Cells(i, 8) 'AX
Else
End If

'comptes 481 sauf 4811, 4812 et 4813 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 481 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4811 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4812 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4813 Then
Else
Sheets("feuil1").Cells(i, 51) = Sheets("feuil1").Cells(i, 8) 'AY
End If
Else
End If





'recup N-2
'compte 4726 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4726 Then
Sheets("feuil28").Cells(i, 20) = Sheets("feuil1").Cells(i, 4) 'T
Else
End If


'compte 4041 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4041 Then
Sheets("feuil28").Cells(i, 21) = Sheets("feuil1").Cells(i, 4) 'U
Else
End If

'compte 4046 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4046 Then
Sheets("feuil28").Cells(i, 22) = Sheets("feuil1").Cells(i, 4) 'V
Else
End If

'compte 4811 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4811 Then
Sheets("feuil28").Cells(i, 23) = Sheets("feuil1").Cells(i, 4) 'Y
Else
End If

'compte 4821 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4821 Then
Sheets("feuil28").Cells(i, 24) = Sheets("feuil1").Cells(i, 4) 'X
Else
End If

'compte 4042 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4042 Then
Sheets("feuil28").Cells(i, 27) = Sheets("feuil1").Cells(i, 4) 'AA
Else
End If

'compte 4047 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4047 Then
Sheets("feuil28").Cells(i, 28) = Sheets("feuil1").Cells(i, 4) 'AB
Else
End If

'compte 4812 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4812 Then
Sheets("feuil28").Cells(i, 29) = Sheets("feuil1").Cells(i, 4) 'AC
Else
End If

'compte 4822 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4822 Then
Sheets("feuil28").Cells(i, 30) = Sheets("feuil1").Cells(i, 4) 'AD
Else
End If

'compte 4813 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4813 Then
Sheets("feuil28").Cells(i, 31) = Sheets("feuil1").Cells(i, 4) 'AE
Else
End If

'compte 414 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 414 Then
Sheets("feuil28").Cells(i, 33) = Sheets("feuil1").Cells(i, 3) 'AG
Else
End If

'compte 485 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 485 Then
Sheets("feuil28").Cells(i, 34) = Sheets("feuil1").Cells(i, 3) 'AH
Else
End If

'compte 4581 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4581 Then
Sheets("feuil28").Cells(i, 36) = Sheets("feuil1").Cells(i, 3) 'AJ
Else
End If

'compte 4494 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4494 Then
Sheets("feuil28").Cells(i, 37) = Sheets("feuil1").Cells(i, 3) 'AK
Else
End If

'compte 4582 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4582 Then
Sheets("feuil28").Cells(i, 38) = Sheets("feuil1").Cells(i, 3) 'AL
Else
End If

'compte 276 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 276 Then
Sheets("feuil28").Cells(i, 44) = Sheets("feuil1").Cells(i, 3) 'AR
Else
End If

'compte 166 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 166 Then
Sheets("feuil28").Cells(i, 45) = Sheets("feuil1").Cells(i, 4) 'AS
Else
End If

'compte 176 + 183 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 176 Or Left(Sheets("feuil28").Cells(i, 1), 3) = 183 Then
Sheets("feuil28").Cells(i, 46) = Sheets("feuil1").Cells(i, 4) 'AT
Else
End If

'compte 467 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 467 Then
Sheets("feuil28").Cells(i, 47) = Sheets("feuil1").Cells(i, 3) 'AU
Else
End If

'comptes 481 sauf 4811, 4812 et 4813 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 481 Then
If Left(Sheets("feuil1").Cells(i, 1), 4) = 4811 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4812 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 4813 Then
Sheets("feuil28").Cells(i, 51) = Sheets("feuil1").Cells(i, 4) 'AY
End If
Else
End If


Next



'affectation dans le tableau
'TRESORERIE
'solde au 1er janvier - compte 4726
Sheets("feuil18").Range("h11") = Sheets("feuil7").Range("h12") - WorksheetFunction.Sum(Sheets("feuil28").Range("t1:t5000"))
'dont solde au 1er janvier - compte 4726
Sheets("feuil18").Range("e12") = WorksheetFunction.Sum(Sheets("feuil28").Range("t1:t5000"))
'solde au 31 décembre - compte 4726
Sheets("feuil18").Range("h106") = Sheets("feuil7").Range("h53") - WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000"))
'dont solde au 31 décembre - compte 4726
Sheets("feuil18").Range("e107") = WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000"))


'INVESTISSEMENTS
'Décaissements des immob incorporelles
Sheets("feuil18").Range("h31") = Sheets("feuil7").Range("h26")
'variation du compte 4041
Sheets("feuil18").Range("h34") = WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("u1:u5000"))
'variation du compte 4046
Sheets("feuil18").Range("h35") = WorksheetFunction.Sum(Sheets("feuil1").Range("v1:v5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("v1:v5000"))
'variation du compte 4811
Sheets("feuil18").Range("h36") = WorksheetFunction.Sum(Sheets("feuil1").Range("w1:w5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("w1:w5000"))
'variation du compte 4821
Sheets("feuil18").Range("h37") = WorksheetFunction.Sum(Sheets("feuil1").Range("x1:x5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("x1:x5000"))

'Décaissements des immob corporelles
Sheets("feuil18").Range("h43") = Sheets("feuil7").Range("h27")
'biens corporelles pris en location acquisition (mvt crédit du compte 17 sauf 176)
Sheets("feuil18").Range("h44") = WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000"))
'tva récupréeé sur immobilisations (mvt crédit du compte 4451)
Sheets("feuil18").Range("h45") = -WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000"))
'variation du compte 4042
Sheets("feuil18").Range("h46") = WorksheetFunction.Sum(Sheets("feuil1").Range("aa1:aa5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("aa1:aa5000"))
'variation du compte 4047
Sheets("feuil18").Range("h47") = WorksheetFunction.Sum(Sheets("feuil1").Range("ab1:ab5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("ab1:ab5000"))
'variation du compte 4812
Sheets("feuil18").Range("h48") = WorksheetFunction.Sum(Sheets("feuil1").Range("ac1:ac5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("ac1:ac5000"))
'variation du compte 4822
Sheets("feuil18").Range("h49") = WorksheetFunction.Sum(Sheets("feuil1").Range("ad1:ad5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("ad1:ad5000"))

'Décaissements des immob financières
Sheets("feuil18").Range("h55") = Sheets("feuil7").Range("h28")
'variation du compte 4813
Sheets("feuil18").Range("h56") = WorksheetFunction.Sum(Sheets("feuil1").Range("ae1:ae5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("ae1:ae5000"))
'intérêts courus du compte 276 (mvt débit)
Sheets("feuil18").Range("h57") = WorksheetFunction.Sum(Sheets("feuil1").Range("af1:af5000"))

'Ecaissements des immob incorporelles et corporelles
Sheets("feuil18").Range("h62") = Sheets("feuil7").Range("h29")
'variation du compte 414
Sheets("feuil18").Range("h64") = -(WorksheetFunction.Sum(Sheets("feuil1").Range("ag1:ag5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("ag1:ag5000")))
'variation du compte 485
Sheets("feuil18").Range("h65") = -(WorksheetFunction.Sum(Sheets("feuil1").Range("ah1:ah5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("ah1:ah5000")))

'Ecaissements des immob financières
Sheets("feuil18").Range("h71") = Sheets("feuil7").Range("h30")
'intérêts courus du compte 276 (mvt crédit)
Sheets("feuil18").Range("h72") = -WorksheetFunction.Sum(Sheets("feuil1").Range("ai1:ai5000"))

'FINANCEMENTS
'Augmentations de capital par apports nouveaux
Sheets("feuil18").Range("h77") = Sheets("feuil7").Range("h35")
'variation du compte 4581
Sheets("feuil18").Range("h79") = -(WorksheetFunction.Sum(Sheets("feuil1").Range("aj1:aj5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("aj1:aj5000")))
'variation du compte 467
Sheets("feuil18").Range("h80") = -(WorksheetFunction.Sum(Sheets("feuil1").Range("au1:au5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("au1:au5000")))

'Prélèvements sur le capital
Sheets("feuil18").Range("h82") = Sheets("feuil7").Range("h37")

'Subventions d'investissement reçues
Sheets("feuil18").Range("h84") = Sheets("feuil7").Range("h36")
'variation du compte 4494
Sheets("feuil18").Range("h85") = -(WorksheetFunction.Sum(Sheets("feuil1").Range("ak1:ak5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("ak1:ak5000")))
'variation du compte 4582
Sheets("feuil18").Range("h86") = -(WorksheetFunction.Sum(Sheets("feuil1").Range("al1:al5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("al1:al5000")))

'Dividendes versés
Sheets("feuil18").Range("h88") = Sheets("feuil7").Range("h38")

'Emprunts
Sheets("feuil18").Range("h90") = Sheets("feuil7").Range("h43")
'intérêts courus du compte 166 (mvt crédit)
Sheets("feuil18").Range("h91") = -WorksheetFunction.Sum(Sheets("feuil1").Range("am1:am5000"))

'Autres dettes financières
Sheets("feuil18").Range("h94") = Sheets("feuil7").Range("h44")
'emprunts de location acquisition
Sheets("feuil18").Range("h95") = -WorksheetFunction.Sum(Sheets("feuil1").Range("an1:an5000"))
'intérêts courus du compte 176 (mvt crédit)
Sheets("feuil18").Range("h96") = -WorksheetFunction.Sum(Sheets("feuil1").Range("ao1:ao5000"))
'intérêts courus du compte 183 (mvt crédit)
Sheets("feuil18").Range("h97") = -WorksheetFunction.Sum(Sheets("feuil1").Range("ap1:ap5000"))

'Remboursements des emprunts et autres dettes financières
Sheets("feuil18").Range("h100") = Sheets("feuil7").Range("h45")
'intérêts courus des comptes 166, 176, 183 (mvt débit)
Sheets("feuil18").Range("h102") = WorksheetFunction.Sum(Sheets("feuil1").Range("aq1:aq5000"))

'CAFG
Sheets("feuil18").Range("h14") = Sheets("feuil7").Range("h15")
'intérêts courus du compte 276
Sheets("feuil18").Range("h15") = -(WorksheetFunction.Sum(Sheets("feuil1").Range("ar1:ar5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("ar1:ar5000")))
'intérêts courus du compte 166
Sheets("feuil18").Range("h16") = (WorksheetFunction.Sum(Sheets("feuil1").Range("as1:as5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("as1:as5000")))
'intérêts courus des comptes 176 + 183
Sheets("feuil18").Range("h17") = (WorksheetFunction.Sum(Sheets("feuil1").Range("at1:at5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("at1:at5000")))

'Variation du BFE
Sheets("feuil18").Range("h19") = Sheets("feuil7").Range("e22")
'tva récupérable sur immobiisation
Sheets("feuil18").Range("h20") = -(Sheets("feuil18").Range("h45") + Sheets("feuil18").Range("h33"))
'variation actif circulant H.A.O.
Sheets("feuil18").Range("h22") = -Sheets("feuil18").Range("h65")
'variation actif circulant
Sheets("feuil18").Range("h23") = -(Sheets("feuil18").Range("h64") + Sheets("feuil18").Range("h79") + Sheets("feuil18").Range("h80") + Sheets("feuil18").Range("h85") + Sheets("feuil18").Range("h86"))
'variation passif circulant
Sheets("feuil18").Range("h24") = -(WorksheetFunction.Sum(Sheets("feuil18").Range("h34:h37")) + WorksheetFunction.Sum(Sheets("feuil18").Range("h46:h49")) + Sheets("feuil18").Range("h56"))
'variation du compte 4726
Sheets("feuil18").Range("h25") = -(WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("t1:t5000")))
'écarts de conversion ACTIF
Sheets("feuil18").Range("h26") = -(Sheets("feuil18").Range("h38") + Sheets("feuil18").Range("h39") + Sheets("feuil18").Range("h50") + Sheets("feuil18").Range("h51") + Sheets("feuil18").Range("h58") + Sheets("feuil18").Range("h66") + Sheets("feuil18").Range("h67") + Sheets("feuil18").Range("h73") + Sheets("feuil18").Range("h92") + Sheets("feuil18").Range("h98"))
'écarts de conversion PASSIF
Sheets("feuil18").Range("h27") = -(Sheets("feuil18").Range("h40") + Sheets("feuil18").Range("h41") + Sheets("feuil18").Range("h52") + Sheets("feuil18").Range("h53") + Sheets("feuil18").Range("h60") + Sheets("feuil18").Range("h68") + Sheets("feuil18").Range("h69") + Sheets("feuil18").Range("h103"))

'Production immobilisée
Sheets("feuil18").Range("h110") = WorksheetFunction.Sum(Sheets("feuil1").Range("ax1:ax5000"))


'_________________________________________________________________________________

'Calculs du tableau

'FLUX opérationnels
'Sous total CAFG
Sheets("feuil18").Range("h18") = WorksheetFunction.Sum(Sheets("feuil18").Range("h14:h17"))
'Sous total BFE
Sheets("feuil18").Range("h28") = WorksheetFunction.Sum(Sheets("feuil18").Range("h19:h27"))
'Total flux opérationnels
Sheets("feuil18").Range("h29") = Sheets("feuil18").Range("h18") + Sheets("feuil18").Range("h28")

'FLUX investissements
'Sous total décaissements immob incorporelles
Sheets("feuil18").Range("h42") = WorksheetFunction.Sum(Sheets("feuil18").Range("h31:h41"))
'Sous total décaissements immob corporelles
Sheets("feuil18").Range("h54") = WorksheetFunction.Sum(Sheets("feuil18").Range("h43:h53"))
'Sous total décaissements immob financières
Sheets("feuil18").Range("h61") = WorksheetFunction.Sum(Sheets("feuil18").Range("h55:h60"))
'Sous total encaissements immob incorporelles et corporelles
Sheets("feuil18").Range("h70") = WorksheetFunction.Sum(Sheets("feuil18").Range("h62:h69"))
'Sous total encaissements immob financières
Sheets("feuil18").Range("h74") = WorksheetFunction.Sum(Sheets("feuil18").Range("h71:h73"))
'Total flux investissements
Sheets("feuil18").Range("h75") = Sheets("feuil18").Range("h42") + Sheets("feuil18").Range("h54") + Sheets("feuil18").Range("h61") + Sheets("feuil18").Range("h70") + Sheets("feuil18").Range("h74")

'FLUX financements
'Sous total Augmentations de capital
Sheets("feuil18").Range("h81") = WorksheetFunction.Sum(Sheets("feuil18").Range("h77:h80"))
'Sous total prélèvement sur le capital
Sheets("feuil18").Range("h83") = Sheets("feuil18").Range("h82")
'Sous total subventions d'investissements
Sheets("feuil18").Range("h87") = WorksheetFunction.Sum(Sheets("feuil18").Range("h84:h86"))
'Sous total dividendes versés
Sheets("feuil18").Range("h89") = Sheets("feuil18").Range("h88")
'Sous total emprunts
Sheets("feuil18").Range("h93") = WorksheetFunction.Sum(Sheets("feuil18").Range("h90:h92"))
'Sous total autres dettes financières
Sheets("feuil18").Range("h99") = WorksheetFunction.Sum(Sheets("feuil18").Range("h94:h98"))
'Sous total remboursements emprunts et dettes
Sheets("feuil18").Range("h104") = WorksheetFunction.Sum(Sheets("feuil18").Range("h100:h103"))
'Total flux financements
Sheets("feuil18").Range("h105") = Sheets("feuil18").Range("h81") + Sheets("feuil18").Range("h83") + Sheets("feuil18").Range("h87") + Sheets("feuil18").Range("h89") + Sheets("feuil18").Range("h93") + Sheets("feuil18").Range("h99") + Sheets("feuil18").Range("h104")

'_______________________________________________________________________________________________________


'affiche la fiche explicative
Sheets("feuil18").Activate

'___________________________________________________________________________________
'message d'équilibre de la fiche explicative et des corrections
If Sheets("feuil18").Range("h11") + Sheets("feuil18").Range("h29") + Sheets("feuil18").Range("h75") + Sheets("feuil18").Range("h105") - Sheets("feuil18").Range("h106") = 0 Then
MsgBox "FICHE EXPLICATIVE  N-1  équilibrée  !" & Chr(10) & Chr(10) & "Veuillez procéder aux éventuelles corrections manuelles."

'message de corrections manuelles obligatoires
'ecarts de conversion actif
If WorksheetFunction.Sum(Sheets("feuil1").Range("av1:av5000")) > 0 Then
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "L'écart de conversion - Actif a un solde en N-1 de  " & WorksheetFunction.Sum(Sheets("feuil1").Range("av1:av5000")) & "." & Chr(10) & "Veuillez affecter la quote-part relative aux dettes et créances financières ainsi qu'aux fournisseurs et créances d'investissement."
Else
End If
'ecarts de conversion passif
If WorksheetFunction.Sum(Sheets("feuil1").Range("aw1:aw5000")) > 0 Then
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "L'écart de conversion - Passif a un solde en N-1 de  " & WorksheetFunction.Sum(Sheets("feuil1").Range("aw1:aw5000")) & "." & Chr(10) & "Veuillez affecter la quote-part relative aux dettes et créances financières ainsi qu'aux fournisseurs et créances d'investissement."
Else
End If
'Autres fournisseurs d'investissement (comptes 481 sauf 4811, 4812 et 4813)
If (WorksheetFunction.Sum(Sheets("feuil1").Range("ay1:ay5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("ay1:ay5000"))) <> 0 Then
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "Les Autres fournisseurs d'investissement (comptes 481 sauf 4811, 4812 et 4813) ont une variation en  N-1  de  " & (WorksheetFunction.Sum(Sheets("feuil1").Range("ay1:ay5000")) - WorksheetFunction.Sum(Sheets("feuil28").Range("ay1:ay5000"))) & "." & Chr(10) & "Veuillez éventuellement répartir le montant entre immobilisations incorporelle et corporelle."
Else
End If



'opérations de location acquisition (crédit bail)
If WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) > 0 Then
Sheets("feuil18").Range("h44").Select
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "Le mouvement au crédit du compte 17, représentant le coût des biens pris en location acquisition en N-1, est de  " & WorksheetFunction.Sum(Sheets("feuil1").Range("y1:y5000")) & "." & Chr(10) & "Veuillez vérifier l'exactitude du montant récupéré et le répartir entre immobilisations corporelle et incorporelle éventuellement."
Else
End If
'tva récupérable sur acquisitions d'immobilisations
If WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) > 0 Then
Sheets("feuil18").Range("h45").Select
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "Le mouvement au débit du compte 4451, représentant la TVA récupérée sur les acquisitions d'immobilisations en N-1, est de  " & WorksheetFunction.Sum(Sheets("feuil1").Range("z1:z5000")) & "." & Chr(10) & "Veuillez vérifier l'exactitude du montant récupéré et le répartir entre immobilisations corporelle et incorporelle éventuellement."
Else
End If
'tva facturée sur cessions d'immobilisations
If Sheets("feuil18").Range("h62") > 0 Then
Sheets("feuil18").Range("h62").Select
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "Il y a eu cession d'immobilisation en N-1 de " & Sheets("feuil18").Range("h62") & "." & Chr(10) & "Veuillez indiquer la TVA éventuelle facturée."
Else
End If
'production immobilisée
If Sheets("feuil18").Range("h110") > 0 Then
Sheets("feuil18").Range("h110").Select
MsgBox "CORRECTION MANUELLE OBLIGATOIRE  !" & Chr(10) & Chr(10) & "Il y a eu production immobilisée en N-1 de " & Sheets("feuil18").Range("h110") & "." & Chr(10) & "Veuillez indiquer la quote-part éventuelle non réglée sur les immobilisations incorporelles, corporelles ou financières."
Else
End If


'message d'équilibre de la fiche explicative et des corrections
Else
MsgBox "ATTENTION  !  FICHE EXPLICATIVE  N-1  déséquilibrée de  " & Abs(Sheets("feuil18").Range("h11") + Sheets("feuil18").Range("h29") + Sheets("feuil18").Range("h75") + Sheets("feuil18").Range("h105") - Sheets("feuil18").Range("h106")) & "."
End If
'______________________________________________________________________________________



'efface les données des feuil1 et feuil28
Sheets("feuil28").Range("t1:za5000").ClearContents
Sheets("feuil1").Range("t1:za5000").ClearContents



'condition d'équilibre du TFT N-1
End If

'condition générale d'édition
End If
End Sub
Private Sub valider_fiche_explicative_n_1()
'demande de validation
If MsgBox("Confirmez vous la validation des corrections de N-1 ?", vbYesNo, "Demande de confirmation") = vbYes Then

For i = 3 To 5000
'recup N-1
'compte 478 (solde débit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 478 Then
Sheets("feuil1").Cells(i, 20) = Sheets("feuil1").Cells(i, 7) 'T
Else
End If

'compte 479 (solde crédit)
If Left(Sheets("feuil1").Cells(i, 1), 3) = 479 Then
Sheets("feuil1").Cells(i, 21) = Sheets("feuil1").Cells(i, 8) 'U
Else
End If

Next



'_______________________________________________________________________
'Déduction des ECA / ECP du BF opérationnel et la TVA facturée sur cession d'immob
'écarts de conversion ACTIF
Sheets("feuil18").Range("h26") = -(Sheets("feuil18").Range("h38") + Sheets("feuil18").Range("h39") + Sheets("feuil18").Range("h50") + Sheets("feuil18").Range("h51") + Sheets("feuil18").Range("h58") + Sheets("feuil18").Range("h66") + Sheets("feuil18").Range("h67") + Sheets("feuil18").Range("h73") + Sheets("feuil18").Range("h92") + Sheets("feuil18").Range("h98"))
'écarts de conversion PASSIF
Sheets("feuil18").Range("h27") = -(Sheets("feuil18").Range("h40") + Sheets("feuil18").Range("h41") + Sheets("feuil18").Range("h52") + Sheets("feuil18").Range("h53") + Sheets("feuil18").Range("h60") + Sheets("feuil18").Range("h68") + Sheets("feuil18").Range("h69") + Sheets("feuil18").Range("h103"))
'TVA facturée sur cessions d'immobilisation
Sheets("feuil18").Range("h21") = -Sheets("feuil18").Range("h63")

'_______________________________________________________________________

'Calculs dans la fiche

'FLUX opérationnels
'Sous total CAFG - production immobilisée
Sheets("feuil18").Range("h14") = Sheets("feuil18").Range("h14") - Abs(WorksheetFunction.Sum(Sheets("feuil18").Range("h111:h113")))
Sheets("feuil18").Range("h18") = WorksheetFunction.Sum(Sheets("feuil18").Range("h14:h17"))
'Sous total BFE
Sheets("feuil18").Range("h28") = WorksheetFunction.Sum(Sheets("feuil18").Range("h19:h27"))
'Total flux opérationnels
Sheets("feuil18").Range("h29") = Sheets("feuil18").Range("h18") + Sheets("feuil18").Range("h28")

'FLUX investissements
'Sous total décaissements immob incorporelles - production immobilisée
Sheets("feuil18").Range("h31") = Sheets("feuil18").Range("h31") + Abs(Sheets("feuil18").Range("h111"))
Sheets("feuil18").Range("h42") = WorksheetFunction.Sum(Sheets("feuil18").Range("h31:h41"))
'Sous total décaissements immob corporelles - production immobilisée
Sheets("feuil18").Range("h43") = Sheets("feuil18").Range("h43") + Abs(Sheets("feuil18").Range("h112"))
Sheets("feuil18").Range("h54") = WorksheetFunction.Sum(Sheets("feuil18").Range("h43:h53"))
'Sous total décaissements immob financières - production immobilisée
Sheets("feuil18").Range("h55") = Sheets("feuil18").Range("h55") + Abs(Sheets("feuil18").Range("h113"))
Sheets("feuil18").Range("h61") = WorksheetFunction.Sum(Sheets("feuil18").Range("h55:h60"))
'Sous total encaissements immob incorporelles et corporelles
Sheets("feuil18").Range("h70") = WorksheetFunction.Sum(Sheets("feuil18").Range("h62:h69"))
'Sous total encaissements immob financières
Sheets("feuil18").Range("h74") = WorksheetFunction.Sum(Sheets("feuil18").Range("h71:h73"))
'Total flux investissements
Sheets("feuil18").Range("h75") = Sheets("feuil18").Range("h42") + Sheets("feuil18").Range("h54") + Sheets("feuil18").Range("h61") + Sheets("feuil18").Range("h70") + Sheets("feuil18").Range("h74")

'FLUX financements
'Sous total Augmentations de capital
Sheets("feuil18").Range("h81") = WorksheetFunction.Sum(Sheets("feuil18").Range("h77:h80"))
'Sous total prélèvement sur le capital
Sheets("feuil18").Range("h83") = Sheets("feuil18").Range("h82")
'Sous total subventions d'investissements
Sheets("feuil18").Range("h87") = WorksheetFunction.Sum(Sheets("feuil18").Range("h84:h86"))
'Sous total dividendes versés
Sheets("feuil18").Range("h89") = Sheets("feuil18").Range("h88")
'Sous total emprunts
Sheets("feuil18").Range("h93") = WorksheetFunction.Sum(Sheets("feuil18").Range("h90:h92"))
'Sous total autres dettes financières
Sheets("feuil18").Range("h99") = WorksheetFunction.Sum(Sheets("feuil18").Range("h94:h98"))
'Sous total remboursements emprunts et dettes
Sheets("feuil18").Range("h104") = WorksheetFunction.Sum(Sheets("feuil18").Range("h100:h103"))
'Total flux financements
Sheets("feuil18").Range("h105") = Sheets("feuil18").Range("h81") + Sheets("feuil18").Range("h83") + Sheets("feuil18").Range("h87") + Sheets("feuil18").Range("h89") + Sheets("feuil18").Range("h93") + Sheets("feuil18").Range("h99") + Sheets("feuil18").Range("h104")

'_____________________________________________________________________________________________________________________________

'CONTRÔLE DE CONCORDANCE DANS LA FICHE
'efface d'abord la colonne z (z1 à z3) / condition d'affectation de la fiche au T.F.T. N
Sheets("feuil18").Range("z1:z3").ClearContents

'Ecarts de conversion Actif
If Sheets("feuil18").Range("h26") > WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) Then
MsgBox "Attention  !  Le montant des Ecarts de conversion - Actif reparti  " & Sheets("feuil18").Range("h26") & "  est supérieur au montant comptabilisé  " & WorksheetFunction.Sum(Sheets("feuil1").Range("t1:t5000")) & "." & Chr(10) & Chr(10) & "NB : Veuillez revoir les affectations  !"
Sheets("feuil18").Range("z1") = 1
Else
End If
'Ecart de conversion passif
If -Sheets("feuil18").Range("h27") > WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) Then
MsgBox "Attention  !  Le montant des Ecarts de conversion - Passif reparti  " & -Sheets("feuil18").Range("h27") & "  est supérieur au montant comptabilisé  " & WorksheetFunction.Sum(Sheets("feuil1").Range("u1:u5000")) & "." & Chr(10) & Chr(10) & "NB : Veuillez revoir les affectations  !"
Sheets("feuil18").Range("z2") = 1
Else
End If
'Opération d'acquisition location (crédit bail)
If -Sheets("feuil18").Range("h95") <> Sheets("feuil18").Range("h32") + Sheets("feuil18").Range("h44") Then
MsgBox "Attention  !  Le montant des Emprunts de location acquisition  " & -Sheets("feuil18").Range("h95") & "  est différent du montant inscrit en Biens pris en location acquisition (incorporelle ou corporelle)  " & Sheets("feuil18").Range("h32") + Sheets("feuil18").Range("h44") & "." & Chr(10) & Chr(10) & "NB : Veuillez revoir les affectations  !"
Sheets("feuil18").Range("z3") = 1
Else
End If

'_________________________________________________________________________________________________________________________________

'AFFECTATION DE LA FICHE AU T.F.T. N-1
'condition générale d'affectation de la fiche au T.F.T. N-1
If WorksheetFunction.Sum(Sheets("feuil18").Range("z1:z3")) <> 0 Then
Else

'condition spécifique d'affectation de la fiche au T.F.T. N-1
If Sheets("feuil18").Range("h11") + Sheets("feuil18").Range("h29") + Sheets("feuil18").Range("h75") + Sheets("feuil18").Range("h105") - Sheets("feuil18").Range("h106") = 0 Then

'Affectation des flux corrigés dans le T.F.T. N-1
'tresorerie au 1er janvier
Sheets("feuil7").Range("h12") = Sheets("feuil18").Range("h11")
'CAFG
Sheets("feuil7").Range("h15") = Sheets("feuil18").Range("h18")
'variaition actif circulant H.A.O.
Sheets("feuil7").Range("h16") = Sheets("feuil7").Range("h16") + Sheets("feuil18").Range("h22")
'variaition actif circulant
Sheets("feuil7").Range("h18") = Sheets("feuil7").Range("h18") + Sheets("feuil18").Range("h20") + Sheets("feuil18").Range("h23") + Sheets("feuil18").Range("h26")
'variaition passif circulant
Sheets("feuil7").Range("h19") = Sheets("feuil7").Range("h19") + Sheets("feuil18").Range("h21") + Sheets("feuil18").Range("h24") + Sheets("feuil18").Range("h25") + Sheets("feuil18").Range("h27")
'décaissements immob incorporels
Sheets("feuil7").Range("h26") = Sheets("feuil18").Range("h42")
'décaissements immob corporels
Sheets("feuil7").Range("h27") = Sheets("feuil18").Range("h54")
'décaissements immob financières
Sheets("feuil7").Range("h28") = Sheets("feuil18").Range("h61")
'encaissements immob incorporelles et corporelles
Sheets("feuil7").Range("h29") = Sheets("feuil18").Range("h70")
'encaissements immob financières
Sheets("feuil7").Range("h30") = Sheets("feuil18").Range("h74")
'augmentation de capital
Sheets("feuil7").Range("h35") = Sheets("feuil18").Range("h81")
'subventions d'investissement
Sheets("feuil7").Range("h36") = Sheets("feuil18").Range("h87")
'prélèvements sur le capital
Sheets("feuil7").Range("h37") = Sheets("feuil18").Range("h83")
'dividendes
Sheets("feuil7").Range("h38") = Sheets("feuil18").Range("h89")
'emprunts
Sheets("feuil7").Range("h43") = Sheets("feuil18").Range("h93")
'autres dettes financières
Sheets("feuil7").Range("h44") = Sheets("feuil18").Range("h99")
'remboursements des emprunts et dettes
Sheets("feuil7").Range("h45") = Sheets("feuil18").Range("h104")
'trésorerie au 31 décembre
Sheets("feuil7").Range("h53") = Sheets("feuil18").Range("h106")

'Calcul des flux de trésorerie dans le tableau du TAFIRE
'total flux de trésorerie opérationnelle
Sheets("feuil7").Range("h23") = WorksheetFunction.Sum(Sheets("feuil7").Range("h15:h19"))
'variation BF opérationelle
Sheets("feuil7").Range("e22") = WorksheetFunction.Sum(Sheets("feuil7").Range("h16:h19"))

'total flux de trésorerie investissements
Sheets("feuil7").Range("h32") = WorksheetFunction.Sum(Sheets("feuil7").Range("h26:h30"))

'total flux de trésorerie financements propres
Sheets("feuil7").Range("h40") = WorksheetFunction.Sum(Sheets("feuil7").Range("h35:h38"))

'total flux de trésorerie financements étrangers
Sheets("feuil7").Range("h47") = WorksheetFunction.Sum(Sheets("feuil7").Range("h43:h45"))

'total flux de trésorerie financements total
Sheets("feuil7").Range("h49") = Sheets("feuil7").Range("h40") + Sheets("feuil7").Range("h47")

'variation de la trésorerie de la période
Sheets("feuil7").Range("h51") = Sheets("feuil7").Range("h23") + Sheets("feuil7").Range("h32") + Sheets("feuil7").Range("h49")

'trésorerie nette au 31 décemnre
Sheets("feuil7").Range("h53") = Sheets("feuil7").Range("h12") + Sheets("feuil7").Range("h51")

MsgBox "T.F.T.  N-1  corrigé équilibré  !"

'condition spécifique d'affectation de la fiche au T.F.T. N-1
Else
MsgBox "T.F.T.  N-1  corrigé déséquilibré de  " & Abs(Sheets("feuil18").Range("h11") + Sheets("feuil18").Range("h29") + Sheets("feuil18").Range("h75") + Sheets("feuil18").Range("h105") - Sheets("feuil18").Range("h106")) & "." & Chr(10) & Chr(10) & "Veuillez reprendre les corrections  !"
End If

'condition générale d'affectation de la fiche au T.F.T. N-1
End If
'______________________________________________________________________________________________________________



'efface les données de la feuil1
Sheets("feuil1").Range("t1:za5000").ClearContents

'demande de validation
End If
End Sub
Private Sub correction_des_flux()
'condition générale d'édition
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'Insérer le chiffre de l'exercice
 Dim resultat As Variant
    resultat = InputBox("CORRECTION DES FLUX  !" & Chr(10) & Chr(10) & "1°/ Pour l'exercice N-1 : veuillez saisir le chiffre  1." & Chr(10) & Chr(10) & "2°/ Pour l'exercice N : veuillez saisir le chiffre  2." & Chr(10), "Corrections") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    
    If resultat = 1 Then
    correction_des_flux_n_1
    Else
    End If
    
    If resultat = 2 Then
    correction_des_flux_n
    Else
    End If
    
 'Insérer le chiffre de l'exercice
    Else
    End If


'condition générale d'édition
End If
End Sub
Private Sub valider_fiche_explicative()

    If Sheets("feuil18").Range("a1") = 1 Then
    valider_fiche_explicative_n_1
    Else
    End If
    
    If Sheets("feuil18").Range("a1") = 2 Then
    valider_fiche_explicative_n
    Else
    End If

End Sub
Private Sub impôt_bic()
'condition générale de traitement
If Sheets("feuil7").Range("g54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers N  !"
Else

'demande de validation
If MsgBox("NB :" & Chr(10) & "Veuillez vous assurer que les éléments ci-dessous sont effectivement renseignés avant l'édition :" & Chr(10) & " - Les Déficits antérieurs, les ARD et la TVA facturée (voir ci-dessous) ;" & Chr(10) & " - Le Régime fiscal, la Forme juridique et l'Exercice comptable (voir page 3 et 4 de       la Fiche d'identification)." & Chr(10) & Chr(10) & "Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'annule d'abord les données
Sheets("feuil27").Range("g13").ClearContents
Sheets("feuil27").Range("g15").ClearContents
Sheets("feuil27").Range("f17").ClearContents
Sheets("feuil27").Range("b19:d19").ClearContents
Sheets("feuil27").Range("f19:h19").ClearContents
Sheets("feuil27").Range("e36").ClearContents
Sheets("feuil27").Range("h58:h59").ClearContents
Sheets("feuil27").Range("g64:g78").ClearContents
Sheets("feuil27").Range("h80").ClearContents
Sheets("feuil27").Range("g83:g86").ClearContents
Sheets("feuil27").Range("h88").ClearContents
Sheets("feuil27").Range("h90").ClearContents
Sheets("feuil27").Range("g94:g95").ClearContents
Sheets("feuil27").Range("g97").ClearContents
Sheets("feuil27").Range("h99").ClearContents
Sheets("feuil27").Range("a117").ClearContents
Sheets("feuil27").Range("h117").ClearContents
Sheets("feuil27").Range("a124").ClearContents
Sheets("feuil27").Range("h124").ClearContents
Sheets("feuil27").Range("h274:h277").ClearContents
Sheets("feuil27").Range("h300:h303").ClearContents
Sheets("feuil6").Range("c82:c83").ClearContents



For i = 3 To 5000
'recup N
'compte 6742
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6742 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 666
If Left(Sheets("feuil2").Cells(i, 1), 3) = 666 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 647 + 657
If Left(Sheets("feuil2").Cells(i, 1), 3) = 647 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 657 Then
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 152
If Left(Sheets("feuil2").Cells(i, 1), 3) = 152 Then
Sheets("feuil2").Cells(i, 23) = Sheets("feuil2").Cells(i, 8) 'W
Else
End If

'compte 6582 + 835
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6582 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 835 Then
Sheets("feuil2").Cells(i, 24) = Sheets("feuil2").Cells(i, 7) 'X
Else
End If

'compte 4281 + 4382  (mvt crédit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4281 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4382 Then
Sheets("feuil2").Cells(i, 25) = Sheets("feuil2").Cells(i, 6) 'Y
Else
End If

'compte 29 (mvt crédit)
If Left(Sheets("feuil2").Cells(i, 1), 2) = 29 Then
Sheets("feuil2").Cells(i, 26) = Sheets("feuil2").Cells(i, 6) 'Z
Else
End If

'compte 15 sauf 152 (mvt crédit)
If Left(Sheets("feuil2").Cells(i, 1), 2) = 15 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 152 Then
Else
Sheets("feuil2").Cells(i, 27) = Sheets("feuil2").Cells(i, 6) 'AA
End If
Else
End If

'compte 19 (mvt crédit)
If Left(Sheets("feuil2").Cells(i, 1), 2) = 19 Then
Sheets("feuil2").Cells(i, 28) = Sheets("feuil2").Cells(i, 6) 'AB
Else
End If

'compte 6581
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6581 Then
Sheets("feuil2").Cells(i, 29) = Sheets("feuil2").Cells(i, 7) 'AC
Else
End If

'compte 4281 + 4382 (mvt débit)
If Left(Sheets("feuil2").Cells(i, 1), 4) = 4281 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 4382 Then
Sheets("feuil2").Cells(i, 30) = Sheets("feuil2").Cells(i, 5) 'AD
Else
End If

'compte 29 (mvt débit)
If Left(Sheets("feuil2").Cells(i, 1), 2) = 29 Then
Sheets("feuil2").Cells(i, 31) = Sheets("feuil2").Cells(i, 5) 'AE
Else
End If

'compte 15 sauf 152 (mvt débit)
If Left(Sheets("feuil2").Cells(i, 1), 2) = 15 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 152 Then
Else
Sheets("feuil2").Cells(i, 32) = Sheets("feuil2").Cells(i, 5) 'AF
End If
Else
End If

'compte 19 (mvt débit)
If Left(Sheets("feuil2").Cells(i, 1), 2) = 19 Then
Sheets("feuil2").Cells(i, 33) = Sheets("feuil2").Cells(i, 5) 'AG
Else
End If

'compte 28 (mvt crédit)
If Left(Sheets("feuil2").Cells(i, 1), 2) = 28 Then
Sheets("feuil2").Cells(i, 34) = Sheets("feuil2").Cells(i, 6) 'AH
Else
End If

'compte 776
If Left(Sheets("feuil2").Cells(i, 1), 3) = 776 Then
Sheets("feuil2").Cells(i, 35) = Sheets("feuil2").Cells(i, 8) 'AI
Else
End If

'compte 759
If Left(Sheets("feuil2").Cells(i, 1), 3) = 759 Then
Sheets("feuil2").Cells(i, 36) = Sheets("feuil2").Cells(i, 8) 'AJ
Else
End If

'compte 849
If Left(Sheets("feuil2").Cells(i, 1), 3) = 849 Then
Sheets("feuil2").Cells(i, 37) = Sheets("feuil2").Cells(i, 8) 'AK
Else
End If


Next


'AFFECTATION dans les tableaux annexes
'Provisions non déductibles sur :
'congés à payer et charges (au crédit des comptes 4428+4438+4448)
Sheets("feuil27").Range("h274") = WorksheetFunction.Sum(Sheets("feuil2").Range("y1:y5000"))
'immobilisations (au crédit du compte 29)
Sheets("feuil27").Range("h275") = WorksheetFunction.Sum(Sheets("feuil2").Range("z1:z5000"))
'réglementées (au crédit du compte 15 sauf 152)
Sheets("feuil27").Range("h276") = WorksheetFunction.Sum(Sheets("feuil2").Range("aa1:aa5000"))
'risques et charges (au crédit du compte 19)
Sheets("feuil27").Range("h277") = WorksheetFunction.Sum(Sheets("feuil2").Range("ab1:ab5000"))
'Provisions antérieurement taxées exonérées
'congés à payer et charges (au débit des comptes 4428+4438+4448)
Sheets("feuil27").Range("h300") = WorksheetFunction.Sum(Sheets("feuil2").Range("ad1:ad5000"))
'immobilisations (au débit du compte 29)
Sheets("feuil27").Range("h301") = WorksheetFunction.Sum(Sheets("feuil2").Range("ae1:ae5000"))
'réglementées (au débit du compte 15 sauf 152)
Sheets("feuil27").Range("h302") = WorksheetFunction.Sum(Sheets("feuil2").Range("af1:af5000"))
'risques et charges (au débit du compte 19)
Sheets("feuil27").Range("h303") = WorksheetFunction.Sum(Sheets("feuil2").Range("ag1:ag5000"))




'AFFECTATION dans l'imprimé de déclaration BIC
'régime d'imposition
If Sheets("feuil4").Range("g61") = 2 Then
Sheets("feuil27").Range("g15") = "X"
Else
Sheets("feuil27").Range("g13") = "X"
End If

'exercice d'imposition
If Sheets("feuil6").Range("h81") = "-" Then
Sheets("feuil27").Range("f17") = "-" 'année
'période d'imposition du 01/01/00
Sheets("feuil27").Range("b19") = "-" 'jour
Sheets("feuil27").Range("c19") = "-" 'mois
Sheets("feuil27").Range("d19") = "-" 'année
'période d'imposition au 31/12/00
Sheets("feuil27").Range("f19") = "-" '(jour)
Sheets("feuil27").Range("g19") = "-" 'mois
Sheets("feuil27").Range("h19") = "-" 'année
Else
Sheets("feuil27").Range("f17") = Year(Sheets("feuil6").Range("h81"))
'période d'imposition du 01/01/00
Sheets("feuil27").Range("b19") = Day(Sheets("feuil6").Range("d81")) '(jour)
Sheets("feuil27").Range("c19") = Month(Sheets("feuil6").Range("d81")) 'mois
Sheets("feuil27").Range("d19") = Year(Sheets("feuil6").Range("d81")) 'année
'période d'imposition au 31/12/00
Sheets("feuil27").Range("f19") = Day(Sheets("feuil6").Range("h81")) '(jour)
Sheets("feuil27").Range("g19") = Month(Sheets("feuil6").Range("h81")) 'mois
Sheets("feuil27").Range("h19") = Year(Sheets("feuil6").Range("h81")) 'année
End If

'forme juridique
If Sheets("feuil4").Range("h60") = "0" Then
Sheets("feuil27").Range("e36") = "SA à participation publique"
Else
End If
If Sheets("feuil4").Range("h60") = "1" Then
Sheets("feuil27").Range("e36") = "Société Anonyme"
Else
End If
If Sheets("feuil4").Range("h60") = "2" Then
Sheets("feuil27").Range("e36") = "SARL"
Else
End If
If Sheets("feuil4").Range("h60") = "3" Then
Sheets("feuil27").Range("e36") = "SCS"
Else
End If
If Sheets("feuil4").Range("h60") = "4" Then
Sheets("feuil27").Range("e36") = "SNC"
Else
End If
If Sheets("feuil4").Range("h60") = "5" Then
Sheets("feuil27").Range("e36") = "Société à Participation"
Else
End If
If Sheets("feuil4").Range("h60") = "6" Then
Sheets("feuil27").Range("e36") = "G.I.E."
Else
End If
If Sheets("feuil4").Range("h60") = "7" Then
Sheets("feuil27").Range("e36") = "Association"
Else
End If
If Sheets("feuil4").Range("h60") = "8" Then
Sheets("feuil27").Range("e36") = "SAS"
Else
End If
If Sheets("feuil4").Range("h60") = "9" Then
Sheets("feuil27").Range("e36") = "Autres"
Else
End If

'détermination du resultat fiscal
'Bénéfice net ou perte nette
If Sheets("feuil6").Range("i54") > 0 Then
Sheets("feuil27").Range("h58") = Sheets("feuil6").Range("i54") 'bénéfice
Else
Sheets("feuil27").Range("h59") = Sheets("feuil6").Range("i54") 'perte
End If
'Réintégrations :
'provisions non déductibles
If Sheets("feuil4").Range("g61") = 2 Then
Else
Sheets("feuil27").Range("g65") = WorksheetFunction.Sum(Sheets("feuil27").Range("h274:h279"))
Sheets("feuil27").Range("g65").Select
If WorksheetFunction.Sum(Sheets("feuil27").Range("h274:h277")) <> 0 Then
MsgBox "PROVISIONS NON DEDUCTIBLES  !" & Chr(10) & Chr(10) & "Des provisions non déductibles (mouvements au crédit des comptes 4281, 4382, 29, 15 ou 19) ont été comptabilisées pour un montant de  " & WorksheetFunction.Sum(Sheets("feuil27").Range("h274:h277")) & "." & Chr(10) & Chr(10) & "Ces provisions ont été entièrement réintégrées car à priori non déductibles (art. 18-E du CGI)."
Else
End If
End If
'intérêts excédentaires comptes courants associés
If WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) <> 0 Then
Sheets("feuil27").Range("g66") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000"))
Sheets("feuil27").Range("g66").Select
 Dim resultat As Variant
    resultat = InputBox("INTERÊTS COMPTES COURANTS ASSOCIES  !" & Chr(10) & Chr(10) & "Des intérêts sur comptes courants associés (solde du compte 6742) ont été comptabilisés pour un montant de  " & WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) & "." & Chr(10) & Chr(10) & "1°) Ces intérêts sont déductibles si le taux appliqué n'excède pas le taux de la BCEAO majoré de trois (3) points et, le montant en compte courant ne doit pas excéder cinq(5) ans avant son remboursement aux associés (art.18-A 6° du CGI). Veuillez vérifier si ces deux(2) conditions cumulatives sont respectées." & Chr(10) & Chr(10) & "2°) Si ces conditions ne sont pas respectées veuillez saisir, sans espace (exemple 100 000), le montant des intérêts excédentaires à réintégrer :", "Compte 6742") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil27").Range("g66") = resultat
    Else
    End If
Else
End If
'rémunération de l'exploitant
If WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) <> 0 Then
Sheets("feuil27").Range("g67") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000"))
Sheets("feuil27").Range("g67").Select
MsgBox "REMUNERATION DE L'EXPLOITANT  !" & Chr(10) & Chr(10) & "Une rémunération de l'exploitant individuel (solde du compte 666) a été comptabilisée pour un montant de  " & WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) & "." & Chr(10) & Chr(10) & "Cette charge a été réintégrée car entièrement non déductible (art. 18-A 2° du CGI)."
Else
End If
'impôts non déductibles (IMF, IBIC)
Sheets("feuil27").Range("g71") = -Sheets("feuil6").Range("i53")
'amendes et penalités de toute nature
If WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) <> 0 Then
Sheets("feuil27").Range("g72") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000"))
Sheets("feuil27").Range("g72").Select
MsgBox "Des amendes et pénalités (solde du compte 647 ou 657) ont été comptabilisées pour un montant de  " & WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) & "  et totalement réintégrées (art. 19 du CGI)."
Else
End If
'plus-values exonérées non réinvesties
If WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) <> 0 Then
Sheets("feuil27").Range("g73").Select
 Dim resultat2 As Variant
    resultat2 = InputBox("PLUS-VALUES NON REINVESTIES  !" & Chr(10) & Chr(10) & "Une plus-value de cession à réinvestir (solde du compte 152) a été comptabilisée pour un montant de  " & WorksheetFunction.Sum(Sheets("feuil2").Range("w1:w5000")) & "." & Chr(10) & Chr(10) & "1°) L'exonération de la plus-value est définitive si elle a été réinvestie entièrement et, dans les trois(3) années qui suivent l'année de son exonération (art. 28 du CGI). Veuillez vérifier si ces conditions sont respectées." & Chr(10) & Chr(10) & "2°) Si ces conditions ne sont pas respectées veuillez saisir, sans espace (exemple 100 000), le montant de la plus-value à réintégrer :", "Compte 152") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat2 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil27").Range("g73") = resultat2
    Else
    End If
Else
End If
'dons et libéralités
If WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) <> 0 Then
Sheets("feuil27").Range("g74") = WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000"))
Sheets("feuil27").Range("g74").Select
 Dim resultat3 As Variant
    resultat3 = InputBox("DONS ET LIBERALITES  !" & Chr(10) & Chr(10) & "Des dons et libéralités (solde du compte 6582 ou 835) ont été comptabilisés pour un montant de  " & WorksheetFunction.Sum(Sheets("feuil2").Range("x1:x5000")) & "." & Chr(10) & Chr(10) & "1°) Les dons accordés à des organismes reconnus sont déductibles dans la double limite de 2,5% du chiffre d'affaires et de 200 000 000 F par an (art. 18-G du CGI). Veuillez saisir, sans espace (exemple 100 000), la quote-part excédentaire éventuelle à réintégrer :" & Chr(10) & Chr(10) & "2°) Les dons accordés à des collectivités territoriales sont déductibles dans la double limite de 3% du chiffre d'affaires et de 500 000 000 F par an (art. 18-G du CGI). Veuillez saisir, sans espace (exemple 100 000), la quote-part excédentaire éventuelle à réintégrer :", "Dons et libéralités") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat3 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil27").Range("g74") = resultat3
    Else
    End If
Else
End If
'indemnités de fonction aux administrateurs
If WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) <> 0 Then
Sheets("feuil27").Range("g76") = WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000"))
Sheets("feuil27").Range("g76").Select
 Dim resultat4 As Variant
    resultat4 = InputBox("INDEMNITES DE FONCTION  !" & Chr(10) & Chr(10) & "Des indemnités de fonction (solde du compte 6581) ont été comptabilisées pour un montant de  " & WorksheetFunction.Sum(Sheets("feuil2").Range("ac1:ac5000")) & "." & Chr(10) & Chr(10) & "1°) Les indemnités de fonction allouées aux administrateurs sont limitées à 3 000 000 F par administrateur et par an (art. 18-A 4° du CGI). Veuillez vérifier que ces conditions sont respectées." & Chr(10) & Chr(10) & "2°) Si les conditions ne sont pas respectées veuillez saisir, sans espace (exemple : 100 000), la quote-part excédentaire à réintégrer :", "Indemnités de fonction") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat4 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil27").Range("g76") = resultat4
    Else
    End If
Else
End If
'autres charges non déductibles
Sheets("feuil27").Range("g78") = WorksheetFunction.Sum(Sheets("feuil27").Range("h329:h343"))
'Déductions :
'provisions antérieurement taxées
If Sheets("feuil4").Range("g61") = 2 Then
Else
Sheets("feuil27").Range("g83") = WorksheetFunction.Sum(Sheets("feuil27").Range("h300:h305"))
Sheets("feuil27").Range("g83").Select
If WorksheetFunction.Sum(Sheets("feuil27").Range("h300:h303")) <> 0 Then
MsgBox "PROVISIONS ANTERIEURES TAXEES  !" & Chr(10) & Chr(10) & "Des provisions antérieurement taxées (mouvements au débit des comptes 4281, 4382, 29, 15 ou 19) ont été comptabilisées pour un montant de  " & WorksheetFunction.Sum(Sheets("feuil27").Range("h300:h303")) & "." & Chr(10) & Chr(10) & "Ces provisions ont été entièrement déduites car à priori non taxables (art. 18-F du CGI)."
Else
End If
End If
'refactions sur produits financiers
Sheets("feuil27").Range("g84") = WorksheetFunction.Sum(Sheets("feuil27").Range("h309:h314"))
'refactions sur actions
Sheets("feuil27").Range("g85") = WorksheetFunction.Sum(Sheets("feuil27").Range("h319:h320"))
'diverses déductions
Sheets("feuil27").Range("g86") = WorksheetFunction.Sum(Sheets("feuil27").Range("h347:h362"))

'Résultat fiscal avant déduction des déficits antérieurs
'total des réintégrations
Sheets("feuil27").Range("h80") = WorksheetFunction.Sum(Sheets("feuil27").Range("g64:g78"))
'total des déductions
Sheets("feuil27").Range("h88") = WorksheetFunction.Sum(Sheets("feuil27").Range("g83:g86"))
'résultat fiscal avant imputation des déficits
Sheets("feuil27").Range("h90") = Sheets("feuil27").Range("h58") + Sheets("feuil27").Range("h59") + Sheets("feuil27").Range("h80") - Sheets("feuil27").Range("h88")

'___________________________________________________________________________________
'Imputations et réintégrations

'exonération du réel simplifié
If Sheets("feuil4").Range("g61") = 2 Then
Else

If Sheets("feuil27").Range("h90") < 0 Then

'ARD créé et Déficits imputés en période de perte
If Sheets("feuil27").Range("h90") + WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000")) - WorksheetFunction.Sum(Sheets("feuil6").Range("a75:a79")) >= 0 Then
Sheets("feuil27").Range("g95") = Abs(Sheets("feuil27").Range("h90") - WorksheetFunction.Sum(Sheets("feuil6").Range("a75:a79"))) 'ARD créé sur l'exercice
Sheets("feuil27").Range("g94") = WorksheetFunction.Sum(Sheets("feuil6").Range("a75:a79")) 'déficits imputés sur l'exercice
Else

If Sheets("feuil27").Range("h90") + WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000")) > 0 Then
Sheets("feuil27").Range("g95") = WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000")) 'ARD créé sur l'exercice
Sheets("feuil27").Range("g94") = Abs(Sheets("feuil27").Range("h90") + WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000"))) 'déficits imputés sur l'exercice
Else
Sheets("feuil27").Range("g95") = WorksheetFunction.Sum(Sheets("feuil2").Range("ah1:ah5000")) 'ARD créé sur l'exercice
End If
End If

Else

'Déficits imputés en période de bénéfice
If Sheets("feuil27").Range("h90") - WorksheetFunction.Sum(Sheets("feuil6").Range("a75:a79")) >= 0 Then
Sheets("feuil27").Range("g94") = WorksheetFunction.Sum(Sheets("feuil6").Range("a75:a79"))
Else
Sheets("feuil27").Range("g94") = Sheets("feuil27").Range("h90")
End If
'ARD imputés en période de bénéfice
If Sheets("feuil27").Range("h90") - Sheets("feuil27").Range("g94") - Sheets("feuil6").Range("a80") >= 0 Then
Sheets("feuil27").Range("g97") = Sheets("feuil6").Range("a80")
Else
Sheets("feuil27").Range("g97") = Sheets("feuil27").Range("h90") - Sheets("feuil27").Range("g94")
End If

End If

'exonération du réel simplifié
End If
'____________________________________________________________________________

'Bénéfice ou perte
Sheets("feuil27").Range("h99") = Sheets("feuil27").Range("h90") - Sheets("feuil27").Range("g94") + Sheets("feuil27").Range("g95") - Sheets("feuil27").Range("g97")

'Impôt sur le bénéfice
'affectation du bénéfice
If Sheets("feuil27").Range("h99") > 0 Then
Sheets("feuil27").Range("a117") = Sheets("feuil27").Range("h99")
Sheets("feuil27").Range("a118") = Right(Sheets("feuil27").Range("a117"), 3)
Sheets("feuil27").Range("a117") = Sheets("feuil27").Range("a117") - Sheets("feuil27").Range("a118")
Sheets("feuil27").Range("a118").ClearContents
Else
End If
'calcul de l'IBIC
Sheets("feuil6").Range("c82") = Sheets("feuil27").Range("a117") * Sheets("feuil27").Range("b117")

'Impôt minimum forfaitaire (IMF)
'affectation du chiffre d'affaires ttc
Sheets("feuil27").Range("a124") = Sheets("feuil6").Range("i20") + Sheets("feuil6").Range("i22") + Sheets("feuil6").Range("i23") + Sheets("feuil6").Range("i24") + Sheets("feuil6").Range("i47") + Sheets("feuil6").Range("i48") + WorksheetFunction.Sum(Sheets("feuil2").Range("ai1:ai5000")) - WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) - WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000")) + Sheets("feuil27").Range("j124")
Sheets("feuil27").Range("a124").Select
Dim resultat5 As Variant
    resultat5 = InputBox("ASSIETTE FISCALE DE L'IMF  !" & Chr(10) & Chr(10) & "La base fiscale de l'IMF est constituée du :" & Chr(10) & "Chiffre d'affaires HT ;" & Chr(10) & "+ Production immobilisée ;" & Chr(10) & "+ Subvention d'exploitation ;" & Chr(10) & "+ Autres produits (sauf compte 759) ;" & Chr(10) & "+ Gain de change (compte 776) ;" & Chr(10) & "+ Produits des cessions d'immobilisations ;" & Chr(10) & "+ Produits HAO (sauf 849) ;" & Chr(10) & "+ TVA facturée." & Chr(10) & Chr(10) & "1°) La base fiscale récupérée est donc de   " & Sheets("feuil27").Range("a124") & "." & Chr(10) & Chr(10) & "2°) Si cette somme ne correspond pas à votre base IMF veuillez saisir, sans espace (exemple : 100 000), le montant à retenir pour le calcul de l'IMF  :", "Base IMF") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat5 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil27").Range("a124") = resultat5
    Else
    End If
'calcul de l'IMF
Sheets("feuil6").Range("c83") = Sheets("feuil27").Range("a124") * Sheets("feuil27").Range("b124")
If Sheets("feuil4").Range("g61") = 2 Then
If Sheets("feuil6").Range("c83") >= 35000000 Then
Sheets("feuil6").Range("c83") = 35000000
Else
If Sheets("feuil6").Range("c83") <= 400000 Then
Sheets("feuil6").Range("c83") = 400000
Else
End If
End If

Else
If Sheets("feuil6").Range("c83") >= 35000000 Then
Sheets("feuil6").Range("c83") = 35000000
Else
If Sheets("feuil6").Range("c83") <= 3000000 Then
Sheets("feuil6").Range("c83") = 3000000
Else
End If
End If
End If

'Impôt à retenir
If Sheets("feuil6").Range("c82") > Sheets("feuil6").Range("c83") Then
Sheets("feuil27").Range("h117") = Sheets("feuil6").Range("c82") - Sheets("feuil27").Range("e117") - Sheets("feuil27").Range("f117") - Sheets("feuil27").Range("g117")
Sheets("feuil27").Range("h117").Select
MsgBox "IMPÔT SUR LE RESULTAT  !" & Chr(10) & Chr(10) & "L'impôt à payer, avant validation, est l'IBIC de  " & Sheets("feuil6").Range("c82") & "."
Else
Sheets("feuil27").Range("h124") = Sheets("feuil6").Range("c83") - Sheets("feuil27").Range("e124") - Sheets("feuil27").Range("f124") - Sheets("feuil27").Range("g124")
Sheets("feuil27").Range("h124").Select
MsgBox "IMPÔT SUR LE RESULTAT  !" & Chr(10) & Chr(10) & "L'impôt à payer, avant validation, est l'IMF de  " & Sheets("feuil6").Range("c83") & "."
End If

'___________________________________________________________________________________________________________




MsgBox "    FIN DE L'EDITION  !"

'efface les recups des feuil2 et feuil1
Sheets("feuil2").Range("t1:za5001").ClearContents

'demande de confirmation
End If

'condition générale de traitement
End If
End Sub
Private Sub affiche_impôt_bic()
'animationv1
Sheets("feuil27").Activate
End Sub
Private Sub annuler_impôt_bic()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données
Sheets("feuil27").Range("g13").ClearContents
Sheets("feuil27").Range("g15").ClearContents
Sheets("feuil27").Range("f17").ClearContents
Sheets("feuil27").Range("b19:d19").ClearContents
Sheets("feuil27").Range("f19:h19").ClearContents
Sheets("feuil27").Range("e36").ClearContents
Sheets("feuil27").Range("h58:h59").ClearContents
Sheets("feuil27").Range("g64:g78").ClearContents
Sheets("feuil27").Range("h80").ClearContents
Sheets("feuil27").Range("g83:g86").ClearContents
Sheets("feuil27").Range("h88").ClearContents
Sheets("feuil27").Range("h90").ClearContents
Sheets("feuil27").Range("g94:g95").ClearContents
Sheets("feuil27").Range("g97").ClearContents
Sheets("feuil27").Range("h99").ClearContents
Sheets("feuil27").Range("a117").ClearContents
Sheets("feuil27").Range("h117").ClearContents
Sheets("feuil27").Range("a124").ClearContents
Sheets("feuil27").Range("h124").ClearContents
Sheets("feuil27").Range("h274:h277").ClearContents
Sheets("feuil27").Range("h300:h303").ClearContents

Sheets("feuil6").Range("c82:c83").ClearContents

End If
End Sub
Private Sub valider_impôt_bic()
'condition générale de traitement
If Sheets("feuil7").Range("g54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers N  !"
Else

'condition spécifique de traitement
If WorksheetFunction.Sum(Sheets("feuil27").Range("h58:h59")) + WorksheetFunction.Sum(Sheets("feuil27").Range("g64:g78")) + WorksheetFunction.Sum(Sheets("feuil27").Range("g83:g86")) = 0 Then
MsgBox "Désolé  !  Aucune donnée à valider."
Else

'demande de validation
If MsgBox("Confirmez vous la validation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then


'_______________________________________________________________________________________________________

'CONTRÔLES DE CORRESPONDANCE
'annule d'abord les cellules z1, z2 et z3
Sheets("feuil27").Range("z1:z3").ClearContents

'dispositions du réel simplifié sur les Déficits antérieurs, ARD et provisions (art. 48 du CGI)
If Sheets("feuil4").Range("g61") = 2 Then

If Sheets("feuil27").Range("g65") + Sheets("feuil27").Range("g83") + Sheets("feuil27").Range("g94") + Sheets("feuil27").Range("g95") + Sheets("feuil27").Range("g97") = 0 Then
Else
MsgBox "Attention  !  Les entités sous le régime du réel simplifié ne sont pas concernées par les dispositions du CGI sur les Déficits antérieurs, les ARD et les Provisions (art. 48 du CGI)." & Chr(10) & Chr(10) & "NB : Veuillez corriger les montants sur l'imprimé."
Sheets("feuil27").Range("z1") = 1
End If


Else
'pour les autres entités, contrôle des provisions non déductibles
If Sheets("feuil27").Range("g65") = WorksheetFunction.Sum(Sheets("feuil27").Range("h274:h279")) Then
Else
MsgBox "Attention  !  Le montant des Provisions non déductibles dans la rubrique REINTEGRATIONS diffère de celui du RELEVE SPECIAL DES PROVISIONS." & Chr(10) & Chr(10) & "NB : Veuillez corriger les montants."
Sheets("feuil27").Range("z2") = 1
End If
'pour les autres entités, contrôle des provisions antérieurs taxées
If Sheets("feuil27").Range("g83") = WorksheetFunction.Sum(Sheets("feuil27").Range("h300:h305")) Then
Else
MsgBox "Attention  !  Le montant des Provisions antérieuremnt taxées dans la rubrique DEDUCTIONS diffère de celui du RELEVE SPECIAL DES PROVISIONS." & Chr(10) & Chr(10) & "NB : Veuillez corriger les montants."
Sheets("feuil27").Range("z3") = 1
End If

'dispositions du réel simplifié sur les Déficits antérieurs, ARD et provisions (art. 48 du CGI)
End If



'____________________________________________________________________________

'CALCULS
'condition des calculs
If WorksheetFunction.Sum(Sheets("feuil27").Range("z1:z3")) > 0 Then
Else

'confirmation du CA TTC pour le calcul de l'IMF
Sheets("feuil27").Range("a124").Select
If MsgBox("Confirmez vous le Chiffre d'affaires TTC de  " & Sheets("feuil27").Range("a124") & "  pour le calcul de l'IMF  ?", vbYesNo, "Demande de confirmation") = vbYes Then

'efface d'abord l'IBIC et l'IMF
Sheets("feuil27").Range("a117").ClearContents
Sheets("feuil27").Range("h117").ClearContents
Sheets("feuil27").Range("h124").ClearContents
Sheets("feuil6").Range("c82:c83").ClearContents

'Résultat fiscal avant déduction des déficits antérieurs
'total des réintégrations
Sheets("feuil27").Range("h80") = WorksheetFunction.Sum(Sheets("feuil27").Range("g64:g78"))
'total des déductions
Sheets("feuil27").Range("h88") = WorksheetFunction.Sum(Sheets("feuil27").Range("g83:g86"))
'résultat fiscal avant imputation des déficits
Sheets("feuil27").Range("h90") = Sheets("feuil27").Range("h58") + Sheets("feuil27").Range("h59") + Sheets("feuil27").Range("h80") - Sheets("feuil27").Range("h88")


'Bénéfice ou perte
Sheets("feuil27").Range("h99") = Sheets("feuil27").Range("h90") - Sheets("feuil27").Range("g94") + Sheets("feuil27").Range("g95") - Sheets("feuil27").Range("g97")

'Impôt sur le bénéfice
'affectation du bénéfice
If Sheets("feuil27").Range("h99") > 0 Then
Sheets("feuil27").Range("a117") = Sheets("feuil27").Range("h99")
Sheets("feuil27").Range("a118") = Right(Sheets("feuil27").Range("a117"), 3)
Sheets("feuil27").Range("a117") = Sheets("feuil27").Range("a117") - Sheets("feuil27").Range("a118")
Sheets("feuil27").Range("a118").ClearContents
Else
End If
'calcul de l'IBIC
Sheets("feuil6").Range("c82") = Sheets("feuil27").Range("a117") * Sheets("feuil27").Range("b117")

'Impôt minimum forfaitaire (IMF)
'calcul de l'IMF
Sheets("feuil6").Range("c83") = Sheets("feuil27").Range("a124") * Sheets("feuil27").Range("b124")
If Sheets("feuil4").Range("g61") = 2 Then
If Sheets("feuil6").Range("c83") >= 35000000 Then
Sheets("feuil6").Range("c83") = 35000000
Else
If Sheets("feuil6").Range("c83") <= 400000 Then
Sheets("feuil6").Range("c83") = 400000
Else
End If
End If

Else
If Sheets("feuil6").Range("c83") >= 35000000 Then
Sheets("feuil6").Range("c83") = 35000000
Else
If Sheets("feuil6").Range("c83") <= 3000000 Then
Sheets("feuil6").Range("c83") = 3000000
Else
End If
End If
End If

'Impôt à retenir
If Sheets("feuil6").Range("c82") > Sheets("feuil6").Range("c83") Then
Sheets("feuil27").Range("h117") = Sheets("feuil6").Range("c82") - Sheets("feuil27").Range("e117") - Sheets("feuil27").Range("f117") - Sheets("feuil27").Range("g117")
Sheets("feuil27").Range("h117").Select
MsgBox "IMPÔT SUR LE RESULTAT  !" & Chr(10) & Chr(10) & "L'impôt à payer, après validation, est l'IBIC de  " & Sheets("feuil6").Range("c82") & "."
Else
Sheets("feuil27").Range("h124") = Sheets("feuil6").Range("c83") - Sheets("feuil27").Range("e124") - Sheets("feuil27").Range("f124") - Sheets("feuil27").Range("g124")
Sheets("feuil27").Range("h124").Select
MsgBox "IMPÔT SUR LE RESULTAT  !" & Chr(10) & Chr(10) & "L'impôt à payer, après validation, est l'IMF de  " & Sheets("feuil6").Range("c83") & "."
End If


'confirmation du CA TTC pour le calcul de l'IMF
End If

'condition des calculs
End If
'___________________________________________________________________________________________________________





'demande de confirmation
End If

'condition spécifique
End If

'condition générale
End If
End Sub
Private Sub patente()
'condition générale de traitement
If Sheets("feuil7").Range("g54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers N  !"
Else

'demande de validation
If MsgBox("NB :" & Chr(10) & "Veuillez vous assurer que les éléments suivants sont effectivement renseignés avant l'édition :" & Chr(10) & " - Le Secteur d'activité, le Taux du Droit sur le chiffre d'affaires et sur la valeur locative (voir ci-dessous) ;" & Chr(10) & " - L'Exercice comptable et le Centre des impôts de rattachement (voir Couverture et Fiche d'identification)." & Chr(10) & Chr(10) & "Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'annule d'abord les données
Sheets("feuil29").Range("e5").ClearContents
Sheets("feuil29").Range("f22").ClearContents
Sheets("feuil29").Range("f24").ClearContents
Sheets("feuil29").Range("f29:f35").ClearContents
Sheets("feuil29").Range("f37").ClearContents
Sheets("feuil29").Range("f41").ClearContents
Sheets("feuil29").Range("f43").ClearContents
Sheets("feuil6").Range("c84:c92").ClearContents


For i = 3 To 5000
'recup N
'compte 6221 + 6222
If Left(Sheets("feuil2").Cells(i, 1), 4) = 6221 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 6222 Then
Sheets("feuil2").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 22
If Left(Sheets("feuil2").Cells(i, 1), 2) = 22 Then
Sheets("feuil2").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 23 sauf 234 + 235 + 238
If Left(Sheets("feuil2").Cells(i, 1), 2) = 23 Then
If Left(Sheets("feuil2").Cells(i, 1), 3) = 234 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 235 Or Left(Sheets("feuil2").Cells(i, 1), 3) = 238 Then
Else
Sheets("feuil2").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
End If
Else
End If

'compte 776
If Left(Sheets("feuil2").Cells(i, 1), 3) = 776 Then
Sheets("feuil2").Cells(i, 35) = Sheets("feuil2").Cells(i, 8) 'AI
Else
End If

'compte 759
If Left(Sheets("feuil2").Cells(i, 1), 3) = 759 Then
Sheets("feuil2").Cells(i, 36) = Sheets("feuil2").Cells(i, 8) 'AJ
Else
End If

'compte 849
If Left(Sheets("feuil2").Cells(i, 1), 3) = 849 Then
Sheets("feuil2").Cells(i, 37) = Sheets("feuil2").Cells(i, 8) 'AK
Else
End If


Next


'affectation dans l'imprimé
'année d'imposition
If Sheets("feuil6").Range("h81") = "-" Then
Sheets("feuil29").Range("e5") = "-"
Else
Sheets("feuil29").Range("e5") = Year(Sheets("feuil6").Range("h81")) + 1
End If
'chiffre d'affaires HT
Sheets("feuil6").Range("c84") = Sheets("feuil6").Range("i20") + Sheets("feuil6").Range("i22") + Sheets("feuil6").Range("i23") + Sheets("feuil6").Range("i24") + Sheets("feuil6").Range("i47") + Sheets("feuil6").Range("i48") + WorksheetFunction.Sum(Sheets("feuil2").Range("ai1:ai5000")) - WorksheetFunction.Sum(Sheets("feuil2").Range("aj1:aj5000")) - WorksheetFunction.Sum(Sheets("feuil2").Range("ak1:ak5000"))
Sheets("feuil29").Range("a20").Select
If Sheets("feuil6").Range("c84") <> 0 Then
Dim resultat As Variant
    resultat = InputBox("CHIFFRE D'AFFAIRES HT  !" & Chr(10) & Chr(10) & "L'assiette du Droit sur le chiffre d'affaires est constituée du :" & Chr(10) & "Chiffre d'affaires HT  (Compte de résultat) ;" & Chr(10) & "+ Production immobilisée ;" & Chr(10) & "+ Subvention d'exploitation ;" & Chr(10) & "+ Autres produits (sauf compte 759) ;" & Chr(10) & "+ Gain de change (compte 776) ;" & Chr(10) & "+ Produits des cessions d'immobilisations ;" & Chr(10) & "+ Produits HAO (sauf 849)." & Chr(10) & Chr(10) & "1°) La base fiscale récupérée est donc de   " & Sheets("feuil6").Range("c84") & "." & Chr(10) & Chr(10) & "2°) Si cette somme ne correspond pas à votre base fiscale veuillez saisir, sans mettre d'espace (exemple 100 000), le montant à retenir pour le calcul de Droit sur le chiffre d'affaires  :", "Chiffre d'affaire HT") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil6").Range("c84") = resultat
    Else
    End If
Else
End If
'Droit sur le Chiffre d'affaires
If Sheets("feuil6").Range("c84") * Sheets("feuil29").Range("l22") <= 300000 Then
Sheets("feuil29").Range("f22") = 300000
Else
If Sheets("feuil29").Range("l22") = 7 / 1000 Then
Sheets("feuil29").Range("f22") = Sheets("feuil6").Range("c84") * Sheets("feuil29").Range("l22")
Else
If Sheets("feuil6").Range("c84") > 1000000000 Then
Sheets("feuil29").Range("f22") = 3000000
Else
If Sheets("feuil6").Range("c84") >= 500000001 Then
Sheets("feuil29").Range("f22") = 1300000
Else
If Sheets("feuil6").Range("c84") >= 200000000 Then
Sheets("feuil29").Range("f22") = 700000
Else
Sheets("feuil29").Range("f22") = 350000
End If
End If
End If
End If
End If

'exonération des hôtels au taux de 0.7% du Droit sur la valeur locative
If Sheets("feuil29").Range("l22") = 7 / 1000 Then
Else
'loyer annuel
If WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) <> 0 Then
Sheets("feuil29").Range("f24") = WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000"))
Sheets("feuil29").Range("f24").Select
Dim resultat1 As Variant
    resultat1 = InputBox("LOYER ANNUEL  !" & Chr(10) & Chr(10) & "Le loyer annuel est constitué du solde des comptes 6221 et 6222 de l'exercice N." & Chr(10) & Chr(10) & "1°) Le montant du loyer annuel récupéré est  " & WorksheetFunction.Sum(Sheets("feuil2").Range("t1:t5000")) & "." & Chr(10) & Chr(10) & "2°) Si ce montant ne correspond pas à votre loyer annuel veuillez saisir, sans mettre d'espace (exemple 100 000), le montant à retenir :", "Loyer annuel") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat1 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil29").Range("f24") = resultat1
    Else
    End If
Else
End If
'terrains
If WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) <> 0 Then
Sheets("feuil6").Range("c90") = WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000"))
Sheets("feuil29").Range("f34").Select
Dim resultat2 As Variant
    resultat2 = InputBox("TERRAINS  !" & Chr(10) & Chr(10) & "La valeur du terrain est constituée du solde du compte 22 de l'exercice N." & Chr(10) & Chr(10) & "1°) Le montant récupéré du terrain est  " & WorksheetFunction.Sum(Sheets("feuil2").Range("u1:u5000")) & "." & Chr(10) & Chr(10) & "2°) Si ce montant ne correspond pas à la valeur du terrain veuillez saisir, sans mettre d'espace (exemple 100 000), le montant à retenir pour le calcul :", "Terrains") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat2 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil6").Range("c90") = resultat2
    Else
    End If
Else
End If
'bâtiments
If WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) <> 0 Then
Sheets("feuil6").Range("c89") = WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000"))
Sheets("feuil29").Range("f33").Select
Dim resultat3 As Variant
    resultat3 = InputBox("BÂTIMENTS  !" & Chr(10) & Chr(10) & "La valeur des bâtiments est constituée du solde des comptes 231, 232, 233 et 237 de l'exercice N." & Chr(10) & Chr(10) & "1°) La valeur récupérée des bâtiments est  " & WorksheetFunction.Sum(Sheets("feuil2").Range("v1:v5000")) & "." & Chr(10) & Chr(10) & "2°) Si ce montant ne correspond pas à l'estimation des bâtiments veuillez saisir, sans mettre d'espace (exemple 100 000), le montant à retenir pour le calcul :", "Bâtiments") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat3 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil6").Range("c89") = resultat3
    Else
    End If
Else
End If
'répartition du bâtiments en bureaux, hangar, usine, etc
If Sheets("feuil6").Range("c89") <> 0 Then
'confirmation de la répartition
If MsgBox("REPARTITION BÂTIMENTS  !" & Chr(10) & Chr(10) & "Souhaitez vous répartir la valeur des Bâtiments  " & Sheets("feuil6").Range("c89") & "  en Bureaux, Magasins, Hangars ou Usines ?", vbYesNo, "Demande de confirmation") = vbYes Then
'quote-part bureaux
Dim resultat4 As Variant
    resultat4 = InputBox("REPARTITION BÂTIMENTS  !" & Chr(10) & Chr(10) & "Montant :  " & Sheets("feuil6").Range("c89") & Chr(10) & Chr(10) & "Veuillez saisir, sans espace (exemple 100 000), la quote-part affectée aux Bureaux :" & Chr(10), "Bureaux") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat4 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil6").Range("c85") = resultat4
    Else
    Sheets("feuil6").Range("c85") = 0
    End If
'quote-part magasins
Dim resultat5 As Variant
    resultat5 = InputBox("REPARTITION BÂTIMENTS  !" & Chr(10) & Chr(10) & "Montant restant :  " & Sheets("feuil6").Range("c89") - Sheets("feuil6").Range("c85") & Chr(10) & Chr(10) & "Veuillez saisir, sans espace (exemple 100 000), la quote-part affectée aux Magasins :" & Chr(10), "Magasins") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat5 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil6").Range("c86") = resultat5
    Else
    Sheets("feuil6").Range("c86") = 0
    End If
'quote-part hangars
Dim resultat6 As Variant
    resultat6 = InputBox("REPARTITION BÂTIMENTS  !" & Chr(10) & Chr(10) & "Montant restant :  " & Sheets("feuil6").Range("c89") - Sheets("feuil6").Range("c85") - Sheets("feuil6").Range("c86") & Chr(10) & Chr(10) & "Veuillez saisir, sans espace (exemple 100 000), la quote-part affectée aux Hangars :" & Chr(10), "Hangars") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat6 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil6").Range("c87") = resultat6
    Else
    Sheets("feuil6").Range("c87") = 0
    End If
'quote-part usines
Dim resultat7 As Variant
    resultat7 = InputBox("REPARTITION BÂTIMENTS  !" & Chr(10) & Chr(10) & "Montant restant :  " & Sheets("feuil6").Range("c89") - Sheets("feuil6").Range("c85") - Sheets("feuil6").Range("c86") - Sheets("feuil6").Range("c87") & Chr(10) & Chr(10) & "Veuillez saisir, sans espace (exemple 100 000), la quote-part affectée aux Usines :" & Chr(10), "Usines") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat7 <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    Sheets("feuil6").Range("c88") = resultat7
    Else
    Sheets("feuil6").Range("c88") = 0
    End If
'quote-part bâtiments
Sheets("feuil6").Range("c89") = Sheets("feuil6").Range("c89") - Sheets("feuil6").Range("c85") - Sheets("feuil6").Range("c86") - Sheets("feuil6").Range("c87") - Sheets("feuil6").Range("c88")
'confirmation de la répartition
End If
'répartition du bâtiments en bureaux, hangar, usine, etc
Else
End If

'Calculs valeurs locatives des bâtiments et terrains
'Bureaux
If Left(Sheets("feuil29").Range("k27"), 1) = "c" Then
Sheets("feuil29").Range("f29") = Sheets("feuil6").Range("c85") * 10 / 100
Else
If Left(Sheets("feuil29").Range("k27"), 1) = "i" Then
Sheets("feuil29").Range("f29") = Sheets("feuil6").Range("c85") * 15 / 100
Else
End If
End If
'Magasins
If Left(Sheets("feuil29").Range("k27"), 1) = "c" Then
Sheets("feuil29").Range("f30") = Sheets("feuil6").Range("c86") * 10 / 100
Else
If Left(Sheets("feuil29").Range("k27"), 1) = "i" Then
Sheets("feuil29").Range("f30") = Sheets("feuil6").Range("c86") * 15 / 100
Else
End If
End If
'Hangars
If Left(Sheets("feuil29").Range("k27"), 1) = "c" Then
Sheets("feuil29").Range("f31") = Sheets("feuil6").Range("c87") * 10 / 100
Else
If Left(Sheets("feuil29").Range("k27"), 1) = "i" Then
Sheets("feuil29").Range("f31") = Sheets("feuil6").Range("c87") * 15 / 100
Else
End If
End If
'Usines
If Left(Sheets("feuil29").Range("k27"), 1) = "c" Then
'Sheets("feuil29").Range("f32") = Sheets("feuil6").Range("c88") * 10 / 100
Else
If Left(Sheets("feuil29").Range("k27"), 1) = "i" Then
Sheets("feuil29").Range("f32") = Sheets("feuil6").Range("c88") * 15 / 100
Else
End If
End If
'Bâtiments
If Left(Sheets("feuil29").Range("k27"), 1) = "c" Then
Sheets("feuil29").Range("f33") = Sheets("feuil6").Range("c89") * 10 / 100
Else
If Left(Sheets("feuil29").Range("k27"), 1) = "i" Then
Sheets("feuil29").Range("f33") = Sheets("feuil6").Range("c89") * 56 / 1000
Else
End If
End If
'Terrains
If Left(Sheets("feuil29").Range("k27"), 1) = "c" Then
Sheets("feuil29").Range("f34") = Sheets("feuil6").Range("c90") * 10 / 100
Else
If Left(Sheets("feuil29").Range("k27"), 1) = "i" Then
Sheets("feuil29").Range("f34") = Sheets("feuil6").Range("c90") * 56 / 1000
Else
End If
End If
'Sous-total valeur locative bâtiments et terrains
Sheets("feuil29").Range("f35") = WorksheetFunction.Sum(Sheets("feuil29").Range("f29:f34"))
'Total valeur locative
Sheets("feuil6").Range("c91") = Sheets("feuil29").Range("f24") + Sheets("feuil29").Range("f35")
'Droit sur la valeur locative
If Sheets("feuil29").Range("l22") = 7 / 1000 Then
Sheets("feuil29").Range("f37") = 0
Else
Sheets("feuil29").Range("f37") = Sheets("feuil6").Range("c91") * Sheets("feuil29").Range("i37")
If Sheets("feuil29").Range("f37") <= Sheets("feuil29").Range("f22") / 3 Then
Sheets("feuil29").Range("f37") = Sheets("feuil29").Range("f22") / 3
Else
End If
End If
'exonération des hôtels au taux de 0.7% du Droit sur la valeur locative
End If

'Total patente(M1 + M2 + M3)
Sheets("feuil6").Range("c92") = Sheets("feuil29").Range("f22") + Sheets("feuil29").Range("f37") + Sheets("feuil29").Range("f38")
'Montant exonération
Sheets("feuil29").Range("f41") = Sheets("feuil6").Range("c92") * Sheets("feuil29").Range("m40")
'Montant de Patente due
Sheets("feuil29").Range("f43") = Sheets("feuil6").Range("c92") - Sheets("feuil29").Range("f41")




Sheets("feuil29").Range("f43").Select
MsgBox "    FIN DE L'EDITION  !" & Chr(10) & Chr(10) & "Le montant de la PATENTE DUE est de  " & Sheets("feuil29").Range("f43") & "."




'annule les données de la feuil2
Sheets("feuil2").Range("t1:za5000").ClearContents


'demande de validation
End If

'condition générale de traitement
End If
End Sub
Private Sub annuler_patente()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
Sheets("feuil29").Range("e5").ClearContents
Sheets("feuil29").Range("f22").ClearContents
Sheets("feuil29").Range("f24").ClearContents
Sheets("feuil29").Range("f29:f35").ClearContents
Sheets("feuil29").Range("f37").ClearContents
Sheets("feuil29").Range("f41").ClearContents
Sheets("feuil29").Range("f43").ClearContents

Sheets("feuil6").Range("c84:c92").ClearContents
End If
End Sub
Private Sub recherche_déséquilibre()
'condition générale d'édition
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'Insérer le chiffre de l'exercice
 Dim resultat As Variant
    resultat = InputBox("RECHERCHE DESEQUILIBRE DU T.F.T.  !" & Chr(10) & Chr(10) & "1°/ Pour l'exercice N-1 : veuillez saisir le chiffre  1." & Chr(10) & Chr(10) & "2°/ Pour l'exercice N : veuillez saisir le chiffre  2." & Chr(10), "Recherche") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    
    If resultat = 1 Then
    rechercher_tafire_n_1
    Else
    End If
    
    If resultat = 2 Then
    rechercher_tafire_n
    Else
    End If
    
 'Insérer le chiffre de l'exercice
    Else
    End If


'condition générale d'édition
End If
End Sub
Private Sub affiche_état_302()
'animationv1
Sheets("feuil20").Activate
End Sub
Private Sub précédent_feuil19()
Sheets("feuil20").Activate
Sheets("feuil20").Range("a2").Select
End Sub
Private Sub suivant_feuil20()
Sheets("feuil19").Activate
Sheets("feuil19").Range("a2").Select
End Sub
Private Sub conversion_balance_proforma()
'condition générale
If WorksheetFunction.Sum(Sheets("feuil1").Range("g3:g5000")) = 0 Then
MsgBox "CONVERSION BALANCE PROFORMA  !" & Chr(10) & Chr(10) & "Veuillez d'abord renseigner la balance  N-1  pour cette opération."
Else
       

If MsgBox("    Confirmez vous l'opération ?", vbYesNo, "Demande de confirmation") = vbYes Then
       
'active la balance N-1
Sheets("feuil1").Activate

       For i = 3 To 5000
       
       'contrôle contrats de concession de service public
       If Left(Sheets("feuil1").Cells(i, 1), 4) = 1676 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 1986 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 1982 Then
       Sheets("feuil1").Cells(i, 1).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 7).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 8).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Cells(i, 1).Select
       MsgBox "CONCESSIONS DE SERVICE PUBLIC  !" & Chr(10) & Chr(10) & "NB : Le solde du compte  " & Sheets("feuil1").Cells(i, 1) & "  doit être viré dans le compte 4752 et les éventuelles immobilisations mises en concession par le concédant à titre gratuit doivent être soldées par le compte 4751."
       Else
       End If
       
       'contrôle engagements pour retraite
       If Left(Sheets("feuil1").Cells(i, 1), 3) = 196 Then
       Sheets("feuil1").Cells(i, 1).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 7).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 8).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Cells(i, 1).Select
       MsgBox "ENGAGEMENTS DE RETRAITE  !" & Chr(10) & Chr(10) & "NB : Seules les entités présentant des comptes annuels en normes IFRS doivent réévaluer leurs provisions pour retraite selon la méthode actuarielle si ce n'était pas la méthode utilisée."
       Else
       End If
       
       'contrôle provisions pour charges à répartir
       If Left(Sheets("feuil1").Cells(i, 1), 3) = 197 Then
       Sheets("feuil1").Cells(i, 1).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 7).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 8).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Cells(i, 1).Select
       MsgBox "PROVISIONS POUR CHARGES A REPARTIR  !" & Chr(10) & Chr(10) & "NB : Le solde du compte  " & Sheets("feuil1").Cells(i, 1) & "  doit être viré dans le compte 1984 s'il s'agit d'une provision pour démantèlement, sinon dans le compte 4752."
       Else
       End If
       
       'contrôle charges immobilisées (hors prime de rembousement et frais de prospection)
       If Left(Sheets("feuil1").Cells(i, 1), 2) = 20 Then
       If Left(Sheets("feuil1").Cells(i, 1), 3) = 206 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2012 Then
       Else
       Sheets("feuil1").Cells(i, 1).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 7).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 8).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Cells(i, 1).Select
       MsgBox "CHARGES IMMOBILISEES  !" & Chr(10) & Chr(10) & "NB : Le solde du compte  " & Sheets("feuil1").Cells(i, 1) & "  doit être viré dans le compte 4751."
       End If
       Else
       End If
       
       'contrôle frais de prospection
       If Left(Sheets("feuil1").Cells(i, 1), 4) = 2012 Then
       Sheets("feuil1").Cells(i, 1).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 7).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 8).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Cells(i, 1).Select
       MsgBox "FRAIS DE PROSPECTION  !" & Chr(10) & Chr(10) & "NB : Le solde du compte  " & Sheets("feuil1").Cells(i, 1) & "  doit être viré dans le compte 4751 ou 2181 en fonction des critères d'activation utilisés."
       Else
       End If
       
       'contrôle primes de remboursement
       If Left(Sheets("feuil1").Cells(i, 1), 3) = 206 Then
       Sheets("feuil1").Cells(i, 1).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 7).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 8).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Cells(i, 1).Select
       MsgBox "PRIMES DE REMBOURSEMENT DES OBLIGATIONS  !" & Chr(10) & Chr(10) & "NB : Le solde du compte  " & Sheets("feuil1").Cells(i, 1) & "  doit être crédité par le débit du compte 161."
       Else
       End If
       
       'contrôle frais de recherche appliquée
       If Left(Sheets("feuil1").Cells(i, 1), 3) = 211 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2811 Then
       Sheets("feuil1").Cells(i, 1).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 7).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 8).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Cells(i, 1).Select
       MsgBox "FRAIS DE RECHERCHE APPLIQUEE  !" & Chr(10) & Chr(10) & "NB : Le solde du compte  " & Sheets("feuil1").Cells(i, 1) & "  doit être viré dans le compte 4751 s'il s'agit de frais de recherche appliquée."
       Else
       End If
       
       'contrôle contrats pluri-exercices
       If Left(Sheets("feuil1").Cells(i, 1), 3) = 475 Then
       Sheets("feuil1").Cells(i, 1).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 7).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 8).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Cells(i, 1).Select
       MsgBox "CONTRATS PLURI-EXERCICES  !" & Chr(10) & Chr(10) & "NB : Le solde du compte  " & Sheets("feuil1").Cells(i, 1) & "  doit être viré dans le compte 4751 avec le compte de stock utilisé (34 ou 35)."
       Else
       End If
       
       'contrôle transports sur achats
       If Left(Sheets("feuil1").Cells(i, 1), 3) = 611 Then
       Sheets("feuil1").Cells(i, 1).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 7).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 8).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Cells(i, 1).Select
       MsgBox "TRANSPORTS SUR ACAHTS  !" & Chr(10) & Chr(10) & "NB : Le solde du compte  " & Sheets("feuil1").Cells(i, 1) & "  doit être viré dans le compte 60.Achats correspondant."
       Else
       End If
       
       'contrôle assurances transport sur achats
       If Left(Sheets("feuil1").Cells(i, 1), 4) = 6256 Then
       Sheets("feuil1").Cells(i, 1).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 7).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 8).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Cells(i, 1).Select
       MsgBox "ASSURANCES TRANSPORT SUR ACAHTS  !" & Chr(10) & Chr(10) & "NB : Le solde du compte  " & Sheets("feuil1").Cells(i, 1) & "  doit être viré dans le compte 60.Achats correspondant."
       Else
       End If
       
       'contrôle commissions et courtages sur achats
       If Left(Sheets("feuil1").Cells(i, 1), 4) = 6321 Then
       Sheets("feuil1").Cells(i, 1).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 7).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 8).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Cells(i, 1).Select
       MsgBox "COMMISSIONS ET COURTAGES SUR ACAHTS  !" & Chr(10) & Chr(10) & "NB : Le solde du compte  " & Sheets("feuil1").Cells(i, 1) & "  doit être viré dans le compte 60.Achats correspondant."
       Else
       End If
       
       'contrôle rémunérations des transitaires
       If Left(Sheets("feuil1").Cells(i, 1), 4) = 6323 Then
       Sheets("feuil1").Cells(i, 1).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 7).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 8).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Cells(i, 1).Select
       MsgBox "REMUNERATIONS DES TRANSITAIRES  !" & Chr(10) & Chr(10) & "NB : Le solde du compte  " & Sheets("feuil1").Cells(i, 1) & "  doit être viré dans le compte 60.Achats correspondant."
       Else
       End If
       
       'contrôle reprises subventions d'investissement
       If Left(Sheets("feuil1").Cells(i, 1), 3) = 865 Then
       Sheets("feuil1").Cells(i, 1).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 7).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Sheets("feuil1").Cells(i, 8).Font.Color = RGB(255, 255, 0) 'Couleur jaune
       Cells(i, 1).Select
       MsgBox "REPRISES DE SUBVENTIONS D'INVESTISSEMENT  !" & Chr(10) & Chr(10) & "NB : Le solde du compte  " & Sheets("feuil1").Cells(i, 1) & "  doit être viré dans le compte 799."
       Else
       End If
         
         
       Next


MsgBox "      FIN DE L'OPERATION  !"


'demande de confirmation
End If

'condition générale
End If
End Sub
Private Sub install()
'condition d'installation
If Sheets("feuil12").Range("a100") = "" Then

'Insérer le code d'installation
 Dim resultat As Variant
    resultat = InputBox("INSTALLATION  !" & Chr(10) & Chr(10) & "Veuillez saisir, en majuscule, votre CODE d'installation :" & Chr(10), "INSTALL") 'La variable reçoit la valeur entrée dans l'InputBox
    If resultat <> "" Then 'Si la valeur est différente de "" on affiche le résultat
    
    If resultat = "ILLICO_INS2018" Or resultat = "ILLICO_INS2019" Then
    Sheets("feuil12").Range("a100") = Left(Sheets("feuil12").Range("a101"), 10)
    MsgBox "       Bienvenue Papa  !" & Chr(10) & "Votre logiciel pédagogique d'états financiers." & Chr(10) & Chr(10) & "                  Licence : Cabinet ILLICO" & Chr(10) & "Téléphone : +225 07 16 95 60 / +225 06 68 63 82"
    Else
     Sheets("feuil12").Range("a100") = Left(Sheets("feuil12").Range("a101"), 10)
    MsgBox "       Bienvenue Papa  !" & Chr(10) & "Votre logiciel pédagogique d'états financiers." & Chr(10) & Chr(10) & "                  Licence : Cabinet ILLICO" & Chr(10) & "Téléphone : +225 07 16 95 60 / +225 06 68 63 82"
    End If
    
    'Si la valeur est différente de "" on affiche le résultat
    Else
    End If
    
'condition d'installation
Else
MsgBox "Désolé  !  Installation déjà effectuée."
End If
End Sub
Private Sub entreprise()
'MsgBox "SAISIR DONNEES ENTREPRISE" & Chr(10) & Chr(10) & "Désolé  !  Vous avez une version DEMO."
Sheets("feuil12").Activate
Sheets("feuil12").Range("a2").Select
End Sub
Private Sub note_3B()
'condition générale de traitement de la NOTE 3B
If Sheets("feuil7").Range("g54") = "" And Sheets("feuil7").Range("h54") = "" Then
MsgBox "Veuillez d'abord éditer vos Etats financiers  !"
Else

'condition spécifique de traitement de la NOTE 3B
If Sheets("feuil5").Range("m31") + Sheets("feuil5").Range("n31") = 0 Then
MsgBox "Désolé  !  Aucune dette de location acquisition comptabilisée."
Else

'demande de confirmation
If MsgBox("Confirmez vous l'édition des données ?", vbYesNo, "Demande de confirmation") = vbYes Then

'traitement des données du TABLEAU
'annule les données du Tableau
Sheets("feuil23").Range("b88:i92").ClearContents


For i = 3 To 5000
'recup SOLDE N
'compte 2286
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2286 Then
Sheets("feuil23").Cells(i, 20) = Sheets("feuil2").Cells(i, 7) 'T
Else
End If

'compte 2316+2326
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2316 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2326 Then
Sheets("feuil23").Cells(i, 21) = Sheets("feuil2").Cells(i, 7) 'U
Else
End If

'compte 2416+2426+2446
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2416 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2426 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2446 Then
Sheets("feuil23").Cells(i, 22) = Sheets("feuil2").Cells(i, 7) 'V
Else
End If

'compte 2456
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2456 Then
Sheets("feuil23").Cells(i, 23) = Sheets("feuil2").Cells(i, 7) 'W
Else
End If


'recup MVT AUGMENTATION
'compte 2286
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2286 Then
Sheets("feuil23").Cells(i, 24) = Sheets("feuil2").Cells(i, 5) 'X
Else
End If

'compte 2316+2326
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2316 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2326 Then
Sheets("feuil23").Cells(i, 25) = Sheets("feuil2").Cells(i, 5) 'Y
Else
End If

'compte 2416+2426+2446
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2416 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2426 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2446 Then
Sheets("feuil23").Cells(i, 26) = Sheets("feuil2").Cells(i, 5) 'Z
Else
End If

'compte 2456
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2456 Then
Sheets("feuil23").Cells(i, 27) = Sheets("feuil2").Cells(i, 5) 'AA
Else
End If


'recup MVT DIMINUTION
'compte 2286
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2286 Then
Sheets("feuil23").Cells(i, 28) = Sheets("feuil2").Cells(i, 6) 'AB
Else
End If

'compte 2316+2326
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2316 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2326 Then
Sheets("feuil23").Cells(i, 29) = Sheets("feuil2").Cells(i, 6) 'AC
Else
End If

'compte 2416+2426+2446
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2416 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2426 Or Left(Sheets("feuil2").Cells(i, 1), 4) = 2446 Then
Sheets("feuil23").Cells(i, 30) = Sheets("feuil2").Cells(i, 6) 'AD
Else
End If

'compte 2456
If Left(Sheets("feuil2").Cells(i, 1), 4) = 2456 Then
Sheets("feuil23").Cells(i, 31) = Sheets("feuil2").Cells(i, 6) 'AE
Else
End If


'recup SOLDE N-1
'compte 2286
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2286 Then
Sheets("feuil13").Cells(i, 32) = Sheets("feuil1").Cells(i, 7) 'AF
Else
End If

'compte 2316+2326
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2316 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2326 Then
Sheets("feuil13").Cells(i, 33) = Sheets("feuil1").Cells(i, 7) 'AG
Else
End If

'compte 2416+2426+2446
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2416 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2426 Or Left(Sheets("feuil1").Cells(i, 1), 4) = 2446 Then
Sheets("feuil13").Cells(i, 34) = Sheets("feuil1").Cells(i, 7) 'AH
Else
End If

'compte 2456
If Left(Sheets("feuil1").Cells(i, 1), 4) = 2456 Then
Sheets("feuil13").Cells(i, 35) = Sheets("feuil1").Cells(i, 7) 'AI
Else
End If


Next

'affecte SOLDE N
'compte 2286
Sheets("feuil23").Range("i88") = WorksheetFunction.Sum(Sheets("feuil23").Range("t1:t5000"))
'compte 2316+2326
Sheets("feuil23").Range("i89") = WorksheetFunction.Sum(Sheets("feuil23").Range("u1:u5000"))
'compte 2416+2426+2446
Sheets("feuil23").Range("i91") = WorksheetFunction.Sum(Sheets("feuil23").Range("v1:v5000"))
'compte 2456
Sheets("feuil23").Range("i92") = WorksheetFunction.Sum(Sheets("feuil23").Range("w1:w5000"))

'affecte AUGMENTATION N
'compte 2286
Sheets("feuil23").Range("c88") = WorksheetFunction.Sum(Sheets("feuil23").Range("x1:x5000"))
'compte 2316+2326
Sheets("feuil23").Range("c89") = WorksheetFunction.Sum(Sheets("feuil23").Range("y1:y5000"))
'compte 2416+2426+2446
Sheets("feuil23").Range("c91") = WorksheetFunction.Sum(Sheets("feuil23").Range("z1:z5000"))
'compte 2456
Sheets("feuil23").Range("c92") = WorksheetFunction.Sum(Sheets("feuil23").Range("aa1:aa5000"))

'affecte DIMINUTION N
'compte 2286
Sheets("feuil23").Range("f88") = WorksheetFunction.Sum(Sheets("feuil23").Range("ab1:ab5000"))
'compte 2316+2326
Sheets("feuil23").Range("f89") = WorksheetFunction.Sum(Sheets("feuil23").Range("ac1:ac5000"))
'compte 2416+2426+2446
Sheets("feuil23").Range("f91") = WorksheetFunction.Sum(Sheets("feuil23").Range("ad1:ad5000"))
'compte 2456
Sheets("feuil23").Range("f92") = WorksheetFunction.Sum(Sheets("feuil23").Range("ae1:ae5000"))

'affecte SOLDE N-1
'compte 2286
Sheets("feuil23").Range("b88") = WorksheetFunction.Sum(Sheets("feuil23").Range("af1:af5000"))
'compte 2316+2326
Sheets("feuil23").Range("b89") = WorksheetFunction.Sum(Sheets("feuil23").Range("ag1:ag5000"))
'compte 2416+2426+2446
Sheets("feuil23").Range("b91") = WorksheetFunction.Sum(Sheets("feuil23").Range("ah1:ah5000"))
'compte 2456
Sheets("feuil23").Range("b92") = WorksheetFunction.Sum(Sheets("feuil23").Range("ai1:ai5000"))


'__________________________________________________________________________________________________
'Calculs du tableau 2 - Amortissements

'sous-total immob. incorporelles
'Sheets("feuil23").Range("b123") = WorksheetFunction.Sum(Sheets("feuil23").Range("b119:b122")) 'SOLDE N-1
'Sheets("feuil23").Range("c123") = WorksheetFunction.Sum(Sheets("feuil23").Range("c119:c122")) 'augmentation
'Sheets("feuil23").Range("e123") = WorksheetFunction.Sum(Sheets("feuil23").Range("e119:e122")) 'diminution
'Sheets("feuil23").Range("g123") = WorksheetFunction.Sum(Sheets("feuil23").Range("g119:g122")) 'SOLDE N

'sous-total immob. corporelles
'Sheets("feuil23").Range("b132") = WorksheetFunction.Sum(Sheets("feuil23").Range("b125:b131")) 'SOLDE N-1
'Sheets("feuil23").Range("c132") = WorksheetFunction.Sum(Sheets("feuil23").Range("c125:c131")) 'augmentation
'Sheets("feuil23").Range("e132") = WorksheetFunction.Sum(Sheets("feuil23").Range("e125:e131")) 'diminution
'Sheets("feuil23").Range("g132") = WorksheetFunction.Sum(Sheets("feuil23").Range("g125:g131")) 'SOLDE N

'total général
'Sheets("feuil23").Range("b133") = Sheets("feuil23").Range("b123") + Sheets("feuil23").Range("b132") 'SOLDE N-1
'Sheets("feuil23").Range("c133") = Sheets("feuil23").Range("c123") + Sheets("feuil23").Range("c132") 'augmentation
'Sheets("feuil23").Range("e133") = Sheets("feuil23").Range("e123") + Sheets("feuil23").Range("e132") 'diminution
'Sheets("feuil23").Range("g133") = Sheets("feuil23").Range("g123") + Sheets("feuil23").Range("g132") 'SOLDE N

'CALCUL ET AFFICHE LES ECRATS DU TABLEAU 2
For i = 88 To 92
If Sheets("feuil23").Cells(i, 2) + Sheets("feuil23").Cells(i, 3) + Sheets("feuil23").Cells(i, 4) + Sheets("feuil23").Cells(i, 5) - Sheets("feuil23").Cells(i, 6) - Sheets("feuil23").Cells(i, 7) - Sheets("feuil23").Cells(i, 9) = 0 Then
Else
Sheets("feuil23").Cells(i, 10) = "Ecart"
Sheets("feuil23").Cells(i, 11) = Sheets("feuil23").Cells(i, 2) + Sheets("feuil23").Cells(i, 3) + Sheets("feuil23").Cells(i, 4) + Sheets("feuil23").Cells(i, 5) - Sheets("feuil23").Cells(i, 6) - Sheets("feuil23").Cells(i, 7) - Sheets("feuil23").Cells(i, 9)
End If
Next
'___________________________________________________________________________________________________


'efface les recups de la feuil23
Sheets("feuil23").Range("t1:za5001").ClearContents


MsgBox "    FIN DE L'EDITION  !"

'demande de confirmation
End If

'condition spécifique de traitement
End If

'condition générale de traitement
End If

End Sub
Private Sub annuler_note_3B()
If MsgBox("Confirmez vous l'annulation des données ?", vbYesNo, "Demande de confirmation") = vbYes Then
'annule les données du Tableau
Sheets("feuil23").Range("b88:k92").ClearContents
End If
End Sub
Private Sub animationv1()
'If Sheets("feuil28").Range("a1") = "" Then

'Véhicule
Sheets("feuil28").Shapes("Image 17").Top = 7.5
Sheets("feuil28").Shapes("Image 17").Left = 700
Sheets("feuil28").Range("a1").Select


secondes = 0.1
timer_avant = Timer
Do While Timer < timer_avant + secondes
    DoEvents
Loop

'Véhicule
Sheets("feuil28").Shapes("Image 17").Left = 800
Sheets("feuil28").Range("a1").Select

'Else
'End If
End Sub
Private Sub animationG()
'If Sheets("feuil28").Range("a1") = "" Then

Sheets("feuil28").Shapes("Picture 57").Top = 65
Sheets("feuil28").Shapes("Picture 57").Left = 5
'Sheets("feuil28").Range("a1").Select


secondes = 0.1
timer_avant = Timer
Do While Timer < timer_avant + secondes
    DoEvents
Loop


Sheets("feuil28").Shapes("Picture 57").Left = 0
'Sheets("feuil28").Range("a1").Select

'Else
'End If
End Sub


